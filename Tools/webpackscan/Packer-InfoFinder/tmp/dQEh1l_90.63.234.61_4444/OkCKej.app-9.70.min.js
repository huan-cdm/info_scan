function cm_update_certificate_status(a,b){if(typeof a!="number"||a!==0&&a!==1)console.log("function cm_update_certificate_status certUsed parameter is wrong");else{if(typeof b!="number"||b!==1&&b!==2){console.log("function cm_update_certificate_status serverNumber:"+b+" is wrong");return}var c=_LOC("rXvWnFMtkQ","Certificate status"),d="",e=new Template('<span style="float:left;">#{message_prefix}:</span><img src="#{img_src}" style="float:left; position: relative; top:-2px; padding: 0px 2px 0px 5px;"><span style="float:left;">#{message_content}</span>');a?d=e.evaluate({message_prefix:c,img_src:"wfe/asg/img/icons/check.png",message_content:_LOC("bMcRUytEfy","Certificate available")}):d=e.evaluate({message_prefix:c,img_src:"wfe/asg/img/icons/cancel.png",message_content:_LOC("qzIeVDtbNL","No certificate available")});var f=$("ELEMENT_cm_server"+b+"_cert_status");f==undefined?console.log("function cm_update_certificate_status certificate status element not found for server:"+b):f.innerHTML=d}}function cm_show_result_text(a,b){if(typeof a!="string"||typeof b!="string")console.log("function cm_show_result_text parameters aren't strings");else{var c=b==="success"?"green":"red",d=b==="success"?_LOC("nQPZxFONzC","Successfully removed certificate"):_LOC("kiMjbTZIhM","Couldn&rsquo;t delete certificate. Find more information in the log files."),e=$(a);e==undefined?console.log("function cm_show_result_text htmlElement "+a+" not found"):(e.style.color=c,e.innerHTML=d,window.setTimeout(function(){e.textContent=""},1e4))}}function cm_remove_cert_callback(a,b){if(b!==1&&b!==2)console.log("function cm_remove_cert_callback parameter: Server number is not valid");else{if(typeof a!="string"){console.log("function cm_remove_cert_callback parameter: status is not a string");return}var c=b===1?"ELEMENT_cm_acc_error":"ELEMENT_cm_acc2_error";cm_show_result_text(c,a)}}function cm_remove_cert(a){if(a===1||a===2){confirm_dialog({message:'<div id="cm_confirm_popup">'+_LOC("PCXSmGQerS","Delete SUM server certificate?")+"</div>",modal:!0,ok_cb:function(){call_fid("cm_remove_cert",{serverNumber:a})}});var b=$("cm_confirm_popup");b!=undefined&&(b.parentNode.style.width="200px")}else console.log("function cm_remove_cert: Server number is not valid")}function migration_confirm_win_wizard(a){console.log("migration_confirm_win_wizard-> message: "+a);var b={message:a,container:'<div style="width:100%; height:100%" id="_migration_confirm_win_container"></div>'};migration_confirm_win(b)}function migration_error_win_wizard(a){console.log("migration_error_win_wizard-> message: "+a);var b="_migration_error_win_container";$(b)!=undefined&&_migration_error_win!=undefined&&(console.log("migration error win already exists, will close old one and open a new window"),_migration_error_win.close());var c={message:a,container:'<div style="width:100%; height:100%" id="'+b+'"></div>'};migration_error_win(c)}function close_wizard_goto(a,b,c){b=typeof b=="string"&&b?b:"",c=typeof c=="string"&&c?c:"",typeof a=="string"&&a&&(core.wizard.wizards.Migration.cancel(),window.setTimeout(function(){core.menu.link(a,b,c)},1e3))}function minitable_ex_init(a,b){var c=$(a);c.innerHTML="",b.originalParent=a,core.minitableMap[b.name]=null;var d=new asg.smtp.minitable_ex(b);core.minitableMap[b.name]=d,c.appendChild(d.htmlElement)}function dataProtectionCCLFilterListInit(a,b,c,d){function q(a,b,c,d){var e=document.getElementById(a),f=e.childNodes[0],g={};d&&(i=d),c?(g=c,g.position="static"):g={position:"static",height:"300px",width:"100%",overflowY:"scroll",overflowX:"hidden"},h=domDiv(g,{id:b},{},f),e.appendChild(h)}function p(){var a=h.getElementsByTagName("input"),b=[],c=[],d=0,g=0,i=0,j=0;for(temp in f)f.hasOwnProperty(temp)&&f[temp]!="show_all"&&b.push("groupid_"+f[temp]);j=b.length;if(j>0){for(i=a.length;d<i;d++)a[d].parentNode.parentNode.hide();a=h.getElementsByClassName(b[0]);for(d=0,i=a.length;d<i;d++)if(j>1)for(g=1;g<j;g++)a[d].className.indexOf(b[g])<0||e&&!o(a[d])?n(a[d]):m(a[d]);else(!e||o(a[d]))&&m(a[d])}else for(i=a.length;d<i;d++)!e||o(a[d])?a[d].parentNode.parentNode.show():a[d].parentNode.parentNode.hide()}function o(a){return i?a.parentNode.parentNode.getElementsByTagName("input")[0].checked:a.checked}function n(a){i?a.parentNode.parentNode.parentNode.hide():a.parentNode.parentNode.hide()}function m(a){i?a.parentNode.parentNode.parentNode.show():a.parentNode.parentNode.show()}function l(){var a=null;g||(g=Builder.node("div",{style:'position:static;width:"330px";display:block;',id:h.id+"_filter_box_group"},null),h.parentNode.insertBefore(g,h));return g}function k(a,b){e=a.checked,p()}function j(a,b){f[a.id]=a.value,p()}var e=0,f={},g,h,i=0;q(a,b,d,c);return{addCCLListFilter:function(a,c,d,e,f,g){var h,i,k,m={values:e,labels:d,value:e[0],name:a};g&&(m.icons=g),filterElement=new core.dropdown(m),f||(f=j),k=l(),filterElement.htmlElement.style="width:110px;margin-right:5px;",filterElement.htmlElement.id=a,filterElement.htmlElement.observe("change",function(a){f(this,b)}),i=Builder.node("div",{style:"position:static;width:165px;display:inline-block;",id:"ELEMENT_DIV_"+a+"_container_box"},[c,Builder.node("div",{style:"width:10px;display:inline-block;"}),filterElement.htmlElement]),k.appendChild(i)},addCheckBoxItem:function(a,c,d){var e,f,g;d||(d=k),f=l(),g=Builder.node("input",{type:"checkbox",id:a}),g.observe("change",function(a){d(this,b)}),e=Builder.node("div",{style:"position:static;width:175px;display:block;margin-right:5px;margin-top:5px;",id:"ELEMENT_DIV_"+a+"_container_box"},[g,Builder.node("div",{style:"width:10px;display:inline-block;"}),c]),f.appendChild(e)},addTextBox:function(a,b,c,d){var e,f,g,h,i,j;c?h="width:355px;display:inline-block;margin-top:5px;text-align:left;"+c:h="width:355px;display:inline-block;margin-top:5px;text-align:left;",d?i="display:inline-block;float:right;"+d:i="display:inline-block;float:right;",j=Builder.node("div",{style:h,id:"ELEMENT_DIV_"+a+"_container_box"},null),j.innerHTML=b,f=l(),e=Builder.node("div",{align:"right",width:"420px",style:i,id:"ELEMENT_DIV_"+a+"_container_box"},j),f.appendChild(e)},addHRLine:function(){var a,b,c;b=l(),a=Builder.node("div",{style:"width:100%;height:1px;border-top:1px dotted #ababab;display:block;margin-top:5px;",id:"ELEMENT_HR_LINE"},[Builder.node("img",{style:"width:1px;height:1px;",src:"core/img/blank1x1.gif"})]),b.appendChild(a)},checkGroupAltering:function(a){var b=this.className.replace(/^\s+|\s+$/g,"").split(" "),c,d=!1,e="";i&&(b=this.parentNode.childNodes[1].childNodes[0].className.replace(/^\s+|\s+$/g,"").split(" "));while(c=b.pop())c!="data_protection_active"&&c!="data_protection_inactive"&&c!="data_protection_hover"&&(c=="data_protection_group_head"?d=!0:c=="data_protection_group_item"?d=!1:e=c);if(e!=""){var f=0,g=!1,h=0;b=a.getElementsByClassName(e);while(b.length>f&&!g){var j=null;i?j=b[f].parentNode.parentNode.childNodes[0]:j=b[f];if(j.type&&j.type=="checkbox")if(d){if(d&&j!=this)if(this.checked)j.setAttribute("prev_value",j.checked),j.checked=!0,j.disabled=!0;else{var k=j.getAttribute("prev_value");k!==null&&(k=k==="false"?!1:!0,j.disabled=!1,j.readonly=!1,j.checked=k)}}else g=!j.checked&&f!=0;f++}!d&&!g&&(i?document.getElementsByClassName(e)[0].parentNode.parentNode.childNodes[0].click():document.getElementsByClassName(e)[0].click())}return!0},AddEventListener:function(a,b,c){var d=c||"input",e=h.getElementsByTagName(d);for(var f=0;f<e.length;f++)e[f].observe(a,function(a){b.call(this,h)})}}}function close_directory_browser(a,b){popup_close(a),b&&($(b).style.display="")}function tree_node_gui(a,b){var c=[],d=document.createElement("img"),e=document.createElement("div"),f;b.nodelist.each(function(d,e){var f=document.createElement("img"),g,h,i;f.src="wfe/"+applicationName+"/img/edir_browser/ldap-blank18x18.gif";if(e==b.nodelist.length-1)b.type=="tree"?f.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-open.gif":b.open?b.end?f.src="wfe/"+applicationName+"/img/edir_browser/ldap-open-end.gif":f.src="wfe/"+applicationName+"/img/edir_browser/ldap-open.gif":b.end?f.src="wfe/"+applicationName+"/img/edir_browser/ldap-closed-end.gif":f.src="wfe/"+applicationName+"/img/edir_browser/ldap-closed.gif",f.onclick=function(){tree_node_click(a,b.ref)},b.statusImg=f;else{g=a.stateOrder.indexOf(b.ref);for(h=g-1;h>=0;h--){i=a.stateObjs[a.stateOrder[h]];if(i.nodelist.length==e+1){i.end||(f.src="wfe/"+applicationName+"/img/edir_browser/ldap-vline-nolink.gif");break}}}c.push(f)}),d.style.display="block",b.type==="tree"?d.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree.png":b.type==="o"?d.src="wfe/"+applicationName+"/img/edir_browser/ldap-root.png":d.src="wfe/"+applicationName+"/img/edir_browser/ldap-container.png",d.style.marginRight="2px",e.innerHTML=b.name,c.push(d),c.push(e),f=domRow(c),f.style.cursor="pointer",f.style.padding="0",f.style.margin="0",f.style.height="18px",f.onclick=function(){tree_node_active(a,b.ref)},b.dom=f;return f}function tree_node_click_open(a){if(a.error&&!myDirectoryBrowserCritical)myDirectoryBrowserCritical=!0,alert(a.error);else{var b=$(a.container_id).self,c=b.stateObjs[a.stateObj_ref];if(!a.nodes)return!0;var d=!1,e=b.stateOrder.indexOf(c.ref)+1;e<b.stateOrder.length&&(d=b.stateObjs[b.stateOrder[e]].dom),a.nodes.each(function(e,f){var g=[];c.nodelist.each(function(a,b){g.push(a)}),g.push(e.value);var h={name:e.name,ref:e.value,type:e.type,open:!1,active:!1,nodelist:g};f==a.nodes.length-1&&(h.end=!0);if(d){var i=b.stateOrder[b.stateOrder.indexOf(c.ref)+f];b.stateOrder.splice(b.stateOrder.indexOf(c.ref)+f,1,i,h.ref),b.treeDiv.insertBefore(tree_node_gui(b,h),d)}else b.stateOrder.push(h.ref),b.treeDiv.appendChild(tree_node_gui(b,h));b.stateObjs[e.value]=h}),c.statusImg&&(a.nodes.length>0?c.end?c.type=="tree"?c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-open.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-open-end.gif":c.type=="tree"?c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-open.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-open.gif":(c.empty=!0,c.end?c.type=="tree"?c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-open.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-vline-end.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-vline.gif")),c.open=!0}}function tree_node_click(a,b){if(!myDirectoryBrowserCritical){var c=a.stateObjs[b];if(!c.open){var d={objs:[{FID:a.nodes_fid,nodelist:c.nodelist,stateObj_ref:c.ref,container_id:a.container_id,browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,context:myDirectoryBrowserContext,callback:"tree_node_click_open"}]};req_send(d)}else{var e=a.stateOrder.indexOf(c.ref);for(var f=e+1;f<a.stateOrder.length;f++){if(a.stateObjs[a.stateOrder[f]].nodelist.length<=c.nodelist.length)break;a.treeDiv.removeChild(a.stateObjs[a.stateOrder[f]].dom),a.stateOrder.splice(f,1),f--}c.statusImg&&!c.empty&&(c.end?c.type=="tree"?c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-closed.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-closed-end.gif":c.type=="tree"?c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-tree-closed.gif":c.statusImg.src="wfe/"+applicationName+"/img/edir_browser/ldap-closed.gif"),c.open=!1}}}function tree_node_active(a,b){var c=a.stateObjs[b];c.active||(a.stateOrder.each(function(b,c){a.stateObjs[b].dom.style.backgroundColor="white",a.stateObjs[b].active=!1}),c.dom.style.backgroundColor="#dddddd",c.active=!0,tree_display_update(a,c.nodelist))}function tree_display_update_callback(a){if(a.error&&!myDirectoryBrowserCritical)myDirectoryBrowserCritical=!0,alert(a.error);else{var b=$(a.container_id).self;if(!a.leaves)return!0;a.leaves.each(function(a,c){var d,e,f,g;switch(a.type){case"user":if(myShowOption=="group")return;break;case"group":if(myShowOption=="user")return;break;default:if(myShowOption!="all")return}d=document.createElement("div"),d.innerHTML=a.name,e=document.createElement("img"),e.style.display="block",e.style.marginRight="2px",a.type=="user"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-user.gif":a.type=="group"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-group.png":a.type=="o"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-root.png":e.src="wfe/"+applicationName+"/img/edir_browser/ldap-container.png",f=domRow([e,d]),f.style.height="16px",f.style.padding="1px 0px 1px 0px",f.style.margin="0",f.style.cursor="pointer",f.style.minWidth=b.displayDiv.style.width,f.style.display="inline",b.displayDiv.appendChild(f),g=new treeDraggable(f,a.value),treeDndMgr.registerDraggable(g)})}}function tree_display_update(a,b){if(!myDirectoryBrowserCritical){myLastNodelist=b,a.displayDiv.innerHTML="";var c={objs:[{FID:a.leaves_fid,nodelist:b,container_id:a.container_id,browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,context:myDirectoryBrowserContext,callback:"tree_display_update_callback"}]};req_send(c)}}function tree_defaults_callback(a){if(a.error&&!myDirectoryBrowserCritical)myDirectoryBrowserCritical=!0,alert(a.error);else{var b=$(a.container_id).self;mySelectedItems&&b.dropzone.accept(mySelectedItems);if(!a.leaves)return!0;a.leaves.each(function(a,c){var d=document.createElement("div");d.innerHTML=a.name;var e=document.createElement("img");e.style.display="block",e.style.marginRight="2px",a.type=="user"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-user.gif":a.type=="group"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-group.png":a.type=="o"?e.src="wfe/"+applicationName+"/img/edir_browser/ldap-root.png":e.src="wfe/"+applicationName+"/img/edir_browser/ldap-container.png";var f=domRow([e,d]);f.style.height="16px",f.style.padding="1px 0px 1px 0px",f.style.margin="0",f.style.cursor="pointer";var g=new treeDraggable(f,a.value);b.dropzone.accept([g])})}}function tree_change_context(a,b){var c=$(b).self,d;myDirectoryBrowserContext=core.dropdownMap[a].getValue(),myDirectoryBrowserLinkedList=myLdapDropZone.memberList(),c.root_name=myDirectoryBrowserContext,b=$(c.container_id),b.removeChild(b.firstChild),d={container:c.container_id,width:750,height:479,root_name:c.root_name,nodes_fid:c.nodes_fid,leaves_fid:c.leaves_fid,defaults_fid:c.defaults_fid,linked_list:myDirectoryBrowserLinkedList,browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,context:myDirectoryBrowserContext},tree_init(d)}function tree_change_server(a,b,c,d){var e=$(d).self,f,g,h;myDirectoryBrowserRef=core.dropdownMap[a].getValue(),myDirectoryBrowserLinkedList=myLdapDropZone.memberList();if(myBrowserContexts&&core.dropdownMap[c]){core.dropdownMap[c].clearOptions(),g=myBrowserContexts[myDirectoryBrowserRef];for(h=0;h<g.length;h++)core.dropdownMap[c].addOption(g[h],g[h])}e.root_name="",d=$(e.container_id),d.removeChild(d.firstChild),f={container:e.container_id,width:750,height:479,root_name:e.root_name,nodes_fid:e.nodes_fid,leaves_fid:e.leaves_fid,defaults_fid:e.defaults_fid,linked_list:myDirectoryBrowserLinkedList,browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,context:""},tree_init(f)}function show_type_change(a,b){var c=core.dropdownMap[a].getValue(),d=$(b).self;myShowOption=c,tree_display_update(d,myLastNodelist)}function tree_defaults(a,b){if(!myDirectoryBrowserCritical){var c={objs:[{FID:a.defaults_fid,valuelist:b,container_id:a.container_id,browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,context:myDirectoryBrowserContext,callback:"tree_defaults_callback"}]};req_send(c)}}function tree_init(a){var b=a,c=$(a.container),d,e,f=[],g;myDirectoryBrowserType=a.browser_type,myDirectoryBrowserRef=a.browser_ref,myDirectoryBrowserContext=a.context,myDirectoryBrowserCritical=!1,a.browser_contexts&&(myBrowserContexts=a.browser_contexts),b.container_id=c.id,b.width||(b.width=700),b.height||(b.height=500),d=Math.floor(b.width/6*3),e=Math.floor(b.height/5*2),b.dropDiv=domDiv({backgroundImage:"url(core/img/dnd_dropzone_bg.png)",border:"1px dotted #ddd",overflow:"auto",width:b.width-6+"px",height:e-5+"px",padding:"2px 2px 2px 2px"},{},{}),b.dropzone=new treeDropzone(b.dropDiv),treeDndMgr.registerDropZone(b.dropzone),b.dropzone.accept(mySelectedItems),b.treeDiv=domDiv({backgroundColor:"#fdfdfd",border:"1px dotted #ddd",overflow:"auto",width:d-6+"px",height:b.height-e-6-5+"px",padding:"2px 2px 2px 2px"},{},{}),b.displayDiv=domDiv({backgroundColor:"#fdfdfd",border:"1px dotted #ddd",overflow:"auto",width:b.width-5-6-d+"px",height:b.height-e-6-5+"px",padding:"2px 2px 2px 2px"},{},{}),c.appendChild(domTableCol([domTd({paddingBottom:"5px"},{},{},domTableRow([domTd({paddingRight:"5px"},{},{},b.treeDiv),domTd({},{},{},b.displayDiv)])),domTd({paddingBottom:"5px"},{},{},b.dropDiv)])),b.stateObjs={__root:{name:b.root_name,ref:"__root",open:!1,active:!1,end:!0,type:"tree",nodelist:["__root"]}},b.stateOrder=["__root"],b.treeDiv.appendChild(tree_node_gui(b,b.stateObjs.__root)),c.self=b,myDirectoryBrowserLinkedList?(f=myDirectoryBrowserLinkedList,myDirectoryBrowserLinkedList=!1):b.linked_list&&(g=core.listMap[b.linked_list],g&&(f=g.memberValues())),f.length>0&&tree_defaults(b,f),tree_node_click(b,"__root"),tree_node_active(b,"__root")}function directory_browser_init(a,b,c,d,e){var f=$("display"),g={linked_list:a};d&&(myDirectoryBrowserSourceForm=d,g.source_form=d,$(d)&&($(d).style.display="none")),mySelectedItems=[],myDirectoryBrowserType=b,myDirectoryBrowserRef=c,new core.popup({name:"DIRECTORY_BROWSER","class":"directory_browser",type:"browser",browser_type:myDirectoryBrowserType,browser_ref:myDirectoryBrowserRef,anchor:"display",update_type:"list",passthru:g,onclose:e||Prototype.emptyFunction,title:config.mappings.auth_backends[myDirectoryBrowserType]+" "+_LOC("JVrQtWSbrC","Browser"),update_name:"FIXME"})}function copy_to_linked_list(a){var b=core.listMap[a];b.refill(myLdapDropZone.memberList());return!0}function tracker_init(a,b,c,d){app.TrackerMap||(app.TrackerMap={}),app.TrackerMap[a+"_:_"+b]?app.TrackerMap[a+"_:_"+b].show():call_fid("get_userlog",{sessionid:a,time:b,callback:function(e){e.userlog||(e.userlog={sid:a,time:b}),e.userlog.mapId=a+"_:_"+b;var f=new app.Tracker(e.userlog);app.TrackerMap[a+"_:_"+b]=f,f.show(!1,c,d)}})}function showFilteredReport(a){core.menu.link("ir_logging","ng_reporting","ng_reporting_report_"+a.data.callname,function(){var b=new core.report.Report({container:"ELEMENT_ng_reporting_container",filter:{ref:a.ref}});b.load(!0)})}function report_init(a){var b=$("REPORT_"+a.name+"_CONTAINER"),c=!1,d=core.reportMap[a.name];d&&d.options.data.reporting.fid===a.data.reporting.fid&&(a.data.reporting.orderby=d.options.data.reporting.orderby,c=!0);var e=new app.report(a);core.reportMap[a.name]=e,core.menu.addListener("click",function(){delete core.reportMap[a.name]},!0),c?req_send({objs:[{FID:e.options.data.reporting.fid,options:e.options,callback:function(a){report_update(a),b.appendChild(e.htmlElement)}}]}):b.appendChild(e.htmlElement)}function get_itfhw_bridgemode(a){var b=get_object(a),c=new Template(_LOC("UPBPYzUQkQ","(on __hardware__)"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),d=new Template(_LOC("vQZxBmnITE","(bridged to VLAN __vlan__)"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),e={none:c,lan:new Template(_LOC("GedcbcxQng","(bridged to AP LAN)")),vlan:d,raw:new Template(_LOC("oQpHkVvKfV","(Standalone Interface)"))},f=e[b.data.ap_bridgemode].evaluate({hardware:b.data.hardware,vlan:b.data.ssid_vlantag});return f}function get_qos_interfaces(){var a=get_objects("qos",["interface"]),b={values:[],labels:{}},c;a&&a.each(function(a){c=get_object(a.data["interface"]),c&&(b.values.push(a.ref),b.labels[a.ref]=c.data.name,a.data.status||(b.labels[a.ref]+=" "+_LOC("RhnLmLMYPD","(disabled)")))});return b}function get_alias_itf_icon(a){var b=get_alias_parent(a);return get_icon(b.ref)}function get_alias_itf_hw(a){var b=get_alias_parent(a);if(b)return"<b>"+b.data.name+"</b>&nbsp;["+get_itf_hw(b.ref)+"]";return""}function get_alias_parent(a){var b=get_objects("interface",["ethernet","vlan","pppoe","pppoa","bridge"]);return b.detect(function(b,c){if(b.data.additional_addresses&&b.data.additional_addresses.length!==0&&b.data.additional_addresses.indexOf(a)!==-1)return!0;return!1})}function get_alias_oper_status(a){var b=get_object(a),c=document.createElement("div");b.data.resolved===1||b.data.resolved6===1?(c.innerHTML=_LOC("kItxFqgXsg","[Up]"),c.style.color="green"):(c.innerHTML=_LOC("XWmvgCTCBQ","[Down]"),c.style.color="red");return get_html(c)}function get_itf_oper_status(a){var b=get_object(a),c,d;if(b.type==="group")return"";c=get_object(b.data.primary_address),d=document.createElement("div"),b.type==="bridge"&&b.data.status===1||c.data.resolved===1||c.data.resolved6===1?(d.innerHTML=_LOC("pSjAODuVLd","[Up]"),d.style.color="green"):(d.innerHTML=_LOC("TQXCgLkDZR","[Down]"),d.style.color="red");return get_html(d)}function get_itf_hw(a){var b=get_object(a),c;if(b.type==="group")return"Interface Group";c=get_object(b.data.itfhw);if(!c||c==="undefined")return!1;if(b.type==="vlan")return c.data.hardware+" (VLAN "+b.data.vlantag+")";return c.data.hardware}function get_member_names(a){var b="",c=0,d=get_object(a),e,f;if(d)do e=d.data.members[c],e&&(f=get_object(e),f&&(c&&(b+=", "),b+=f.data.name)),c++;while(d.data.members[c]);return b}function get_vpn_id(a){var b=get_object(a),c;if(b){c=get_object(b.data.meta);if(c)return(c.data.vpn_id_type==="der_asn1_dn"?unescape_rfc2253_DN(c.data.vpn_id):c.data.vpn_id).escapeHTML()}return""}function get_itf_dhcpv6_range_end(a){var b=a.split(":",2),c=get_object(b[1]),d,e,f,g,h;if(c&&c.data.address6!==""){d=c.data.address6,e=parseInt(c.data.netmask6,10);if(e<112)return d.replace(/:[a-f0-9]*$/i,":ffff");f=d.match(/[a-f0-9]*$/i),g=(1<<128-parseInt(e,10))-1,h=parseInt(f,16)|g;return d.replace(/:[a-f0-9]*$/i,":"+h.toString(16).toLowerCase())}return""}function get_itf_dhcpv6_range_start(a){var b=a.split(":",2),c=get_object(b[1]),d,e,f,g,h;if(c&&c.data.address6!==""){d=c.data.address6,e=parseInt(c.data.netmask6,10);if(e<112)return d.replace(/:[a-f0-9]*$/i,":f000");f=d.match(/[a-f0-9]*$/i),g=65535<<128-parseInt(e,10),h=parseInt(f,16)&g;return d.replace(/:[a-f0-9]*$/i,":"+h.toString(16).toLowerCase())}return""}function get_itf_ipaddr6(a){var b,c,d;if(a.indexOf(":")!==-1){b=a.split(":",2),c=get_object(b[1]);if(c&&c.data&&c.data.address6)return c.data.address6}else{d=get_object(a);if(d){c=get_object(d.data.primary_address);if(c&&c.data&&c.data.address6)return c.data.address6}}return""}function get_itf_dhcp_range_end(a){var b,c,d;if(a.indexOf(":")!==-1){b=a.split(":",2),c=get_object(b[1]);return ipcalc_last_useable(c.data.address,c.data.netmask)}d=get_object(a);if(d)return get_itf_dhcp_range_end("none"+d.data.primary_address);return""}function get_itf_dhcp_range_start(a){var b,c,d;if(a.indexOf(":")!==-1){b=a.split(":",2),c=get_object(b[1]);return ipcalc_first_useable(c.data.address,c.data.netmask)}d=get_object(a);if(d)return get_itf_dhcp_range_start("none"+d.data.primary_address);return""}function get_itf_ipaddr(a){var b,c,d;if(a.indexOf(":")!==-1){b=a.split(":",2),c=get_object(b[1]);if(c&&c.data&&c.data.address)return c.data.address}else{d=get_object(a);if(d){c=get_object(d.data.primary_address);if(c&&c.data&&c.data.address)return c.data.address}}return""}function get_dhcp_server_by_mac_map(a){var b=get_objects("dhcp",["server","server6"]).detect(function(b){if(b.data.mappings.indexOf(a)>-1)return!0;return!1});if(b){if(b.type==="server6")return"_ipv6_"+b.ref;return"_ipv4_"+b.ref}return!1}function get_itfname_by_mac_map(a){var b,c=get_objects("dhcp",["server","server6"]).detect(function(b){if(b.data.mappings.indexOf(a)>-1)return!0;return!1});if(c){b=get_object(c.data["interface"]);if(b)return b.data.name}return"unknown"}function get_itf_flags(a){var b=get_object(a),c,d;if(b.type==="group")return"";c=get_object(b.data.primary_address),d="MTU "+b.data.mtu,b.data.proxyarp&&b.data.proxyarp===1&&(d+=" &middot; PROXYARP"),b.data.proxyndp&&b.data.proxyndp===1&&(d+=" &middot; PROXYNDP"),c.data.default_gateway_status===1&&(d+=" &middot; DEFAULT GW "+c.data.default_gateway_address),core.ipv6&&c.data.default_gateway_status6===1&&(c.data.default_gateway_status===1?d+=" | "+c.data.default_gateway_address6:d+=" &middot; DEFAULT GW "+c.data.default_gateway_address6),b.data.hostname&&b.data.hostname!==""&&(d+=" &middot; HOSTNAME "+b.data.hostname),b.data.apn&&b.data.mobile_network!=="cdma"&&(d+=" &middot; APN "+b.data.apn),b.data.signal&&(d+=' &middot; SIGNAL <img style="display:inline" src="wfe/'+applicationName+"/img/icons/signal_",b.data.signal>-76?d+="5":b.data.signal>-87?d+="4":b.data.signal>-98?d+="3":b.data.signal>-107?d+="2":d+="1",d+='.png" alt="'+b.data.signal+' dBm" title="'+b.data.signal+' dBm">');return d}function get_user_ras_ip(a){var b=get_object(a).data;if(b&&b.use_ras_ip)return _LOC("ywEBVyemut","RAS Address:")+"&nbsp;"+b.ras_ip;return""}function get_user_auth(a){var b=get_object(a),c="";switch(b.data.authentication){case"local":c+=_LOC("zSikhaJwpv","Locally authenticated")+"&nbsp;";break;case"remote":c+=_LOC("aShNkgYRxC","Remotely authenticated")+"&nbsp;",b.data.backend_update===1&&(c+=_LOC("PDguqbTQAf","[User data updated from backend automatically]"));break;case"none":c+=_LOC("kjcwJNblii","No authentication")+"&nbsp;"}return c}function get_user_info(a){var b=get_object(a),c="";b.data.realname&&b.data.realname.length>0&&(c+=b.data.realname+"&nbsp;"),b.data.email_primary.length>0&&(c+="&lt;"+b.data.email_primary+"&gt;&nbsp;");return c}function get_service_spi(a){var b=get_object(a);if(b.data.spi_low===b.data.spi_high)return b.data.spi_low;return b.data.spi_low+":"+b.data.spi_high}function get_service_src(a){var b=get_object(a);if(b.data.src_low===b.data.src_high)return b.data.src_low;return b.data.src_low+":"+b.data.src_high}function get_service_dst(a){var b=get_object(a);if(b.data.dst_low===b.data.dst_high)return b.data.dst_low;return b.data.dst_low+":"+b.data.dst_high}function get_service_icmp_tc(a){var b=get_object(a),c=b.data.type+"_";c.length<3&&(c="0"+c),c+=b.data.code,c.length<5&&(c=c.replace(/.$/,"0"),c+=b.data.code);return c}function get_service_icmpv6_tc(a){var b=get_object(a),c=b.data.type,d=b.data.code;if(b.type!=="icmpv6")return"";isNaN(c)||(c=c.toString(10)),isNaN(d)||(d=d.toString(10)),c.length<2&&(c="0"+c);if(d.length<1)return c;d.length===1&&(d="0"+d);return c+"_"+d}function get_service_type(a){var b=get_object(a),c={tcp:"TCP",udp:"UDP",tcpudp:"TCP/UDP",icmp:"ICMP",icmpv6:"ICMPv6",esp:"ESP",ah:"AH",ip:"IP"};if(c[b.type])return c[b.type];return""}function get_value_ip(a){var b="",c="";typeof a.data.resolved!="undefined"&&(a.data.resolved||a.data.address!==""&&a.data.address!="0.0.0.0")&&(b=a.data.address,typeof a.data.netmask!="undefined"&&(b+="/"+a.data.netmask)),core.ipv6&&typeof a.data.resolved6!="undefined"&&(a.data.resolved6||a.data.address6!==""&&a.data.address6!=="::")&&(c=a.data.address6,typeof a.data.netmask6!="undefined"&&(c+="/"+a.data.netmask6));if(b!==""&&c==="")return b;if(c!==""&&b==="")return c;if(b===""&&c==="")return _LOC("SHhjKnxSys","unresolved");return b+" | "+c}function get_lb_status(a,b,c){var d="",e=get_object(a);e&&(d=e.data.name+" (",core.ipv6?(e.data.resolved&&(b?d+='<span style="color: green;">'+_LOC("WIUnPIUyhw","IPv4 Up")+"</span>":d+='<span style="color: red;">'+_LOC("tmhAIrDqeC","IPv4 Down")+"</span>",e.data.resolved6&&(d+=" / ")),e.data.resolved6&&(c?d+='<span style="color: green;">'+_LOC("GYTjaRnjQq","IPv6 Up")+"</span>":d+='<span style="color: red;">'+_LOC("RrtTklPTSt","IPv6 Down")+"</span>")):b?d+='<span style="color: green;">'+_LOC("eEIadwAvog","Up")+"</span>":d+='<span style="color: red;">'+_LOC("hUJKiDfsfF","Down")+"</span>",d+=")");return d}function toggle_red_vlan(){document.getElementById("FORM_TABLE_red_server_FORM_ELEMENT_lanport_mode")!=null&&(document.getElementById("FORM_TABLE_red_server_FORM_ELEMENT_route_mode").value==="default"?core.formMap.TABLE_red_server_FORM.elements.lanport_mode.enableOption("vlan"):core.formMap.TABLE_red_server_FORM.elements.lanport_mode.disableOption("vlan"))}function toggle_red_route_mode(){var a=document.getElementById("FORM_TABLE_red_server_FORM_ELEMENT_lanport_mode");a!=null&&(a.value==="vlan"?(core.formMap.TABLE_red_server_FORM.elements.route_mode.disableOption("split"),core.formMap.TABLE_red_server_FORM.elements.route_mode.disableOption("fullbr")):(core.formMap.TABLE_red_server_FORM.elements.route_mode.enableOption("split"),core.formMap.TABLE_red_server_FORM.elements.route_mode.enableOption("fullbr")))}function toggle_other_downloads(){var a=$("other_downloads"),b=$("other_download_icon");a&&b&&(a.style.display==="block"?(a.style.display="none",b.style.transform="rotate(180deg)"):(a.style.display="block",b.style.transform="rotate(-90deg)"))}function add_print_sandbox_detailed_view(){var a=$$(".OHELP_LINK")[1],b=a.up(),c=a.up().up(),d=domTd({},{align:"right"},{},domImg({cursor:"pointer"},{src:"core/img/print.gif",width:"16px"},{onclick:function(){var a=$("POPUP_sandbox_detailedview_CONTENT").innerHTML,b=window.open("","Sandboxing: Sandboxed item detail","height=400,width=600");b.document.write("<html><head><title>Sandboxing: Sandboxed item detail</title>"),b.document.write("</head><body >"),b.document.write(a),b.document.write("</body></html>"),b.document.close(),b.focus(),b.print(),b.close()}}));c.insertBefore(d,b)}function check_manual_sandstorm(a){a.manual_results.done||(a.manual_results.retry++,sandstorm_manual_timer=setTimeout(function(){sandstorm_manual_fetch(a.manual_results)},3e3))}function sandstorm_manual_fetch(a){sandstorm_manual_timer&&(clearTimeout(sandstorm_manual_timer),sandstorm_manual_timer=null),a.options||(a.options={}),req_send({objs:[{FID:a.FID,callback:"check_manual_sandstorm",retry:a.retry,token:a.token}]})}function sandstorm_manual(a){sandstorm_manual_timer=setTimeout(function(){sandstorm_manual_fetch(a)},3e3)}function toggle_sandstorm_activity_graph(a){$$(".sandstorm_graph_email, .sandstorm_graph_web, .sandstorm_graph_all").invoke("hide"),$$(".sandstorm_graph_"+a).invoke("show")}function sandbox_release_handler(){var a={FID:"sandbox_mass_release",callback:remove_throbber,update_type:"table",update_name:this.parentName},b=new Template(_LOC("ksMpnpNQHi","Are you sure that you want to release __NUMBER_OF_AFFECTED_USERS__ item(s)?"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),c,d;a.obj_ref=core.tableMap.http_sandbox_history_list.getCheckedItems(),c=b.evaluate({NUMBER_OF_AFFECTED_USERS:a.obj_ref.size()});if(a.obj_ref.size()==0){alert(_LOC("SikSqSGUOt","Please select at least one item."));return!1}confirm_dialog({message:c,modal:!0,ok_cb:function(){var b=_LOC("ZzatiVyeMn","Release in progress. This operation may take some time.");show_throbber(b),req_send({objs:[a]})}})}function render(template,data,target){var container=$(target),data=data||{},rawTemplate,getScope=eval(core.utils.scriptloader.require("wfe/asg/js/controllers/"+template+"_controller.js",!1,!0,!1)),request=new Ajax.Request("/wfe/asg/templates/"+template+".html",{method:"GET",onSuccess:function(a){rawTemplate=a.response,_.extend(data,{onRender:[]},getScope(data)),container&&(container.innerHTML=_.template(rawTemplate,data)),_.each(data.onRender,function(a){a.call()})}})}function stylize_quota_status_page(){$$(".table_mass_action_menu_button")[0].style.display="none",$$(".table_mass_action_menu_cell")[0].style.paddingLeft="4px",$$(".table_mass_action_menu_cell")[0].style.paddingRight="4px",$$(".table_mass_action_menu_cell")[0].style.width="13px",$$(".table_mass_action_menu_cell")[0].style.width="13px",$$(".ngiconbutton")[0].down("img").remove()}function quota_reset_handler(){var a={FID:"http_quota_mass_reset",callback:remove_throbber,update_type:"table",update_name:this.parentName},b=new Template(_LOC("hgfvxJqmsk","Are you sure that you want to reset today's quota time remaining for __NUMBER_OF_AFFECTED_USERS__ user(s)?"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),c,d;a.obj_ref=core.tableMap.http_quota_status.getCheckedItems(),c=b.evaluate({NUMBER_OF_AFFECTED_USERS:a.obj_ref.size()});if(a.obj_ref.size()==0){alert(_LOC("UPhmQjNxNg","Please select at least one user."));return!1}confirm_dialog({message:c,modal:!0,ok_cb:function(){var b=_LOC("WbMyobrUDN","Reset in progress. This operation may take some time.");show_throbber(b),req_send({objs:[a]})}})}function show_throbber(a){var b=Builder.node("div",{id:"POPUP_throbber_CONTENT"});b.setStyle({position:"absolute",top:"0px",left:"0px",boxShadow:"0 0 7px #666666",minWidth:"260px",width:"260px",padding:"8px","background-color":"#F7F7F7"}),$("popup_master").appendChild(b),Position.clone($$(".table_sort_column_cell")[1],b,{setWidth:!1,setHeight:!1}),b.style.top=parseInt(b.style.top)+50+"px",b.style.left=parseInt(b.style.left)-30+"px",b.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:"core/img/ajaxload.gif",style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(a)])))),WindowUtilities.disableScreen("astaro","overlay_modal_POPUP_throbber",.5,"popup_master",$("popup_master"))}function remove_throbber(a){$("POPUP_throbber_CONTENT")&&($("POPUP_throbber_CONTENT").remove(),$("overlay_modal_POPUP_throbber").remove(),reload_display()),alert(a.error[0].text)}function init_quota_time_controls(){var a=!!$$('select[id^="ELEMENT_sp_categories"]').filter(function(a){return a.value==="quota"}).size(),b=$$("#ELEMENT_uncategorized select")[0].value==="quota";tag_quotas_in_use=!!$$("select.web_action_quota").size(),quota_time_controls_container=$("ELEMENT_quota_time_controls"),quota_time_field=$("ELEMENT_quota_time"),a||tag_quotas_in_use||b?(input_activate(quota_time_controls_container),input_activate(quota_time_field)):(input_deactivate(quota_time_controls_container),input_deactivate(quota_time_field))}function quota_time_handler(a,b){var c=$("ELEMENT_quota_time"),d=1440,e;c.value>d&&(c.value=d);if(a==="up"||a.keyCode&&a.keyCode==38)e="up";else if(a==="down"||a.keyCode&&a.keyCode==40)e="down";else{a.keyCode&&Event.stop(a);return}c%b!==0&&(c.value=Math[e==="up"?"floor":"ceil"](parseInt(c.value)/b)*b);if(e==="up"){var f=parseInt(c.value)+b;f>d?c.value=b:c.value=f}else if(e==="down"){var f=parseInt(c.value)-b;f<=0?c.value=d:c.value=f}}function toggle_http_user_portal(){var a=$("ELEMENT_portal_use_cert").getValue();a==="on"||a===!0?(input_activate("ELEMENT_portal_domain"),input_activate("ELEMENT_portal_cert")):(input_deactivate("ELEMENT_portal_domain"),input_deactivate("ELEMENT_portal_cert"))}function http_category_action_apply_color(a){var b=$(a).getValue();switch(b){case"allow":domApplyStyle(a,{backgroundColor:"#D2E4B9"});break;case"warn":domApplyStyle(a,{backgroundColor:"#F7E4B2"});break;case"deny":domApplyStyle(a,{backgroundColor:"#F6BFCF"});break;case"block":domApplyStyle(a,{backgroundColor:"#F6BFCF"});break;case"quota":domApplyStyle(a,{backgroundColor:"#A4D3EE"})}return!0}function toggle_domain_regex_restrict_domains(a){a==="on"||a===!0?($$("input[id$=restrict_regex]")[0].checked=!0,input_activate($$("tr[id$=ROW_domain]")[0]),input_activate($$("tr[id$=ROW_include_subdomains]")[0])):($$("input[id$=restrict_regex]")[0].checked=!1,input_deactivate($$("tr[id$=ROW_domain]")[0]),input_deactivate($$("tr[id$=ROW_include_subdomains]")[0]))}function toggle_domain_regex_mode(a,b){a=="Domain"?($$("[id$=regexps]").invoke("hide"),$$("[id$=restrict_regex]").invoke("hide"),toggle_domain_regex_restrict_domains(!0)):($$("[id$=regexps]").invoke("show"),$$("[id$=restrict_regex]").invoke("show"),b||core.listMap.domain.listMembers.size()>0?toggle_domain_regex_restrict_domains(!0):toggle_domain_regex_restrict_domains(!1))}function display_device_os_auth(a,b){for(var c=0;c<$(a).length;c++)$(a).options[c].show();var d=$(b).value;if(d=="Windows"||d=="Linux"||d=="iOS"||d=="Android"||d=="Blackberry")for(var c=0;c<$(a).length;c++){$(a).value=="opendirectory_auth"&&($(a).value="__pleaseselect");var e=$(a).options[c].value;e=="opendirectory_auth"&&$(a).options[c].hide()}if(d=="Linux"||d=="iOS"||d=="Kindle"||d=="Android"||d=="Blackberry")for(var c=0;c<$(a).length;c++){$(a).value=="agent"&&($(a).value="__pleaseselect");var e=$(a).options[c].value;e=="agent"&&$(a).options[c].hide()}}function toggle_http_extended_log_search(a){var b=["user","url","srcip","action","multilog","web_table_output","noassets","hour","min"],c=["s","e"];a==="http"||a==="eplog"?(b.each(function(b){b==="hour"||b==="min"?c.each(function(a){$("ELEMENT_"+a+b).up("td").show(),$("ELEMENT_"+a+b).up("td").previous("td").show()}):($("ELEMENT_"+b).up("tr").show(),b==="multilog"||b==="web_table_output"||b==="noassets"?$("ELEMENT_"+b).up("tr").up("tr").next("tr").show():$("ELEMENT_"+b).up("tr").next("tr").show()),b==="noassets"&&a==="eplog"&&($("ELEMENT_"+b).up("tr").hide(),$("ELEMENT_"+b).up("tr").up("tr").next("tr").hide())}),$("ELEMENT_multilog").up().next("td").down().innerHTML=a==="eplog"?_LOC("peiEguiOaI","Also show search results from Web Filtering log"):_LOC("qSImUFydqI","Also show search results from Endpoint Web Protection log")):b.each(function(a){a==="hour"||a==="min"?c.each(function(b){$("ELEMENT_"+b+a).up("td").hide(),$("ELEMENT_"+b+a).up("td").previous("td").hide()}):($("ELEMENT_"+a).up("tr").hide(),a==="multilog"||a==="web_table_output"||a==="noassets"?$("ELEMENT_"+a).up("tr").up("tr").next("tr").hide():$("ELEMENT_"+a).up("tr").next("tr").hide())})}function is_domain(a){if(!is_ipv4(a)&&!is_ipv6(a))return/^(([a-zA-Z0-9\-_]+)\.)*([A-Za-z0-9\-_]+)$/.test(a);return!1}function is_ipv4(a){return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(a)}function is_ipv6(a){return/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/.test(a)}function parse_uri(a){var b=document.createElement("a");b.href=a.replace(/^([a-zA-Z]+([a-zA-Z0-9]+)?:\/{2})?/,"http://");return{source:a,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,path:b.pathname.replace(/^([^\/])/,"/$1"),query:b.search,fragment:b.hash.replace("#","")}}function get_dhcp_server_ranges(a){var b=get_object(a);return b.data.range_start+" - "+b.data.range_end}function get_dhcp_host_address(a,b){b===4?$(core.formMap.FORM_DCHP_STATIC_MAPPING.elements.ip_address).update(get_object(a).data.address):$(core.formMap.FORM_DHCP6_STATIC_MAPPING.elements.ip_address).update(get_object(a).data.address6);return}function get_html5vpn_defport(){var a="TABLE_clientless_vpn_FORM",b=core.formMap[a].elements.service.getValue();if(b=="vnc_rdp")return"3389";if(b=="vnc_web")return"80";if(b=="vnc_webs")return"443";if(b=="pty_telnet")return"23";if(b=="pty_ssh")return"22";if(b=="native_vnc")return"5900"}function hotspot_preview(a){var b=new Window({className:"astaro",width:800,height:600,resizable:!0,draggable:!0,minimizable:!1,maximizable:!1,destroyOnClose:!0,closable:!0,title:a.title,onClose:function(b){call_fid("hotspot_preview_cleanup",{url:a.url})}});b.setURL(a.url),b.showCenter(!0)}function server_balancing_edit_scheduler(a){popup_close("POPUP_active");var b=new core.popup({name:"POPUP_active","class":"scheduler",types:"loadbalance",anchor:"ELEMENT_scheduler_button_DROPZONE_extraicon",obj_ref:a,passthru:{members:$("FORM_TABLE_lb_FORM_ELEMENT_destination_nat_group").dropzone.members}})}function get_form_elements(a){if(a){var b=core.formMap[a],c=b._get_layout(),d=get_object(c.destination);b.req.options.obj_src&&(c.obj_src=evaluate.apply(this,[b.req.options.obj_src]));return c}}function dev_check_wildcard(){var a="TABLE_epp_dpctrl_exception_FORM",b=/^REF/i;if(core.formMap[a].elements.device){var c=core.formMap[a].elements.device.getValue();if(c.match(b)){var d=get_object(c),e=$$("select#"+core.formMap[a].elements.usage.id+" option"),f=$(core.formMap[a].elements.usage.id);d.data.device_type=="floppy_drive"||d.data.device_type=="optical_drive"||d.data.device_type=="removable_storage"?(f.options[0]=new Option("Allowed","allowed"),f.options[1]=new Option("Read only","read_only")):d.data.device_type=="modem"||d.data.device_type=="wireless"?(f.options[0]=new Option("Allowed","allowed"),f.options[1]=new Option("Block bridged","block_bridged")):f.options[0]=new Option("Allowed","allowed")}}}function uplink_balancing_edit_monitoring(a){popup_close("POPUP_active");var b=new core.popup({name:"POPUP_active","class":"scheduler",types:"loadbalance",anchor:"ELEMENT_monitoring_button_DROPZONE_extraicon",obj_ref:a,passthru:{monitoring:1,members:[]}})}function uplink_balancing_edit_scheduler(a){popup_close("POPUP_active");var b=new core.popup({name:"POPUP_active","class":"scheduler",types:"loadbalance",anchor:"ELEMENT_scheduler_button_DROPZONE_extraicon",obj_ref:a,passthru:{members:$("ELEMENT_active").dropzone.members}})}function basic_setup_finished(){window.location.href=window.location.href}function hidden_post_sso(a,b,c){var d,e;if(a&&b&&c){d=window.open("","");if(!d)return!1;e="<html><head></head><body><form id='formid' method='post' action='"+a+"'>",e+="<input type='hidden' name='login' value='"+b+"'/>",e+="<input type='hidden' name='auth_key' value='"+c+"'/>",e+="</form><script type='text/javascript'>document.getElementById(\"formid\").submit()</script></body></html>",d.document.write(e)}}function red_deploy_error(a){var b=$("GRID_RED_DEPLOY_ERROR_CONTAINER"),c,d,e;if(a&&a.error&&b){b.firstChild&&b.firstChild.remove();if(typeof a.error=="object"){c=a.error.pop(),d=c.text;if(c.field){e=c.field.length;while(e--)border_blink_element(c.field[e])}}else d=a.error;b.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:"core/img/icons/warning.png",style:"padding-right:5px"})),$(Builder.node("td",{color:"red"},"")).update(d)]))))}}function change_pf_rules_status(a,b){$H(a).each(function(a){var c=get_object(a.key);typeof c!="undefined"&&(b?c.data.status=a.value==="0"||a.value===0?0:1:c.data.status=0)})}function cert_check_wildcard(a){var b="TABLE_http_reverse_proxy_appserver_table_FORM",c="none",d,e,f,g=[],h=[],i=/(?:^|[\s\/,])CN=([^\s\/,]+)/,j=/^\s*((dns|ip(?: address)?):([^,]+?))\s*$/i,k=/.*?([\*]+)/,l=0,m=core.formMap[b],n=m.elements;if(!n.type||n.type.getValue()!=="https"&&n.type.getValue()!=="https_redir")n.domain.up(1).hide(),n.domain_san.up(1).hide(),n.domain_wc.up(1).hide();else if(n.certificate&&n.certificate.getValue()!=="__pleaseselect"){d=n.certificate.getValue(),e=get_object(d),f=get_object(e.data.meta),i.exec(f.data.subject)&&g.push(RegExp.$1.toLowerCase()),k.exec(f.data.subject)&&(c="wildcard");for(l=0;l<f.data.subject_alt_names.length;l++)k.exec(f.data.subject_alt_names[l])&&(c="wildcard"),j.exec(f.data.subject_alt_names[l])&&g.indexOf(RegExp.$3.toLowerCase())==-1&&g.push(RegExp.$3.toLowerCase());n.certificate.value===m.req.passthru.confd_certificate&&(h=m.req.passthru.confd_domain),c!=="wildcard"&&(c=g.length===1?"single":"san");if(c==="wildcard")n.domain.up(1).hide(),n.domain_san.up(1).hide(),core.listMap.domain_wc.memberValues().length===0&&core.listMap.domain_wc.refill(!1,{values:h.length>0?h:g,labels:{}}),n.domain_wc.up(1).show();else if(c==="single")n.domain.up(1).show(),n.domain_san.up(1).hide(),n.domain_wc.up(1).hide(),n.domain.value=g[0];else{n.domain.up(1).hide();if(a==="toggle"||a==="error")h=core.listMap.domain_san.memberValues();core.listMap.domain_san.checked=h,core.listMap.domain_san.refill(!1,{values:g,labels:{}}),n.domain_san.up(1).show(),n.domain_wc.up(1).hide()}}else n.domain.up(1).hide(),n.domain_san.up(1).hide(),n.domain_wc.up(1).hide();m.req.passthru.cert_type=c;return!0}function reverse_proxy_frontend_hide_real_webservers(a){var b="TABLE_http_reverse_proxy_appserver_table_FORM",c=core.formMap[b],d=c.elements;c.req.passthru.has_default_location==1||a?(d.backend.up(1).show(),d.no_default_location.up(1).hide(),c.req.passthru.has_default_location=1):(d.backend.up(1).hide(),d.no_default_location.up(1).show())}function log_file_action(a,b,c){var d=core.dropdownMap[a].getValue(),e=$("ELEMENT_LOG_FILE_ERROR"),f=!1,g,h,i,j,k,l;e.update();if(!!d){b.each(function(a){$("ELEMENT_"+a).checked&&(f=!0)});if(!f){g=Builder.node("img",{src:"core/img/icons/warning.png",align:"left",style:"margin-right: 5px;"}),h=Builder.node("span",_LOC("khxpjUUCcn","You need to select at least one log file.")),e.appendChild(g),e.appendChild(h);return}d==="clear"?(i=Builder.node("img",{src:"core/img/icons/confirm.png",align:"left",style:"margin-right: 5px;"}),j=Builder.node("span",_LOC("BVXtuVcoOI","Are you sure that you want to delete these log files?")),k=new core.button({label:_LOC("hISauKgJJn","Cancel"),icon:"core/img/icons/cancel.png",button_float:"right",onclickfunc:function(){e.update(),core.dropdownMap[a].setValue("__pleaseselect")}}),l=new core.button({label:_LOC("UIcirnpyLc","OK"),icon:"core/img/icons/check.png",button_float:"right",onclickfunc:function(){call_fid("log_mass_action",{action:d,archive:c?1:0},b)}}),e.appendChild(i),e.appendChild(j),e.appendChild(k.htmlElement),e.appendChild(l.htmlElement)):call_fid("log_mass_action",{action:d,archive:c?1:0},b)}}function selectAllCheckboxes(a,b){var c=$(a).checked;document.getElementsByClassName(b).each(function(a){a.checked=c})}function epp_dynamic_overview(a,b,c,d,e,f){call_fid("epp_dynamic_alerts",{mcs_id:a,callback:function(g){if(g.events){var h=[{label:c,"default":!0,exec:function(){call_fid("epp_overview",{id:b,type:d,sorting:e,string:f,filter:"1",sort:"1",callback:function(a){}},["string_filer","sort"])}}];g.more&&h.push({label:_LOC("fbxGGBdVPu","Resolve All"),exec:function(){call_fid("epp_overview",{mcs_id:a,type:"all",sorting:e,string:f,filter:"1",sort:"1",callback:function(a){}},["string_filer","sort"])}}),h.push({label:_LOC("sOSwpWzGLi","Cancel"),exec:function(){}});var i=interactionPopup({open:!0,title:_LOC("wTlkIBKtbj","Action description:"),text:unescape(g.events),buttons:h})}}},[])}function emailpki_local_cas_delete(a,b){call_fid("email_encryption_external_cas",{"delete":a,ack:b||0,callback:function(b){if(!b.error){if(b.confirm){var c=[{label:_LOC("QEkUIpzXfb","OK"),"default":!0,exec:function(){emailpki_local_cas_delete(a,b.ack)}},{label:_LOC("evxVaXlGcE","Cancel"),exec:function(){}}],d=interactionPopup({open:!0,text:b.confirm[0].text,buttons:c});return}if(b.success)return}}},[])}function http_local_cas_delete(a,b){call_fid("http_cas",{"delete":a,ack:b||0,callback:function(b){if(!b.error){if(b.confirm){var c=[{label:_LOC("XeVamPVWRn","OK"),"default":!0,exec:function(){http_local_cas_delete(a,b.ack)}},{label:_LOC("TCZAabdMvB","Cancel"),exec:function(){}}],d=interactionPopup({open:!0,text:b.confirm[0].text,buttons:c});return}if(b.success)return}}},[])}function http_delete(a,b,c,d){call_fid(a,{"delete":b,ack:c||0,callback:function(c){if(!c.error){if(c.confirm){var e=[{label:_LOC("ZFQQzqlSWS","OK"),"default":!0,exec:function(){http_delete(a,b,c.ack,d)}},{label:_LOC("OBzLoXCJua","Cancel"),exec:function(){}}],f=interactionPopup({open:!0,text:c.confirm[0].text,buttons:e});return}if(c.success){d();return}}}},[])}function http_popup_navi_update_buttons(a){input_activate("ELEMENT_FORM_"+a+"_popup_BUTTON_apply"),input_activate("ELEMENT_FORM_"+a+"_popup_BUTTON_back"),input_activate("ELEMENT_FORM_"+a+"_popup_BUTTON_next"),$("Add_mode_"+a)&&app.wizardTabs.index[a]!=app.wizardTabs[a].length-1&&input_deactivate("ELEMENT_FORM_"+a+"_popup_BUTTON_apply"),app.wizardTabs.index[a]==0?input_deactivate("ELEMENT_FORM_"+a+"_popup_BUTTON_back"):app.wizardTabs.index[a]==app.wizardTabs[a].length-1&&input_deactivate("ELEMENT_FORM_"+a+"_popup_BUTTON_next")}function http_popup_navi_show_section(a,b){var c=b.sub("GRID_","").sub("_CONTAINER","");app.wizardTabs[a].each(function(a){$("GRID_"+a+"_CONTAINER").hide()}),$(b).show(),app.wizardTabs._on_show[c]&&app.wizardTabs._on_show[c].call()}function filter_action_popup_close_callback(a){_.isArray(a)&&a.length&&req_send({objs:[{FID:"http_delete_cloned_objects",cloned_objects:a}]}),popup_close("POPUP_http_cff_action")}function http_popup_navi(a,b){var c=b;b.indexOf("GRID_")!=-1?(http_popup_navi_show_section(a,b),c=b.replace("GRID_","").replace("_CONTAINER","")):http_popup_navi_show_section(a,"GRID_"+b+"_CONTAINER"),app.wizardTabs.index[a]=app.wizardTabs[a].indexOf(c),$$(".navi_icon."+a).invoke("removeClassName","navi_selected"),$("menu_"+c).addClassName("navi_selected"),app.helpUUID[a][b]&&update_online_help_link(app.helpUUID[a][b],"POPUP_"+a),http_popup_navi_update_buttons(a)}function http_popup_save_update(a){var b=["div","a"];a.update_type=="dropdown"&&dropdown_update(a.update_name,a.name),a.update_type=="dynamic_dropdown"&&(dropdown=core.dropdownMap[a.update_name],dropdown&&dropdown.appendOption({label:a.label,value:a.ref,selected:!0})),b.indexOf(a.update_type)!=-1&&$$("#"+a.update_name).each(function(b,c){b.update(a.label),b.title=a.label}),a.update_type=="list"&&core.listMap[a.update_name].createMember(a.label||a.ref,a.new_member_pos==undefined?-1:a.new_member_pos,a.ref,null,a.enabled?parseInt(a.enabled):!1)}function http_save_cff_profile(a){call_fid("http_default_assignment_submit",{callback:function(a){function b(){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\\n";$("default_assignments_status").style.color="red",$("default_assignments_status").appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:"core/img/icons/warning.png",style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(c)])))),auto_hide_element("default_assignments_status")}}a.error&&typeof a.error=="object"&&b()},profile:a},["cff_profiles"])}function http_profiles_list_update(){call_fid("http_proxy_profile_form_submit",{callback:function(a){function b(){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\\n";$("list_profile_status").style.color="red",$("list_profile_status").appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:"core/img/icons/warning.png",style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(c)])))),auto_hide_element("list_profile_status")}}a.error&&typeof a.error=="object"&&b()},action:"list_update"},["profile"])}function http_save_filter_action(a,b){b?http_overwrite_confirmation_popup(null,b,a):fieldset_apply(a)}function http_overwrite_confirmation_popup(a,b,c,d,e){var f=d==="policy"?_LOC("jJdTzeaYLy","This policy is use by multiple filter profiles"):_LOC("fcRsvEwrRm","This filter action is used by multiple policies"),g=_LOC("mbCfncBbsP","Would you like to"),h=d==="policy"?_LOC("MBUUvQbQkR","Save the policy for all filter profiles"):_LOC("ZOXpmHSbjj","Save the filter action for all policies"),i=d==="policy"?_LOC("yczpBWggRe","Save as a new policy"):_LOC("xKWVuUrejE","Save as a new filter action: "),j,k,l,m;j=Builder.node("ul");for(var n=0;n<b.length;n++)j.appendChild(Builder.node("li",b[n]));k=Builder.node("div",[Builder.node("p",f),j,Builder.node("p",g),Builder.node("input",{type:"radio",checked:!0,id:"save_radio",value:"save",label:"Save",name:"save_action",onchange:"$('new_object_name').disabled = $('save_radio').checked;"}),Builder.node("label",{"for":"save_radio"},h),Builder.node("br"),Builder.node("input",{type:"radio",checked:!1,id:"save_as_radio",value:"save_as",name:"save_action",onchange:"$('new_object_name').disabled = $('save_radio').checked;"}),Builder.node("label",{"for":"save_as_radio"},i),Builder.node("input",{type:"text",name:"new_object_name",disabled:!0,id:"new_object_name"})]);var o=[{label:"OK",exec:function(){$$('input[name="save_action"]').each(function(a){if(a.checked&&a.value=="save_as"){var b;d==="policy"?b=$("FORM_FORM_POPUP_edit_assignment_ELEMENT_cff_profile_name"):b=$("ELEMENT_name"),b.value=$F("new_object_name"),m=!0,d==="policy"&&(delete core.formMap[c.name].req.options.obj_src,core.formMap[c.name].req.options={update_type:"list",update_name:"cff_profiles"},core.formMap[c.name].req.passthru.save_as_new_object=1,$("ELEMENT_profile").value!=="REF_DefaultHTTPProfile"&&(core.formMap[c.name].req.passthru.in_progress=$("ELEMENT_profile").value),core.formMap[c.name].req.passthru.checked=0,core.listMap.cff_profiles.memberValues().checked.each(function(a){a===e&&(core.formMap[c.name].req.passthru.checked=1)}),core.formMap[c.name].req.passthru.checked==0&&(core.listMap.cff_profiles.checked=core.listMap.cff_profiles.memberValues().checked))}}),c.data.passthru.save_as_new_object=m,c.data.passthru.no_overwrite=!0,d==="policy"?form_submit(c.name):fieldset_apply(c),$("popup_master").style.zIndex=999,WindowUtilities.enableScreen()}.bind(this)},{label:"Cancel",exec:function(){WindowUtilities.enableScreen(),$("popup_master").style.zIndex=999}}];$("popup_master").style.zIndex=Windows.maxZIndex;var l=interactionPopup({open:!0,text:k.innerHTML,buttons:o});WindowUtilities.disableScreen("astaro","overlay_modal",.5,l.id,"")}function http_cff_mode_toggle(a){var b=a==="allow"?"block":"allow";$$("#cff_mode_opposite_text_cap").each(function(a){a.update(b.charAt(0).toUpperCase()+b.slice(1))}),$$("#GRID_url_filtering_categories_CONTAINER select").each(function(b){b.value=a==="block"?"deny":a,http_category_action_apply_color(b)});var c=$$("#ELEMENT_uncategorized_ROW select")[0];c.value=a,http_category_action_apply_color(c),a==="allow"?input_activate("ELEMENT_spyware"):(input_deactivate("ELEMENT_spyware"),$("ELEMENT_spyware").checked=!0)}function http_register_popup_close_action(popup,callback){var p=core.popupMap["POPUP_"+popup];p.closeButton.childNodes[0].onclick=function(){eval(callback)},$("ELEMENT_FORM_"+popup+"_popup_BUTTON_cancel").onclick=function(){eval(callback)}}function ha_reload_status_clear(){ha_reload_status_timer&&(window.clearTimeout(ha_reload_status_timer),ha_reload_status_timer=!1)}function ha_reload_status_req(){ha_reload_status_timer&&(window.clearTimeout(ha_reload_status_timer),ha_reload_status_timer=!1),reload_display()}function ha_reload_status(){ha_reload_status_timer&&(window.clearTimeout(ha_reload_status_timer),ha_reload_status_timer=!1),ha_reload_status_timer=window.setTimeout(ha_reload_status_req,1e4)}function flow_monitor_itf_ref(a){var b=flow_monitor_win_map.detect(function(b,c){if(b.itf&&b.itf==a)return b.itf_ref;return null});return b}function reporting_hw_get_node(a){var b=core.dropdownMap.ha_node.getValue();call_fid("rrd_hardware_"+a,{ha_node:b},[])}function afc_set_all(a){var b=core.dropdownMap.afcsetall.getIndex();core.dropdownMap.afcsetall.getValue()&&b--,a.each(function(a){core.dropdownMap[a].setValue(b)})}function countdown(){countdownHandle&&(window.clearTimeout(countdownHandle),countdownHandle=null),--countdownTime,countdownTime>0?(waitTime=_calcWaitTime(countdownTime),$("login_blocked_timeout").innerHTML=waitTime,countdownHandle=window.setTimeout(countdown,1e3)):location.reload()}function _calcWaitTime(a){var b=Math.floor(a/60),c=a%60,d;b<10&&(b="0"+b),c<10&&(c="0"+c),d=b+":"+c,a>60?d=d+" "+_LOC("IIEDeyPFXN","minutes"):a===60?d=d+" "+_LOC("RThffOYrbF","minute"):d=d+" "+_LOC("cCuvpKdoQz","seconds");return d}function init_countdown(a){countdownTime=a,countdown()}function report_parse(a){if(a.report.html||a.report.link){a.report.win&&(report_win.resizeTo(a.report.win.width,a.report.win.height),report_win.moveTo(25,25));if(a.report.link)report_win.location.href=a.report.link;else{var b=report_win.document;b.open(),b.write(a.report.html),b.close()}}else report_timer=setTimeout(function(){report_fetch(a.report)},3e3)}function report_fetch(a){report_timer&&(clearTimeout(report_timer),report_timer=null),a.options||(a.options={}),req_send({objs:[{FID:a.FID,options:a.options,callback:"report_parse",token:a.token}]})}function report_generate(a){report_win=window.open("","Report","height=100,width=300,location=no,menubar=yes,resizable=yes,scrollbars=yes,status=no,toolbar=no");var b=report_win.document;b.write(a.html),b.close(),core.openedWindows.push(report_win),report_win.focus(),report_timer=setTimeout(function(){report_fetch(a)},3e3)}function register_qm_window(a){qm_window=window.open("qm/?lang="+a,"qm_window"),core.openedWindows.push(qm_window),qm_window.focus()}function ldap_portswap(a,b){var c=$("FORM_TABLE_servers_FORM_ELEMENT_"+b),d=parseInt(c.value);c&&(a&&d===389?c.value="636":!a&&d===636&&(c.value="389"))}function auth_set_default_timeout(a){switch(a){case"edirectory":return"10";case"adirectory":return"10";case"ldap":return"10";case"radius":return"3";case"tacacs":return"5";default:return""}}function auth_set_default_port(a){switch(a){case"edirectory":case"adirectory":case"ldap":return"389";case"radius":return"1812";case"tacacs":return"49";default:return"389"}}function make_params_edirectory_prefetch(){var a=core.formMap.TABLE_servers_FORM._get_layout(),b=a.prefetch_contexts;return b}function make_server_params(){var a=core.formMap.TABLE_servers_FORM,b=a._get_layout(),c=get_object(b.server);c&&(b.server_ip=c.data.address),a.req.options.obj_src&&(b.obj_src=evaluate.call(this,a.req.options.obj_src));if(b.contexts&&b.contexts.length)for(var d=0,e=b.contexts.length;d<e;++d)b.contexts[d]=b.contexts[d].unescapeHTML();return b}function make_params_edirectory(){var a=core.formMap.TABLE_servers_FORM._get_layout(),b=get_object(a.server);b&&(a.server=b.data.address);return a}function auth_get_val(a){return $("FORM_TABLE_servers_FORM_ELEMENT_"+a).value}function show_u2d_desc(a){var b=$("U2D_POPUP_ANCHOR_"+a);b&&new core.popup({name:"U2D_POPUP_DESC_"+a,"class":"u2d",type:"desc",anchor:b,passthru:{package_id:a}})}function add_u2d_schedule(a,b){var c=$("U2D_POPUP_ANCHOR_"+b);c&&new core.popup({name:"U2D_POPUP_SCHEDULE_"+a,"class":"u2d",type:"schedule",anchor:c,passthru:{version:a}})}function present_selected_fields(a){function b(b){var c="ELEMENT_"+b,d=$$("input[id^="+c+"], textarea[id^="+c+"]");d.each(function(c){var d=c.up("tr");d&&(a.getValue()===b?d.show():d.hide())})}a.options.values.length>0?a.options.values.each(b):a.options.optionGroups.length>0&&a.options.optionGroups.each(function(a){a.options.each(function(a){b(a.value)})})}function http_reverse_proxy_set_redirection_target_port(a,b){a=="http"?b.value="80":a=="https"?b.value="443":b.value="",b.value?b.parentNode.parentNode.show():b.parentNode.parentNode.hide()}function http_auth_device(a){a?(input_activate("ELEMENT_device_auth_trans"),input_activate("ELEMENT_device_auth_stand")):(input_deactivate("ELEMENT_device_auth_trans"),input_deactivate("ELEMENT_device_auth_stand"))}function http_auth_hs(a,b){var c,d,e=0,f="ELEMENT_block_on_auth_failed";input_deactivate("ELEMENT_op_mode2"),b&&input_activate("ELEMENT_op_mode2"),a==="standard"?($("ELEMENT_auth_stand").show(),$("ELEMENT_auth_trans").hide(),$("ELEMENT_device_auth_stand").show(),$("ELEMENT_device_auth_trans").hide(),c="ELEMENT_auth_stand",d="device_auth_stand"):($("ELEMENT_auth_stand").hide(),$("ELEMENT_auth_trans").show(),$("ELEMENT_device_auth_stand").hide(),$("ELEMENT_device_auth_trans").show(),c="ELEMENT_auth_trans",d="device_auth_trans"),e=$(c).down("select").value!=="none"?1:0,core.minitableMap[d].getValue().each(function(a){var b=get_object(a);b.data.auth_mode!=="none"&&(e=1)}),e?input_activate($(f)):input_deactivate($(f))}function http_https_scan(){var a=["ELEMENT_selective_scan_cat","ELEMENT_selective_scan_tags"],b=get_element("scan_ssl_opt");b&&(b==="selective_https_scanning"?_.each(a,function(a){input_activate(a)}):_.each(a,function(a){input_deactivate(a)}))}function notification_submit(a){req_send({objs:[{FID:"notifications_notifications",categoryid:a,notify_submit:1,notifications:notifications}]})}function notification_checkboxmgr(a,b){var c=$("ELEMENT_"+a+"_"+b).checked?1:0;notifications[b][a]=c}function port_scroll_position_update(a){$("dashboard_box_content_div_id")&&($("dashboard_box_content_div_id").scrollTop=a||0)}function dashboard_set_refresh(){dashboard_timer&&window.clearTimeout(dashboard_timer),dashboard_timer=!1,call_fid("dashboard_set_refresh",{},["dashboard_refresh"])}function dashboard_load(){var a;dashboard_timer&&window.clearTimeout(dashboard_timer),dashboard_timer=!1,cur_display_req&&cur_display_req.objs[0].FID==="dashboard"&&(a={objs:[{FID:"dashboard",target:"display",port_scroll_position:$("dashboard_box_content_div_id").scrollTop||0}]},req_send(a))}function dashboard_reload(a){a&&(dashboard_timer=window.setTimeout(dashboard_load,a*1e3))}function ips_pattern_mass_actions(a,b){var c=[],d=null,e,f,g,h;if(b)switch(b){case"group":d=$("ELEMENT_"+a).checked,c=document.getElementsByClassName(a),c.each(function(a,b){$(a.id).checked=d}),/[a-zA-Z_]+(REF_[a-zA-Z0-9_]+)/.exec(a),myref=RegExp.$1,d?(core.dropdownMap["IPS_ACTION_"+myref].enable(),core.dropdownMap["IPS_ACTION_"+myref]&&core.dropdownMap["IPS_AGE_"+myref].enable()):(core.dropdownMap["IPS_ACTION_"+myref].disable(),core.dropdownMap["IPS_ACTION_"+myref]&&core.dropdownMap["IPS_AGE_"+myref].disable()),e=d?!1:!0,$("ELEMENT_IPS_WARNINGS_"+myref).disabled=e,$("ELEMENT_IPS_NOTIFICATION_"+myref).disabled=e,f=document.getElementsByClassName("IPS_ACTION_"+myref),f.each(function(a,b){/ELEMENT_([a-zA-Z_]+REF_[a-zA-Z0-9_]+)/.exec(a.id);var c=RegExp.$1;d?core.dropdownMap[c].enable():core.dropdownMap[c].disable()}),g=document.getElementsByClassName("IPS_WARNINGS_"+myref),g.each(function(a,b){$(a.id).disabled=e}),h=document.getElementsByClassName("IPS_NOTIFICATION_"+myref),h.each(function(a,b){$(a.id).disabled=e});break;case"warning":case"notification":d=$("ELEMENT_"+a).checked,c=document.getElementsByClassName(a),c.each(function(a,b){$(a.id).checked=d})}else d=core.dropdownMap[a].getValue(),c=document.getElementsByClassName(a),c.each(function(a,b){/ELEMENT_([a-zA-Z_]+REF_[a-zA-Z0-9_]+)/.exec(a.id);var c=RegExp.$1;core.dropdownMap[c].setValue(d,!0)})}function show_quagga_debug(a,b){var c={objs:[{FID:"quagga_debug_fetch",proto:a,what:b,callback:function(b){var c,d,e;b&&b.quaggadebug&&(c="<html><head><title>Quagga Debug Output</title></head><body><pre id='quaggadebug'></pre></body></html>",d=window.open("","_quagga_debug_window_","left=10,top=10,width=500,height=250,scrollbars=yes,resizable=yes"),e=d.document,e.write(c),e.close(),d.document.getElementById("quaggadebug").innerHTML=b.quaggadebug)}}]};req_send(c)}function enable_web_control(a){call_fid("enable_web_control",{callback:function(a){if(!a.success)var b=[{label:_LOC("aXNAKzxkml","Ok"),"default":!0,exec:function(){}}],c=interactionPopup({open:!0,text:_LOC("wGrGLoDysE","An error occurred while enabling Web Control."),buttons:b,centered:!0})},groups:a},[])}function prompt_enable_web_control(a,b,c){var d,e;if(b&&!c)a.length>1?d=_LOC("dWeORUZJDT","Web Control is not enabled for one or more endpoint groups. Would you like to enable it now?"):d=_LOC("xTeGXPwzIZ","Web Control is not enabled for the endpoint group. Would you like to enable it now?");else if(!b&&c||!b&&!c)d=_LOC("EGyPDaFOYO","Web Control is not enabled. Would you like to enable it now?");if(d)var f=[{label:_LOC("rrxSbisoVp","Yes, enable now"),"default":!0,exec:function(){enable_web_control(a)}},{label:_LOC("gTWscrTnGY","No, leave for later"),exec:function(){}}],g=interactionPopup({open:!0,text:d,buttons:f})}function should_prompt_enable_web_control(a){call_fid("web_control_status",{callback:function(b){(!b.global_status||!b.group_status)&&a.length>0&&prompt_enable_web_control(a,b.global_status,b.group_status)},groups:a},[])}function basic_setup_apply(a,b){var c=core.buttonMap[a][0],d=$("bsetup_pleasewait"),e;c.disable(),e=function(a,b,c){d.style.color=b,c?(d.update(),d.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:c,style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(a)]))))):d.update(a)},call_fid("login_process",{callback:function(a){var b="",d,f,g,h;if(a.error){c.enable();if(Object.isArray(a.error)){d=a.error.length;while(d--){f=a.error[d],g=f.field;if(g){g=g.uniq(),h=g.length;while(h--)g[h]&&border_blink_element(g[h])}b+=f.text+"\n"}e(b,"red","core/img/icons/warning.png")}}a.success&&(e(a.success[0].text,"green"),setTimeout(basic_setup_finished,4e4))}},b)}function filter_http(a){return a.type==="lsl_tag"}function filter_endpoints(a){return a.type==="endpoint"||a.type==="endpoints_group"}function refresh_timeout_offline(){var a,b;!webadmin_timeout||(webadmin_keepalive=config.webadmin_keepalive>0?config.webadmin_keepalive:Math.round(webadmin_timeout/3),webadmin_keepalive*3>webadmin_timeout&&(webadmin_keepalive=Math.round(webadmin_timeout/3)),a=Math.round((new Date).getTime()/1e3),b=a-webadmin_timeout_set,b>webadmin_keepalive&&(webadmin_timeout_set=Math.round((new Date).getTime()/1e3),_debug('time_diff was "'+b+'" at a webadmin_keepalive of "'+webadmin_keepalive+'" and webadmin_timeout of "'+webadmin_timeout+'"'),call_fid("refresh_timeout")))}var sp_category_map=config.mappings.sp_category_map,dnd_clases=["network","service","interface","aaa","http","epp","awscli","aws"],dnd_titles={network:'Networks <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',service:'Services <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',"interface":'Interfaces <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',aaa:'Users/Groups <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',http:'HTTP <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',epp:'Computers/Groups <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',awscli:'Amazon Web Services <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>',aws:'Amazon Web Services <span style="font-size:11px;">(#{firstKey}+#{secondKey})</span>'},dnd_type_filters={network:{values:["0","host","network","availability_group","group","dns_host","dns_group","aaa","range","interface_address","interface_broadcast","interface_network","multicast"],labels:{0:"All",host:"Hosts",network:"Networks",availability_group:"Availability Groups",group:"Groups",dns_host:"DNS Hosts",dns_group:"DNS Groups",aaa:"User/Group",interface_address:"Interface addresses",interface_broadcast:"Interface broadcast addresses",interface_network:"Interface networks",multicast:"Multicast Groups",range:"Network Ranges"}},service:{values:["0","tcp","udp","tcpudp","icmp","icmpv6","ah","esp","ip","group"],labels:{0:"All",tcp:"TCP",udp:"UDP",tcpudp:"TCP/UDP",icmp:"ICMP",icmpv6:"ICMPv6",ah:"AH",esp:"ESP",ip:"Generic",group:"Groups"}},"interface":{values:["0","ppp3g","pppoa","pppoe","ethernet","vlan","group","pppmodem","bridge"],labels:{0:"All",group:"Group",ethernet:"Ethernet",vlan:"Ethernet VLAN",pppoe:"DSL (PPPOE)",pppoa:"DSL (PPPOA)",pppmodem:"Modem (PPP)",ppp3g:"3G/UMTS",bridge:"Ethernet Bridge"}},aaa:{values:["0","user","group"],labels:{0:"All",user:"Users",group:"Groups"}},http:{values:["parent_proxy","lsl_tag","sp_subcat"],labels:{parent_proxy:"Parent Proxy",lsl_tag:"Tags",sp_subcat:"Categories"}},epp:{values:["0","endpoint","endpoints_group"],labels:{0:"All",endpoint:"Computers",endpoints_group:"Groups"}},awscli:{values:["0","profile"],labels:{0:"All",profile:"Profiles"}},aws:{values:["0","region"],labels:{0:"All",region:"Regions"}}},dnd_bgcolors=["#f7f7f7","#e4e4e7"],dnd_cnt={network:0,service:0,"interface":0,aaa:0},icmp_map={"00_00":"[T00/C00] Ping: Echo reply","03_00":"[T03/C00] Destination unreachable: Network","03_01":"[T03/C01] Destination unreachable: Host unreachable","03_02":"[T03/C02] Destination unreachable: Protocol unreachable","03_03":"[T03/C03] Destination unreachable: Port unreachable","03_04":"[T03/C04] Destination unreachable: Fragmentation needed","03_05":"[T03/C05] Destination unreachable: Source route failed","03_06":"[T03/C06] Destination unreachable: Network unknown","03_07":"[T03/C07] Destination unreachable: Host unknown","03_08":"[T03/C08] Destination unreachable: Host isolated","03_09":"[T03/C09] Destination unreachable: Prohibited network access","03_10":"[T03/C10] Destination unreachable: Prohibited host access","03_11":"[T03/C11] Destination unreachable: Network unreachable w/ this TOS","03_12":"[T03/C12] Destination unreachable: Host unreachable w/ this TOS","03_13":"[T03/C13] Destination unreachable: Communication prohibited","03_14":"[T03/C14] Destination unreachable: Precedence violation","03_15":"[T03/C15] Destination unreachable: Precedence cut off","04_00":"[T04/C00] Source quench","05_00":"[T05/C00] Redirect: Network","05_01":"[T05/C01] Redirect: Host","05_02":"[T05/C02] Redirect: Network/TOS","05_03":"[T05/C03] Redirect: Host/TOS","06_00":"[T06/C00] Alternate Host Address","08_00":"[T08/C00] Ping: Echo request","09_00":"[T09/C00] Router Advertisement","09_16":"[T09/C16] Router Advertisement: no common traffic","10_00":"[T10/C00] Router selection","11_00":"[T11/C00] TTL: TTL exceeded","11_01":"[T11/C01] TTL: Frag. reassembly time exceeded","12_00":"[T12/C00] Parameter problem","12_01":"[T12/C01] Parameter problem: missing option","12_02":"[T12/C02] Parameter problem: bad length","13_00":"[T13/C00] Timestamp","14_00":"[T14/C00] Timestamp reply","15_00":"[T15/C00] Information request","16_00":"[T16/C00] Information reply","17_00":"[T17/C00] Address mask request","18_00":"[T18/C00] Address mask reply","30_00":"[T30/C00] Traceroute","31_00":"[T31/C00] Datagram Conversion Error","32_00":"[T32/C00] Mobile Host Redirect","33_00":"[T33/C00] IPv6 Where-Are-You","34_00":"[T34/C00] IPv6 I-am-here","35_00":"[T35/C00] Mobile Registration Request","36_00":"[T36/C00] Mobile Registration Reply","39_00":"[T39/C00] SKIP","40_00":"[T40/C00] Photuris: Bad SPI","40_01":"[T40/C01] Photuris: Authentication Failed","40_02":"[T40/C02] Photuris: Decompression Failed","40_03":"[T40/C03] Photuris: Decryption Failed","40_04":"[T40/C04] Photuris: Need Authentication","40_05":"[T40/C05] Photuris: Bad Need Authorization"},icmpv6_map={"01_00":"[T01/C00] Destination unreachable: no route to destination","01_01":"[T01/C01] Destination unreachable: communication prohibited","01_02":"[T01/C02] Destination unreachable: beyond scope of source address","01_03":"[T01/C03] Destination unreachable: address unreachable","01_04":"[T01/C04] Destination unreachable: port unreachable","01_05":"[T01/C05] Destination unreachable: source address failed ingress/egress policy","01_06":"[T01/C06] Destination unreachable: reject route to destination","02_00":"[T02/C00] Packet Too Big","03_00":"[T03/C00] Time Exceeded: hop limit exceeded in transit","03_01":"[T03/C01] Time Exceeded: fragment reassembly time exceeded","04_00":"[T04/C00] Parameter Problem: erroneous header field encountered","04_01":"[T04/C01] Parameter Problem: unrecognized Next Header type encountered","04_02":"[T04/C02] Parameter Problem: unrecognized IPv6 option encountered","128_00":"[T128/C00] Ping: Echo Request","129_00":"[T129/C00] Ping: Echo Reply","130_00":"[T130/C00] Multicast Listener Query","131_00":"[T131/C00] Multicast Listener Report","132_00":"[T132/C00] Multicast Listener Done","133_00":"[T133/C00] Router Solicitation","134_00":"[T134/C00] Router Advertisement","135_00":"[T135/C00] Neighbor Solicitation","136_00":"[T136/C00] Neighbor Advertisement","137_00":"[T137/C00] Redirect Message","138_00":"[T138/C00] Router Renumbering: Command","138_01":"[T138/C01] Router Renumbering: Result","138_255":"[T138/C255] Router Renumbering: Sequence Number Reset","139_00":"[T139/C00] Node Information: Query IPv6","139_01":"[T139/C01] Node Information: Query Name/NOOP","139_02":"[T139/C02] Node Information: Query IPv4","140_00":"[T140/C00] Node Information: Response successful","140_01":"[T140/C01] Node Information: Response refused","140_02":"[T140/C02] Node Information: Response unknown","141_00":"[T141/C00] Inverse Neighbor Discovery: Solicitation","142_00":"[T142/C00] Inverse Neighbor Discovery: Advertisement",143:"[T143] Version 2 Multicast Listener Report","144_00":"[T144/C00] Home Agent Address Discovery: Request","145_00":"[T145/C00] Home Agent Address Discovery: Reply","146_00":"[T146/C00] Mobile Prefix: Solicitation","147_00":"[T147/C00] Mobile Prefix: Advertisement",151:"[T151] Multicast Router: Advertisement",152:"[T152] Multicast Router: Solicitation",153:"[T153] Multicast Router: Termination",154:"[T154] FMIPv6 Messages"},ctMap={network:{"*":{FID:"network_form",txt_edit:_LOC("hZwJzXxMVq","Edit network definition"),txt_add:_LOC("NHoOlrhzsS","Add network definition")}},service:{"*":{FID:"service_form",txt_edit:_LOC("KoaXjaNCDa","Edit service definition"),txt_add:_LOC("PfcLXhnuTM","Add service definition")}},scheduler:{"*":{FID:"scheduler_form",txt_edit:_LOC("frRqeUKYpi","Edit scheduler"),txt_add:_LOC("YzQznKMkkL","Add scheduler")}},"interface":{group:{FID:"interface_group_form",txt_edit:_LOC("JqCzaBOiMy","Edit Interface Group"),txt_add:_LOC("spBzuCURKv","Add Interface Group")}},ca_export:{"*":{FID:"ca_export_form",txt_add:_LOC("AYUgPwDOjX","Download&nbsp;certificate&nbsp;authority&nbsp;"),txt_edit:"void"}},ca_cert_export:{"*":{FID:"ca_cert_export_form",txt_add:_LOC("PFcxBWpwqP","Download certificate"),txt_edit:"void"}},upload_http_ca:{"*":{FID:"upload_http_ca_form",txt_add:_LOC("wXZNGpIwZg","Upload PKCS#12 certificate file"),txt_edit:"void"}},download_http_ca:{"*":{FID:"download_http_ca_form",txt_add:_LOC("GTmCeNOreb","Download certificate file"),txt_edit:"void"}},regenerate_http_ca:{"*":{FID:"regenerate_http_ca_form",txt_add:_LOC("KiHtygXRgQ","Create new signing CA"),txt_edit:"void"}},emailpki_download_smime:{"*":{FID:"emailpki_download_smime_form",txt_add:_LOC("jtCIUxhTrF","Download certificate"),txt_edit:"void"}},emailpki_download_openpgp:{"*":{FID:"emailpki_download_openpgp_form",txt_add:_LOC("NAjWjXYORg","Download certificate"),txt_edit:"void"}},upload:{"*":{FID:"upload_form",txt_add:_LOC("eWtOiMMGht","Upload file"),txt_edit:"void"}},dashboard:{"*":{FID:"dashboard_settings_form",txt_add:_LOC("ueQyzRGfct","Edit dashboard settings"),txt_edit:"void"}},download:{snapshot:{FID:"snapshot_download_form",txt_add:_LOC("UxTXsNnXnm","Download options"),txt_edit:"void"},peer_config:{FID:"ssl_site_to_site_vpn_download_form",txt_add:_LOC("rhPyiltvAQ","Download&nbsp;peer&nbsp;configuration&nbsp;"),txt_edit:"void"},ssl_vpn_packages:{FID:"download_ssl_vpn_packages_form"},ipsec_vpn_certificates:{FID:"download_ipsec_vpn_certificates_form"},l2tp_vpn_certificates:{FID:"download_l2tp_vpn_certificates_form"},ios_vpn_configs:{FID:"download_ios_vpn_configs_form"}},backup:{snapshot:{FID:"snapshot_sendnow_form",txt_add:_LOC("wCrGfaxwUa","Send Now options"),txt_edit:"void"}},u2d:{desc:{FID:"u2d_desc",txt_add:_LOC("CoYDvsfocp","Up2Date information"),txt_edit:"void"},schedule:{FID:"u2d_schedule",txt_add:_LOC("lmysKusLSZ","Schedule Installation"),txt_edit:"void"}},ldap:{browser:{FID:"ldap_browser",txt_add:_LOC("KArpnlqJSf","eDirectory Browser"),txt_edit:"void"}},directory_browser:{browser:{FID:"directory_browser",txt_add:_LOC("TKdnpOaMnV","Directory Browser"),txt_edit:"void"}},cff:{expression:{FID:"cff_expression_form",txt_add:_LOC("IsuiCMCJeb","Add expression"),txt_edit:_LOC("fqSnbdeEwg","Edit expression")}},pop3:{server:{FID:"pop3_server_form",txt_add:_LOC("paaIkGidPo","Add server"),txt_edit:_LOC("RFUauwhfGf","Edit server")}},ips:{rule_modifier:{FID:"ips_rule_modifier_form",txt_add:_LOC("NKALnGQFOX","Modify rule"),txt_edit:_LOC("RPqLsqYxOf","Edit modified rule")}},remote_syslog:{server:{FID:"remote_syslog_server_form",txt_add:_LOC("qObiVmreCz","Add Syslog Server"),txt_edit:_LOC("yzEGUwqNLY","Modify Syslog Server")}},aaa:{user:{FID:"user_form",txt_edit:_LOC("KeNKCcRktw","Edit user"),txt_add:_LOC("AWnYybPNNX","Add user")},group:{FID:"group_form",txt_edit:_LOC("hAJoNWBfca","Edit user group"),txt_add:_LOC("sLCjpRjNhs","Add user group")},"*":{FID:"user_form",txt_edit:_LOC("JiFibEHADw","Edit user"),txt_add:_LOC("fDJgGfKTOo","Add user")}},ospf:{message_digest_key:{FID:"ospf_mdkey_form",txt_edit:_LOC("zPpWjRRQdj","Edit message digest key"),txt_add:_LOC("xhiewvaKiB","Add message digest key")}},time:{"*":{FID:"time_form",txt_add:_LOC("vWxBCerGXP","Add time event"),txt_edit:_LOC("UNeaBNBfCm","Edit time event")}},dhcp:{static_mapping:{FID:"dhcp_static_mapping_form",txt_add:_LOC("gIzBTEdLmC","Make static"),txt_edit:"void"}},ha_status:{device_name:{FID:"ha_status_device_name",txt_add:_LOC("mZzsAximhm","Edit device name"),txt_edit:"void"}},awe:{device:{FID:"awe_device_form",txt_add:"void",txt_edit:_LOC("HectMiDkIo","Edit Access Point")},client:{FID:"awe_client_form",txt_add:_LOC("lMIdnoDOno","Add Wireless Client"),txt_edit:_LOC("mxBnLaUWJT","Edit Wireless Client")},local:{FID:"awe_local_form",txt_add:"void",txt_edit:_LOC("JCTWGKqsuf","Edit Local Access Point")},red:{FID:"awe_red_form",txt_add:"void",txt_edit:_LOC("CWxipUtyZZ","Edit RED Access Point")}},awe_network_device_association:{mesh_role:{FID:"awe_mesh_role_form",txt_add:_LOC("jECExXuNbR","Add Mesh Role"),txt_edit:_LOC("HfadYYvtkK","Edit Mesh Role")}},itfhw:{awe_network:{FID:"awe_network_form",txt_add:"void",txt_edit:_LOC("fMUJrejknR","Edit Wireless Network")},awe_network_group:{FID:"awe_group_form",txt_add:"void",txt_edit:_LOC("zFkaNZUPal","Edit Access Point Group")},red_server:{FID:"red_server_form",txt_edit:_LOC("edogOkSFdW","Edit RED"),txt_add:"void"}},reverse_proxy:{url:{FID:"http_reverse_proxy_urls_form",txt_add:_LOC("pWfIaGZokV","Add URL"),txt_edit:_LOC("WNRXePcegb","Edit URL")},filter:{FID:"http_reverse_proxy_filters_form",txt_add:_LOC("pkLCHMxTUv","Add Filter"),txt_edit:_LOC("YJwmfGTSoG","Edit Filter")},sitemap:{FID:"sitemap_import_form",txt_add:_LOC("kravNmTvNl","Import Google Sitemap"),txt_edit:"void"},backend:{FID:"http_reverse_proxy_realserver_form",txt_add:_LOC("OUyBZDyCxe","Create Real Webserver"),txt_edit:"void"}},reporting:{mail:{FID:"report_mail_recipients_form",txt_edit:_LOC("lQbYJScveZ","Edit Recipient Group"),txt_add:_LOC("PNASMlGXZt","Add Recipient Group")},filter:{FID:"webreport_filter_form",txt_edit:_LOC("yGQBDCDJmc","Edit custom report"),txt_add:_LOC("otYxXYUnCC","Save custom report")},sendmail:{FID:"webreport_sendmail_form",txt_edit:_LOC("XarIEKlNTF","Send report"),txt_add:_LOC("YcgQftaSqA","Send report")}},http:{parent_proxy:{FID:"http_parent_proxies_form",txt_edit:_LOC("SfhyzMspIw","Edit Parent Proxy"),txt_add:_LOC("OQFinXCBBp","Add Parent Proxy")},domain_regex:{FID:"http_domain_regex_form",txt_edit:_LOC("FmyQWeoZvu","Edit whitelist/blacklist object"),txt_add:_LOC("owOEDzrnZW","Add whitelist/blacklist object")},cff_profile:{FID:"http_proxy_cff_profile_assignments_form",txt_edit:_LOC("LVigLuWCYH","Edit Policy"),txt_add:_LOC("hxIcyxbmMs","Add Policy")},local_site:{FID:"http_local_site_form",txt_edit:_LOC("LJYVFaxXSJ","Edit Site"),txt_add:_LOC("bmkMJNTLhQ","Add Site(s)")},cff_action:{FID:"filter_action_popup",txt_edit:_LOC("vJyHMJdKTO","Edit Filter Action"),txt_add:_LOC("pmULdkjDYO","Add Filter Action")},profile:{FID:"http_additional_profiles_popup",txt_edit:_LOC("ZsqUNKrBzi","Edit Profile"),txt_add:_LOC("PFxnBGpWIm","Add Profile")},device_auth:{FID:"http_device_auth_form",txt_edit:_LOC("ULUPcxJlRb","Edit Device-specific Authentication"),txt_add:_LOC("JJnuwybxGo","Add Device-specific Authentication")},lsl_tag:{FID:"http_lsl_tag_form",txt_edit:_LOC("iVDymUrVFd","Edit Website Tag"),txt_add:_LOC("iowjepVJXC","Add Website Tag")},detailed_report:{FID:"sandbox_detailed_report",txt_edit:_LOC("CGYqKESWWY","Sophos Sandstorm: Sandbox submission details"),txt_add:_LOC("kPwFMvlnWY","Sophos Sandstorm: Sandbox submission details")},sandstorm_manual:{FID:"send_to_sandstorm",txt_edit:_LOC("GMMoxblXkA","Sample File Analysis with Sandstorm"),txt_add:_LOC("hgXFXcKYSn","Sample File Analysis with Sandstorm")}},parent_proxy:{"*":{FID:"parent_proxy_form",txt_edit:_LOC("TSpnuWlvDn","Edit Parent Proxy"),txt_add:_LOC("lqxQsNoCCr","Add Parent Proxy")}},nnd:{scan:{FID:"nnd_scan_networks_form",txt_add:"Scan Network",txt_edit:"void"}},epp:{endpoints_groups:{FID:"epp_manage_eps_groups_form",txt_edit:_LOC("zbFbAIKhcb","Edit computers group"),txt_add:_LOC("DiukSaFxkV","Add computers group")},endpoint:{FID:"epp_manage_eps_form",txt_edit:_LOC("ZXaUkjHEQi","Edit Computer"),txt_add:"void"}},authentication:{otp_token:{FID:"auth_otp_form",txt_edit:_LOC("YrZBcgEIWA","Edit OTP Token"),txt_add:_LOC("wjMMMJQEck","Add OTP Token")},otp_token_import:{FID:"auth_otp_import_form",txt_add:_LOC("ijMIcHtUon","Import OTP Tokens")},otp_timeoffset:{FID:"auth_otp_timeoffset_form",txt_add:_LOC("tUDPlHWIkF","Check OTP token time-offset")}},aptp:{atp_exception:{FID:"aptp_exceptions_form",txt_edit:"void",txt_add:_LOC("MaKJprzrCN","Add ATP Exception")},ips_exception:{FID:"aptp_exceptions_form",txt_edit:"void",txt_add:_LOC("HykFGdMdcx","Disable IPS Rule")}},hotspot:{voucher:{FID:"hotspot_voucher_form",txt_edit:_LOC("iZfEpbrorp","Edit Voucher Definition"),txt_add:_LOC("QqJeegIJhf","Add Voucher Definition")}},smtp:{header_operation:{FID:"smtp_header_operation_form",txt_add:_LOC("mlmoGfmRaH","Add Header Modification rule"),txt_edit:_LOC("EYbEbxPVOb","Edit Header Modification rule")}},stas:{collector:{FID:"stas_collector_form",txt_add:_LOC("VGeKEuuqLU","Add Collector definition"),txt_edit:_LOC("BDTVkGVCkG","Edit Collector definition")}}},user_preferences=null,popup_type_whitelist={http:["cff_action"]},form_type_whitelist={network_form:["host","dns_host","dns_group","network","group","availability_group","range","multicast"],macaddresses_form:["mac_list"],service_form:["tcp","udp","tcpudp","icmp","icmpv6","esp","ah","ip","group"],scheduler_form:["loadbalance"],qos_ts_form:["traffic_selector","group"],ipsec_gateway_form:["remote_gateway"],ipsec_connection_site_to_site_form:["site_to_site"],ipsec_policy_form:["policy"],time_form:["single","recurring"],http_cff_categories_form:["sp_category"],filter_action_popup:["cff_action"],http_exception_form:["exception"],packetfilter_rule_form:["packetfilter"],parent_proxy_form:["parent_proxy","parent_proxy_host"]},applicationName=config.appid,webadmin_keepalive,webadmin_timeout_set=!1,app={};app.dnd_show_network=new Keys(Keys.TRIGGERKEYS.CTRL,"z",function(){logged_in&&dnd_show("network")}),app.dnd_show_service=new Keys(Keys.TRIGGERKEYS.CTRL,"x",function(){logged_in&&dnd_show("service")}),app.dnd_show_interface=new Keys(Keys.TRIGGERKEYS.CTRL,"c",function(){logged_in&&dnd_show("interface")}),app.dnd_show_aaa=new Keys(Keys.TRIGGERKEYS.CTRL,"v",function(){logged_in&&dnd_show("aaa")}),app.dnd_show_epp=new Keys(Keys.TRIGGERKEYS.CTRL,"m",function(){logged_in&&dnd_show("epp",!1,filter_endpoints)}),app.focus_searchbox=new Keys(Keys.TRIGGERKEYS.CTRL,"y",function(){var a=!1;core.Events.observe("dnd:overlay_closed",function(){a=!1}),core.Events.observe("dnd:overlay_opened",function(){a=!0});return function(){if(logged_in){window.setTimeout(function(){a||core.menu.searchbox.focus()},10);return!1}}}()),app.reverse_proxy={global_status:0,balancer_id:{},balancer_status:{}},app.helpUUID={http_cff_action:{url_filtering:"1f6ba78d-5d1c-4bfb-b5de-d4e287cd27bb",allow_block:"6accb6f0-3043-11e3-aa6e-0800200c9a66",downloads:"5820b0fe-8406-40cf-9f43-2c3037f3ce15",av:"831bf2be-6e13-44a2-be45-edfcf4c0cc59",additional:"bd6337c0-7128-46d5-8685-981bd18e6e99"},http_profile:{profile:"edf9bdcc-cae3-4682-92f8-02760623c29d",policies:"2058717b-e5a1-4ab8-9ab9-2686a0e8e717"}},app.wizardTabs={http_cff_action:["url_filtering","allow_block","downloads","av","additional"],http_profile:["profile","https","policies"],_on_show:{additional:function(){init_quota_time_controls()}},index:{http_cff_action:-1,http_profile:-1}},simpleErrors.OBJECT_NAMESPACE=_LOC("JnquTFluQB","An item with that name already exists, please use a different name"),simpleErrors.QOS_BW_CALC=_LOC("ODoBDISeqP","The settings you are attempting to make result in an impossible bandwidth allocation situation. Please review your settings."),simpleErrors.OBJECT_INVALID_NAME=_LOC("MIPPfxQlDE","The name you have entered cannot be used. Please try a different name. If the problem persists, please check the documentation for information on how items of this type can be named."),simpleErrors.MULTI_DEFAULT_GW=_LOC("nYTzWntLPm","You already have a default gateway defined. Only one default gateway can be used on the system."),simpleErrors.PW_COMPLEXITY=_LOC("ZpiHimgiBq","The entered password does not match the required complexity: Please check the requirements in Definitions & Users > Authentication Servers > Servers."),simpleErrors.ITFHW_EXCLUSIVE=_LOC("wavfrQDyrC","The hardware you selected is in use by a VLAN interface. It can only be used to add additional VLAN interfaces."),dynIncPath="wfe/"+applicationName+"/js/dynamic_includes/";var snapshot_table_render=function(){function h(a){var b,c=/^([\d]+)\.([\d]{3})([\d]+)$/,d=/\-0*([0-9]+)/;b=a.replace(c,"$1.$2-$3"),b=b.replace(d,"-$1");return b||a}function g(a,b){var c=new core.popup({name:"POPUP_BACKUP_DOWNLOAD_"+a,"class":"download",type:"snapshot",anchor:b,update_type:"download",update_name:a})}function f(a,b){var c=new core.popup({name:"POPUP_BACKUP_SENDNOW_"+a,"class":"backup",type:"snapshot",anchor:b,update_type:"backup",update_name:a})}function e(){var a=document.getElementsByClassName("SNAPSHOT_MASSACTION_CHECKBOX"),b=a.length,c=[],d;if(b){while(b--)d=a[b],d.checked&&c.push(d.id);c.length?confirm(_LOC("IQCAAaYrmz","Are you sure that you want to delete these backups?"))&&req_send({objs:[{FID:"snapshot_delete",snapshot_names:c,snapshot_table_render:"1",callback:snapshot_table_render}]}):alert(_LOC("WhMVAkQmsf","Please select at least one snapshot to delete."))}}function d(a){confirm(_LOC("mJyVmirkHz","Are you sure that you want to delete this backup?"))&&req_send({objs:[{FID:"snapshot_delete",snapshot_names:[a],snapshot_table_render:"1",callback:snapshot_table_render}]})}function c(a,b){var c="";b?alert(_LOC("KbtSvvKgAo","WARNING: The backup version given for restoring is newer than the current system version. This might introduce permanent damage and some features might not work as expected and is therefore not allowed.")):(c=_LOC("JQjimncfJN","Restoring a backup will log you out of WebAdmin. Are you sure you want to restore?"),confirm(c)&&req_send({objs:[{FID:"snapshot_restore",snapshot_name:a,snapshot_table_render:"1",callback:reload_wfe}]}))}var a=function(a,b,c,d){var e=Builder.node("img",{src:b,title:a,height:16,width:16,align:"left"});d&&(e=Builder.node("div",{style:"line-height:17px;cursor:pointer;"},[e,Builder.node("span",{},a)])),Event.observe(e,"click",c);return e},b=[_LOC("OqXNzYsJag","Available backups"),_LOC("DDiFSCGFzT","Date/Time of creation"),_LOC("mGpQuQGPyM","Version"),_LOC("ORwibSSljB","Creator")];return function(i){i&&i.error&&alert(i.error[0].text);var j=$("snapshot_table_wrapper"),k,l,m,n,o,p=["#F7F7F7","#E4E4E7"];if(!j)return!0;if(!i||!i.snapshot_table_render){req_send({objs:[{FID:"snapshot_list",snapshot_table_render:"1",callback:"snapshot_table_render"}]});return!0}if(!i.snapshots)return!0;j.innerHTML="",k=domDiv({color:"#333333"},{},{},domTableRow([domTd({},{className:"ir_table_caption_left"},{},domSpan({},{},{},"")),domTd({},{className:"ir_table_caption_center",width:"148"},{},domSpan({fontWeight:"bold",display:"block",width:"148px"},{className:"ellipsis",title:b[0]},{},b[0])),domTd({},{className:"ir_table_caption_center",width:"149"},{},domSpan({fontWeight:"bold",display:"block",width:"149px"},{className:"ellipsis",title:b[1]},{},b[1])),domTd({},{className:"ir_table_caption_center",width:"50"},{},domSpan({fontWeight:"bold",display:"block",width:"50px"},{className:"ellipsis",title:b[2]},{},b[2])),domTd({},{className:"ir_table_caption_center"},{},domSpan({fontWeight:"bold",display:"block",width:"250px"},{className:"ellipsis",title:b[2]},{},b[3])),domTd({},{className:"ir_table_caption_right"},{},domSpan({},{},{},""))],{width:"100%"})),l=domDiv({},{},{}),n=$(Builder.node("input",{type:"checkbox",title:_LOC("gXavIvBFYK","Select/Unselect all snapshots")})),Event.observe(n,"click",function(){var a=document.getElementsByClassName("SNAPSHOT_MASSACTION_CHECKBOX"),b=a.length,c=n.checked;while(b--)a[b].checked=c}),o=a(_LOC("PLUACYuoPV","Delete selected snapshots"),"core/img/icons/delete.png",e,!0),m=domDiv({},{},{},domTableRow([domTd({},{},{},domSpan({},{},{},"")),domTd({},{},{},n),domTd({},{},{},o)])),domApplyStyle(j,{position:"relative",overflow:"auto",marginBottom:"6px",width:"100%"}),j.appendChild(k),j.appendChild(l);if(i.snapshots.length===0){l.appendChild(domTableRow([domTd({padding:"4px"},{align:"center"},{},domSpan({},{},{},_LOC("rbkIWmoKMz","No backups available")))],{width:"100%",backgroundColor:"#eeeeee"}));return!0}j.appendChild(m),i.snapshots.each(function(b,e){var i=new Date(b.timestamp*1e3),j=a(_LOC("GyKuYYcCep","Restore"),"core/img/icons/restore.png",c.curry(b.name,b.version_conflict)),k=a(_LOC("TpGodFCAqE","Download"),"core/img/icons/download.png",function(){g(b.name,k)}),m=a(_LOC("KCbTeSMzEg","Send"),"core/img/icons/send.png",function(){f(b.name,m)}),n=a(_LOC("VCFKbEEhYc","Delete"),"core/img/icons/delete.png",d.curry(b.name)),o=$(Builder.node("input",{type:"checkbox",id:b.name,className:"SNAPSHOT_MASSACTION_CHECKBOX"})),q=b.version.toString();q.length===1&&(q+=".");while(q.length<5)q+="0";q=h(q),l.appendChild(domDiv({backgroundColor:p[e%2]},{},{},domTableRow([domTd({padding:"3px 0"},{valign:"top"},{},o),domTd({cursor:"pointer",padding:"5px 0 0 5px",width:"16px"},{valign:"top"},{},k),domTd({cursor:"pointer",padding:"5px 0 0 5px",width:"16px"},{valign:"top"},{},j),domTd({cursor:"pointer",padding:"5px 0 0 5px",width:"16px"},{valign:"top"},{},n),b.sendable?domTd({cursor:"pointer",padding:"5px 0 0 5px",width:"16px"},{valign:"top"},{},m):domTd({padding:"5px 0 0 5px",width:"16px"},{valign:"top"},{},!1),domTd({},{},{},domTableCol([domTd({padding:"4px 4px 4px 4px",backgroundColor:p[e%2]},{},{},domTableRow([domTd({paddingRight:"4px",width:"16px"},{valign:"top"},{},domImg({},{src:"core/img/icons/date.png"},{})),domTd({paddingRight:"8px",width:"130px"},{valign:"top"},{},domSpan({},{},{},i.getFullYear()+"-"+zeropad(i.getMonth()+1,2)+"-"+zeropad(i.getDate(),2)+" "+zeropad(i.getHours(),2)+":"+zeropad(i.getMinutes(),2))),domTd({paddingRight:"8px",width:"50px"},{valign:"top"},{},domSpan({fontWeight:"bold",color:b.version_conflict?"#ee7f00":"#000"},{},{},q)),domTd({paddingRight:"4px",width:"16px"},{valign:"top"},{},domImg({},{src:"core/img/"+(b.username==="system"?"dashboard/system.png":"icons/user.png")},{})),domTd({},{valign:"top"},{},domSpan({},{},{},b.username))],{width:"100%"})),b.comment?domTd({padding:"4px 4px 4px 4px",backgroundColor:p[e%2]},{},{},domTableRow([domTd({paddingRight:"4px",width:"16px"},{valign:"top"},{},domImg({},{src:"core/img/icons/comment.png"},{})),domTd({wordWrap:"break-word",maxWidth:"590px"},{valign:"top"},{},domSpan({},{},{},b.comment||"&nbsp;"))],{width:"100%"})):!1],{width:"100%",paddingLeft:"54px"}))])))})}}(),copy_aim_policy_to_clipboard=function(){return function(){req_send({objs:[{FID:"get_iam_policy",callback:function(a){Event.observe($("ELEMENT_asg_ha_autoscaling_copy_iam"),"click",function(){clipboard.copy(a.iam_policy).then(function(){infopop_up("ELEMENT_asg_ha_autoscaling_copy_iam","Copied")},function(a){infopop_up("ELEMENT_asg_ha_autoscaling_copy_iam","Clipboard access failed. Browser probably too old"),console.log("Clipboard access failed. Browser probably too old",a)})})}}]})}}(),dashboard_timer=!1;(function(a){function g(){b&&a.clearTimeout(b),b=!1,call_fid(c,{timer:core.dropdownMap[d].getValue()},[])}function f(){b&&a.clearTimeout(b),b=!1,$("ELEMENT_"+d)?call_fid(c,{timer:core.dropdownMap[d].getValue()},[]):call_fid(c,{},[])}function e(e,g,h){e&&(c=e),h&&(d=h),g?b=a.setTimeout(f,g*1e3):a.clearTimeout(b)}var b=!1,c,d;a.page_reloader=e,a.page_reloader_set=g})(window);var notifications,qm_window=!1,report_timer=null,report_win=!1,countdownTime=0,countdownHandle=null,flow_monitor_open=function(){var a=[];window.flow_monitor_itf_ref=function(b){var c=a.detect(function(a,c){if(a.itf&&a.itf==b)return a.itf_ref;return null});return c};return function(b){var c=b||{},d=a.length,e=a.detect(function(a,b){if(a.itf&&a.itf==c.monitor["interface"]){if(a.win&&!a.win.closed)return a;d=b}return null}),f=function(){window.open("flow_monitor.html","FMITF"+c.monitor["interface"],"height=750,width=980,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbars=no")};if(!e){try{e={win:f(),itf:c.monitor["interface"],itf_ref:c.monitor.itf_ref}}catch(g){}a[d]=e}else e.win.closed&&(e.win=f());e.win&&(e.win.theInterface=c.monitor["interface"],core.openedWindows.push(e.win))}}(),ha_reload_status_timer=!1,ha_reload_status_timeout=3e3;(function(a){function f(a){a.nnd_scanned_hosts&&($("OBJ_TABLE_empty_text").update(a.nnd_scanned_hosts),d())}function e(){c(),req_send({objs:[{FID:"nnd",nnd_scan:1,callback:"nnd_scan_host_callback"}]})}function d(){c(),b=window.setTimeout(e,3e3)}function c(){b&&(window.clearTimeout(b),b=null)}var b=null;a.nnd_scan_hosts=d})(window);var init_user_information=function(){var a=!1;return function(){Event.observe($("topbar_icon"),"mouseover",function(b){call_fid("get_user_information",{callback:function(b){a=$(Builder.node("div",{id:"topbar_user_information"})),inited=!0;var c=Builder.node("div",{},[Builder.node("label",_LOC("umCkwYsIIA","Username:")),Builder.node("span",b.userinfo.myself.username),Builder.node("br"),Builder.node("label",_LOC("ZIGpQodolB","IP:")),Builder.node("span",b.userinfo.myself.address)]),d=[];a.appendChild(c),b.userinfo.logged_in_users&&b.userinfo.logged_in_users.length&&(b.userinfo.logged_in_users.each(function(a){d.push(a.username+" ("+a.address+")")}),a.appendChild(Builder.node("div",{id:"topbar_user_information_others"},[Builder.node("strong",_LOC("tmaXEzucfz","Other logged in users:")),Builder.node("span",d.join(", "))]))),$("top").appendChild(a)}})}),Event.observe(document,"mouseover",function(b){a&&b.target!==$("topbar_icon")&&(a.remove(),a=!1)})}}();core.Events.observe("ajax:html_changed",function(){var a=$("panel_top_viewers_icon");a&&init_who_is_watching()});var init_who_is_watching=function(){var a=function(a){$("panel_top_viewers_icon").setAttribute("title",a.watchers)},b=function(b){call_fid("who_is_watching",{callback:a},[])};return function(){Event.observe($("panel_top_viewers_icon"),"mouseover",b)}}(),toggle_who_is_watching=function(){var a=!1,b=function(a){var b=$("panel_top_viewers_icon");b&&(a?b.setStyle({visibility:"visible",marginRight:"5px"}):b.setStyle({visibility:"hidden",marginRight:"5px"}))};core.Events.observe("ajax:html_changed",function(){b(a)});return function(b){a=b}}(),geoip_get_countries_by_region=function(){var a=function(a){core.listMap.countries.refill(!1,{values:a.countries.values,labels:a.countries.labels}),$("LISTBOX_FOOTER_CB_SELECTALL").checked=!1,$("LISTBOX_FOOTER_CB_SELECTALLLABEL").update(_LOC("TnGLerTqGL","Select all"))};return function(b){req_send({objs:[{FID:"get_countries_by_region",region:b,callback:a}]})}}(),geoip_region_sync_countries=function(){return function(a,b){var c=core.dropdownMap[a].getValue();c!="_select"&&document.getElementsByClassName(b).each(function(a){var b=a.id.replace(/ELEMENT_/,"");core.dropdownMap[b].setValue(c,c)})}}(),time_event_recurring_indicator=function(){function p(){h=null,j=o("FORM_TABLE_definitions_time_FORM_ELEMENT_start_time"),k=o("FORM_TABLE_definitions_time_FORM_ELEMENT_end_time"),e=n(),f=e.length;if(f){l=[];for(m=0;m<f;m++)i=a.indexOf(e[m]),j>=k&&(h=i===6?config.mappings.day_names[0]:config.mappings.day_names[i+1]),l.push(config.mappings.day_names[i]+" "+j+" - "+(h||"")+" "+k);$(core.formMap[b].elements.event_indicator).update(l.join("<br />"))}else $(core.formMap[b].elements.event_indicator).update("<i>"+_LOC("muyRfARaHW","Time Event Schedule")+"</i>")}function o(a){g=$A($(a).getElementsByTagName("select"));return g[0].options[g[0].selectedIndex].value+":"+g[1].options[g[1].selectedIndex].value}function n(){return c.collect(function(a){if(a.checked)return a.value;return null}).compact()}var a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],b="TABLE_definitions_time_FORM",c=[],d=0,e=[],f=0,g=[],h,i,j,k,l,m;return function(){c=$A(core.formMap[b].elements.weekdays.getElementsByTagName("input")),d=c.length;for(m=0;m<d;m++)Event.observe($(c[m]),"change",p);g=$A($("FORM_TABLE_definitions_time_FORM_ELEMENT_start_time").getElementsByTagName("select"));for(m=0;m<g.length;m++)Event.observe($(g[m]),"change",p);g=$A($("FORM_TABLE_definitions_time_FORM_ELEMENT_end_time").getElementsByTagName("select"));for(m=0;m<g.length;m++)Event.observe($(g[m]),"change",p);p();return!0}}();(function(){var a=!1;window.generate_otp_codes=function(b,c){var d=[];c=c||10,a||(Math.seedRandom(SID),a=!0),c.times(function(){d.push(sprintf("%'06d",Math.random()*1e6))}),core.listMap[b].importOk(d)}})();var s2s_ssl_client_connection=function(){var a="FORM_TABLE_ssl_s2s_connections_FORM_ELEMENT_package_password";return function(){core.formMap.TABLE_ssl_s2s_connections_FORM.elements.connection_type.getValue()==="client_connection"&&(core.uploadMap.configuration_package.getValue().indexOf(".epc")>=0?input_activate(a):(input_deactivate(a),$(a).value=""))}}(),qrcode_show=function(){var a,b,c=new Template(_LOC("shKJrNBKSq","QRCode for __USERNAME__"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),d,e,f,g,h;return function(i){req_send({objs:[{FID:"get_node_collection",nodes:[["settings","hostname"],["settings","organization"],["auth","otp","default_timestep"]],callback:function(j){user=get_object(i.data.user),f=user.data.name+(user.data.email?" ("+user.data.email+")":""),e=base32encode(i.data.secret),algorithm=i.data.digest.toUpperCase(),d="otpauth://totp/",d+=encodeURIComponent(f+"@"+j.nodes.settings.hostname),d+="?secret="+encodeURIComponent(e),d+=algorithm!=="SHA1"?"&algorithm="+algorithm:"",d+="&issuer="+encodeURIComponent(j.nodes.settings.organization),d+="&period="+(i.data.timestep>0?i.data.timestep:j.nodes.auth.otp.default_timestep),g=Builder.node("div"),h=new QRCode(g,{text:d,width:159,height:159,correctLevel:1,codeMinVersion:9}),a=Builder.node("div",{id:"qrcodes_container"},[g,Builder.node("ul",{className:"qrcodes_text"},[g,Builder.node("li",[Builder.node("label").update(_LOC("qSssvEnVzI","Account:")),Builder.node("span").update(user.data.name+"@"+j.nodes.settings.hostname)]),Builder.node("li",[Builder.node("label").update(_LOC("EqAsbqmIqf","Secret (BASE32):")),Builder.node("span").update(e)]),Builder.node("li",[Builder.node("label").update(_LOC("uWljlhANuC","Secret (HEX):")),Builder.node("span").update(i.data.secret)])])]),b=new Window({className:"astaro",width:500,height:190,resizable:!1,draggable:!0,minimizable:!1,maximizable:!1,destroyOnClose:!0,closable:!0,title:c.evaluate({USERNAME:user.data.name})}),b.setContent(a),b.showCenter(!0)}}]})}}(),sms_client_auth=function(){return function(a){["hostname","port","username","password"].each(function(a){input_activate("ELEMENT_sms_"+a)});var b=a[core.dropdownMap.sms_name.getValue()];b.length&&b.each(function(a){input_deactivate("ELEMENT_sms_"+a)})}}(),bridge_forward_ethertypes=function(){return function(a,b){var c=core.listMap.forwarded_ethertypes.memberValues(),d=c.indexOf(b),e={values:[],labels:{}};c=c.uniq(),a==="remove"?c.splice(d,1):d===-1&&c.push(b),c.each(function(a,b){e.values.push(a),e.labels[a]=a}),core.listMap.forwarded_ethertypes.refill(null,e)}}(),interface_update_hardware=function(){return function(a){req_send({objs:[{FID:"interface_update_hardware",interface_type:a,obj_ref:core.formMap.TABLE_interfaces_FORM.req.options.obj_src?core.formMap.TABLE_interfaces_FORM.req.options.obj_ref:!1,callback:function(b){a=="bridge"?core.listMap.ports.refill(null,b.hardware):core.formMap.TABLE_interfaces_FORM.elements.hardware_eth.refill(b.hardware)}}]})}}(),was_deactivated=!1,activation_timeout,delay_input_activate=function(){return function(a,b){b==0?(window.clearTimeout(activation_timeout),activation_timeout=null):was_deactivated&&(input_deactivate(a),activation_timeout=window.setTimeout(function(){input_activate(a)},b)),was_deactivated=b==0}}(),sandstorm_manual_timer=null,_migration_timeout,_migration_error_win,migration_timeout=function(){return function(){_migration_timeout&&(window.clearTimeout(_migration_timeout),_migration_timeout=null)}}(),migration_progress=function(){_mig_states={init:_LOC("dCFPPMqtEn","Initializing"),requesting:_LOC("xYRIeOioLA","Connecting to migration service"),downloading:_LOC("rsrTgaDOAR","Downloading tools from migration service"),verifying:_LOC("jUYUZOlXlQ","Verifying downloaded package"),installing:_LOC("kflaquzdGP","Launching migration wizard")};return function(a){for(var b=0;b<3;b++)tab_fade_out("up2date_tabs",b);$("menu").hide(),migration_timeout();if($("mig_progress_state")){$("mig_progress_state").update(_mig_states[a]);if(a==="finished"){call_fid("migration_wizard_start",{},[]);for(var b=0;b<3;b++)tab_fade_in("up2date_tabs",b);$("menu").show(),core.wizard.Migration()}else _migration_timeout=window.setTimeout('call_fid("migration_agent", {migration: "'+a+'"}, [])',3e3)}}}(),migration_error_win=function(){return function(a){migration_timeout(),_migration_error_win=new Window({className:"astaro",width:275,height:130,resizable:!1,draggable:!1,minimizable:!1,maximizable:!1,destroyOnClose:!0,closeable:!0,title:_LOC("LUhOtaiqRt","Error")}),_migration_error_win.setHTMLContent(a.container);var b=Builder.node("div",{style:"height: 100%;"},[Builder.node("div",{style:"height:93px; padding:8px 0px 0px 8px; overflow:auto"},a.message),Builder.node("div",{id:"ELEMENT_toolset_error_close"},"")]);$("_migration_error_win_container").appendChild(b),button_init("ELEMENT_toolset_error_close",{label:_LOC("pRSSCNbJTQ","Close"),onclickfunc:function(){_migration_error_win.close()},icon:"core/img/icons/cancel.png",button_float:"right"}),_migration_error_win.showCenter(!0)}}(),migration_confirm_win=function(){return function(a){migration_timeout(),_migration_confirm_win=new Window({className:"astaro",width:275,height:130,resizable:!1,draggable:!1,minimizable:!1,maximizable:!1,destroyOnClose:!0,closeable:!0,title:_LOC("QWBfDLnFgz","Migration Confirm")}),_migration_confirm_win.setHTMLContent(a.container);var b=Builder.node("div",{style:"height: 100%;"},[Builder.node("div",{style:"height:95px; padding-left:5px"},a.message),Builder.node("div",{style:"height: 30px; margin-right:3px; position: relative; float:right;"},[Builder.node("div",{id:"ELEMENT_toolset_confirm_close",style:"height: 50px; position: absolute; bottom: 0px;"},""),Builder.node("div",{id:"ELEMENT_toolset_confirm_confirm",style:"height: 50px; position: absolute; bottom: 0px;"},"")])]);$("_migration_confirm_win_container").appendChild(b),button_init("ELEMENT_toolset_confirm_confirm",{label:_LOC("uSfMbyDpka","Confirm"),onclickfunc:function(){core.wizard.providers.Migration.data.next_page=1,_migration_confirm_win.close()},icon:"core/img/icons/check.png"}),button_init("ELEMENT_toolset_confirm_close",{label:_LOC("bVqpcwmmJK","Cancel"),onclickfunc:function(){_migration_confirm_win.close()},icon:"core/img/icons/cancel.png"}),_migration_confirm_win.showCenter(!0)}}(),migration_error=function(){return function(a){migration_timeout(),_error_map={EAGAIN:_LOC("JIBrBVMoKF","Unable to connect to migration service. Check your Internet connection. If connected, please try again in a few minutes."),ETIMEOUT:_LOC("nSEqSpOfTS","The operation timed out, please try again later."),EAUTH:_LOC("FjFSKOukrE","Sophos ID or password incorrect. Migration Portal rejected credentials."),ENOTREGISTERED:_LOC("QvFJUfzCCE","Sophos UTM is not registered with Migration Portal (any more)."),ENOTOOLSET:_LOC("ChEomkHQnB","No corresponding toolset found. Please contact support."),ECDNERROR:_LOC("aqDyxZUTLk","No access to CDN. Please check your DNS settings."),ESIGNERROR:_LOC("QfAWFhgrDy","Error in GPG Signature verification."),EINSTALLERROR:_LOC("WwOMBwpfaT","Error during installation of toolset package(s)."),EEXTRACTERROR:_LOC("cMOvBlBHwd","Error during extraction of the toolset package."),ENOCROSANSW:_LOC("oUQrYMzyKL","No corresponding answer from Server for Migration tab visibility.")},a.data.error=_error_map[a.result];for(var b=0;b<3;b++)tab_fade_in("up2date_tabs",b);$("menu").show(),req_send({objs:[{FID:"migration_wizard_start",error:a}]})}}(),export_log_archive=function(){function h(){a&&(window.clearTimeout(a),a=null),req_send({objs:[{FID:"logging_export_archived_keepalive",callback:function(b){a=window.setTimeout("export_log_archive.keepalive()",1e4)}}]})}function g(b){b?a=window.setTimeout("export_log_archive.update()",3e3):(window.clearTimeout(a),a=null)}function f(){g(!1),req_send({objs:[{FID:"logging_export_archived_status","export":d,callback:function(a){if(a.finished){b.setHTMLContent(c);var d=Builder.node("img",{style:"margin: 0 auto;cursor:pointer;cursor:hand;",src:"core/img/icons/download_big.png"});Event.observe(d,"click",function(){h(),window.open(a.url,"_blank")});var e=Builder.node("div",{style:"height: 100%; padding: 8px; text-align: center;"},[Builder.node("div",{style:"text-align: left; margin-bottom: 8px;"},_LOC("CcDemKJWeh","The archived log files download package has been created and is now available for download..")),Builder.node("div",{style:"text-align: left; margin-bottom: 16px;"},_LOC("TlAWKgUTfy","Please keep this window open until the download has been finished.")),Builder.node("div",{},d)]);$("export_window_content").appendChild(e)}else a.finished?$("export_window_content").appendChild(Builder.node("div",{style:"color: red;"},a.error)):g(!0)}}]})}function e(){b=new Window({className:"astaro",width:300,height:150,resizable:!1,draggable:!1,minimizable:!1,maximizable:!1,destroyOnClose:!0,closeable:!0,title:_LOC("GqXBWjlErI","Export All Archived Log Files"),closeCallback:function(){a&&(window.clearTimeout(a),a=null);return!0}}),b.setHTMLContent(c);var e=Builder.node("div",{style:"height: 100%; padding: 8px; text-align: center;"},[Builder.node("div",{style:"text-align: left; margin-bottom: 16px;"},_LOC("eKaXziETYU","Please be patient. Generating the download package may take some while.")),Builder.node("div",{className:"mig-spinner-loader"})]);$("export_window_content").appendChild(e),b.showCenter(!0),req_send({objs:[{FID:"logging_export_archived",callback:function(a){a.export&&a.export.expected_size?(d=a.export,g(!0)):$("export_window_content").appendChild(Builder.node("div",{style:"color: red;"},a.error))}}]})}var a=null,b,c='<div id="export_window_content"></div>',d;return{init:e,update:f,keepalive:h}}(),redEulaWindow,redEulaPopup=function(){return function(){req_send({objs:[{FID:"get_eula_for_red",callback:function(a){redEulaWindow=new Window({className:"astaro",width:555,height:100,closable:!1,resizable:!1,minimizable:!1,maximizable:!1,draggable:!1,title:_LOC("HxftAxjtPA","Sophos End User Terms of Use")});var b=Builder.node("div",{style:"color:red;"},""),c=new core.button({label:"Accept",icon:"core/img/icons/check.png",button_float:"right",onclickfunc:function(){document.querySelector("#eula_check").checked?req_send({objs:[{FID:"set_eula_for_red",reshow_eula:!0,callback:function(a){tab_fade_in("red_server",2),tab_fade_in("red_server",3),tab_fade_in("red_server",4),redEulaWindow.close()}}]}):b.update(_LOC("hariKHZJbx","Accept the license agreement to proceed."))}}),d=Builder.node("div",[Builder.node("input",{id:"eula_check","class":"checkbox",type:"checkbox",value:0}),Builder.node("label",{"for":"eula_check"}).update(_LOC("lUSKcqXGNG","I accept the <a target='_blank' class='inline_link' href='https://www.sophos.com/en-us/legal/sophos-end-user-terms-of-use'>Sophos End User Terms of Use</a> and acknowledge the <a target='_blank' class='inline_link' href='https://www.sophos.com/en-us/legal/sophos-group-privacy-policy'>Sophos Privacy Notice</a>."))]),e=Builder.node("div",[Builder.node("div",{style:"text-align: right; padding: 4px;"},[Builder.node("a",{href:"http://lists.astaro.com/Sophos-utm-3rd-party-license.txt",target:"_blank"},"Sophos UTM 3rd Party License")]),Builder.node("div",[Builder.node("table",{style:"width: 100%"},[Builder.node("tr",[Builder.node("td",{style:"text-align: right"},[d])])])]),Builder.node("hr"),Builder.node("table",{style:"width: 100%"},[Builder.node("td",{style:"vertical-align: middle;"},b),Builder.node("td",{style:"text-align: right;"},c.htmlElement)])]);redEulaWindow.setContent(e),redEulaWindow.showCenter(!0)}}]})}}(),backend_objects_update=!1,get_value=function(){function b(b){var c=get_object(b);a+=c.data.name+"&nbsp;"}var a="";return function(c){var d=get_object(c),e,f,g,h,i,j,k;a="";switch(d["class"]){case"aws":switch(d.type){case"region":a=d.data.code;break;default:}break;case"itfparams":return get_value_ip(d);case"service":switch(d.type){case"tcp":case"udp":case"tcpudp":e=d.data.src_low,f=d.data.dst_low,d.data.src_high!==d.data.src_low&&(e=d.data.src_low+":"+d.data.src_high),d.data.dst_high!==d.data.dst_low&&(f=d.data.dst_low+":"+d.data.dst_high),a=e+" &rarr; "+f;break;case"icmp":a=icmp_map[get_service_icmp_tc(d.ref)];break;case"icmpv6":a=icmpv6_map[get_service_icmpv6_tc(d.ref)];break;case"ip":a="IP Protocol "+d.data.proto;break;case"ah":case"esp":if(d.data.spi_high!==d.data.spi_low)return d.data.spi_low+":"+d.data.spi_high;return d.data.spi_low}break;case"network":switch(d.type){case"range":a=d.data.from+"&nbsp;&rarr;&nbsp;"+d.data.to,d.data.from6&&(a+="<br>"+d.data.from6+"&nbsp;&rarr;&nbsp;"+d.data.to6);break;case"dns_host":a=d.data.hostname,a+=" ["+get_value_ip(d)+"]";break;case"dns_group":a=d.data.hostname+" [",d.data.resolved!==0||core.ipv6!==0&&d.data.resolved6!==0?(d.data.resolved===1&&(a+=d.data.addresses[0]+" ("+d.data.addresses.length+" "+_LOC("YmfYQaEyfb","IPs total")+")"),core.ipv6&&d.data.resolved6&&(d.data.resolved===1&&(a+=" | "),a+=d.data.addresses6[0]+" ("+d.data.addresses6.length+" IPs total)")):a+=_LOC("vrRzGmOFhW","unresolved"),a+="]";break;case"aaa":d.data.resolved===1?a=d.data.addresses.length+" "+_LOC("pMJNLkOCmf","IPv4 addresses"):a=_LOC("HnEKtODdAd","unresolved");break;case"group":break;default:return get_value_ip(d)}break;case"interface":if(d.type==="group")a=get_member_names(c);else{a="0.0.0.0/0",g=get_object(d.data.primary_address);if(g&&(g.data.resolved||g.data.resolved6||g.data.type==="static"))return get_value_ip(g)}break;case"snmp":d.type==="trap"&&(h=get_object(d.data.host),a=h.data.name+"&nbsp;["+d.data.community+"]");break;case"dns":switch(d.type){case"route":a=d.data.prefix+"&nbsp;&rarr;&nbsp;",d.data.targets.each(b);break;case"axfr":a=d.data.prefix+"&nbsp;&rarr;&nbsp;",d.data.targets.each(b);break;case"mapping":a=d.data.hostname+"&nbsp;&rarr;&nbsp;",d.data.ipaddr!==""&&d.data.ipaddr!=="0.0.0.0"?(a+=d.data.ipaddr,core.ipv6&&d.data.ip6addr!==""&&d.data.ip6addr!=="0.0.0.0"&&(a+=" | "+d.data.ip6addr)):core.ipv6&&d.data.ip6addr!==""&&d.data.ip6addr!=="0.0.0.0"&&(a+=d.data.ip6addr),d.data.reverse&&(a+=" (reverse)")}break;case"route":switch(d.type){case"static":i=get_object(d.data.network),j=get_object(d.data.target),d.data.type==="itf"?a=i.data.name+" &rarr; "+_LOC("ThJdRPxhsd","Interface")+" "+j.data.name:d.data.type==="host"?a=i.data.name+" &rarr; "+_LOC("VrvVRbAIbn","Gateway")+" "+j.data.name+" ["+get_value_ip(j)+"]":a=i.data.name+" &rarr; <i>"+_LOC("TJyMqEZqsb","Blackhole")+"</i>";break;case"policy":}break;case"pim_sm":d.type==="route"&&(i=get_object(d.data.network),d.data.type==="interface"?a=i.data.name+" &rarr; "+_LOC("dvcQViwkpS","Interface")+" "+get_object(d.data["interface"]).data.name:(k=get_object(d.data.gateway),a=i.data.name+" &rarr; "+_LOC("QwhssrpApc","Gateway")+" "+k.data.name+" ["+k.data.address+"]"));break;case"aaa":d.type==="user"&&d.data.realname&&(a=d.data.realname)}return a}}(),get_icon=function(){var a="wfe/"+applicationName+"/img/icons/",b={aaa:{user:"user",group:"group"},awscli:{profile:"aws"},aws:{region:"globe-icon-utm"},ca:{signing_ca:"certificate-key",verification_ca:"certificate",host_cert:"certificate",crl:"ipsec-crl",host_key_cert:"certificate-key"},dyndns:{dflt:"dns-host"},hotspot:{portal:"hotspot_portal",voucher:"hotspot_voucher"},"interface":{group:"ethernet-group",ethernet:"ethernet",dflt:"ethernet"},ipsec:{policy:"ipsec-policy",remote_gateway:"ipsec-remote-gw"},ipsec_connection:{site_to_site:"ipsec-tunnel",roadwarrior_psk:"ipsec-tunnel",roadwarrior_ca:"ipsec-tunnel",roadwarrior_x509:"ipsec-tunnel"},itfhw:{ethernet:"ethernet-itfhw",red_server:"red",awe_network:"awe_network"},itfparams:{secondary:"ethernet-alias",dflt:"ethernet"},network:{aaa:"network-user",any:"any",dflt:"network",dns_host:"dns-host",dns_group:"dns-host",group:"network-group",host:"host",range:"network",interface_address:"ethernet",interface_network:"ethernet",interface_broadcast:"ethernet",network:"network"},service:{group:"service-group",dflt:"service"},time:{single:"time-event-1",recurring:"time-event-p"},epp:{endpoint:"endpoint",endpoints_group:"endpoints_group"},ssl_vpn:{dflt:"ipsec-tunnel"},route:{dflt:"route"},pim_sm:{dflt:"route"},http:{lsl_tag:"tag",sp_subcat:"category"},stas:{collector:"stas-collector"}},c={};return function(d){var e=$A(arguments),f="unknown",g,h="",i,j,k,l,m,n;typeof d=="object"&&(e=[]),d={obj_ref:e[0]||d.obj_ref,subkey:e[1]||d.subkey,dflt:e[2]||d.dflt,restricted:e[3]||d.restricted},d.dflt&&(f=d.dflt),g=backend_objects[d.obj_ref],d.subkey&&g.data[d.subkey]&&(g=backend_objects[g.data[d.subkey]]);if(!g){_debug("wfe/asg/js/cache.js->get_icon: could not resolve object");return!1}k=g.ref,l=g["class"],m=g.type,n=g.data,c[k]?f=c[k]:(b[l]&&(b[l][m]?f=b[l][m]:b[l].dflt&&(f=b[l].dflt)),c[k]=f);if(core.ipv6&&l==="network")if(n.address||n.address6||m==="dns_group"){i=!1,j=!1;if(n.resolved||n.address&&n.address!=="0.0.0.0")i=!0;if(n.resolved6||n.address6&&n.address6!=="::")j=!0;!d.restricted||d.restricted.ipv4&&d.restricted.ipv6?h=j||i?"_v"+(i?"4":"")+(j?"6":""):"":d.restricted.ipv4?i&&j?h="_v46g6":(i&&(h="_v4"),j&&(h="_na")):d.restricted.ipv6&&(i&&j?h+="_v46g4":(i&&(h="_na"),j&&(h="_v6")))}g.lock==="acc"&&(f=f+"-acc"),l==="aaa"&&m==="user"&&n&&!n.enabled&&(f+="_na");if(l==="awe"&&m==="device")return"core/img/"+g.data.type+".png";if(l==="awe"&&m==="local")return g.data.type=="ath9k"?"core/img/SG115w.png":"core/img/SG125w.png";if(l==="awe"&&m==="red")return"core/img/RED15w.png";if(l==="itfhw"&&m==="awe_network"&&g.data.mesh_mode==="mesh")return a+"mesh_network.png";if(l==="awe_network_device_association"&&m==="mesh_role")return a+"mesh_role_"+g.data.role+".png";if(l==="stas"&&m==="collector")return a+"host.png";return a+f+h+".png"}}(),get_vpn_id_type=function(){var a={ipv4_address:_LOC("hmaDaYUeHW","IP Address"),fqdn:_LOC("VreXVKobCk","Hostname"),user_fqdn:_LOC("aMSFjfRmjv","Email address"),der_asn1_dn:_LOC("GoIfAjiixV","Distinguished name")};return function(b){var c=get_object(b),d;if(c){d=get_object(c.data.meta);if(d)return a[d.data.vpn_id_type]}return""}}();app.DashboardSettingsWindow=function(a){this.options=a,this.anchor=$(a.anchor),Event.observe(this.anchor,"click",this.open.bind(this))},app.DashboardSettingsWindow.prototype=function(){function a(){this.popup=new core.ngPopup({name:"POPUP_dashboard_settings_form","class":"dashboard",anchor:this.anchor,update_type:"dashboard",leftSide:!0,width:300})}return{open:a}}(),app.tabifyDashboardBox=function(){function e(b,c){var e=[],f=c.length,g=0,h,i,j,k;for(;g<f;)h=c[g++],$(h).hide(),a[b]||(a[b]=h),j=$(h).down(12),i=Builder.node("li",{id:"tab_"+b+"_"+h,className:"dashboard_tab"},[j]),Event.observe(i,"click",d.curry(b,h,f)),e.push(i);$(a[b]).show();return $(Builder.node("ul",{style:"list-style:none;padding:0;margin:0;"},e))}function d(d,e,f){var g,h,i,j;e!==a[d]&&($(a[d]).hide(),i="tab_"+d+"_"+a[d],g=$(i).down(".dashboard_box_header_center"),g.hide(),j=$(i).down(".dashboard_box_header_icon img"),j&&(j.style.opacity="0.5"),g.style.width="0px",h=$(i).down(".dashboard_box_header_link"),h&&(h.hide(),h.style.width="0px"),i="tab_"+d+"_"+e,g=$(i).down(".dashboard_box_header_center"),g.show(),h=$(i).down(".dashboard_box_header_link"),h&&(h.style.width="16px",h.show()),j=$(i).down(".dashboard_box_header_icon img"),j&&(j.style.opacity="1"),g.style.width=c(b[d],f,h),$(e).show(),a[d]=e)}function c(a,b,c){return a-b*32-4-(c?16:0)+"px"}var a={},b={};return function(d){var f=[],g,h,i=0,j,k,l,m,n,o=d.name;if(d.reset)a={};else{d.active&&(a[o]=d.active),d.width&&(b[o]=d.width),h=e(o,d.tabs),h.getElementsBySelector(".dashboard_box_header_icon img").each(function(a){a.style.opacity="0.5"}),j=d.tabs.length,$(d.tabs[0]).up().insertBefore(h,$(d.tabs[0])),$(d.tabs[0]).up().insertBefore(Builder.node("div",{style:"clear:both;"}),$(d.tabs[0]));for(;i<j;)g=d.tabs[i++],m="tab_"+o+"_"+g,k=$(m).down(".dashboard_box_header_center"),k.hide(),k.style.width="0px",l=$(m).down(".dashboard_box_header_link"),l&&(l.hide(),l.style.width="0px");m="tab_"+o+"_"+a[o],k=$(m).down(".dashboard_box_header_center"),k.show(),l=$(m).down(".dashboard_box_header_link"),l&&(l.style.width="16px",l.show()),n=$(m).down(".dashboard_box_header_icon img"),n&&(n.style.opacity="1"),k.style.width=c(b[o],j,l)}}}(),app.report=Class.create(),Object.extend(app.report.prototype,core.report.prototype),app.report.prototype.addFilters=function(){var a=this;this.timeframeRanges=new core.dropdown({values:this.options.tf_values,labels:this.options.tf_labels,value:this.options.defaults.timeframeRanges,onchange:"core.reportMap['"+this.options.name+"'].changeTimeframe()",style:{width:"150px"}}),this.timeframe_start_input=domInput({padding:"2px",margin:"0px",fontSize:"12px",height:"16px",border:"1px solid #aaaaaa",backgroundColor:"white",width:"100px"},{type:"text",id:"REPORTING_timeframe_start",value:this.options.defaults.timeframeStart},{}),this.timeframe_stop_input=domInput({padding:"2px",margin:"0px",fontSize:"12px",height:"16px",border:"1px solid #aaaaaa",backgroundColor:"white",width:"100px"},{type:"text",id:"REPORTING_timeframe_stop",value:this.options.defaults.timeframeStop||this.options.defaults.timeframeStart},{});var b=new core.date.TimeframePicker({maxDate:new Date,panelLeftTitle:_LOC("YhxCzvpMih","Select From-Date"),panelRightTitle:_LOC("sfPxXlgobP","Select Until-Date"),oncomplete:function(a){var b="y-M-d",c=DateFormat.format(a.firstDay,b),d=DateFormat.format(a.lastDay,b);this.timeframe_start_input.value=c,this.timeframe_stop_input.value=d}.bind(this)}),c=function(a){Event.stop(a),b.show($("timeframe_start_div"))}.bind(this);Event.observe(this.timeframe_start_input,"click",c),Event.observe(this.timeframe_stop_input,"click",c);var d=domTableRow([domTd({height:"24px",paddingRight:"5px"},{valign:"middle"},{height:24},this.timeframeRanges.htmlElement),domTd({height:"24px"},{valign:"middle"},{height:24},domDiv({visibility:"hidden",paddingRight:"5px",position:"relative"},{id:"timeframe_start_div"},{},domTableRow([domTd({paddingRight:"5px"},{},{},domSpan({},{},{},_LOC("paRsmHSRqA","from:"))),domTd({},{},{},this.timeframe_start_input)]))),domTd({height:"24px"},{valign:"middle"},{height:24},domDiv({visibility:"hidden"},{id:"timeframe_stop_div"},{},domTableRow([domTd({paddingRight:"5px"},{},{},domSpan({},{},{},_LOC("ywZJyZIwhT","to:"))),domTd({},{},{},this.timeframe_stop_input)])))]);return d},app.report.prototype.applyFilters=function(){if(this.timeframeRanges.getValue()==="custom"){if($("REPORTING_timeframe_start").value===""){this._markAsMissing($("REPORTING_timeframe_start"),!0),alert(_LOC("lszQagzqen","You forgot to enter the start date!"));return}this._markAsMissing($("REPORTING_timeframe_start"),!1),this.options.data.reporting.timeframe.start_ymd=$("REPORTING_timeframe_start").value;if($("REPORTING_timeframe_stop").value===""){this._markAsMissing($("REPORTING_timeframe_stop"),!0),alert(_LOC("YaQgCpVfAo","You forgot to enter the end date!"));return}this._markAsMissing($("REPORTING_timeframe_stop"),!1),this.options.data.reporting.timeframe.stop_ymd=$("REPORTING_timeframe_stop").value,delete this.options.data.reporting.timeframe.custom}else this.options.data.reporting.timeframe.start_ymd="",this.options.data.reporting.timeframe.stop_ymd="",this.options.data.reporting.timeframe.custom=this.timeframeRanges.getValue()},app.report.prototype.changeTimeframe=function(){this.timeframeRanges.getValue()==="custom"?($("timeframe_start_div").style.visibility="",$("timeframe_stop_div").style.visibility=""):($("timeframe_start_div").style.visibility="hidden",$("timeframe_stop_div").style.visibility="hidden")},app.Tracker=Class.create({initialize:function(a){var b,c,d,e;this.options=Object.extend({sid:"",srcip:"",time:"",user:"",objects:{},main:{}},a||{}),this.htmlElement=Builder.node("div"),this.options.sid||(this.options.sid=this.options.sessionid),this.mainEntries=[],this.mainEntries.push(Builder.node("tr",{},[Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("ZtBmGTMjEw","Name")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("bMYoQnfDJI","Time")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("cwoPMdGOGM","Old Value")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("ERWXHyPLhs","New Value")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("SXFSeXUNdY","Comment"))])),$H(this.options.main).keys().sort(function(a,b){return this.options.main[a].unshift().time>this.options.main[b].unshift().time}.bind(this)).each(function(a){var b=0;return function(c,d){var e=0,f={key:c,value:a.options.main[c]},g=f.value.length,h;for(;e<g;e++)h=new app.Tracker.Row.Main(Object.extend({name:f.key,className:b++%2?"":"ir_table_line_gradient"},f.value[e]||{})),a.mainEntries.push(h.toHTML())}}(this)),this.mainEntries.length<=1&&this.mainEntries.push(Builder.node("tr",{},Builder.node("td",{colSpan:"5",align:"left"},_LOC("bqlEBOQtau","There is no information about changes on nodes for this session!")))),b=Builder.node("table",{className:"ir_table",width:"100%",border:"0",cellspacing:"0"},Builder.node("tbody",{},this.mainEntries)),c=Builder.node("table",{width:"100%",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"ir_table_caption_left"}),Builder.node("td",{className:"ir_table_caption_center",align:"left"},_LOC("ZVxvDyyuwM","Changes on nodes in this session")),Builder.node("td",{className:"ir_table_caption_right"})]))),this.objectEntries=[Builder.node("tr",{},[Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("NSHzAwphAZ","Action")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("ThtlNMIjPj","Name")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("viiRmfWyWj","Time")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("BRLJhIAnjU","Description")),Builder.node("td",{className:"ir_table_header",align:"left"},_LOC("eQiuUBBxVu","Comment"))])],$H(this.options.objects).keys().sort(function(a,b){return this.options.objects[a].unshift().time>this.options.objects[b].unshift().time}.bind(this)).each(function(a){var b=0;return function(c,d){var e=0,f={key:c,value:a.options.objects[c]},g=f.value.length,h;for(;e<g;e++){h=new app.Tracker.Row.Object[f.value[e].action](Object.extend({name:f.key,className:b++%2?"":"ir_table_line_gradient"},f.value[e]||{}));try{a.objectEntries.push(h.toHTML())}catch(i){_debug(i)}}}}(this)),this.objectEntries.length<=1&&this.objectEntries.push(Builder.node("tr",{},Builder.node("td",{colSpan:"6",align:"left"},_LOC("RqVXmrANqd","There is no information about changes on objects for this session!")))),d=Builder.node("table",{className:"ir_table",border:"0",cellspacing:"0",width:"100%"},Builder.node("tbody",{},this.objectEntries)),e=Builder.node("table",{width:"100%",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"ir_table_caption_left"}),Builder.node("td",{className:"ir_table_caption_center",align:"left"},_LOC("OPueYqJmBw","Changes on objects in this session")),Builder.node("td",{className:"ir_table_caption_right"})]))),this.htmlElement.appendChild(Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},[Builder.node("tr",{},Builder.node("td",{},c)),Builder.node("tr",{},Builder.node("td",{},b)),Builder.node("tr",{},Builder.node("td",{},Builder.node("img",{src:"core/img/blank1x1.gif",height:"10"}))),Builder.node("tr",{},Builder.node("td",{},e)),Builder.node("tr",{},Builder.node("td",{},d))])))},show:function(a,b,c){if(!this.window){var d=new Template(_LOC("QpgpdiFugs","Changelog for user __USERNAME__ at __TIME__"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/),e;e=d.evaluate({USERNAME:this.options.user,TIME:this.options.time}),this.window=new Window({className:"astaro",title:e,top:c,left:b,maxWidth:document.viewport.getWidth()-30,maxHeight:document.viewport.getHeight()-60,destroyOnClose:!0,closable:!0,minimizable:!1,maximizable:!1,draggable:!0,onDestroy:function(){delete app.TrackerMap[this.options.mapId]}.bind(this)}),this.window.setContent(this.htmlElement)}this.window.show(a),this.window.updateWidth(),this.window.updateHeight(),this.window.toFront()},close:function(){}}),app.Tracker.Row={},app.Tracker.Row.Object={},app.Tracker.Row.Main={},app.Tracker.Row.Object.created=Class.create({initialize:function(a){this.options=Object.extend({objname:"",time:"","class":"",type:"",name:""},a||{})},toHTML:function(){var a="";this.htmlElement=Builder.node("tr",{className:this.options.className},[Builder.node("td",{align:"left",valign:"top"},_LOC("VfjSIZxinL","Object created")),Builder.node("td",{align:"left",valign:"top"},this.options.objname||" "),Builder.node("td",{align:"left",valign:"top"},this.options.time||" "),Builder.node("td",{align:"left",valign:"top"},this.options.obj_descr||" "),Builder.node("td",{align:"left",valign:"top"},a||" ")]);return this.htmlElement}}),app.Tracker.Row.Object.changed=Class.create({initialize:function(a){this.options=Object.extend({objname:"",time:"","class":"",type:""},a||{})},toHTML:function(){var a="",b=[];this.options.attributes&&this.options.attributes.length&&(b=[],a=[],this.options.attributes.each(function(a){var c="",d=a,e=!1,f=!1,g=!1,h=!1,i,j,k="",l;typeof this.options["descr_"+a]!="undefined"&&(d=this.options["descr_"+a]),c=Builder.node("p",{},d),typeof this.options["oldattr_"+a]!="undefined"&&(e=this.options["oldattr_"+a]),typeof this.options["attr_"+a]!="undefined"&&(f=this.options["attr_"+a]);if(e&&f){try{g=e.evalJSON(),h=f.evalJSON()}catch(m){g=!1,h=!1}Object.isArray(g)&&Object.isArray(h)?(i=g.diff(h),j=h.diff(g),j.length&&(l=[],j.each(function(a){l.push(Builder.node("li",{},a))}),c.appendChild(Builder.node("p",{style:"margin:1px 0 0 6px;"},["Removed: ",Builder.node("ul",{style:"margin:0;"},l)]))),i.length&&(l=[],i.each(function(a){l.push(Builder.node("li",{},a))}),c.appendChild(Builder.node("p",{style:"margin:1px 0 0 6px;"},["Added: ",Builder.node("ul",{style:"margin:0;"},l)])))):c.appendChild(Builder.node("span",{style:"margin:1px 0 0 6px;"},[" ("+e+" => "+f+")"]))}b.push(Builder.node("p",{style:"margin:2px 0;"},c))}.bind(this)),a.push(Builder.node("p",{style:"margin:2px 0;"},[_LOC("ItxvvPYdau","Changed attributes:")].concat(b)))),this.htmlElement=Builder.node("tr",{className:this.options.className},[Builder.node("td",{align:"left",valign:"top"},_LOC("vaJwLvNAvC","Object changed")),Builder.node("td",{align:"left",valign:"top"},this.options.objname||" "),Builder.node("td",{align:"left",valign:"top"},this.options.time||" "),Builder.node("td",{align:"left",valign:"top"},this.options.obj_descr||" "),Builder.node("td",{align:"left",valign:"top"},a.length?a:" ")]);return this.htmlElement}}),app.Tracker.Row.Object.deleted=Class.create({initialize:function(a){this.options=Object.extend({objname:"",time:"","class":"",type:""},a||{})},toHTML:function(){var a="";this.htmlElement=Builder.node("tr",{className:this.options.className},[Builder.node("td",{align:"left",valign:"top"},_LOC("roZHvLQEdt","Object deleted")),Builder.node("td",{align:"left",valign:"top"},this.options.objname||" "),Builder.node("td",{align:"left",valign:"top"},this.options.time||" "),Builder.node("td",{align:"left",valign:"top"},this.options.obj_descr||" "),Builder.node("td",{align:"left",valign:"top"},a||" ")]);return this.htmlElement}}),app.Tracker.Row.Main=Class.create({initialize:function(a){this.options=Object.extend({name:"",node_descr:"",oldvalue:"",value:"",time:""},a||{});try{this.oldvalue=this.options.oldvalue.evalJSON(),this.value=this.options.value.evalJSON()}catch(b){this.oldvalue=!1,this.value=!1}this.oldvalue||(this.oldvalue=this.options.oldvalue),this.value||(this.value=this.options.value)},toHTML:function(){var a=[];if(Object.isArray(this.oldvalue)&&Object.isArray(this.value)){var b=this.value.diff($A(this.oldvalue)),c=this.oldvalue.diff($A(this.value)),d=[];b.length&&(d=[],b.each(function(a){d.push(Builder.node("p",{style:"margin:2px 0;"},[a]))}),a.push(Builder.node("p",{style:"margin:2px 0;"},[_LOC("RRYrsMQaaT","Removed:")].concat(d)))),c.length&&(d=[],c.each(function(a){d.push(Builder.node("p",{style:"margin:2px 0;"},[a]))}),a.push(Builder.node("p",{style:"margin:2px 0;"},[_LOC("vnIGjGDmNS","Added:")].concat(d))))}var e=[];Object.isArray(this.oldvalue)&&(e=this.oldvalue,this.oldvalue=[],e.each(function(a){this.oldvalue.push(Builder.node("p",{style:"margin:2px 0;"},[a]))}.bind(this))),Object.isArray(this.value)&&(e=this.value,this.value=[],e.each(function(a){this.value.push(Builder.node("p",{style:"margin:2px 0;"},[a]))}.bind(this))),this.htmlElement=Builder.node("tr",{className:this.options.className},[Builder.node("td",{align:"left",valign:"top"},this.options.node_descr||this.options.name),Builder.node("td",{align:"left",valign:"top"},this.options.time||" "),Builder.node("td",{align:"left",valign:"top"},this.oldvalue||" "),Builder.node("td",{align:"left",valign:"top"},this.value||" "),Builder.node("td",{align:"left",valign:"top"},a.length?a:" ")]);return this.htmlElement}});var myLdapDropZone=!1,myDirectoryBrowserType=!1,myDirectoryBrowserRef=!1,myDirectoryBrowserContext="",myDirectoryBrowserLinkedList=!1,myDirectoryBrowserSourceForm=!1,myDirectoryBrowserCritical=!1,myShowOption="both",myLastNodelist=[],myBrowserContexts=!1,mySelectedItems=[],myTreeDndMgr=Class.create();myTreeDndMgr.prototype=(new Rico.DragAndDrop).extend({_updateDraggableLocation:function(a){var b=this.dragElement.style;b.left=this._leftOffset(a)-Math.round(this.dragElement.offsetWidth/3)+"px",b.top=this._topOffset(a)-Math.round(this.dragElement.offsetHeight/2)+"px",b.cursor="pointer"}});var treeDndMgr=new myTreeDndMgr,treeDraggable=Class.create();treeDraggable.removeOnDrop=!1,treeDraggable.prototype=(new Rico.Draggable).extend({initialize:function(a,b){this.htmlElement=a,this.ref=b,this.selected=!1,this.htmlElement.mydraggable=this},select:function(){this.selected=!0,this.realBgColor=this.htmlElement.style.backgroundColor,this.htmlElement.style.backgroundColor="#dddddd"},deselect:function(){this.selected=!1,this.htmlElement.style.backgroundColor=this.realBgColor},getSingleObjectDragGUI:function(){var a=document.createElement("div");a.style.backgroundColor="#dddddd",a.style.border="1px solid black",a.style.whiteSpace="nowrap",a.style.zIndex=9999,a.style.padding="2px 2px 2px 2px",a.style.margin="0",a.style.minWidth=this.htmlElement.offsetWidth-10+"px",a.innerHTML=this.htmlElement.innerHTML;return a},getMultiObjectDragGUI:function(a){var b="",c;a.each(function(a,c){b+=a.htmlElement.innerHTML+"<br>"}),c=document.createElement("div"),c.style.backgroundColor="#dddddd",c.style.border="1px solid black",c.style.whiteSpace="nowrap",c.style.zIndex=9999,c.style.padding="2px 2px 2px 2px",c.style.minWidth=this.htmlElement.offsetWidth-10+"px",c.innerHTML=b;return c},getDroppedGui:function(){return this.htmlElement.innerHTML}});var treeDropzone=Class.create();treeDropzone.prototype=(new Rico.Dropzone).extend({initialize:function(a){this.htmlElement=a,this.absoluteRect=null,this.members=[],this.memberElements={},myLdapDropZone=this},activate:function(){},deactivate:function(){},showHover:function(){},hideHover:function(){},accept:function(a){var b=0,c=a.length,d;for(;b<c;b++)d=a[b],this._insertSorted(d),mySelectedItems.push(d)},canAccept:function(a){return!0},_remove:function(a,b){this.members.splice(this.members.indexOf(a),1),this.htmlElement.removeChild(this.memberElements[a]),delete this.memberElements[a]},memberList:function(){return this.members},_insertSorted:function(a){var b,c=this,d,e,f;if(this.members.length>0&&this.members.any(function(b,c){if(b==a.ref)return!0;return!1}))return!0;b=document.createElement("img"),b.style.display="block",b.src="core/img/icons/trash.png",b.style.marginRight="6px",b.style.cursor="pointer",b.onclick=function(){c._remove(a.ref,!0)},d=document.createElement("div"),d.style.marginRight="6px",d.innerHTML=a.getDroppedGui(),d.style.height="16px",e=document.createElement("div"),e.style.padding="0",e.style.margin="0",e.innerHTML="["+a.ref+"]",f=domRow([b,d,e]),f.style.margin="0",f.style.padding="2px 0px 2px 0px",this.htmlElement.appendChild(f),this.members.push(a.ref),this.memberElements[a.ref]=f,mySelectedItems.push(a)}}),app.crtAppSelector=!1,app.AppSelector=Class.create({initialize:function(a){app.crtAppSelector=this,core.tools.clearDndSelection(),this.options=Object.extend({anchor:!1,target:!1,type:"apps",categories:[],values:[],labels:{},columns:[{key:"application",label:_LOC("pzdVlODtPL","Application"),style:{textAlign:"left",verticalAlign:"top",paddingTop:"1px"},width:"*",tooltip:"_tooltip"},{key:"group",label:_LOC("dpBGNeBCoC","Category"),style:{textAlign:"left",verticalAlign:"top",paddingTop:"1px"},width:"200px"},{key:"risk",label:_LOC("bsKAxBsFzS","Risk"),style:{textAlign:"right",verticalAlign:"top",paddingTop:"1px"},width:"80px"},{key:"productivity",label:_LOC("PFtZKKfXRq","Productivity"),style:{textAlign:"right",verticalAlign:"top",paddingTop:"1px"},width:"80px"}]},a||{});var b=this.options;this.selectedValues={values:b.values,labels:b.labels,tooltips:b.tooltips||{}},this.actionValue="block",b.form&&b.formAction&&(this.actionValue=$F(b.form.elements[b.formAction])),this.resultTableApps=new app.AppSelector.Table({selected:this.selectedValues.values,checkboxes:b.type==="apps",columns:b.columns,formAction:this.actionValue}),this.resultTableApps.observe(this.addSelection.bind(this)),this.riskValue=this.actionValue==="block"?1:5,this.productivityValue=this.actionValue==="block"?5:1,b.form&&b.formRisk&&b.formProductivity&&(this.riskValue=$F(b.form.elements[b.formRisk]),this.productivityValue=$F(b.form.elements[b.formProductivity])),this.toHTML(),core.menu.addListener("click",this.close.bind(this),!0),this.doSearch({keyword:$F(this.searchBox),category:$F(this.categorySelect),risk:this.riskValue,productivity:this.productivityValue,initvalues:b.type==="apps"?b.values:[]})},toHTML:function(){function n(){this.searchTimeout&&(window.clearTimeout(this.searchTimeout),delete this.searchTimeout);var a=$F(this.categorySelect);a.length||(this.categorySelect.selectAll(),a=$F(this.categorySelect)),this.searchTimeout=window.setTimeout(this.doSearch.curry({keyword:$F(this.searchBox),category:a,risk:$F(this.riskSelect),productivity:$F(this.productivitySelect)}).bind(this),823)}function m(a,b,c){var d=b.length,e,f=0,g,h;for(f=0;f<d;f++)e=b[f],g=c?c.indexOf(e)>=0:!1,h=new Option(e.label||e,e.value||e,g,g),h.selected=g,h.defaultSelected=g,a.options[a.options.length]=h}function l(a){return Builder.node("col",{width:a==="*"?"":a})}var a,b,c,d,e,f,g,h=0,i,j,k;this.closeButton=Builder.node("img",{src:"core/img/blank1x1.gif",width:"19px","class":"FORM_close",style:"float:right;cursor:pointer;"}),Event.observe(this.closeButton,"click",this.close.bind(this)),a=Builder.node("div",{style:"float:left;width:50%;"}),$(a).update(this.options.title),this.titleBar=Builder.node("div",{className:"FORM_header"},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",style:"width:100%;line-height:21px;"},Builder.node("tbody",Builder.node("tr"),[Builder.node("td",{className:"FORM_header_left"}),Builder.node("td",{className:"FORM_header_center"},[a,this.closeButton]),Builder.node("td",{className:"FORM_header_right"})]))]),this.okButton=new core.button({name:"app_selector_ok",icon:"core/img/icons/check.png",label:_LOC("ncrZNxmlGN","Apply")}),this.okButton.htmlElement.setStyle({"float":"right"}),Event.observe(this.okButton.htmlElement,"click",this.apply.bind(this)),this.cancelButton=new core.button({name:"import_cancel",icon:"core/img/icons/cancel.png",label:_LOC("MGYtLmZLFu","Cancel")}),this.cancelButton.htmlElement.setStyle({"float":"right"}),Event.observe(this.cancelButton.htmlElement,"click",this.close.bind(this)),b=Builder.node("div",{style:"width:10px;float:right;"}),$(b).update("&nbsp;"),this.buttons=Builder.node("div",{style:"padding:2px;width:100%;text-align:right;",align:"right"},Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"padding:2px 20px 2px 10px;width:100%;"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{},[this.cancelButton.htmlElement,b,this.okButton.htmlElement])])))),c=[l(4)],d=[l(4)],e=[Builder.node("th",{className:"table_columns_header_left"})],f=this.options.columns,this.options.type==="apps"&&(g=Builder.node("input",{type:"checkbox",style:"margin:3px;"}),Event.observe(g,"click",function(){this.resultTableApps.check($F(g)==="on")}.bind(this)),e.push($(Builder.node("th",{className:"table_columns_header_center"},g)).setStyle({padding:"0"})),c.push(l(20)),d.push(l(20)),e.push(Builder.node("th",{className:"table_columns_header_divider"})),c.push(l(4)),d.push(l(4))),this.searchBox=Builder.node("input",{className:"tableStringFilter",style:"float:right;"}),Event.observe(this.searchBox,"keyup",this.onKeyUp.bind(this));if(f)for(h=0;h<f.length;h++)e.push($(Builder.node("th",{className:"table_columns_header_center"},[h===0&&this.options.type==="apps"?Builder.node("span",{style:"float:left;line-height:20px;"},f[h].label):f[h].label,h===0&&this.options.type==="apps"?this.searchBox:!1])).setStyle(f[h].style||{})),c.push(l(f[h].width)),d.push(l(f[h].width)),h<f.length-1&&(e.push(Builder.node("th",{className:"table_columns_header_divider"})),c.push(l(4)),d.push(l(4)));e.push(Builder.node("th",{className:"table_columns_header_right"})),c.push(l(4)),d.push(l(4)),c.push(Builder.node("tbody",Builder.node("tr",{},e))),i=Builder.node("table",{style:"table-layout:auto;width:744px;",cellpadding:"0",cellspacing:"0"},c),j=Builder.node("div",{style:"margin:5px 5px 0 5px;"},i),this.resultBoxAppsTable=Builder.node("div",{style:"height:300px;overflow-y:scroll;margin:0 5px 5px 5px;background-color:white;"}),this.resultBoxAppsTable.appendChild(this.resultTableApps.toHTML(d)),this.resultBoxAppsCount=Builder.node("div",{style:"padding-left:5px;"}),this.resultBoxApps=Builder.node("div",[j,this.resultBoxAppsTable,this.resultBoxAppsCount]),k=this.options.type==="categories"?this.selectedValues.values.length?this.selectedValues.values:this.options.categories:this.options.categories,this.categorySelect=Builder.node("select",{size:5,multiple:!0}),m(this.categorySelect,this.options.categories,k),this.categorySelect.selectAll=function(){var a=this.options.length;while(a--)this.options[a].selected=!0}.bind(this.categorySelect),Event.observe(this.categorySelect,"change",n.bind(this)),this.categoryBox=Builder.node("div",this.categorySelect),this.riskop=">=",this.prodop="<=",this.actionValue==="accept"&&(this.riskop="<=",this.prodop=">="),this.riskSelect=Builder.node("select"),m(this.riskSelect,[{value:1,label:"Risk "+this.riskop+" 1 (low)"},{value:2,label:"Risk "+this.riskop+" 2"},{value:3,label:"Risk "+this.riskop+" 3"},{value:4,label:"Risk "+this.riskop+" 4"},{value:5,label:"Risk "+this.riskop+" 5 (high)"}]),this.riskValue&&(this.riskSelect.value=this.riskValue),Event.observe(this.riskSelect,"change",n.bind(this)),this.riskBox=Builder.node("div",{style:"padding-top:5px;"},this.riskSelect),this.productivitySelect=Builder.node("select"),m(this.productivitySelect,[{value:1,label:"Productivity "+this.prodop+" 1 (low)"},{value:2,label:"Productivity "+this.prodop+" 2"},{value:3,label:"Productivity "+this.prodop+" 3"},{value:4,label:"Productivity "+this.prodop+" 4"},{value:5,label:"Productivity "+this.prodop+" 5 (high)"}]),this.productivityValue&&(this.productivitySelect.value=this.productivityValue),Event.observe(this.productivitySelect,"change",n.bind(this)),this.productivityBox=Builder.node("div",this.productivitySelect),this.content=Builder.node("div",{},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",style:"width:100%;margin:5px;"},Builder.node("tbody",[Builder.node("tr",[Builder.node("td",{className:"valign_top"},Builder.node("span",_LOC("IasKCgzrLq","Category:"))),Builder.node("td",{className:"valign_top"},this.categoryBox),Builder.node("td",{className:"valign_top"},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",Builder.node("tr",Builder.node("td",Builder.node("span",{style:"padding-right:5px;"},_LOC("xkbxiftmuq","Productivity:"))),Builder.node("td",this.productivityBox)),Builder.node("tr",Builder.node("td",Builder.node("span",{style:"padding-top:5px;"},_LOC("VlxiUZUecI","Risk:"))),Builder.node("td",this.riskBox))))]),this.options.type==="categories"?Builder.node("td",{className:"valign_top"},this.buttons):!1])])),this.resultBoxApps]),this.options.anchor=$("tab_content_wrap"),this.options.width=$("tab_content_wrap").getWidth(),this.htmlElement=Builder.node("div",{style:"left:"+Position.positionedOffset(this.options.anchor)[0]+"px;"+"width:"+this.options.width+"px;"+"position:absolute;"+"z-index:99;",className:"importPopup"},[this.titleBar,this.content,this.options.type==="apps"?Builder.node("div",{style:"width:760px;margin-left:5px;height:1px;border-top:1px dotted #7b7b7b;"},Builder.node("img",{src:"core/img/blank1x1.gif",height:1,width:1})):!1,this.options.type==="apps"?this.buttons:!1]),$("popup_master").appendChild(this.htmlElement),Position.clone(this.options.anchor,this.htmlElement,{setWidth:!1,setHeight:!1}),new Draggable(this.htmlElement,{handle:this.titleBar});return this.htmlElement},onKeyUp:function(a){a.keyCode===27?this.close():(this.searchTimeout&&(window.clearTimeout(this.searchTimeout),delete this.searchTimeout),this.searchTimeout=window.setTimeout(this.doSearch.curry({keyword:$F(this.searchBox),category:$F(this.categorySelect),risk:$F(this.riskSelect),productivity:$F(this.productivitySelect)}).bind(this),823))},doSearch:function(a){this.htmlElement.style.cursor="progress",a=Object.extend({keyword:!1,category:!1,risk:!1,productivity:!1,initvalues:[]},a||{});if(this.lastKeyword!==a.keyword||this.lastCategory!==a.category||this.lastRisk!==a.risk||this.lastProductivity!==a.productivity)this.lastKeyword=a.keyword,this.lastCategory=a.category,this.lastRisk=a.risk,this.lastProductivity=a.productivity,input_deactivate(this.resultBoxApps),call_fid("search_applications_and_groups",{keyword:a.keyword,category:a.category,risk:a.risk,productivity:a.productivity,riskop:this.riskop,prodop:this.prodop,initvalues:a.initvalues,callback:this.displaySearchResult.bind(this)})},displaySearchResult:function(a){this.resultTableApps.clear(),this.resultTableApps.update(a.result.apps,function(){input_activate(this.resultBoxApps),this.htmlElement.style.cursor=""}.bind(this),a.keyword),this.resultBoxAppsCount.update(a.result.apps.length+" "+_LOC("pVyXFTrYCi","Applications found"))},getSelection:function(){},addSelection:function(a){var b=this.selectedValues,c,d,e;if(Object.isArray(a)){c=a.length;while(c--)this.addSelection(a[c])}else{d=a.data,e=b.values.indexOf(d._value);if(e>=0){a.isSelected()||b.values.splice(e,1);return}b.values.push(d._value),b.labels[d._value]=d._label||d._value,b.tooltips[d._value]=d._tooltip||d._value}},apply:function(){var a=this.options,b,c;a.type==="apps"&&a.target.refill(!1,this.selectedValues),a.type==="categories"&&(Object.isArray(a.target)?a.target.each(function(a){a.refill(!1,{values:$F(this.categorySelect)})}.bind(this)):a.target.refill(!1,{values:$F(this.categorySelect)}),b=a.form.elements[a.formRisk],c=a.form.elements[a.formProductivity],b&&c&&(c.value=$F(this.productivitySelect),b.value=$F(this.riskSelect))),this.close()},close:function(){$(this.htmlElement).hide(),this.options.onclose&&this.options.onclose()}}),app.AppSelector.Table=Class.create({initialize:function(a){this.options=Object.extend({selected:[]},a||{}),this.columns={},this.rows=[],this.currentRow=-1},toHTML:function(a){this.bodyElement=Builder.node("tbody"),a.push(this.bodyElement),this.htmlElement=Builder.node("table",{style:"width:100%;",cellpadding:"0",cellspacing:"0"},a);return this.htmlElement},check:function(a){var b=this._checkOne.bind(this),c,d;for(c=0,d=this.rows.length;c<d;c++)window.setTimeout(b.curry(c,a),c)},_checkOne:function(a,b){this.rows[a].select(!0,b)},update:function(a,b,c){var d,e,f;this.reset(!0);if(Object.isArray(a)){d=this._updateOne.bind(this);for(e=0,f=a.length;e<f;e++)window.setTimeout(d.curry(a[e],e,c),e);window.setTimeout(b,e)}},_updateOne:function(a,b,c){var d=this.options,e=app.AppSelector.Table.Row,f=new e(d.columns,a,!!(b%2),d.checkboxes,c,d.formAction);d.selected.indexOf(a._value)>=0&&f.select(),f.observe(this.notify.bind(this)),this.rows.push(f),this.bodyElement.appendChild(f.toHTML())},clear:function(){this.htmlElement.removeChild(this.bodyElement),this.bodyElement=Builder.node("tbody",{},[]),this.htmlElement.appendChild(this.bodyElement)},reset:function(a){var b=this.rows.length;this.rows=[],a&&(this.currentRow=-1)},markCurrentRow:function(a){this.rows[this.currentRow]&&(this.rows[this.currentRow].mark(a),this.rows[this.currentRow].current(!0))},getSelectedItems:function(){return this.rows.findAll(function(a){return a.isSelected()})},observe:function(a){this.callback=a},notify:function(a){this.callback(a)}}),app.AppSelector.Table.Row=Class.create({initialize:function(a,b,c,d,e,f){this.columns=a,this.keyword=e||!1,this.data=b,this.actionValue=f,this.disabled=!1,this.selected=!1,this.callback=Prototype.emptyFunction,this.className="ng_rep_table_row_"+(c?"odd":"even"),d&&(this.data.blockable!==1&&this.actionValue==="block"?(this.disabled=!0,this.checkbox=Builder.node("div")):this.checkbox=Builder.node("input",{type:"checkbox",style:"margin:3px;"}))},toHTML:function(a){function n(a,b,c){var d=Event.findElement(c,"td");if(d.helptext)d.removeChild(d.helptext),delete d.helptext;else{if(b&&b.length>1)while(a.match(f))a=a.replace(f,"<b>"+RegExp.$1+"</b>");d.helptext=Builder.node("div",{style:"background-color: white;margin: 5px;padding: 5px;border: 1px dashed black;"}).update(a),d.appendChild(d.helptext)}Event.stop(c)}var b=[Builder.node("td")],c=this.htmlElement,d=this.checkbox,e,f,g,h,i,j,k,l,m;this.checkbox&&(b.push($(Builder.node("td",this.checkbox)).setStyle({width:"20px",verticalAlign:"top"})),b.push(Builder.node("td",{className:"table_columns_row_divider"}))),e=Builder.node("img",{src:"core/img/icons/info.png",style:"cursor:pointer;",align:"right"}),f=new RegExp("("+this.keyword+")(?!</b>)","i");for(g=0,h=this.columns.length;g<h;g++){i=this.columns[g],j=this.data[i.key],k=$(Builder.node("span")),l=[k];if(i.tooltip){if(this.keyword&&this.keyword.length>1)while(j.match(f))j=j.replace(f,"<b>"+RegExp.$1+"</b>");l.push(e),Event.observe(e,"click",n.curry(this.data[i.tooltip]||"",this.keyword))}k.update(j),b.push($(Builder.node("td",{},l)).setStyle(i.style||{})),g<h-1&&b.push(Builder.node("td",{className:"table_columns_row_divider"}))}b.push(Builder.node("td")),c=$(Builder.node("tr",{className:this.className},b)),d&&(m=this.select.bind(this),this.disabled||(Event.observe(c,"click",m),Event.observe(d,"click",m)));return c},observe:function(a){this.callback=a},notify:function(){typeof this.callback=="function"&&this.callback(this)},mark:function(a){this.disabled||(this.checkbox.checked=!this.checkbox.checked)},select:function(a,b,c){var d=this.checkbox;this.disabled||(a!==!0?d.checked=!d.checked:d.checked=b,this.selected=!!d.checked,this.notify())},isSelected:function(){return this.selected}}),app.AppBlockShaper=function(a){this.element=a.element,this.mark=a.mark,this.afcActive=a.afc==="active",this.state=0,Event.observe(this.element,"mouseover",this.showWindow.bind(this))},app.AppBlockShaper.prototype=function(){function q(a){b.update(),a==="1"||a===1?e.show():e.hide(),this.mark&&this.mark!=="0"?(d.show(),f.show()):(d.hide(),f.hide())}function p(a){h||($("popup_master").appendChild(g),Event.observe(window,"mouseover",o),h=!0),e.hide(),d.hide(),f.hide(),b.update(_LOC("PKursfPSlr","Please wait...")),c.update(),Position.clone(this.element.down("td",1),g,{}),i=this.mark,g.show()}function o(a){var b=$(Event.findElement(a,"tr")),c=!1;b===window.document?(b=$(Event.findElement(a,"div")),b!==g&&b!==d&&b!==e&&b!==f&&(c=!0)):b.hasClassName("application")||(c=!0),c&&($("popup_master").hasChildNodes()&&$("popup_master").removeChild(g),Event.stopObserving(window,"mouseover",o),h=!1)}function n(b){call_fid("is_application_blockable",{mark:this.mark,callback:function(c){a[this.mark]=c.is_blockable,b(a[this.mark])}.bind(this)})}function m(a,b){a!=="shape"&&a!=="throttle"||!!b.save?call_fid("application_control_"+a,{mark:i,itf:b.itf,appselector:b.appselector||"NEW",bandwidth_upper:b.bandwidth_upper,bandwidth:b.bandwidth,limit:b.limit,mode:b.mode,callback:function(a){b.callback&&b.callback(a)}}):call_fid("application_control_get_selectors",{mark:i,callback:function(c){if(a==="shape"&&!b.save)k(c.appselectors);else if(a==="throttle"&&!b.save){l(c.appselectors);return}}})}function l(a){var b,c=new core.dropdown(get_qos_interfaces()),d=j(a),e=Builder.node("input",{type:"number"}),f=new core.dropdown({values:[",","srcip","dstip","srcip,dstip"],labels:{",":_LOC("LEdKtmtTtL","Shared"),srcip:_LOC("EcnBFUUaVo","each source address"),dstip:_LOC("BWMwwUOntS","each destination address"),"srcip,dstip":_LOC("tzBVnZSWBe","each source/destination")},value:","}),g=new core.button({label:_LOC("wSVPhTbmbr","Save"),icon:"core/img/icons/check.png",button_float:"right",onclickfunc:function(){m("throttle",{itf:c.getValue(),save:!0,limit:$F(e),mode:f.getValue(),appselector:d?d.getValue():"NEW",callback:function(a){a.success&&b.close(),a.error&&i.update(a.error[0].text)}})}}),h=new core.button({label:_LOC("jJRrkwprBy","Cancel"),icon:"core/img/icons/cancel.png",button_float:"right",onclickfunc:function(){b.close()}}),i=Builder.node("span"),k;b=new Window({className:"astaro",width:350,height:150,title:_LOC("znifhfnewQ","Create Throttling Rule")}),k=$(Builder.node("div",{},[Builder.node("table",{},Builder.node("tbody",[d?Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("axCaGgJTKB","Use Application Selector"))),Builder.node("td",d.htmlElement)]):"",Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("twIqWXcsne","Interface"))),Builder.node("td",c.htmlElement)]),Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("PdiQnNboOk","Limit (kbit/s):"))),Builder.node("td",e)]),Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("UFgloklygv","Limit"))),Builder.node("td",f.htmlElement)])])),h.htmlElement,g.htmlElement,Builder.node("div",{style:"color:red;background-image:url(core/img/icons/warning.png);background-repeat:no-repeat;padding-left:30px;width:200px;"},i)])),b.setContent(k),b.showCenter(!0)}function k(a){var b=get_qos_interfaces(),c=new core.dropdown(b),d=j(a),e=new Window({className:"astaro",width:360,height:150,title:_LOC("snnEDySASz","Create Shaping Rule")}),f=new core.button({label:_LOC("DFYPhxfQbG","Save"),icon:"core/img/icons/check.png",button_float:"right",onclickfunc:function(){m("shape",{itf:c.getValue(),appselector:d?d.getValue():"NEW",bandwidth_upper:$F(h),bandwidth:$F(i),save:!0,callback:function(a){a.success&&e.close(),a.error&&k.update(a.error[0].text)}})}}),g=new core.button({label:_LOC("smTpLGDPGw","Cancel"),icon:"core/img/icons/cancel.png",button_float:"right",onclickfunc:function(){e.close()}}),h=Builder.node("input",{type:"number"}),i=Builder.node("input",{type:"number"}),k=Builder.node("span"),l=$(Builder.node("div",{},[Builder.node("table",{},Builder.node("tbody",[d?Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("sVpWUQCnne","Use Application Selector"))),Builder.node("td",d.htmlElement)]):"",Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("eJziBFWULd","Interface"))),Builder.node("td",c.htmlElement)]),Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("VtUOzFgXFe","Guaranteed Bandwidth (kbit/s):"))),Builder.node("td",i)]),Builder.node("tr",[Builder.node("td",Builder.node("span",_LOC("ghtBGmvmlN","Maximum bandwidth (kbit/s):"))),Builder.node("td",h)])])),g.htmlElement,f.htmlElement,Builder.node("div",{style:"color:red;background-image:url(core/img/icons/warning.png);background-repeat:no-repeat;padding-left:30px;width:200px;"},k)]));e.setContent(l),e.showCenter(!0)}function j(a){var b=a.length,c=["NEW"],d={NEW:_LOC("DnvvdSCQTV","Create new Application Selector")},e=!1,f;if(Object.isArray(a)&&b){while(b--)f=a[b],c.push(f.ref),d[f.ref]=f.data.name;e=new core.dropdown({values:c,labels:d,value:"NEW"})}return e}var a={},b=Builder.node("span",_LOC("HcCipUsKrB","Please wait...")),c=Builder.node("span",{style:"float:right;background-color:white;"},""),d=Builder.node("div",{className:"action_button action_shape",style:"float:right;margin: 0 5px;cursor:pointer;"},[Builder.node("img",{src:"wfe/asg/img/flow_monitor/fm-icon-shape.png",align:"left",title:_LOC("OkbFVdvgLJ","Shape")})]),e=Builder.node("div",{className:"action_button action_block",style:"float:right;margin: 0 5px;cursor:pointer;"},[Builder.node("img",{src:"wfe/asg/img/flow_monitor/fm-icon-block.png",align:"left",title:_LOC("SExqIyTobo","Block")})]),f=Builder.node("div",{className:"action_button action_throttle",style:"float:right;margin: 0 5px;cursor:pointer;"},[Builder.node("img",{src:"wfe/asg/img/flow_monitor/fm-icon-throttle.png",align:"left",title:_LOC("pSEbcPDzeU","Throttle")})]),g=$(Builder.node("div",{style:"width:200px;position:absolute;"},[b,f,e,d,c])),h=!1,i=!1;g.hide(),Event.observe(d,"click",m.curry("shape")),Event.observe(f,"click",m.curry("throttle")),Event.observe(e,"click",m.curry("block",{callback:function(a){a.success&&(c.update(a.success),c.style.color="green"),a.error&&(c.update(a.error[0].text),c.style.color="red")}}));return{isMarkBlockable:function(b){var c=config.mappings.mark_to_application;this.afcActive?typeof a[this.mark]=="undefined"?c&&c[this.mark]?(a[this.mark]=c[this.mark].blockable,b(a[this.mark])):n.apply(this,[b]):b(a[this.mark]):b(!1)},showWindow:function(){p.apply(this),this.isMarkBlockable(q.bind(this))},hideWindow:function(a){g.hide()}}}(),core.Events.observe("ajax:html_changed",function(){document.getElementsByClassName("application").each(function(a){var b=$(a),c=new app.AppBlockShaper({element:b,mark:b.dataset?b.dataset.mark:b.getAttribute("data-mark"),afc:b.dataset?b.dataset.afc:b.getAttribute("data-afc")})})});var init_u2d_progress=function(){var a=!1,b=null,c=function(){b&&(window.clearTimeout(b),b=null),e()},d=function(d){if(a)if(d.state){var e=a.win.document;e.write(d.progress),e.close(),b=window.setTimeout(c,2e3)}else reload_tab()},e=function(){try{var a={callback:"update_u2d_progress",SID:SID},b=new Ajax.Request("up2date_progress.plx",{method:"post",evalJSON:!0,postBody:Object.toJSON(a),onSuccess:function(a){a.responseJSON?response=a.responseJSON:response=a.responseText.evalJSON();try{d(response)}catch(b){_debug("Error: Up2Date Progress: "+b)}}})}catch(c){_debug("Error: Up2Data Progress: "+c)}},f=function(b){b.init?(a={win:window.open("","up2dateProgress","height=600,width=1000,resizable=yes,location=no,menubar=no,scrollbars=yes,status=no,toolbar=no")},e()):alert(_LOC("IQZxQQFxIo","Could not initialize up2date progress window."))};return function(){req_send({objs:[{FID:"u2d_init_progress",callback:f}]})}}();app.upgrade=function(){function d(c){b(),req_send({objs:[{FID:"upgrade_init",up_init_start:c,callback:function(b){b.up_init_failed?alert(b.up_init_failed):b.up_init_running?($("UPGRADE_init_progress").update(_LOC("YPsHqdBkVz","Initializing")),a=window.setTimeout("app.upgrade.upgrade_init_check('"+c+"')",3e3)):call_fid("upgrade_process",{stage:2},[])}}]})}function c(){b(),req_send({objs:[{FID:"upgrade_progress",stage:4,callback:function(b){var c={1:_LOC("hBHZTsoHRW","Could not connect to the FTP server."),2:_LOC("dvtytPoNhz","Upgrade package could not be downloaded."),3:_LOC("SKFambkjII","MD5 checksum could not be downloaded."),4:_LOC("tKxrVwGjzt","MD5 checksum mismatch.")};if(parseFloat(b.progress.error,10))alert(_LOC("AIQnNHxxnx","Upgrade failed:")+c[b.progress.error]),req_send({objs:[{FID:"upgrade",target:"TABSET_up2date_tabs_CONTENT",callback:null,opts:!1}]});else if(b.progress.stage==5)call_fid("upgrade_process",{stage:5},[]);else{var d=Builder.node("table",{id:"UPGRADE_download_progress_TABLE"},[Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{colspan:2},b.progress.sub_name)]),b.progress.sub_stage==2?Builder.node("tr",{},[Builder.node("td",{colspan:2},[Builder.node("div",{id:"progress_wrap"},[Builder.node("div",{id:"progress_bar",style:"width: "+b.progress.percent+"%"},""),Builder.node("span",{},b.progress.percent+"%")])])]):!1,Builder.node("tr",{},[Builder.node("td",{},"Time elapsed: "+(b.progress.elapsed?b.progress.elapsed:"00:00:00")),b.progress.sub_stage==2?Builder.node("td",{style:"text-align: right;"},b.progress.size+" of "+b.progress.download):!1])])]);$("UPGRADE_download_progress_TABLE")&&$("UPGRADE_download_progress_TABLE").remove(),$("UPGRADE_download_progress").appendChild(d),a=window.setTimeout(app.upgrade.upgrade_get_progress,3e3)}}}]})}function b(){a&&(window.clearTimeout(a),a=null)}var a;return{upgrade_get_progress:c,upgrade_init_check:d}}(),app.GlobalLivelog=!0,app.Livelog=function(){var a,b,c=!1,d,e=!1,f=!1,g=!1,h=!1,i,j,k,l,m,n,o,p;i=function(b,c){$(b).setAttribute("title",_LOC("dNJorMYDMA","Open live log:")+" "+a.labels[c||d]||c||d)},j=function(a){window.clearTimeout(e),e=!1},k=function(a){Event.findElement(a,"ul")!==b&&(j(),open_logfile_live(d))},l=function(a){c||Event.findElement(a,"ul")!==b&&(j(),open_logfile_live(d))},m=function(b){d=b||a.value,i(a.container),h=!0},n=function(){var e,f=[],j=a.logs.length,k=0,l,n=function(a){b.hide(),c=!1,m(a),open_logfile_live(d)};if(!b||h){b&&$(a.container).removeChild(b);for(;k<j;)l=a.logs[k++],e=Builder.node("li",{},(a.labels[l]||l)+(l===d?" *":"")),i(e,l),Event.observe(e,"click",n.curry(l)),f.push(e);b=$(Builder.node("ul",{},f)),$(a.container).appendChild(b),h=!1}b.show(),c=!0,g||(core.menu.addListener("click",p),g=!0)},o=function(){e=window.setTimeout(n,1e3)},p=function(a){c&&b&&typeof b.hide=="function"&&(b.hide(),c=!1)};return core.tools.isTouchDevice()?{init:function(b){f||(a=Object.extend({container:!1,logs:[],labels:{},value:"http"},b||{}),d=a.value,i(a.container),Event.observe($(a.container),"mouseup",l),Event.observe($(a.container),"touchstart",o),Event.observe($(a.container),"touchend",j),Event.observe(window,"click",p),f=!0)},setCurrentLiveLog:m}:{init:function(b){f||(a=Object.extend({container:!1,logs:[],labels:{},value:"http"},b||{}),d=a.value,i(a.container),Event.observe($(a.container),"mouseup",k),Event.observe($(a.container),"mouseover",o),Event.observe($(a.container),"mouseout",j),Event.observe(window,"click",p),f=!0)},setCurrentLiveLog:m}}();var dataProtectionCCLFilter=function(){var b="";return{nl2br:function(a){return a.replace(/\n/g,"<br />").replace(/\|n/g,"<br />")},isNewForm:function(){if(b!=$("TABLE_smtp_profiles_SIDEBAR").firstChild.id){b=$("TABLE_smtp_profiles_SIDEBAR").firstChild.id;return!0}return!1},PreInitFormWrapper:function(a,b,c,d){var e=$(a),f=$(b),g=e.parentNode,h=g.childNodes,i,j,k,l=[],m=0,n=h.length;i=h[0];while(i.id!==e.id&&m<n)m++,i=h[m];m++,i=h[m],e.innerHTML="",j=Builder.node("table",{style:"position:static;width:330px;",id:"FORM_TABLE_smpt_profiles_FORM_TABLE_container_box_for_ccls"}),k=Builder.node("td",{style:"position: static; width: 330px;",colspan:4,id:c},j);while(m<n&&i&&i.id!==f.id)l.push(i),m++,i=h[m];for(m=0,n=l.length;m<n;m++)j.appendChild(l[m]);e.appendChild(k),d&&(descDiv=Builder.node("td",{style:"position:static;width:330px;",colspan:4},Builder.node("div",{style:"border:none;border-top:1px dotted gray;width:100%;margin-top:7px;overflow:auto;text-align:left;",id:d})),f.innerHTML="",f.appendChild(descDiv));return e}}}();typeof asg=="undefined"&&(asg={}),typeof asg.smtp=="undefined"&&(asg.smtp={},asg.smtp.untainted_get_object=get_object),asg.smtp.minitable_ex_serializator=Class.create({_FAKEAUTOID:0,serializationList:["ref","autoname","class","type","hidden","lock","nodel"],objFields:["data"],serialize_object:function(a){var b="";b="#"+this._FAKEAUTOID++;for(var c=0;c<this.serializationList.length;c++){var d=this.serializationList[c];typeof a[d]!="undefined"?b+="#"+encodeURIComponent(a[d]):b+="#"}for(var c=0;c<this.objFields.length;c++){var d=this.objFields[c],e=JSON.stringify(a[d]);typeof a[d]!="undefined"?b+="#"+encodeURIComponent(e):b+="#"}return b},deserialize_object:function(a){var b={},c=[],d=0,e=this.serializationList.length+2,f=e+this.objFields.length;if(a.charAt(0)!=="#")return-1;c=a.split("#");for(d=2;d<e;d++){var g=this.serializationList[d-2];b[g]=decodeURIComponent(c[d])}for(;d<f;d++){var g=this.objFields[d-e],h=decodeURIComponent(c[d]);b[g]=h.evalJSON()}if(!b.ref||b.ref==="")b.ref=a;return b}}),typeof asg.smtp.serial!="object"&&(asg.smtp.serial=new asg.smtp.minitable_ex_serializator),asg.smtp.minitable_ex=Class.create(core.minitable,{formDrawn:!1,get_object:function(a){var b=asg.smtp.serial,c;a.charAt(0)==="#"?c=asg.smtp.serial.deserialize_object(a):c=asg.smtp.untainted_get_object(a);return c},fwrapp_getobject:function(a){var b=$A(arguments[1]),c=$A(b).splice(1,b.length);get_object=this.get_object,ret=a.apply(this,c),get_object=asg.smtp.untainted_get_object;return ret},redraw_table:function(){$(this.options.originalParent).innerHTML="",minitable_ex_init(this.options.originalParent,this.options)},initialize:function(options){var This=this;this.options=Object.extend({width:280,height:120,bgcolors:["#f7f7f7","#E4E4E7"],string_filter:!1,nodelete:!1,checkboxes:!1,checked:[],selectNewObjects:!1},options||{}),this.numItems=0,this.stringFilterString="",this.stringFilter=!1,this.options.string_filter&&(this.stringFilter=document.createElement("input"),this.stringFilter.setAttribute("type","text"),this.stringFilter.className="text",this.stringFilter.style.backgroundImage="url(core/img/icons/search.png)",this.stringFilter.style.backgroundRepeat="no-repeat",this.stringFilter.style.width="50px",this.stringFilter.style.paddingLeft="16px",this.stringFilter.onkeyup=this.setStringFilter.bind(this)),this.itemBox=domDiv({width:"100%",position:"relative",overflow:"auto",width:this.options.width+"px",height:this.options.height-23+"px"},{},{}),popup_close("POPUP_"+this.options.name),this.addIcon=!1,options.noadd||(this.addIcon=domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_addicon",title:_LOC("WZnQzkRhOU","Create new...")},{onclick:this.openPopup.bind(this)})),this.itemBox.style.border="1px solid #AAAAAA",this.itemBox.style.borderTopWidth="0px",this.htmlElement=domTableCol([domTd({},{},{},domTableRow([domTd({width:"4px",backgroundImage:"url(core/img/box/widget_left.png)"},{className:"DRAGDROP_DROPZONE_HEADER_left"},{},""),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},domSpan({color:"#333333",fontWeight:"bold"},{},{},this.options.title?this.options.title:"&nbsp;")),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x",width:"68px"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},this.stringFilter),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x",width:"16px"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},this.addIcon),domTd({width:"4px",backgroundImage:"url(core/img/box/widget_right.png)"},{className:"DRAGDROP_DROPZONE_HEADER_right"},{},"")],{width:"100%",height:"26px"})),domTd({},{},{},this.itemBox)]),this.options.value&&(this.options.obj_refs=this.options.value);var objs=[];this.options.obj_refs?this.options.obj_refs.each(function(a,b){objs.push(this.get_object(a))}):this.options.obj_src&&(objs=eval(this.options.obj_src)),objs.each(function(a,b){var c=new asg.smtp.minitable_exObjItem(this,a);c.objType=this.options.objType,this.options.checkboxes&&this.options.checked.indexOf(a.ref)>=0&&(c.checkbox.checked=!0),this.itemBox.appendChild(c.htmlElement),this.numItems++}.bind(this)),this.colorize();return this},updateItem:function(a){var b=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self"),c=this.get_object(a),d=b.detect(function(a,b){if(a.obj.ref==c.ref)return!0;return!1});if(d)d.obj.ref=a,d.update(),this.itemBox.appendChild(d.htmlElement),this.applyFilter();else{var e=new asg.smtp.minitable_exObjItem(this,c),f=e.htmlElement;this.itemBox.appendChild(f),this.options.checkboxes&&this.options.selectNewObjects&&(e.checkbox.checked=!0),this.numItems++,this.applyFilter()}},getValue:function(){var a=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self");return a.collect(function(a,b){var c=a.obj.ref;if(!this.options.checkboxes)return c.charAt(0)==="#"?asg.smtp.serial.serialize_object(a.obj):c;if(a.checkbox.checked)return c.charAt(0)==="#"?asg.smtp.serial.serialize_object(a.obj):c}.bind(this))}}),asg.smtp.minitable_exObjItem=Class.create(core.minitableObjItem,{oget_object:asg.smtp.untainted_get_object,objType:"",parentName:"",get_object:function(a){var b=asg.smtp.serial,c={};a.charAt(0)==="#"?c=asg.smtp.serial.deserialize_object(a):c=asg.smtp.untainted_get_object(a);return c},fwrapp_getobject:function(a){var b=$A(arguments[1]),c=$A(b).splice(1,b.length),d;get_object=this.get_object,d=a.apply(this,c),get_object=asg.smtp.untainted_get_object;return d},update:function($super){return this.fwrapp_getobject($super,arguments)},initalize:function($super){return this.fwrapp_getobject($super,arguments)},del:function(){var a=this.obj.ref,b=this.parent;a.charAt(0)==="#"?confirm_dialog({message:_LOC("BHmTOzFAsg","Are you sure that you want to delete the object ?"),ok_cb:function(){core.minitableMap[this.parent.options.name].deleteItem(a),tabset_update_traffic()}.bind(this)}):req_send({objs:[{FID:"obj_delete",obj_ref:this.obj.ref,callback:"object_delete_result",update_type:"minitable",update_name:this.parent.options.name}]})},edit:function(){var popup;this.obj.ref.charAt(0)==="#"?(popup={name:"POPUP_EDIT_virtual_object","class":this.obj.class,type:this.obj.type,tobj_ref:this.obj.ref,anchor:this.editButton,modal:this.parent.options.modal,help:this.parent.options.help,update_type:"minitable",update_name:this.parent.options.name,passthru:{}},options=this.parent.options):(popup={name:"POPUP_EDIT_"+this.obj.ref,obj_ref:this.obj.ref,anchor:this.editButton,modal:this.parent.options.modal,help:this.parent.options.help,update_type:"minitable",update_name:this.parent.options.name,passthru:{}},options=this.parent.options),options.passthru&&Object.extend(popup.passthru,options.passthru);if(options.dynamicPassthru)for(var key in options.dynamicPassthru)options.dynamicPassthru.hasOwnProperty(key)&&(popup.passthru[key]=eval(options.dynamicPassthru[key]));form=new asg.smtp.EditPopup(popup)}}),asg.smtp.EditPopup=Class.create(core.popup,{get_object:function(a){var b=asg.smtp.serial,c={};a.charAt(0)==="#"?c=asg.smtp.serial.deserialize_object(a):c=asg.smtp.untainted_get_object(a);return c},initialize:function(a){var b=this,c,d,e,f,g,h;this.options=a,core.tools.clearDndSelection(),this.options.type||(this.options.type="__UNSET"),this.editObj=!1,this.formReq=!1;if(this.options.obj_ref||this.options.obj_clone){c=this.get_object(this.options.obj_ref);if(!c){this.close();return!1}if(c.lock&&(c.lock!="acc"||!popup_type_whitelist[c.class]||popup_type_whitelist[c.class].indexOf(c.type)==-1)){this.close();return!1}this.options.obj_clone||(this.editObj=c),ctMap[c["class"]]&&(this.formReq=ctMap[c["class"]][c.type]||ctMap[c["class"]]["*"])}else this.options["class"]&&(this.formReq=ctMap[this.options["class"]][this.options.type]||ctMap[this.options["class"]]["*"],this.options.types&&this.options.types.length==1&&ctMap[this.options["class"]][this.options.types[0]]&&(this.formReq=ctMap[this.options["class"]][this.options.types[0]]));if(!this.formReq){alert(_LOC("nMiIZmyPph","Can't find form to add or edit this object, sorry.")),this.close();return!1}this.helpButton=domA({},{className:"OHELP_LINK",target:"help"},{},domImg({cursor:"pointer"},{src:"core/img/icons/form_help.png",width:"19px"},{})),this.closeButton=domTd({width:"19px"},{align:"right"},{},domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",width:"19px",className:"FORM_close"},{onclick:function(){b.close()}})),this.titlebar=domTd({},{align:"left",className:"FORM_header"},{},domTableRow([domTd({},{align:"left",className:"FORM_header_left"},{},""),domTd({},{align:"left",className:"FORM_header_center"},{},domTableRow([domTd({},{},{},domSpan({},{id:"popup_title"},{},this.options.title||(this.editObj?this.formReq.txt_edit:this.formReq.txt_add))),this.options.help?domTd({width:"19px"},{align:"right"},{},this.helpButton):"",this.closeButton],{width:"100%"})),domTd({},{align:"left",className:"FORM_header_right"},{},"")],{width:"100%"})),this.htmlElement=domTableCol([this.titlebar,domTd({padding:"8px",backgroundColor:"#f7f7f7"},{},{},domDiv({},{id:this.options.name+"_CONTENT"},{}))]),$(this.htmlElement).setStyle({position:"absolute",top:"0px",left:"0px",boxShadow:"0 0 7px #666666",minWidth:"260px",width:(this.options.width||260)+"px"}),$("popup_master").appendChild(this.htmlElement),Position.clone(this.options.anchor,this.htmlElement,{setWidth:!1,setHeight:!1}),this.options.leftSide?this.htmlElement.style.left=parseInt(this.htmlElement.style.left,10)-(this.options.width||260)+"px":document.viewport&&(d=document.viewport.getWidth(),f=this.options.width||260,this.options.center?(h=d/2-f/2,g=$("content_wrapper").cumulativeOffset()[1]||92,this.htmlElement.style.top=g+"px",this.htmlElement.style.left=h+"px"):(e=Position.page(this.options.anchor),d-e[0]<f&&(this.htmlElement.style.left=d-f+"px"))),this.formReq.options=this.options.passthru||{},this.formReq.passthru=this.options.passthru||{},this.formReq.options.name="FORM_"+this.options.name,this.formReq.options.update_type=this.options.update_type,this.formReq.options.update_name=this.options.update_name,this.options.browser_type&&this.options.browser_type!==""&&(this.formReq.options.browser_type=this.options.browser_type),this.options.browser_ref&&this.options.browser_ref!==""&&(this.formReq.options.browser_ref=this.options.browser_ref),this.formReq.options.types=this.options.types,this.formReq.closeJs="core.popupMap['"+this.options.name+"'].close();",this.editObj&&(this.formReq.options.obj_src='"'+this.editObj.ref+'"',this.formReq.options.obj_ref=this.editObj.ref),this.options.obj_clone&&(this.formReq.options.obj_clone='"'+c.ref+'"',this.formReq.options.obj_ref=c.ref),this.options.upload_id&&(this.formReq.options.upload_id=this.options.upload_id),this.formReq.target=this.options.name+"_CONTENT",this.formReq.options.tobj_ref=this.options.tobj_ref,req_send({objs:[this.formReq]}),core.popupMap[this.options.name]=this,this.options.modal&&WindowUtilities.disableScreen("astaro","overlay_modal_"+this.options.name,.5,"popup_master",$("popup_master")),this.htmlElement.self=this,new Draggable(this.htmlElement,{handle:this.titlebar}),this.options.help&&(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/.test(this.options.help)?update_online_help_link(this.options.help,this.options.name):this.helpButton.href=$("OHELP_TOPBAR_LINK").href),this.htmlElement.style.zIndex=++Windows.maxZIndex,core.menu.addListener("click",this.close.bind(this),!0);return this}})
