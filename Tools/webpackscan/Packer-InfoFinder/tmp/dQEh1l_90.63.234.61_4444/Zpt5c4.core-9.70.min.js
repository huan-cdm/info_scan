function datepicker_init(a,b){var c=$(a);c.observe("focus",function(a){var d=!1,e={};c.value&&c.value!=""&&(d=new Date(c.value),d&&(e.month=d.getMonth(),e.year=d.getFullYear())),e.onselect=function(a){this.input.value=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate(),this.close()},(new core.date.DatePicker(e)).show(c,b)})}function status_slider_init(a){var b=$("status_slider_container");a.container="status_slider_container",b.statusSlider=new core.status_slider(a)}function capslock_register(){new core.capslock({element_id:"ELEMENT_login_password",capslock_warn:"display_login_error"})}function fieldset_message(a,b){core.fieldsetMap||(core.fieldsetMap={}),core.fieldsetMap[a.name]?core.fieldsetMap[a.name].refresh(a):core.fieldsetMap[a.name]=new core.fieldset(a),core.fieldsetMap[a.name].messageElement.update(b)}function fieldset_apply(a){core.fieldsetMap||(core.fieldsetMap={}),core.fieldsetMap[a.name]?core.fieldsetMap[a.name].refresh(a):core.fieldsetMap[a.name]=new core.fieldset(a),core.fieldsetMap[a.name].submit(!1,a.data)}function register_feedReader(a){if(!core.feed||!core.feed.options||core.feed.options.length===0)core.feed=new core.feedReader(a)}function chart_init(a){"use strict";return new core.Chart(a)}function $$$(a){if(core.dropdownMap[a])return $(core.dropdownMap[a].htmlElement);if(core.uploadMap[a])return $(core.uploadMap[a].htmlElement);if(core.minitableMap[a])return $(core.minitableMap[a].htmlElement);if(core.buttonMap[a])return{saveButton:$(core.buttonMap[a][0].htmlElement),cancelButton:$(core.buttonMap[a][1].htmlElement),formElement:$(core.formMap[a].htmlElement)};var b=$("ELEMENT_"+a);if(b)return dndMgr.getDropZone("ELEMENT_"+a)?dndMgr.getDropZone("ELEMENT_"+a):b.htmlElement?$(b.htmlElement):b}function CP_getCalendar(){var now=new Date;if(this.type=="WINDOW")var windowref="window.opener.";else var windowref="";var result="";this.type=="WINDOW"?(result+="<HTML><HEAD><TITLE>Calendar</TITLE>"+this.getStyles()+"</HEAD><BODY MARGINWIDTH=0 MARGINHEIGHT=0 TOPMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0>\n",result+="<CENTER><TABLE WIDTH=100% BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>\n"):(result+='<TABLE CLASS="'+this.cssPrefix+'cpBorder" WIDTH=144 BORDER=1 BORDERWIDTH=1 CELLSPACING=0 CELLPADDING=0>\n',result+="<TR><TD ALIGN=CENTER>\n",result+="<CENTER>\n");if(this.displayType=="date"||this.displayType=="week-end"){this.currentDate==null&&(this.currentDate=now);if(arguments.length>0)var month=arguments[0];else var month=this.currentDate.getMonth()+1;if(arguments.length>1&&arguments[1]>0&&arguments[1]-0==arguments[1])var year=arguments[1];else var year=this.currentDate.getFullYear();var daysinmonth=[0,31,28,31,30,31,30,31,31,30,31,30,31];if(year%4===0&&year%100!==0||year%400===0)daysinmonth[2]=29;var current_month=new Date(year,month-1,1),display_year=year,display_month=month,display_date=1,weekday=current_month.getDay(),offset=0;offset=weekday>=this.weekStartDay?weekday-this.weekStartDay:7-this.weekStartDay+weekday,offset>0&&(display_month--,display_month<1&&(display_month=12,display_year--),display_date=daysinmonth[display_month]-offset+1);var next_month=month+1,next_month_year=year;next_month>12&&(next_month=1,next_month_year++);var last_month=month-1,last_month_year=year;last_month<1&&(last_month=12,last_month_year--);var date_class;this.type!="WINDOW"&&(result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>"),result+="<TR>\n";var refresh=windowref+"CP_refreshCalendar",refreshLink="javascript:"+refresh;if(this.isShowNavigationDropdowns){result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="78" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpMonthNavigation" name="cpMonth" onChange="'+refresh+"("+this.index+",this.options[this.selectedIndex].value-0,"+(year-0)+');">';for(var monthCounter=1;monthCounter<=12;monthCounter++){var selected=monthCounter==month?"SELECTED":"";result+='<option value="'+monthCounter+'" '+selected+">"+this.monthNames[monthCounter-1]+"</option>"}result+="</select></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>',result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="56" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpYearNavigation" name="cpYear" onChange="'+refresh+"("+this.index+","+month+',this.options[this.selectedIndex].value-0);">';for(var yearCounter=year-this.yearSelectStartOffset;yearCounter<=year+this.yearSelectStartOffset;yearCounter++){var selected=yearCounter==year?"SELECTED":"";result+='<option value="'+yearCounter+'" '+selected+">"+yearCounter+"</option>"}result+="</select></TD>"}else this.isShowYearNavigation?(result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+last_month+","+last_month_year+');">&lt;</A></TD>',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="58"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+"</SPAN></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+next_month+","+next_month_year+');">&gt;</A></TD>',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>',result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+"("+this.index+","+month+","+(year-1)+');">&lt;</A></TD>',this.isShowYearNavigationInput?result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><INPUT NAME="cpYear" CLASS="'+this.cssPrefix+'cpYearNavigation" SIZE="4" MAXLENGTH="4" VALUE="'+year+'" onBlur="'+refresh+"("+this.index+","+month+',this.value-0);"></TD>':result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><SPAN CLASS="'+this.cssPrefix+'cpYearNavigation">'+year+"</SPAN></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+"("+this.index+","+month+","+(year+1)+');">&gt;</A></TD>'):(result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+last_month+","+last_month_year+');">&lt;&lt;</A></TD>\n',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="100"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+" "+year+"</SPAN></TD>\n",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+next_month+","+next_month_year+');">&gt;&gt;</A></TD>\n');result+="</TR></TABLE>\n",result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=0 CELLPADDING=1 ALIGN=CENTER>\n",result+="<TR>\n";for(var j=0;j<7;j++)result+='<TD CLASS="'+this.cssPrefix+'cpDayColumnHeader" WIDTH="14%"><SPAN CLASS="'+this.cssPrefix+'cpDayColumnHeader">'+this.dayHeaders[(this.weekStartDay+j)%7]+"</TD>\n";result+="</TR>\n";for(var row=1;row<=6;row++){result+="<TR>\n";for(var col=1;col<=7;col++){var disabled=!1;if(this.disabledDatesExpression!=""){var ds=""+display_year+LZ(display_month)+LZ(display_date);eval("disabled=("+this.disabledDatesExpression+")")}var dateClass="";display_month==this.currentDate.getMonth()+1&&display_date==this.currentDate.getDate()&&display_year==this.currentDate.getFullYear()?dateClass="cpCurrentDate":display_month==month?dateClass="cpCurrentMonthDate":dateClass="cpOtherMonthDate";if(disabled||this.disabledWeekDays[col-1])result+='\t<TD CLASS="'+this.cssPrefix+dateClass+'"><SPAN CLASS="'+this.cssPrefix+dateClass+'Disabled">'+display_date+"</SPAN></TD>\n";else{var selected_date=display_date,selected_month=display_month,selected_year=display_year;if(this.displayType=="week-end"){var d=new Date(selected_year,selected_month-1,selected_date,0,0,0,0);d.setDate(d.getDate()+(7-col)),selected_year=d.getYear(),selected_year<1e3&&(selected_year+=1900),selected_month=d.getMonth()+1,selected_date=d.getDate()}result+='\t<TD CLASS="'+this.cssPrefix+dateClass+'"><A HREF="javascript:'+windowref+this.returnFunction+"("+selected_year+","+selected_month+","+selected_date+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+this.cssPrefix+dateClass+'">'+display_date+"</A></TD>\n"}display_date++,display_date>daysinmonth[display_month]&&(display_date=1,display_month++),display_month>12&&(display_month=1,display_year++)}result+="</TR>"}var current_weekday=now.getDay()-this.weekStartDay;current_weekday<0&&(current_weekday+=7),result+="<TR>\n",result+='\t<TD COLSPAN=7 ALIGN=CENTER CLASS="'+this.cssPrefix+'cpTodayText">\n';if(this.disabledDatesExpression!=""){var ds=""+now.getFullYear()+LZ(now.getMonth()+1)+LZ(now.getDate());eval("disabled=("+this.disabledDatesExpression+")")}disabled||this.disabledWeekDays[current_weekday+1]?result+='\t\t<SPAN CLASS="'+this.cssPrefix+'cpTodayTextDisabled">'+this.todayText+"</SPAN>\n":result+='\t\t<A CLASS="'+this.cssPrefix+'cpTodayText" HREF="javascript:'+windowref+this.returnFunction+"('"+now.getFullYear()+"','"+(now.getMonth()+1)+"','"+now.getDate()+"');"+windowref+"CP_hideCalendar('"+this.index+"');\">"+this.todayText+"</A>\n",result+="\t\t<BR>\n",result+="\t</TD></TR></TABLE></CENTER></TD></TR></TABLE>\n"}if(this.displayType=="month"||this.displayType=="quarter"||this.displayType=="year"){if(arguments.length>0)var year=arguments[0];else if(this.displayType=="year")var year=now.getFullYear()-this.yearSelectStartOffset;else var year=now.getFullYear();this.displayType!="year"&&this.isShowYearNavigation&&(result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>",result+="<TR>\n",result+='\t<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year-1)+');">&lt;&lt;</A></TD>\n',result+='\t<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="100">'+year+"</TD>\n",result+='\t<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year+1)+');">&gt;&gt;</A></TD>\n',result+="</TR></TABLE>\n")}if(this.displayType=="month"){result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;i<4;i++){result+="<TR>";for(var j=0;j<3;j++){var monthindex=i*3+j;result+='<TD WIDTH=33% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnMonthFunction+"("+year+","+(monthindex+1)+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">'+this.monthAbbreviations[monthindex]+"</A></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}if(this.displayType=="quarter"){result+="<BR><TABLE WIDTH=120 BORDER=1 CELLSPACING=0 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;i<2;i++){result+="<TR>";for(var j=0;j<2;j++){var quarter=i*2+j+1;result+='<TD WIDTH=50% ALIGN=CENTER><BR><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnQuarterFunction+"("+year+","+quarter+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">Q'+quarter+"</A><BR><BR></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}if(this.displayType=="year"){var yearColumnSize=4;result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>",result+="<TR>\n",result+='\t<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year-yearColumnSize*2)+');">&lt;&lt;</A></TD>\n',result+='\t<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year+yearColumnSize*2)+');">&gt;&gt;</A></TD>\n',result+="</TR></TABLE>\n",result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;i<yearColumnSize;i++){for(var j=0;j<2;j++){var currentyear=year+j*yearColumnSize+i;result+='<TD WIDTH=50% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnYearFunction+"("+currentyear+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">'+currentyear+"</A></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}this.type=="WINDOW"&&(result+="</BODY></HTML>\n");return result}function getCalendarStyles(){var a="",b="";this!=null&&typeof this.cssPrefix!="undefined"&&this.cssPrefix!=null&&this.cssPrefix!=""&&(b=this.cssPrefix),a+="<STYLE>\n",a+="."+b+"cpYearNavigation,."+b+"cpMonthNavigation { background-color:#C0C0C0; text-align:center; vertical-align:middle; text-decoration:none; color:#000000; font-weight:bold; }\n",a+="."+b+"cpDayColumnHeader, ."+b+"cpYearNavigation,."+b+"cpMonthNavigation,."+b+"cpCurrentMonthDate,."+b+"cpCurrentMonthDateDisabled,."+b+"cpOtherMonthDate,."+b+"cpOtherMonthDateDisabled,."+b+"cpCurrentDate,."+b+"cpCurrentDateDisabled,."+b+"cpTodayText,."+b+"cpTodayTextDisabled,."+b+"cpText { font-family:arial; font-size:8pt; }\n",a+="TD."+b+"cpDayColumnHeader { text-align:right; border:solid thin #C0C0C0;border-width:0px 0px 1px 0px; }\n",a+="."+b+"cpCurrentMonthDate, ."+b+"cpOtherMonthDate, ."+b+"cpCurrentDate  { text-align:right; text-decoration:none; }\n",a+="."+b+"cpCurrentMonthDateDisabled, ."+b+"cpOtherMonthDateDisabled, ."+b+"cpCurrentDateDisabled { color:#D0D0D0; text-align:right; text-decoration:line-through; }\n",a+="."+b+"cpCurrentMonthDate, .cpCurrentDate { color:#000000; }\n",a+="."+b+"cpOtherMonthDate { color:#808080; }\n",a+="TD."+b+"cpCurrentDate { color:white; background-color: #C0C0C0; border-width:1px; border:solid thin #800000; }\n",a+="TD."+b+"cpCurrentDateDisabled { border-width:1px; border:solid thin #FFAAAA; }\n",a+="TD."+b+"cpTodayText, TD."+b+"cpTodayTextDisabled { border:solid thin #C0C0C0; border-width:1px 0px 0px 0px;}\n",a+="A."+b+"cpTodayText, SPAN."+b+"cpTodayTextDisabled { height:20px; }\n",a+="A."+b+"cpTodayText { color:black; }\n",a+="."+b+"cpTodayTextDisabled { color:#D0D0D0; }\n",a+="."+b+"cpBorder { border:solid thin #808080; }\n",a+="</STYLE>\n";return a}function CP_select(a,b,c){var d=arguments.length>3?arguments[3]:null;if(!window.getDateFromFormat)alert("calendar.select: To use this method you must also include 'date.js' for date formatting");else{if(this.displayType!="date"&&this.displayType!="week-end"){alert("calendar.select: This function can only be used with displayType 'date' or 'week-end'");return}if(a.type!="text"&&a.type!="hidden"&&a.type!="textarea"){alert("calendar.select: Input object passed is not a valid form input object"),window.CP_targetInput=null;return}if(a.disabled)return;window.CP_targetInput=a,window.CP_calendarObject=this,this.currentDate=null;var e=0;d!=null?e=getDateFromFormat(d,c):a.value!=""&&(e=getDateFromFormat(a.value,c));if(d!=null||a.value!="")e==0?this.currentDate=null:this.currentDate=new Date(e);window.CP_dateFormat=c,this.showCalendar(b)}}function CP_showCalendar(a){arguments.length>1&&(arguments[1]==null||arguments[1]==""?this.currentDate=new Date:this.currentDate=new Date(parseDate(arguments[1]))),this.populate(this.getCalendar()),this.showPopup(a)}function CP_refreshCalendar(a){var b=window.popupWindowObjects[a];arguments.length>1?b.populate(b.getCalendar(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])):b.populate(b.getCalendar()),b.refresh()}function CP_hideCalendar(){arguments.length>0?window.popupWindowObjects[arguments[0]].hidePopup():this.hidePopup()}function CP_showYearNavigationInput(){this.isShowYearNavigationInput=arguments.length>0?arguments[0]:!0}function CP_showNavigationDropdowns(){this.isShowNavigationDropdowns=arguments.length>0?arguments[0]:!0}function CP_setCssPrefix(a){this.cssPrefix=a}function CP_setTodayText(a){this.todayText=a}function CP_addDisabledDates(a,b){arguments.length==1&&(b=a);if(a!=null||b!=null)this.disabledDatesExpression!=""&&(this.disabledDatesExpression+="||"),a!=null&&(a=parseDate(a),a=""+a.getFullYear()+LZ(a.getMonth()+1)+LZ(a.getDate())),b!=null&&(b=parseDate(b),b=""+b.getFullYear()+LZ(b.getMonth()+1)+LZ(b.getDate())),a==null?this.disabledDatesExpression+="(ds<="+b+")":b==null?this.disabledDatesExpression+="(ds>="+a+")":this.disabledDatesExpression+="(ds>="+a+"&&ds<="+b+")"}function CP_setDisabledWeekDays(){this.disabledWeekDays=new Object;for(var a=0;a<arguments.length;a++)this.disabledWeekDays[arguments[a]]=!0}function CP_setYearSelectStartOffset(a){this.yearSelectStartOffset=a}function CP_setDisplayType(a){if(a!="date"&&a!="week-end"&&a!="month"&&a!="quarter"&&a!="year"){alert("Invalid display type! Must be one of: date,week-end,month,quarter,year");return!1}this.displayType=a}function CP_showYearNavigation(){this.isShowYearNavigation=arguments.length>0?arguments[0]:!0}function CP_setWeekStartDay(a){this.weekStartDay=a}function CP_setDayHeaders(){for(var a=0;a<arguments.length;a++)this.dayHeaders[a]=arguments[a]}function CP_setMonthAbbreviations(){for(var a=0;a<arguments.length;a++)this.monthAbbreviations[a]=arguments[a];this.copyMonthNamesToWindow()}function CP_setMonthNames(){for(var a=0;a<arguments.length;a++)this.monthNames[a]=arguments[a];this.copyMonthNamesToWindow()}function CP_setReturnYearFunction(a){this.returnYearFunction=a}function CP_setReturnQuarterFunction(a){this.returnQuarterFunction=a}function CP_setReturnMonthFunction(a){this.returnMonthFunction=a}function CP_setReturnFunction(a){this.returnFunction=a}function CP_tmpReturnYearFunction(a){alert("Use setReturnYearFunction() to define which function will get the clicked results!\nYou clicked: year="+a)}function CP_tmpReturnQuarterFunction(a,b){alert("Use setReturnQuarterFunction() to define which function will get the clicked results!\nYou clicked: year="+a+" , quarter="+b)}function CP_tmpReturnMonthFunction(a,b){alert("Use setReturnMonthFunction() to define which function will get the clicked results!\nYou clicked: year="+a+" , month="+b)}function CP_tmpReturnFunction(a,b,c){if(window.CP_targetInput!=null){var d=new Date(a,b-1,c,0,0,0);window.CP_calendarObject!=null&&window.CP_calendarObject.copyMonthNamesToWindow(),window.CP_targetInput.value=formatDate(d,window.CP_dateFormat)}else alert("Use setReturnFunction() to define which function will get the clicked results!")}function CP_copyMonthNamesToWindow(){if(typeof window.MONTH_NAMES!="undefined"&&window.MONTH_NAMES!=null){window.MONTH_NAMES=[];for(var a=0;a<this.monthNames.length;a++)window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthNames[a];for(var a=0;a<this.monthAbbreviations.length;a++)window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthAbbreviations[a]}}function CalendarPopup(){var a;arguments.length>0?a=new PopupWindow(arguments[0]):(a=new PopupWindow,a.setSize(150,175)),a.offsetX=-152,a.offsetY=25,a.autoHide(),a.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],a.monthAbbreviations=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a.dayHeaders=["S","M","T","W","T","F","S"],a.returnFunction="CP_tmpReturnFunction",a.returnMonthFunction="CP_tmpReturnMonthFunction",a.returnQuarterFunction="CP_tmpReturnQuarterFunction",a.returnYearFunction="CP_tmpReturnYearFunction",a.weekStartDay=0,a.isShowYearNavigation=!1,a.displayType="date",a.disabledWeekDays=new Object,a.disabledDatesExpression="",a.yearSelectStartOffset=2,a.currentDate=null,a.todayText="Today",a.cssPrefix="",a.isShowNavigationDropdowns=!1,a.isShowYearNavigationInput=!1,window.CP_calendarObject=null,window.CP_targetInput=null,window.CP_dateFormat="MM/dd/yyyy",a.copyMonthNamesToWindow=CP_copyMonthNamesToWindow,a.setReturnFunction=CP_setReturnFunction,a.setReturnMonthFunction=CP_setReturnMonthFunction,a.setReturnQuarterFunction=CP_setReturnQuarterFunction,a.setReturnYearFunction=CP_setReturnYearFunction,a.setMonthNames=CP_setMonthNames,a.setMonthAbbreviations=CP_setMonthAbbreviations,a.setDayHeaders=CP_setDayHeaders,a.setWeekStartDay=CP_setWeekStartDay,a.setDisplayType=CP_setDisplayType,a.setDisabledWeekDays=CP_setDisabledWeekDays,a.addDisabledDates=CP_addDisabledDates,a.setYearSelectStartOffset=CP_setYearSelectStartOffset,a.setTodayText=CP_setTodayText,a.showYearNavigation=CP_showYearNavigation,a.showCalendar=CP_showCalendar,a.hideCalendar=CP_hideCalendar,a.getStyles=getCalendarStyles,a.refreshCalendar=CP_refreshCalendar,a.getCalendar=CP_getCalendar,a.select=CP_select,a.setCssPrefix=CP_setCssPrefix,a.showNavigationDropdowns=CP_showNavigationDropdowns,a.showYearNavigationInput=CP_showYearNavigationInput,a.copyMonthNamesToWindow();return a}function PopupWindow(){window.popupWindowIndex||(window.popupWindowIndex=0),window.popupWindowObjects||(window.popupWindowObjects=[]),window.listenerAttached||(window.listenerAttached=!0,PopupWindow_attachListener()),this.index=popupWindowIndex++,popupWindowObjects[this.index]=this,this.divName=null,this.popupWindow=null,this.width=0,this.height=0,this.populated=!1,this.visible=!1,this.autoHideEnabled=!1,this.contents="",this.url="",this.windowProperties="toolbar=no,location=no,status=no,menubar=no,scrollbars=auto,resizable,alwaysRaised,dependent,titlebar=no",arguments.length>0?(this.type="DIV",this.divName=arguments[0]):this.type="WINDOW",this.use_gebi=!1,this.use_css=!1,this.use_layers=!1,$?this.use_gebi=!0:document.all?this.use_css=!0:document.layers?this.use_layers=!0:this.type="WINDOW",this.offsetX=0,this.offsetY=0,this.getXYPosition=PopupWindow_getXYPosition,this.populate=PopupWindow_populate,this.setUrl=PopupWindow_setUrl,this.setWindowProperties=PopupWindow_setWindowProperties,this.refresh=PopupWindow_refresh,this.showPopup=PopupWindow_showPopup,this.hidePopup=PopupWindow_hidePopup,this.setSize=PopupWindow_setSize,this.isClicked=PopupWindow_isClicked,this.autoHide=PopupWindow_autoHide,this.hideIfNotClicked=PopupWindow_hideIfNotClicked}function PopupWindow_attachListener(){document.layers&&document.captureEvents(Event.MOUSEUP),window.popupWindowOldEventListener=document.onmouseup,window.popupWindowOldEventListener!==null?document.onmouseup=new Function("window.popupWindowOldEventListener(); PopupWindow_hidePopupWindows();"):document.onmouseup=PopupWindow_hidePopupWindows}function PopupWindow_hidePopupWindows(a){for(var b=0;b<popupWindowObjects.length;b++)if(popupWindowObjects[b]!==null){var c=popupWindowObjects[b];c.hideIfNotClicked(a)}}function PopupWindow_autoHide(){this.autoHideEnabled=!0}function PopupWindow_hideIfNotClicked(a){this.autoHideEnabled&&!this.isClicked(a)&&this.hidePopup()}function PopupWindow_isClicked(a){if(this.divName!==null){if(this.use_layers){var b=a.pageX,c=a.pageY,d=document.layers[this.divName];return b>d.left&&b<d.left+d.clip.width&&c>d.top&&c<d.top+d.clip.height?!0:!1}if(document.all){var d=window.event.srcElement;while(d.parentElement!==null){if(d.id==this.divName)return!0;d=d.parentElement}return!1}if(this.use_gebi&&a){var d=a.originalTarget;while(d.parentNode!==null){if(d.id==this.divName)return!0;d=d.parentNode}return!1}return!1}return!1}function PopupWindow_hidePopup(){this.divName!==null?this.use_gebi?$(this.divName).style.visibility="hidden":this.use_css?document.all[this.divName].style.visibility="hidden":this.use_layers&&(document.layers[this.divName].visibility="hidden"):this.popupWindow&&!this.popupWindow.closed&&(this.popupWindow.close(),this.popupWindow=null)}function PopupWindow_showPopup(a){this.getXYPosition(a),this.x+=this.offsetX,this.y+=this.offsetY,!this.populated&&this.contents!=""&&(this.populated=!0,this.refresh());if(this.divName!==null)this.use_gebi?($(this.divName).style.left=this.x+"px",$(this.divName).style.top=this.y+"px",$(this.divName).style.visibility="visible"):this.use_css?(document.all[this.divName].style.left=this.x,document.all[this.divName].style.top=this.y,document.all[this.divName].style.visibility="visible"):this.use_layers&&(document.layers[this.divName].left=this.x,document.layers[this.divName].top=this.y,document.layers[this.divName].visibility="visible");else{if(this.popupWindow==null||this.popupWindow.closed){this.x<0&&(this.x=0),this.y<0&&(this.y=0),screen&&screen.availHeight&&this.y+this.height>screen.availHeight&&(this.y=screen.availHeight-this.height),screen&&screen.availWidth&&this.x+this.width>screen.availWidth&&(this.x=screen.availWidth-this.width);var b=window.opera||document.layers&&!navigator.mimeTypes["*"]||navigator.vendor=="KDE"||document.childNodes&&!document.all&&!navigator.taintEnabled;this.popupWindow=window.open(b?"":"about:blank","window_"+a,this.windowProperties+",width="+this.width+",height="+this.height+",screenX="+this.x+",left="+this.x+",screenY="+this.y+",top="+this.y+"")}this.refresh()}}function PopupWindow_refresh(){if(this.divName!==null){if(this.use_gebi)$(this.divName).innerHTML=this.contents;else if(this.use_css)document.all[this.divName].innerHTML=this.contents;else if(this.use_layers){var a=document.layers[this.divName];a.document.open(),a.document.writeln(this.contents),a.document.close()}}else this.popupWindow!==null&&!this.popupWindow.closed&&(this.url!=""?this.popupWindow.location.href=this.url:(this.popupWindow.document.open(),this.popupWindow.document.writeln(this.contents),this.popupWindow.document.close()),this.popupWindow.focus())}function PopupWindow_setWindowProperties(a){this.windowProperties=a}function PopupWindow_setUrl(a){this.url=a}function PopupWindow_populate(a){this.contents=a,this.populated=!1}function PopupWindow_setSize(a,b){this.width=a,this.height=b}function PopupWindow_getXYPosition(a){var b;this.type=="WINDOW"?b=getAnchorWindowPosition(a):b=getAnchorPosition(a),this.x=b.x,this.y=b.y}function parseDate(a){var b=arguments.length==2?arguments[1]:!1;generalFormats=["y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"],monthFirst=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],dateFirst=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"];var c=["generalFormats",b?"dateFirst":"monthFirst",b?"monthFirst":"dateFirst"],d=null;for(var e=0;e<c.length;e++){var f=window[c[e]];for(var g=0;g<f.length;g++){d=getDateFromFormat(a,f[g]);if(d!=0)return new Date(d)}}return null}function getDateFromFormat(a,b){a=a+"",b=b+"";var c=0,d=0,e="",f="",g="",h,i,j=new Date,k=j.getYear(),l=j.getMonth()+1,m=1,n=j.getHours(),o=j.getMinutes(),p=j.getSeconds(),q="";while(d<b.length){e=b.charAt(d),f="";while(b.charAt(d)==e&&d<b.length)f+=b.charAt(d++);if(f=="yyyy"||f=="yy"||f=="y"){f=="yyyy"&&(h=4,i=4),f=="yy"&&(h=2,i=2),f=="y"&&(h=2,i=4),k=_getInt(a,c,h,i);if(k==null)return 0;c+=k.length,k.length==2&&(k>70?k=1900+(k-0):k=2e3+(k-0))}else if(f=="MMM"||f=="NNN"){l=0;for(var r=0;r<MONTH_NAMES.length;r++){var s=MONTH_NAMES[r];if(a.substring(c,c+s.length).toLowerCase()==s.toLowerCase())if(f=="MMM"||f=="NNN"&&r>11){l=r+1,l>12&&(l-=12),c+=s.length;break}}if(l<1||l>12)return 0}else if(f=="EE"||f=="E")for(var r=0;r<DAY_NAMES.length;r++){var t=DAY_NAMES[r];if(a.substring(c,c+t.length).toLowerCase()==t.toLowerCase()){c+=t.length;break}}else if(f=="MM"||f=="M"){l=_getInt(a,c,f.length,2);if(l==null||l<1||l>12)return 0;c+=l.length}else if(f=="dd"||f=="d"){m=_getInt(a,c,f.length,2);if(m==null||m<1||m>31)return 0;c+=m.length}else if(f=="hh"||f=="h"){n=_getInt(a,c,f.length,2);if(n==null||n<1||n>12)return 0;c+=n.length}else if(f=="HH"||f=="H"){n=_getInt(a,c,f.length,2);if(n==null||n<0||n>23)return 0;c+=n.length}else if(f=="KK"||f=="K"){n=_getInt(a,c,f.length,2);if(n==null||n<0||n>11)return 0;c+=n.length}else if(f=="kk"||f=="k"){n=_getInt(a,c,f.length,2);if(n==null||n<1||n>24)return 0;c+=n.length,n--}else if(f=="mm"||f=="m"){o=_getInt(a,c,f.length,2);if(o==null||o<0||o>59)return 0;c+=o.length}else if(f=="ss"||f=="s"){p=_getInt(a,c,f.length,2);if(p==null||p<0||p>59)return 0;c+=p.length}else if(f=="a"){if(a.substring(c,c+2).toLowerCase()=="am")q="AM";else if(a.substring(c,c+2).toLowerCase()=="pm")q="PM";else return 0;c+=2}else{if(a.substring(c,c+f.length)!=f)return 0;c+=f.length}}if(c!=a.length)return 0;if(l==2)if(k%4==0&&k%100!==0||k%400==0){if(m>29)return 0}else if(m>28)return 0;if(l==4||l==6||l==9||l==11)if(m>30)return 0;n<12&&q=="PM"?n=n-0+12:n>11&&q=="AM"&&(n-=12);var u=new Date(k,l-1,m,n,o,p);return u.getTime()}function _getInt(a,b,c,d){for(var e=d;e>=c;e--){var f=a.substring(b,b+e);if(f.length<c)return null;if(_isInteger(f))return f}return null}function _isInteger(a){var b="1234567890";for(var c=0;c<a.length;c++)if(b.indexOf(a.charAt(c))==-1)return!1;return!0}function formatDate(a,b){b=b+"";var c="",d=0,e="",f="",g=a.getYear()+"",h=a.getMonth()+1,i=a.getDate(),j=a.getDay(),k=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),n,o,p,q,r,s,t,u,v,w,x,k,y,z,A,B,C=new Object;g.length<4&&(g=""+(g-0+1900)),C.y=""+g,C.yyyy=g,C.yy=g.substring(2,4),C.M=h,C.MM=LZ(h),C.MMM=MONTH_NAMES[h-1],C.NNN=MONTH_NAMES[h+11],C.d=i,C.dd=LZ(i),C.E=DAY_NAMES[j+7],C.EE=DAY_NAMES[j],C.H=k,C.HH=LZ(k),k==0?C.h=12:k>12?C.h=k-12:C.h=k,C.hh=LZ(C.h),k>11?C.K=k-12:C.K=k,C.k=k+1,C.KK=LZ(C.K),C.kk=LZ(C.k),k>11?C.a="PM":C.a="AM",C.m=l,C.mm=LZ(l),C.s=m,C.ss=LZ(m);while(d<b.length){e=b.charAt(d),f="";while(b.charAt(d)==e&&d<b.length)f+=b.charAt(d++);C[f]!==null?c=c+C[f]:c=c+f}return c}function compareDates(a,b,c,d){var e=getDateFromFormat(a,b),f=getDateFromFormat(c,d);if(e==0||f==0)return-1;if(e>f)return 1;return 0}function isDate(a,b){var c=getDateFromFormat(a,b);if(c==0)return!1;return!0}function LZ(a){return(a<0||a>9?"":"0")+a}function AnchorPosition_getWindowOffsetTop(a){return AnchorPosition_getPageOffsetTop(a)-document.body.scrollTop}function AnchorPosition_getPageOffsetTop(a){var b=a.offsetTop;while((a=a.offsetParent)!==null)b+=a.offsetTop;return b}function AnchorPosition_getWindowOffsetLeft(a){return AnchorPosition_getPageOffsetLeft(a)-document.body.scrollLeft}function AnchorPosition_getPageOffsetLeft(a){var b=a.offsetLeft;while((a=a.offsetParent)!==null)b+=a.offsetLeft;return b}function getAnchorWindowPosition(a){var b=getAnchorPosition(a),c=0,d=0;$?isNaN(window.screenX)?(c=b.x-document.body.scrollLeft+window.screenLeft,d=b.y-document.body.scrollTop+window.screenTop):(c=b.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset,d=b.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset):document.all?(c=b.x-document.body.scrollLeft+window.screenLeft,d=b.y-document.body.scrollTop+window.screenTop):document.layers&&(c=b.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset,d=b.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset),b.x=c,b.y=d;return b}function getAnchorPosition(a){var b=!1,c=new Object,d=0,e=0,f=!1,g=!1,h=!1;$?f=!0:document.all?g=!0:document.layers&&(h=!0);if(f&&document.all)d=AnchorPosition_getPageOffsetLeft(document.all[a]),e=AnchorPosition_getPageOffsetTop(document.all[a]);else if(f){var i=$(a);d=AnchorPosition_getPageOffsetLeft(i),e=AnchorPosition_getPageOffsetTop(i)}else if(g)d=AnchorPosition_getPageOffsetLeft(document.all[a]),e=AnchorPosition_getPageOffsetTop(document.all[a]);else{if(!h){c.x=0,c.y=0;return c}var j=0;for(var k=0;k<document.anchors.length;k++)if(document.anchors[k].name==a){j=1;break}if(j==0){c.x=0,c.y=0;return c}d=document.anchors[k].x,e=document.anchors[k].y}c.x=d,c.y=e;return c}function menu_action(a,b){if(a){var c=a.helpuuid||"",d,e,f,g;update_online_help_link(c),a.area||a.tabset?(d=a.fid||0,e=b||a.caption,f=a.area||0,g=a.tabset||0,c=a.helpuuid||"",back_fid=d,back_entry=a,back_caption=b,load_panel(a.fid,e,f,g,c)):a.fid&&(back_fid=a.fid,back_entry=a,back_caption=b,load_display(a.fid,c))}}function menu_top(a){wait_popup(!1);if(a&&a.offer_wizard=="1"){core.wizard.ASG_Network();return!0}core.menu.addListener("click",function(){window.scrollTo(0,0)},!1)}function menu_load(){req_send({objs:[{FID:"menu_data",callback:"menu_top"}]}),wait_popup(!0,_LOC("WZAfijuqDZ","Please wait, organizing objects."))}function upload_run(a){var b=core.uploadMap[a],c=window.frames["upload_"+b.uploadId].document.forms[0].FILE.value,d=b.popup.formReq.options.name,e=!1,f=_LOC("DZIvqqscbk","Extension not allowed, please upload a file with extension __EXTENSIONTEXT__ !"),g=_LOC("CPqvOEiYrS","Extension not allowed, please upload a file with extensions __EXTENSIONTEXT__ !"),h,i,j,k,l;if(!b.filename&&!c){core.formMap[d].messageElement.alert(_LOC("OJkJAtqcdC","You forgot to select a file!")),core.buttonMap[d]&&core.buttonMap[d].each(function(a,b){a.enable()});return!1}if(b.options.allowedExtensions){b.options.allowedExtensions.each(function(a){e=e||c.toLowerCase().indexOf("."+a.toLowerCase())>0});if(!e){h=(new Template(b.options.allowedExtensions.length>1?g:f,/(^|.|\r|\n)(\__\s*(\w+)\s*__)/)).evaluate({EXTENSIONTEXT:b.options.allowedExtensions.join(" "+_LOC("BrTdkmiHqH","or")+" ")}),core.formMap[d].messageElement.alert(h),core.buttonMap[d]&&core.buttonMap[d].each(function(a,b){a.enable()});return!1}}core.formMap[d].messageElement.update(),i="webadmin.plx?upload=1&UID="+a,window.frames["upload_"+b.uploadId].document.forms[0].action=i,window.frames["upload_"+b.uploadId].document.forms[0].submit(),j=$("upload_progress_"+b.uploadId),k=domDiv({},{className:"UPLOAD_progress_container"},{},domDiv({},{id:"upload_bar_"+b.uploadId,className:"UPLOAD_progress_bar"},{})),l=domDiv({},{id:"upload_text_"+b.uploadId,className:"UPLOAD_progress_text"},{},domSpan({},{},{},_LOC("nFdxcnqXla","Starting upload, please wait"))),k.appendChild(l),j.appendChild(k),update_progress_request(a)}function upload_update(a,b){core.uploadMap[a].setFilename(b)}function upload_init(a,b){"use strict";var c=$(a),d=new core.upload(b);core.uploadMap[b.name]=d,c.appendChild(d.htmlElement)}function reload_tab(){!AjaxReqQueue.started,_debug("reloading tab"),cur_tab_req.objs.each(function(a,b){a.cur_tabs=cur_tabs}),req_send(cur_tab_req)}function reload_display(){cur_tab_req?reload_tab():(_debug("reloading display"),!AjaxReqQueue.started,cur_display_req.objs.each(function(a,b){a.cur_tabs=cur_tabs}),req_send(cur_display_req))}function load_tab(a,b,c,d){var e={objs:[{FID:a,target:b,opts:c,callback:d||null},{FID:"update_user_location",callback:null}]};cur_tab_req=e,req_send(e)}function load_display(a,b){var c={objs:[{FID:a,target:"display",helpuuid:b}]};cur_display_req=c,cur_tab_req=!1,req_send(c)}function load_panel(a,b,c,d,e){var f={};config&&config.appid=="acc"?f={objs:[{FID:"default_panel",area:c,tabset:d,fid:a,target:"display",caption:b,cur_tabs:cur_tabs,helpuuid:e}]}:f={objs:[{FID:"default_panel",area:c,tabset:d,target:"display",caption:b,helpuuid:e}]},a&&f.objs.push({FID:a,target:"PANEL_default_panel_CONTENT"}),cur_display_req=f,cur_tab_req=!1,req_send(f)}function reload_application(){window.setTimeout("document.location.reload()",500)}function perform_logout_cleanup(){$("navbar").innerHTML="",$("display").innerHTML="",$("display").appendChild(domDiv({},{className:"display_login"},{},domDiv({position:"absolute",left:"220px",top:"120px",color:"white",fontSize:"20px"},{},{},domSpan({},{},{},_LOC("PjDMeTKCwa","Logging off..."))))),core.openedWindows.each(function(a,b){a.close()}),core.openedWindows=[],terminate_logfiles()}function logout(){config.pendingRequests||(json_queue=[],json_current={done:!0,aborted:!0}),call_fid("logout",{},[])}function json_abort(){req_send({terminate:1},!0)}function refresh_timeout(){webadmin_timeout&&(!webadmin_timeout_on_dashboard||typeof back_fid=="undefined"||back_fid!=="dashboard")&&(webadmin_timeout_handle&&window.clearTimeout(webadmin_timeout_handle),webadmin_timeout_handle=window.setTimeout(logout,webadmin_timeout*999))}function req_send(a,b){b||(b=!1),AjaxReqQueue||(AjaxReqQueue=new Ajax.RequestQueue),a.objs[0].FID=="pending"&&config.pendingRequests&&(b=!0),AjaxReqQueue.add(a,b).start(),refresh_timeout();return!0}function call_fid(a,b,c){b||(b={}),c||(c=[]),b.elements={};var d=!0;try{c.each(function(a,c){var e=get_element(a);typeof e!="boolean"&&(b.elements[a]=e,d=!1)})}catch(e){}if(d)try{delete b.elements}catch(e){b.elements=null}var f={objs:[b]};f.objs[0].FID=a,req_send(f)}function report_update(a){core.reportMap[a.options.name].options=a.options,core.reportMap[a.options.name].update()}function report_init(a){var b=$("REPORT_"+a.name+"_CONTAINER"),c=new core.report(a);core.reportMap[a.name]=c,b.appendChild(c.htmlElement)}function minitable_init(a,b){var c=$(a),d=new core.minitable(b);core.minitableMap[b.name]=d,c.appendChild(d.htmlElement)}function iconlist(a,b){return domTableCol(a.collect(function(a,c){var d=get_object(a);if(d&&d.data.name.indexOf("REF_")!==0)return domTd({},{},{},domTableRow([domTd({paddingRight:"2px"},{},{},domImg({},{src:get_icon(d.ref)},{})),domTd({},{},{},domSpan(b?b.style:{},{},{},d.data.name))],{paddingBottom:"2px"}));return!1}))}function object_toggle_result(a){a.error&&alert(a.error[0].text);if(a.confirm){var b=[{label:_LOC("WxuSziAhLD","OK"),"default":!0,exec:function(){req_send({objs:[{FID:"obj_set",ack:a.ack,obj:a.obj,callback:object_toggle_result,update_type:a.update_type,update_name:a.update_name,toggle_field:a.toggle_field,toggle_value:a.toggle_value}]},!0)}},{label:_LOC("hGUOpzWUaB","Cancel"),exec:function(){}}];if(typeof a.confirm=="object"&&a.confirm.length){var c=[];a.confirm.each(function(a){c.push(a.text)})}this._confirmPopup=interactionPopup({open:!0,text:c.join("<br /><br />"),buttons:b})}else{if(!a.success){var d=a.toggle_field||"status",e=get_object(a.obj.ref);typeof a.toggle_value!="undefined"?e.data[d]=a.toggle_value:e.data[d]==1?e.data[d]=0:e.data[d]=1;return}tabset_update_traffic(),a.update_type=="table"?core.tableMap[a.update_name].updateItem(a.success,a.moveTo):a.update_type=="minitable"&&core.minitableMap[a.update_name].updateItem(a.success)}}function object_mass_delete_result(a){if(typeof a.error=="string")alert(a.error);else{if(Object.isArray(a.error)){alert(a.error[0].text);return}if(a.confirm&&a.confirm[0].text)var b=[{label:_LOC("udTMstZSHi","OK"),"default":!0,exec:function(){delete a.confirm,req_send({objs:[a]})}},{label:_LOC("psgexYlywX","Cancel"),exec:function(){}}],c=interactionPopup({open:!0,text:a.confirm[0].text,buttons:b});a.update_type=="table"?core.tableMap[a.update_name].deleteItem(a.success):a.update_type=="minitable"&&core.minitableMap[a.update_name].deleteItem(a.success)}}function object_delete_result(a){if(typeof a.error=="string")alert(a.error);else{if(Object.isArray(a.error)){alert(a.error[0].text);return}if(a.confirm&&a.confirm.length){var b=[],c;for(c=0;c<a.confirm.length;c++)b.push(a.confirm[c].text);confirm_dialog({message:b,ok_cb:function(){delete a.confirm,req_send({objs:[a]})}})}a.update_type=="table"&&(core.tableMap[a.update_name].deleteItem(a.success),tabset_update_traffic()),a.update_type=="minitable"&&(core.minitableMap[a.update_name].deleteItem(a.success),tabset_update_traffic()),a.update_type=="ngtable"&&core.NgTable.del(a.update_name,a.success)}}function objectUsageDomTd(a){var b=a.ref;a.class==="ca"&&a.type==="csr"&&(b=a.data.certificate);return domTd({},{},{},domDiv({borderTop:"1px dotted #999999",paddingTop:"6px",paddingBottom:"4px"},{"class":"TABLEOBJITEM_usage"},{},domTableRow([domTd({},{},{},domUsage(b))])))}function domUsageCallback(a){var b=core.usageMap[a.obj_ref];b&&a.usage_html&&(b.innerHTML=a.usage_html)}function domUsage(a){req_send({objs:[{FID:"get_object_usage",callback:"domUsageCallback",obj_ref:a}]}),core.usageMap[a]=domDiv({},{},{},domImg({},{src:"core/img/throbber_baton.gif",width:"13",height:"13"},{}));return core.usageMap[a]}function table_init(a){var b=$("TABLE_"+a.name+"_CONTAINER"),c=!1,d,e;for(d in core.tableMapOffsets)d!=a.name&&(core.tableMapOffsets[d]=0);core.tableSearchValues||(core.tableSearchValues={}),core.tableScrollOffset||(core.tableScrollOffset={}),core.tableSorting={},core.tableDisplayNum||(core.tableDisplayNum={}),core.tableDisplayNum[a.name]||(core.tableDisplayNum[a.name]=core.userPreferences.items_per_page?parseInt(core.userPreferences.items_per_page,10):25),a.numDisplay=core.tableDisplayNum[a.name],c=new core.table(a),core.tableMap[a.name]=c,b.appendChild(c.htmlElement),c.maximize(),core.tableScrollOffset[c.options.name]&&(c.scrollBox.scrollTop=core.tableScrollOffset[c.options.name]),e=c.maximize.bind(c),Event.observe(window,"resize",e),core.menu.addListener("click",function(){Event.stopObserving(window,"resize",e)},!0),core.menu.addListener("click",resetTableSearchValues,!0)}function resetTableSearchValues(){var a;core.tableSearchValues={},core.tableScrollOffset={},core.tableSorting={},core.tableDisplayNum={};for(a in core.tableMapOffsets)typeof core.tableMapOffsets[a]!="function"&&(core.tableMapOffsets[a]=0)}function list_delete_result(a){var b=a.passthru.remove_confirm;if(typeof a.error=="string")alert(a.error);else{if(Object.isArray(a.error)){alert(a.error[0].text);return}if(a.confirm&&a.confirm.length){var c=[],d;for(d=0;d<a.confirm.length;d++)c.push(a.confirm[d].text);confirm_dialog({message:c,modal:!0,ok_cb:function(){b?core.listMap[a.update_name].removeByValue(a.obj_ref):(delete a.confirm,req_send({objs:[a]}))}})}a.success&&a.update_type=="list"&&core.listMap[a.update_name].removeByValue(a.success)}}function list_init(a,b,c){function q(a){function f(a){Event.findElement(a,"img")!==c&&Event.findElement(a,"div")!==b&&Event.findElement(a,"input")!==e.down()&&($(c).up().removeChild(b),Event.stopObserving(document,"click",f))}var b=Builder.node("div",{className:"LISTBOX_menu"},a),c,e=Builder.node("div",{style:"clear:left;display:block;float:left;padding:0 2px 0 0;"},Builder.node("input",{type:"text",style:'background-image: url("core/img/icons/search.png");background-repeat: no-repeat;background-position: 1px 2px;padding-left: 16px; width: 82px;'}));b.appendChild(e),Event.observe(e,"keyup",function(a){a.keyCode===13&&d.list.filter($F(e.down())),a.keyCode===27&&($(c).up().removeChild(b),Event.stopObserving(document,"click",f))});return function(a){d.list.disabled||(c=Event.findElement(a,"img"),$(c).up().appendChild(b),Event.observe(document,"click",f))}}var d=$("ELEMENT_"+a.name),e=!1,f=!1,g=!1,h=!1,i=!1,j,k=!1,l=!1,m=!1,n=!1,o=!1,p=!1;b&&(d=b),a.width||(a.width=250),a.height||(a.height=160),d.list=new core.list(a,c),core.listMap[a.name]=d.list,a.folder&&(e=Builder.node("img",{title:_LOC("pIrEccpNsp","Browse..."),src:"core/img/blank1x1.gif",className:"LISTBOX_foldericon",id:"ELEMENT_"+a.name+"_LIST_folder_icon",style:"cursor:pointer"}),Event.observe(e,"click",d.list.doFolderAction.bindAsEventListener(d.list))),a.importer&&!a.meta&&(a.importer=!1,_debug("Missing metadata for importer, importer was disabled!")),a.importer&&(f=Builder.node("div",domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",id:"ELEMENT_"+a.name+"_LIST_import_icon",title:_LOC("cNKvuxmoxI","Import..."),className:"LISTBOX_importicon"},{})),Event.observe(f,"click",d.list.openImportPopup.bindAsEventListener(d.list))),a.special_action&&(g=Builder.node("div",domImg({cursor:"pointer"},{src:a.special_action.icon||"core/img/blank1x1.gif",id:"ELEMENT_"+a.name+"_LIST_special_action_icon",title:a.special_action.tooltip,className:a.special_action.className||"LISTBOX_specialicon","data-important":a.special_action.important},{})),Event.observe(g,"click",d.list.doSpecialAction.bindAsEventListener(d.list)),d.list.specialAction.anchor||(d.list.specialAction.anchor=g),a.special_action.important&&(p=g)),a.exporter&&(h=Builder.node("div",domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",id:"ELEMENT_"+a.name+"_LIST_export_icon",title:_LOC("YuxryTHvco","Export..."),className:"LISTBOX_exporticon"},{})),Event.observe(h,"click",d.list.openExportPopup.bindAsEventListener(d.list))),!a.nodeleteall&&!a.nodelete&&(i=Builder.node("div",domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",id:"ELEMENT_"+a.name+"_LIST_removeall_icon",title:_LOC("JgLaQLhIHP","Empty..."),className:"LISTBOX_removeallicon"},{})),Event.observe(i,"click",d.list.remove_all.curry(!0).bindAsEventListener(d.list))),j=a.width,a.width&&(j=a.width,j=a.unordered?j:j-48,j=!a.unordered&&(a.values&&a.values.length>99||a.value&&a.value.length>99)?j-8:j,j=a.checkboxes?j-20:j,j=a.sliders?j-30:j,j=a.nodelete?j:j-16,j=a.values&&a.values.length>4||a.value&&a.value.length>4?j-16:j),a.noadd||(l=Builder.node("div",Builder.node("img",{src:"core/img/blank1x1.gif",className:"LISTBOX_addicon",title:_LOC("BPiPneaZrg","Add new..."),id:"ELEMENT_"+a.name+"_LIST_add_icon",style:"cursor:pointer"})),Event.observe(l,"click",function(){d.list.disabled||d.list.createMember("",d.list.members().length,"",!0)}),k=Builder.node("div",{id:"LIST_POPUP_ANCHOR_"+d.id,style:"width:23px"},l)),a.title&&(m=document.createElement("div"),m.className="ellipsis LISTBOX_header_title",m.style.maxWidth=a.width-63+"px",m.innerHTML=a.title);if((e||k||m||i||f||h||g)&&!a.noheader){var r=[f,h,g,i],s=[],t=0,u,v;if(r.filter(function(a){return!!a}).length>2){o=Builder.node("img",{src:"core/img/blank1x1.gif",className:"LISTBOX_menuicon",title:_LOC("rcrTekufPA","Open actions menu"),id:"ELEMENT_"+a.name+"_LIST_menu_icon",style:"cursor:pointer"}),u=r.length;for(;t<u;t++)v=r[t],v&&v.down().dataset.important!=="1"&&v.down().getAttribute("data-index")!=="1"&&(v.down().setAttribute("align","left"),v.appendChild(Builder.node("span",{},[v.down().title])),v.style.cssText="float:left;clear:left;display:block;",s.push(v));r=[o],Event.observe(o,"click",q(s))}var w=domRow([e,k,p,f||h||g||i?Builder.node("img",{src:"core/img/blank1x1.gif",className:"LISTBOX_divider"}):""].concat(r),[{attr:"align",value:"right"}]);w.className="LISTBOX_header_buttons",n=Builder.node("div",{style:"width:"+(parseInt(a.width,10)+2)+"px"},[Builder.node("table",{style:"width:100%;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"LISTBOX_HEADER_left"}),Builder.node("td",{className:"LISTBOX_HEADER_center"},[m,w]),Builder.node("td",{className:"LISTBOX_HEADER_right"})])))]),d.appendChild(n)}d.border="1px dashed green",d.appendChild(d.list.htmlElement);if(a.checkboxes&&a.checkboxes_selectall){var x=Builder.node("input",{type:"checkbox",id:"LISTBOX_FOOTER_CB_SELECTALL"}),y=Builder.node("label",{id:"LISTBOX_FOOTER_CB_SELECTALLLABEL"},_LOC("DcCCXuEJiw","Select All")),z=Builder.node("div",{className:"LISTBOX_FOOTER",style:"width: "+a.width+"px;"},[x,y]);function A(a){var b=$(x).checked,c=b?_LOC("IMawSnPKJF","Deselect all"):_LOC("mRyhzgSTkY","Select all"),d=core.listMap[a].members();d.each(function(a){$(a.checkbox).checked=b}),$(y).update(c)}Event.observe(x,"click",A.curry(a.name)),d.appendChild($(z))}}function popup_close(a){var b=core.popupMap[a];if(b){b.close(),delete core.popupMap[a];return!0}return!1}function tab_traffic(a,b){try{a>0?($("TAB_TRAFFIC_"+b).style.backgroundImage='url("core/img/trafficlights/traffic_small_green.png")',$("TAB_TRAFFIC_"+b).setAttribute("title",_LOC("nGbJxxFEHS","Status: Enabled"))):($("TAB_TRAFFIC_"+b).style.backgroundImage='url("core/img/trafficlights/traffic_small_red.png")',$("TAB_TRAFFIC_"+b).setAttribute("title",_LOC("QbicmyGeGm","Status: Disabled")))}catch(c){_debug(c)}}function tab_fade_in(a,b){var c=tabs[a];c[b].faded=!1,input_activate("TABSET_"+a+"_TAB_"+b)}function tab_fade_out(a,b){var c=tabs[a];c[b].faded=!0,input_deactivate("TABSET_"+a+"_TAB_"+b),$("TABSET_"+a+"_TAB_"+b).style.opacity="1"}function tab_activate(a,b){var c=tabs[a];c[b].faded||(cur_tabs[a]=b,core.menu.hist.push(tab_getLink(a,b)),tabs_render(a),input_activate("TABSET_"+a+"_CONTENT"),document.getElementsByClassName("TRAFFIC_LIGHT_SMALL_OFF").each(function(a,b){var c=a.getAttribute("oldstatus");c&&(a.className="TRAFFIC_LIGHT_SMALL_"+c)}))}function tab_getLink(a,b){var c=core.menu.lastActive.options,d=[];c.parent&&d.push(c.parent),d.push(c.name),c.tabset&&c.tabset.name==a&&c.tabset.tabs[b]&&d.push(c.tabset.tabs[b].name);return d}function tab_switch_cnt(a,b,c){tabs[b][c]={caption:tabs[b][c].caption,fid:tabs[b][c].fid,name:tabs[b][c].name,helpuuid:tabs[b][c].helpuuid,options:a},tab_activate(b,c)}function tabs_render(tabset_name){var this_set=tabs[tabset_name],t=0,str="TABSET_"+tabset_name+"_TAB_";cur_tabset=tabset_name,linkToTab&&(cur_tabs[tabset_name]=linkToTabNo,linkToTab=!1),remove_license_exceptions();for(;t<this_set.length;t++)t==cur_tabs[tabset_name]?($(str+t+"_LEFT").className="TABSET_TAB_left_active",$(str+t+"_CENTER").className="TABSET_TAB_center_active",$(str+t+"_RIGHT").className="TABSET_TAB_right_active",app.GlobalLivelog&&(this_set[t].livelog?app.Livelog.setCurrentLiveLog(this_set[t].livelog):app.Livelog.setCurrentLiveLog(core.menu.lastActive.livelog))):($(str+t+"_LEFT").className="TABSET_TAB_left_inactive",$(str+t+"_CENTER").className="TABSET_TAB_center_inactive",$(str+t+"_RIGHT").className="TABSET_TAB_right_inactive");if(this_set[cur_tabs[tabset_name]].fid){this_set[cur_tabs[tabset_name]].helpuuid&&update_online_help_link(this_set[cur_tabs[tabset_name]].helpuuid);var options=this_set[cur_tabs[tabset_name]].options?eval(this_set[cur_tabs[tabset_name]].options):!1;load_tab(this_set[cur_tabs[tabset_name]].fid,"TABSET_"+tabset_name+"_CONTENT",loadTabOptions||options||!1,loadTabCallback),loadTabOptions=!1}else $("TABSET_"+tabset_name+"_CONTENT").innerHTML="&nbsp;";remove_popups()}function area_load(a){a.FID=a.fid,a.target="AREA_"+a.name+"_CONTENT",req_send({objs:[a]})}function dnd_update(a){dnd_remove(a),dnd_add(a,!0)}function dnd_sort(a){var b=-1,c=a.childNodes.length-2;for(;c>=0;c--)a.lastChild.caption.innerHTML.toLowerCase()<=a.childNodes[c].caption.innerHTML.toLowerCase()&&(b=c);b>=0&&a.insertBefore(a.lastChild,a.childNodes[b])}function dnd_add(a,b){var c=$("__DND_"+a["class"]);if(c&&a&&!a.hidden){var d=new myDraggable(a,c);b&&dnd_sort(c),dndMgr.registerDraggable(d),d.htmlElement.prevMouseover=d.htmlElement.onmouseover,d.htmlElement.onmouseover=function(){this.prevMouseover?(this.prevMouseover(),this.onmouseover=this.prevMouseover):this.onmouseover=function(){return!0}}}}function dnd_remove(a){var b=$("__DND_"+a["class"]),c=$("__DND_DRAGGABLE_"+a.ref);b&&c&&(b.removeChild(c),b.members&&(b.members=b.members.select(function(b,c){if(b!=a.ref)return b})))}function dnd_colorize(a){var b=$("__DND_"+a);if(b.members){var c=0;b.members.each(function(a,b){var d=$("__DND_DRAGGABLE_"+a);d.style.height||c++})}}function dnd_filter_run(a,b){function d(c,d){var e=$("__DND_DRAGGABLE_"+c),f=get_object(c);typeof b=="function"?a!="0"&&f.type!=a||!b(f)?e.style.height="0px":e.style.height=null:(a=="0"||f.type==a)&&f.data.name.toLowerCase().indexOf(b.toLowerCase())>=0?e.style.height=null:e.style.height="0px"}var c=$("dnd_frame");if(c.activeClass){var e=$("__DND_"+c.activeClass);e.members&&(e.members.each(d),dnd_colorize(c.activeClass))}}function dnd_filter(a,b,c){var d=$("dnd_frame"),e=1e3,f;d.activeClass&&(f=$("__DND_"+d.activeClass),e=f.members.length),d.filter_timeout&&window.clearTimeout(d.filter_timeout),c?d.filter_timeout=window.setTimeout("dnd_filter_run('"+a+"','"+b+"')",e):d.filter_timeout=window.setTimeout("dnd_filter_run('"+a+"','"+b+"')",10)}function dnd_hide(){var a=$("dnd_frame"),b=$("dnd_type_filter");a.activeClass=!1,b.style.visibility="hidden",a.style.zIndex=4,a.hide(),core.tools.clearDndSelection(),core.Events.fire("dnd:overlay_closed")}function dnd_show(a,b,c){core.utils.uuid(function(){var b;typeof a=="object"?b=a["class"]:b=a;switch(b){case"network":return"2d644990-0320-11de-8ada-0015f2751db8";case"service":return"2d64b90c-0320-11de-8ada-0015f2751db8";case"interface":return"2d6527ca-0320-11de-8ada-0015f2751db8";case"aaa":return"2d63da5a-0320-11de-8ada-0015f2751db8";case"epp":return"247a70ac-2b63-417e-8764-e0571a3195ce";case"http":return"e762a4d7-7bee-4571-9c0c-c544aaf3aae6"}}(),function(){function f(){var e=$("dnd_frame"),f,g,h,i;typeof c=="function"&&dnd_filter_run(0,c),typeof e.restyle!="function"&&(e.restyle=function(){var a=Position.page($("navbar"))[1],b=Math.min($("content_wrapper").getHeight(),document.viewport.getHeight()-18),c=e.style;a>=0?(c.top=a+"px",c.height=b+"px"):(c.top="0px",c.height=b+"px"),dnd_clases.each(function(a,c){$("__DND_"+a).style.height=b-60+"px"})});if(!(SID&&SID.length>1)||e.activeClass&&e.activeClass==a&&!b){dnd_hide();return!0}dnd_clases.each(function(b,c){var d=$("__DND_"+b);a==b?d.style.zIndex=1:d.style.zIndex=0}),f=dnd_titles[a],core.userPreferences.shortcuts[a]&&core.userPreferences.shortcuts[a][0]!=="OFF"?f=(new Template(dnd_titles[a])).evaluate({firstKey:core.userPreferences.shortcuts[a][0],secondKey:core.userPreferences.shortcuts[a][1]}):f=f.replace(/<.*>/,""),$("dnd_title").innerHTML=f,g=$("dnd_type_filter"),g.style.visibility="visible",h=$A(g.getElementsByTagName("option")),h.each(function(a,b){g.removeChild(a)}),dnd_type_filters[a].values.each(function(b,c){g.options[c]=new Option(dnd_type_filters[a].labels[b],b);if(!d&&b=="0"||b==d)g.options[c].defaultSelected=!0,g.options[c].selected=!0}),d&&(g.value=d),i=$("dnd_string_filter"),i.value="",e.activeClass=a,dnd_filter_run(d||0,c||""),e.style.zIndex=1e3,e.restyle(),e.show(),core.Events.fire("dnd:overlay_opened",{activeClass:a,activeType:d})}var d=!1,e=function(){function g(c){var h=0,i=a.length,j;while(h<d)if(i>0)j=a.shift(),j&&dnd_add(j),h++;else break;f(Math.round((b-i)/(b/100))),i>0?e=window.setTimeout(function(){g(c)},20):(dnd_setup=!0,wait_popup(!1),window.clearTimeout(e),typeof c=="function"&&c()),refresh_timeout()}function f(c){wait_popup(!0,_LOC("GlvPZmiUAH","Please wait, organizing drag'n'drop objects.")+_LOC("qtqgDJjveV","<br>This may take a while!")+"<br/>"+c+"% done ("+a.length+"/"+b+" "+_LOC("uOfwKairDm","Objects to parse")+")",c)}var a=[],b=0,c=99,d=99,e;return function(h){if(dnd_setup===!1){dnd_setup=1,dnd_init(),a=[];for(key in backend_objects)backend_objects[key]["class"]&&dnd_clases.indexOf(backend_objects[key]["class"])>=0&&a.push(backend_objects[key]);b=a.length,object_sort(a);if(b<c*10){var i=Math.round(b/11);b<11?d=i+1:d=i}else d=c;f("0"),e=window.setTimeout(function(){g(h)},20)}return!0}}();return function(){Object.isString(a)||(d=a.type,a=a["class"]),d=="*"&&(d=!1),dnd_setup?f():e(f)}}(),[])}function dnd_init(){var a=$("dnd_frame");if(!a)return!0;dnd_clases.each(function(b,c){var d=$("__DND_"+b);d&&a.removeChild(d),dnd_cnt[b]=0}),dnd_clases.each(function(b,c){var d=document.createElement("div");d.id="__DND_"+b,d.style.cssText="position:absolute;top:54px;left:4px;width:181px;height:591px;overflow:auto;background-color:#f7f7f7;z-index:0;",a.appendChild(d)}),a.activeClass=!1;return!0}function dnd_dropzone_update(a,b){dndMgr.getDropZone(a).update(b)}function dnd_dropzone_single_update(a,b){dndMgr.getDropZone(a).add(b)}function dnd_dropzone_init(a,b,c,d){var e=$("ELEMENT_"+a.name);b&&(e=b),a=Object.extend({width:158,height:160,sorted:!0,sortable:!1},a||{}),a.sorted&&(c=!0,d=!1),d=!1,a.sortable&&(d=!0,c=!1);var f=new myDropzone(e.id,a.acceptClass,a.acceptTypes,a.blacklistProperties?a.blacklistProperties:!1,a.restricted?a.restricted:!1,a.width,a.height-25,c,d,dnd_helpers[a.dropzoneType]||dnd_helpers["default"]);f.afterAddAction=a.afterAddAction,a.noeditable&&(f.noeditable=!0),dndMgr.registerDropZone(f),a.value&&(a.value instanceof Array?a.value.each(function(a,b){var c;if(!!a){c=get_object(a);if(!c)return;f._insert(c)}}):dnd_helpers[a.name]._insert&&f._insert(a.value));var g;a.extra_icon&&(g=Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_extraicon",title:a.extra_icon.title,id:"ELEMENT_"+a.extra_icon.name+"_DROPZONE_extraicon",style:"cursor: pointer;"+(a.extra_icon.icon?'background-image:url("'+a.extra_icon.icon+'");':"")}),a.extra_icon.disabled||Event.observe(g,"click",function(){if(!this.disabled)var b=evaluate.apply(this,[a.extra_icon.onclick])}.bind(f)));var h=Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_foldericon",title:_LOC("SyaiXNDnut","Browse..."),id:"ELEMENT_"+a.name+"_DROPZONE_folder_icon",style:"cursor:pointer"});Event.observe(h,"click",function(){this.disabled||(a.acceptTypes&&a.acceptTypes.length&&a.acceptTypes.length==1?dnd_show({"class":a.acceptClass,type:a.acceptTypes[0]}):dnd_show(a.acceptClass))}.bind(f));var i=Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_addicon",title:a.add_icon&&a.add_icon.title?a.add_icon.title:_LOC("PrzQjGrMXJ","Create new..."),id:"ELEMENT_"+a.name+"_DROPZONE_add_icon",style:"cursor: pointer;"+(a.add_icon&&a.add_icon.icon?'background-image:url("'+a.add_icon.icon+'");':"")});popup_close("POPUP_"+e.id),Event.observe(i,"click",function(){if(!this.disabled&&!this.popupOpened){this.popupOpened=!0,input_deactivate("ELEMENT_"+a.name+"_DROPZONE_add_icon");var b=new core.popup({name:"POPUP_"+e.id,"class":a.acceptClass,types:a.acceptTypes,anchor:i,modal:a.modal,help:a.help,update_type:"dropzone",update_name:e.id,onclose:function(){this.popupOpened=!1,input_activate("ELEMENT_"+a.name+"_DROPZONE_add_icon")}.bind(this)})}}.bind(f));var j=document.createElement("div"),k=parseInt(a.width,10)-8,l;j.className="DRAGDROP_DROPZONE_header_title ellipsis",j.innerHTML="&nbsp;",a.title&&(j.innerHTML=a.title,j.setAttribute("title",a.title),a.noadd||(k-=22),a.nofolder||(k-=22),a.extra_icon&&(k-=23),!a.nofolder&&!a.noadd&&(k-=3),j.style.width=k+"px"),l=Builder.node("div",{style:"width:"+(parseInt(a.width,10)+2)+"px"},[Builder.node("table",{style:"width:100%;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"DRAGDROP_DROPZONE_HEADER_left"}),Builder.node("td",{className:"DRAGDROP_DROPZONE_HEADER_center"},[j,a.extra_icon&&a.extra_icon.last?Builder.node("div",{style:"float:right;padding-top:1px;"},g):"",a.extra_icon&&a.extra_icon.last?Builder.node("div",{style:"float:right;margin-top:4px;"},Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_divider"})):"",a.noadd?"":Builder.node("div",{style:"float:right;padding-top:1px;"},i),!a.nofolder&&!a.noadd?Builder.node("div",{style:"float:right;margin-top:4px;"},Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_divider"})):"",a.nofolder?"":Builder.node("div",{style:"float:right;padding-top:1px;"},h),a.extra_icon&&!a.extra_icon.last?Builder.node("div",{style:"float:right;margin-top:4px;"},Builder.node("img",{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_divider"})):"",a.extra_icon&&!a.extra_icon.last?Builder.node("div",{style:"float:right;padding-top:1px;"},g):""]),Builder.node("td",{className:"DRAGDROP_DROPZONE_HEADER_right"})])))]),e.appendChild(l),e.appendChild(f.htmlElement),e.dropzone=f;return f}function dnd_dropzone_single_init(a,b){var c=$("ELEMENT_"+a.name);b&&(c=b),a.width||(a.width=157),a.height||(a.height=24);var d=new singleDropzone(c.id,a.acceptClass,a.acceptTypes,a.blacklistProperties?a.blacklistProperties:!1,a.restricted?a.restricted:!1,a.width-16-16-4-4+(a.noadd?20:0),a.height);a.noeditable&&(d.noeditable=!0),a.disabled&&(d.disable(),d.deactivate()),dndMgr.registerDropZone(d),a.value.length>0&&d.add(a.value);var e=Builder.node("img",{title:_LOC("QIqFCzjKQD","Browse..."),src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_foldericon",id:"ELEMENT_"+a.name+"_DROPZONE_folder_icon"});Event.observe(e,"click",function(){this.disabled||(a.acceptTypes&&a.acceptTypes.length&&a.acceptTypes.length==1&&a.acceptTypes[0]!="*"?dnd_show({"class":a.acceptClass,type:a.acceptTypes[0]}):dnd_show(a.acceptClass))}.bind(d));var f=Builder.node("img",{title:_LOC("qxwyUvqdbQ","Create new..."),src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_addicon",id:"ELEMENT_"+a.name+"_DROPZONE_add_icon"});popup_close("POPUP_"+c.id),Event.observe(f,"click",function(){if(!this.disabled&&!this.popupOpened){this.popupOpened=!0,input_deactivate("ELEMENT_"+a.name+"_DROPZONE_add_icon");var b=new core.popup({name:"POPUP_"+c.id,"class":a.acceptClass,types:a.acceptTypes,anchor:f,modal:a.modal,help:a.help,update_type:"dropzone_single",update_name:c.id,onclose:function(){this.popupOpened=!1,input_activate("ELEMENT_"+a.name+"_DROPZONE_add_icon")}.bind(this)})}}.bind(d));var g=[Builder.node("td",{},d.htmlElement)];a.nofolder||g.push(Builder.node("td",{},e)),a.noadd||g.push(Builder.node("td",{},f));var h=Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},g)));c.appendChild(h),c.style.width=$(h).getWidth()+"px",c.dropzone=d;return d}function dropdown_update(a,b){dropdown=core.dropdownMap[a],dropdown&&(dropdown.options.value=b,dropdown.fill())}function dropdown_init(a,b){b.container=$(a);var c=new core.dropdown(b)}function border_blink_callback(a){var b=$(a);b&&(border_blink_map[b.id]%2==1?browser=="ie"&&browser_version<7?(b.style.background=b.backgroundStored,b.style.backgroundImage=b.backgroundImageStored,b.style.backgroundColor=b.backgroundColorStored):browser=="safari"?(b.style.fontWeight="normal",b.style.color="black"):b.style.border=b.borderStored:browser=="ie"&&browser_version<7?(b.backgroundStored=b.style.background,b.backgroundImageStored=b.style.backgroundImage,b.backgroundColorStored=b.style.backgroundColor,b.style.background="red"):browser=="safari"?(b.style.fontWeight="bold",b.style.color="red"):(b.borderStored=b.style.border,b.style.border="1px solid red"),border_blink_map[b.id]<21&&(border_blink_map[b.id]++,border_blink_timer[b.id]=window.setTimeout(function(){border_blink_callback(b.id)},200)))}function border_blink_element(a){if(a){var b=$("ELEMENT_"+a);b||(b=$(a)),b&&b.style&&(border_blink_map[b.id]=0,border_blink_timer[b.id]=window.setTimeout(function(){border_blink_callback(b.id)},200)),b&&typeof b.focus=="function"&&b.focus(),b&&typeof b.select=="function"&&b.select()}}function border_blink(a,b){var c=!1;typeof b=="string"&&(core.formMap[a]&&(b=core.formMap[a].req.layout.filter(function(a,b){if(a.name==b)return a},b)),b=b[0]);switch(b.type){case"list":case"list_cb":c=core.listMap[b.name].htmlElement;break;case"text":case"select-one":case"dropdown":case"password":case"checkbox_group":c=$("FORM_"+a+"_ELEMENT_"+b.name);break;case"dropzone":case"dropzone_single":var d=$("FORM_"+a+"_ELEMENT_"+b.name);if(d){var e=dndMgr.getDropZone(d.id);e&&e.htmlElement&&(c=e.htmlElement)}break;case"upload":c=$(core.uploadMap[b.name].htmlElement.down(3)),c.id||(c.id="ELEMENT_upload_container_"+b.name);break;default:_debug("not in list: element-type "+b.type)}c&&c.style&&border_blink_element(c),c&&typeof c.focus=="function"&&c.focus(),c&&typeof c.select=="function"&&c.select()}function get_element(a){if(core.dropdownMap[a])return core.dropdownMap[a].getValue();if(core.uploadMap[a])return core.uploadMap[a].getValue();if(core.minitableMap[a])return core.minitableMap[a].getValue();if(core.sliderMap&&core.sliderMap[a])return core.sliderMap[a].getValue();var b=$("ELEMENT_"+a),c=[],d;if(b){if(d=dndMgr.getDropZone("ELEMENT_"+a)){if(d instanceof singleDropzone)return d.member;if(d instanceof myDropzone)return d.getMembers();_debug("Element: [ELEMENT_"+a+"] found in dropzone map but wasn't a dropzone object");return""}if(b.list)return b.list.memberValues();if(b.getAttribute("name")=="RADIOGROUP"){c=$A(b.getElementsByTagName("input"));var e=c.detect(function(a,b){if(a.checked)return!0;return!1});if(e)return e.value;return!1}if(b.getAttribute("name")=="CHECKBOXGROUP"){c=$A(b.getElementsByTagName("input"));return c.collect(function(a,b){if(a.checked)return a.value;return null}).compact()}if(b.getAttribute("name")=="DROPDOWNGROUP"){var f={};$A(b.getElementsByTagName("select")).each(function(a){f[a.name]=a.value});return f}if(b.type=="checkbox")return b.checked?1:0;if(b.type=="radio")return b.checked?b.value:!1;return b.value?b.value:b.value===""?"":!1}return!1}function get_default_value(req,element){var value=!1;if(req.options.obj_src||req.options.obj_clone){var obj_ref,obj=null;req.options.obj_src&&(obj_ref=eval(req.options.obj_src),obj=get_object(obj_ref)),req.options.obj_clone&&(obj_ref=eval(req.options.obj_clone),obj=get_object(obj_ref).clone(),obj.ref=null),element.refpath&&element.refpath.each(function(a,b){obj&&(obj=get_object(obj.data[a]))});if(obj&&obj.data)if(element.basefield)typeof obj[element.basefield]!="undefined"&&(value=obj[element.basefield]);else if(element.field)typeof obj[element.field]!="undefined"&&(value=obj[element.field]),typeof obj.data[element.field]!="undefined"&&(value=obj.data[element.field]);else if(element.field_js){var toEval=element.field_js.replace(/__OBJ_REF/,obj.ref||obj_ref);value=eval(toEval)}}value===!1&&req.options.defaults&&typeof req.options.defaults[element.name]!="undefined"&&(value=req.options.defaults[element.name]);if(value===!1&&element.dflt||value===""&&element.dflt&&element.forcedflt)typeof element.dflt=="string"&&element.dflt.match(/REF_/)?element.dflt.indexOf(":")!=-1||get_object(element.dflt)?value=element.dflt:value="":value=element.dflt;(value===!1||value===0)&&element.type=="checkbox"&&(value="0"),value===!1&&(value="");return value}function form_submit(a){var b=core.formMap[a];b.submit()}function form_cancel(a){var b=core.formMap[a];b.cancel()}function render_form(a,b){var c=core.formMap[a];c.render(b)}function form_update(a){var b=core.formMap[a];b.update()}function form_submit_result(a){var b=core.formMap[a.form_name];b.submit_result(a)}function form_init(a){var b,c,d,e,f,g=[],h;if(a.preload){b=a.layout.length;if(b){while(b--){d=a.layout[b];if(Object.isArray(d)){c=d.length;while(c--)h=d[c].type,g.indexOf(h)===-1&&g.push(h)}else h=d.type,g.indexOf(h)===-1&&g.push(h)}g=g.filter(function(a){return a!=="rules_editor"}),core.form["renderInputFunctions__"+h]||window.setTimeout(function(){var a=g.length,b;while(a--)b=g[a],core.utils.scriptloader.require([core.dynIncPath+"_formInput_"+b+".min.js",dynIncPath+"_formInput_"+b+".min.js",core.dynIncPath+"_formInput_"+b+".js",dynIncPath+"_formInput_"+b+".js"],!1,0,!0)},1)}}else e=new core.form(a),core.formMap[a.options.name]=e,f=$("FORM_"+e.form_name),f?f.appendChild(e.htmlElement):_debug("container FORM_"+e.form_name+" was not generated "),e.update()}function button_init(a,b){var c;b.container=a,c=new core.button(b)}function slider_init(a){a=Object.extend({container:"ELEMENT_"+a.name,name:"not_set",axis:"horizontal",incremenent:1,maximum:null,minimum:0,range:$R(a.minimum,a.maximum),sliderValue:a.sliderValue||a.value,onSlide:function(b,c){$("ELEMENT_slider_"+a.name+"_label").update(c.getLabelText())},onChange:function(a){console.log(a)}},a||{}),a.minimum&&a.maximum&&(a.range=$R(a.minimum,a.maximum));var b=$(Builder.node("div",{className:"SLIDER_handle",id:"ELEMENT_slider_"+a.name+"_handle"})),c=$(Builder.node("div",{className:"SLIDER_label",id:"ELEMENT_slider_"+a.name+"_label"})),d=$(Builder.node("div",{id:"ELEMENT_slider_"+a.name,className:"SLIDER_track"},[c,b])),e=Builder.node("div",{className:"SLIDER_container"},d);$(a.container).appendChild(e),core.sliderMap||(core.sliderMap={}),core.sliderMap[a.name]=new core.Slider(b,d,a),a.labels&&c.update(core.sliderMap[a.name].getLabelText());return core.sliderMap[a.name]}function remove_license_exceptions(){$("license_exception")&&$("license_exception").parentNode.removeChild($("license_exception")),license_exception(!0,!0,!0)}function license_exception_msg(a){var b;typeof a=="undefined"?b=license_info_texts.FEATURE:b=a;if($("license_exception"))$("license_exception").innerHTML=b;else{var c='<div class="license_exception" id="license_exception">'+b+"</div>";new Insertion.Top("display",c)}}function remove_popups(){while($("popup_master").firstChild)$("popup_master").removeChild($("popup_master").firstChild);var a=[];Object.keys(core.iPopupMap).compact().each(function(a,b){typeof core.iPopupMap[a]!="function"&&a!="______array"&&interactionPopup({iPopup:a,open:!1})})}function alert(a){core.alertMap.push(interactionPopup({open:!0,alert:!0,text:a,buttons:[{label:"OK"}]}));return!0}function confirm_dialog(a,b){a=Object.extend({message:"",cancel_cb:function(){},ok_cb:function(){}},a||{});var c,d=[{label:_LOC("eXzUOtXZgM","OK"),icon:"core/img/icons/check.png","default":!0,exec:function(){a.ok_cb()}},{label:_LOC("aGQcWVWRpk","Cancel"),icon:"core/img/icons/cancel.png",exec:function(){a.cancel_cb()}}],e,f="",g=function(a,b,c){var d="",e=c||6;for(var f=0;f<e;f++)a[f+(b||0)]&&(d+="<p>"+a[f+(b||0)]+"</p>");return d};if(Object.isArray(a.message)){e=a.message.length;if(e<7)c=interactionPopup({open:!0,modal:a.modal,text:g(a.message,0,e),buttons:d});else{var h={label:_LOC("XonqffzmBL","Next"),"default":!0,exec:function(){confirm_dialog(a,(b||0)+6)}},i={label:_LOC("vBYCxJCaNT","Back"),exec:function(){confirm_dialog(a,(b||0)-6)}};interactionPopup({open:!0,modal:a.modal,title:_LOC("KuGBgTYUyU","Information:"),text:g(a.message,b),buttons:[(b||0)>0?i:null,a.message[(b||0)+6]?h:null,a.message[(b||0)+6]?null:{label:_LOC("usKlYJBarW","OK"),"default":!0,exec:function(){a.ok_cb()}},{label:_LOC("gwKOoCISMo","Cancel"),"default":!0,exec:function(){a.cancel_cb()}}]})}}else c=interactionPopup({open:!0,modal:a.modal,text:a.message,buttons:d})}function error_dialog(a,b){if(Object.isArray(a)){var c=a.length,d="",e=function(a,b,c){var d="",e=c||6;for(var f=0;f<e;f++)a[f+(b||0)]&&(d+="<p>"+a[f+(b||0)]+"</p>");return d};c<7?alert(e(a,0,c)):interactionPopup({open:!0,title:_LOC("nKDSSJWhkU","Information:"),text:e(a,b),buttons:[(b||0)>0?{label:"Back",exec:function(){error_dialog(a,(b||0)-6)}}:null,a[(b||0)+6]?{label:"Next","default":!0,exec:function(){error_dialog(a,(b||0)+6)}}:{label:"OK"}]})}else alert(a)}function interactionPopup(a){var b=!1;if(a.open===!0){b=init_interactionPopup(),a.modal&&WindowUtilities.disableScreen("astaro","overlay_modal_"+b.id,.5,b.id,"");if(b){b.style.zIndex=2e3+b.iPosition,b.style.visibility="visible";if(browser=="ie"&&b.childNodes)for(var c=0;c<b.childNodes.length;c++)b.removeChild(b.childNodes[c]);b.innerHTML="";var d=document.createElement("div");b.appendChild(d),a.title?d.innerHTML=a.title:a.buttons.length>1?d.innerHTML=_LOC("WxSFXUtflF","Please confirm:"):d.innerHTML=_LOC("ABLHjUNsPY","Information:"),new Draggable(b,{handle:d}),d.className="iPopUpTitle";var e=document.createElement("div");b.appendChild(e),e.innerHTML=a.text,e.className="iPopUpText";var f=[],g=focus_element_id,h=!1;a.buttons.compact().each(function(c){var d=function(){c.exec&&c.exec(),focus_element_id=g,a.alert&&core.alertMap.pop(),a.modal&&WindowUtilities.enableScreen("overlay_modal_"+this.id),interactionPopup({open:!1,iPopup:this.id+""})}.bind(b),e=new core.button({label:c.label,icon:c.icon||!1,onclickfunc:d});f.push(domTd({padding:"2px"},{},{},e.htmlElement)),!h&&(c["default"]||a.buttons.length==1)&&(e.htmlElement.id="btnDefault_"+b.id,e.htmlElement.alt='$("btnDefault_'+b.id+'").onclick();',focus_register(e.htmlElement),e.htmlElement.style.fontWeight="bold",h=!0)}),b.appendChild(domTableRow(f)),b.options=a;return b}}else{var i="";if(typeof a.iPopup=="string")i=a.iPopup;else if(typeof a.iPopup=="object")i=a.iPopup.id;else return!1;_debug("have to kill "+i);var j=core.iPopupMap[i];j&&j.parentNode?j.parentNode.removeChild(j):j=null,i!==""&&j&&(_debug("delete the popup from map: "+i),j=!1)}return!1}function init_interactionPopup(){popupCounter++;if(!$("iPopup_"+popupCounter)){_debug("have to generate iPopup_"+popupCounter);var a=50,b=0;iPosition=0;var c=Object.keys(core.iPopupMap);for(var d=c.length-1;d>=0;d--){var e=c[d];if(!e.match(/^iPopup_/))continue;var f=$(e);if(f){b++;if(b>a)console.log("More than "+a+" old popups are shown, old popups will be removed"),f.parentNode.removeChild(f),delete core.iPopupMap[e];else{iPosition++;var g=a-iPosition,h=300+4*g,i=220+4*g+(document.documentElement.scrollTop||document.body.scrollTop),j=parseInt(f.style.left.replace("px","")),k=parseInt(f.style.top.replace("px",""));Math.abs(j-h)<=4&&Math.abs(k-i)<=4&&(f.style.left=h+"px",f.style.top=i+"px")}}else delete core.iPopupMap[e]}var l=document.createElement("div");document.body.appendChild(l),l.id="iPopup_"+popupCounter,l.num=popupCounter,l.className="iPopUp",l.style.left=300+4*iPosition+"px",l.style.top=220+4*iPosition+(document.documentElement.scrollTop||document.body.scrollTop)+"px",l.iPosition=iPosition,core.iPopupMap[l.id]=l;return l}return $("iPopup_"+popupCounter)}function infopop_down(){var a=$("infopop");a&&(window.clearTimeout(infopop_down_timer),a.innerHTML="",a.style.zIndex=0,a.style.visibility="hidden")}function infopop_at(a,b,c){var d=$("infopop");c||(c={});if(d)if(b&&a){d.style.visibility="hidden",Position.clone(a,d,{setWidth:!1,setHeight:!1}),d.innerHTML="",d.innerHTML=b,d.style.zIndex=1e3,d.style.width=null,d.style.height=null;if(typeof c.position=="string"){var e=Element.getDimensions(d),f=Element.getDimensions(a),g=Position.cumulativeOffset(d);switch(c.position){case"top":d.style.top=g[1]-e.height+"px";break;case"right":d.style.left=g[0]+f.width+"px";break;case"bottom":d.style.top=g[1]+f.height+"px";break;case"left":d.style.left=g[0]-e.width+"px"}}d.style.visibility="visible",c.autohide&&(infopop_down_timer&&(window.clearTimeout(infopop_down_timer),infopop_down_timer=!1),infopop_down_timer=window.setTimeout(infopop_down,5e3))}else infopop_down()}function infopop_at(a,b,c){var d=$("infopop");c||(c={});if(d)if(b&&a){d.style.visibility="hidden",Position.clone(a,d,{setWidth:!1,setHeight:!1}),d.innerHTML="",d.innerHTML=b,d.style.zIndex=1e3,d.style.width=null,d.style.height=null;if(typeof c.position=="string"){var e=Element.getDimensions(d),f=Element.getDimensions(a),g=Position.cumulativeOffset(d);switch(c.position){case"top":d.style.top=g[1]-e.height+"px";break;case"right":d.style.left=g[0]+f.width+"px";break;case"bottom":d.style.top=g[1]+f.height+"px";break;case"left":d.style.left=g[0]-e.width+"px"}}d.style.visibility="visible",c.autohide&&(infopop_down_timer&&(window.clearTimeout(infopop_down_timer),infopop_down_timer=!1),infopop_down_timer=window.setTimeout(infopop_down,5e3))}else infopop_down()}function infopop_up(a,b,c,d,e,f,g,h){var i=$("infopop"),j=d?document.viewport.getScrollOffsets()[1]:0,k=document.viewport.getWidth(),l,m,n,o,p,q,r;i&&(b&&a?(i.style.visibility="hidden",Position.clone(a,i,{setWidth:!1,setHeight:!1,offsetTop:j}),i.innerHTML="",i.innerHTML=b,i.style.zIndex=1e3,i.style.width=f?f+"px":null,i.style.wordWrap="break-word",i.style.height=null,l=Element.getDimensions(a),m=Position.cumulativeOffset(i),n=m[1]+l.height,i.style.top=n+"px",g&&!c&&(o=m[0],k-o<g&&(p=o+i.getWidth()-k,i.style.left=o-p+"px")),c&&(q=Element.getDimensions(i),r=m[0]-q.width,i.style.left=r+"px"),h&&(i.style.maxWidth=h+"px",i.style.wordWrap="break-word"),g&&(i.style.minWidth=g+"px"),i.style.visibility="visible",e||(infopop_down_timer&&(window.clearTimeout(infopop_down_timer),infopop_down_timer=!1),infopop_down_timer=window.setTimeout(infopop_down,5e3))):infopop_down())}function input_state_on_dropdown(a,b){var c=$(a);c||(c=core.dropdownMap[a].htmlElement),c||(c=$("ELEMENT_"+a));if(c&&b){var d=b[c.options[c.selectedIndex].value];d||(d=b["*"]),d&&(d.off&&d.off.each(function(a,b){input_deactivate(a)}),d.on&&d.on.each(function(a,b){input_activate(a)}))}}function mod_grid_row(a,b,c){var d=$("GRID_"+a+"_ROWCONTAINER");if(d){var e=$A(d.getElementsByTagName("tr"));if(e&&e[b])switch(c){case"hide":$(e[b]).hide();break;case"show":$(e[b]).show(),e[b].id||(e[b].id="GRID_"+a+"_ROWCONTAINER_ROW_"+b),input_activate(e[b].id);break;case"fade":e[b].id||(e[b].id="GRID_"+a+"_ROWCONTAINER_ROW_"+b),input_deactivate(e[b].id)}}}function input_activate(a){function g(a,b){var c;a=$(a),a.onclickDisabled||a.cursorDisabled||a.onmouseoverDisabled||a.onmouseoutDisabled?(a.onclick=a.onclickDisabled||null,a.onclickDisabled=!1,a.style.cursor=a.getAttribute("cursor_disabled")||null,a.cursorDisabled=!1,a.onmouseover=a.onmouseoverDisabled||null,a.onmouseoverDisabled=!1,a.onmouseout=a.onmouseoutDisabled||null,a.onmouseoutDisabled=!1):(c=a.getAttribute("cursor_disabled"),c&&(a.style.cursor=c),a.dropzone?a.dropzone.enable():a.deactivateable&&(a.style.color=a.getAttribute("color_disabled"),a.setAttribute("color_disabled",""))),a.button&&a.button.enable(),a.list&&typeof a.list.enable=="function"&&a.list.enable()}var b=$(a),c=["div","td","input","a","button","span","img","table"],d=0,e=c.length,f;if(!!b){b.style.color="black",b.removeClassName("opaque");if(b){["input","select","textarea","button"].indexOf(b.nodeName.toLowerCase())>-1&&(b.disabled=!1),["input","select","textarea","button"].each(function(a){$A(b.getElementsByTagName(a)).each(function(a){a.disabled=!1})});if(b.button){b.button.enable();return}b.list&&typeof b.list.enable=="function"&&b.list.enable();for(;d<e;)f=$A(b.getElementsByTagName(c[d++])),f.each(g)}}}function input_deactivate(a,b){function h(a){a=$(a),a.setAttribute("cursor_disabled",a.style.cursor),a.style.cursor="default",a.onclick||a.onmouseover||a.onmouseout?(a.onclickDisabled=a.onclick,a.onclick=null,a.onmouseoverDisabled=a.onmouseover,a.onmouseover=null,a.onmouseoutDisabled=a.onmouseout,a.onmouseout=null):a.dropzone?a.dropzone.disable():a.deactivateable&&(a.setAttribute("color_disabled",a.style.color),a.style.color=b?"#666666":"#999999"),a.button&&a.button.disable(),a.statusSlider&&a.statusSlider.disable(),a.list&&typeof a.list.disable=="function"&&a.list.disable()}var c=$(a),d=["div","td","input","a","button","span","img","table"],e=0,f=d.length,g;if(!!c){c.style.color=b?"#666666":"#999999",c.addClassName("opaque");if(c){["input","select","textarea","button"].indexOf(c.nodeName.toLowerCase())>-1&&(c.disabled=!0),["input","select","textarea","button"].each(function(a){$A(c.getElementsByTagName(a)).each(function(a){a.disabled=!0})});if(c.button){c.button.disable();return}c.statusSlider&&c.statusSlider.disable(),c.list&&typeof c.list.disable=="function"&&c.list.disable();for(;e<f;)g=$A(c.getElementsByTagName(d[e++])),g.each(h)}}}function geckofix_revert(){var a=$("tab_content_wrap");a&&(a.style.minWidth="762px");return!0}function geckofix_init(){if(browser.indexOf("gecko")>=0){var a=$("tab_content_wrap");if(a){a.style.minWidth="763px";var b=window.setTimeout("geckofix_revert()",1)}}return!0}function modifyPxWidth(a,b,c){var d=$(a);if(d)if(c)d.style.width=b+"px";else{var e=d.style.width;e&&e.indexOf("px")>0&&(d.style.width=e.replace(/px/,"")-b*-1+"px")}}function get_html(a){var b=document.createElement("div");b.appendChild(a);return b.innerHTML}function domTab(a,b,c,d){var e=document.createElement("table");e.setAttribute("cellpadding","0",0),e.setAttribute("cellspacing","0",0),e.setAttribute("border","0",0),a&&domApplyStyle(e,a);var f=document.createElement("tbody");e.appendChild(f),d.each(function(a,b){if(!!a){var c=document.createElement("tr");a.each(function(a,b){!a||c.appendChild(a)}),e.appendChild(c)}});return e}function domRow(a,b){var c=document.createElement("table");c.setAttribute("cellpadding","0",0),c.setAttribute("cellspacing","0",0),c.setAttribute("border","0",0),b&&b.each(function(a,b){c.setAttribute(a.attr,a.value,1)});var d=document.createElement("tbody"),e=document.createElement("tr");a.each(function(a,b){if(!!a){var c=document.createElement("td");a.attrs&&domApplyAttributes(c,a.attrs),c.appendChild(a),e.appendChild(c)}}),d.appendChild(e),c.appendChild(d);var f=document.createElement("div");f.appendChild(c);return f}function domTableRow(a,b,c){var d=document.createElement("table"),e=document.createElement("tbody"),f=document.createElement("tr");d.setAttribute("cellpadding","0",0),d.setAttribute("cellspacing","0",0),d.setAttribute("border","0",0),d.appendChild(e),e.appendChild(f),a.each(function(a,b){!a||f.appendChild(a)}),c&&domApplyAttributes(d,c),b&&domApplyStyle(d,b);return d}function domTableCol(a,b){var c=document.createElement("table"),d=document.createElement("tbody");c.setAttribute("cellpadding","0",0),c.setAttribute("cellspacing","0",0),c.setAttribute("border","0",0),c.appendChild(d),a.each(function(a,b){if(!!a){var c=document.createElement("tr");c.appendChild(a),d.appendChild(c)}}),b&&domApplyStyle(c,b);return c}function domTr(a,b,c){var d=document.createElement("tr");a.each(function(a,b){!a||d.appendChild(a)}),b&&domApplyStyle(d,b),c&&domApplyAttributes(d,c);return d}function domTd(a,b,c,d){var e=document.createElement("td");d&&e.appendChild(d),c&&domApplyTriggers(e,c),b&&domApplyAttributes(e,b),a&&domApplyStyle(e,a);return e}function domInput(a,b,c){var d=document.createElement("input");c&&domApplyTriggers(d,c),b&&domApplyAttributes(d,b),a&&domApplyStyle(d,a);return d}function domDiv(a,b,c,d){var e=document.createElement("div");d&&e.appendChild(d),c&&domApplyTriggers(e,c),b&&domApplyAttributes(e,b),a&&domApplyStyle(e,a);return e}function domA(a,b,c,d){var e=document.createElement("a");d&&e.appendChild(d),c&&domApplyTriggers(e,c),b&&domApplyAttributes(e,b),a&&domApplyStyle(e,a);return e}function domSpan(a,b,c,d){var e=document.createElement("span");d&&(e.innerHTML=d),c&&domApplyTriggers(e,c),b&&domApplyAttributes(e,b),a&&domApplyStyle(e,a);return e}function domImg(a,b,c){var d=document.createElement("img");b&&domApplyAttributes(d,b),a&&domApplyStyle(d,a),c&&domApplyTriggers(d,c);return d}function domApplyTriggers(a,b){b.onclick&&(a.onclick=b.onclick),b.onmouseover&&(a.onmouseover=b.onmouseover),b.onmouseout&&(a.onmouseout=b.onmouseout)}function domApplyAttributes(a,b){var c=$H(b);a=$(a),c.each(function(b,c){if(!(b[0].length<2)){if(b[0].indexOf("_")===0)return;switch(b[0]){case"id":a.id=b[1];break;case"valign":browser=="ie"?a.vAlign=b[1]:a.setAttribute(b[0],b[1]);break;case"colspan":browser=="ie"?a.colSpan=b[1]:a.setAttribute(b[0],b[1]);break;case"rowspan":browser=="ie"?a.rowSpan=b[1]:a.setAttribute(b[0],b[1]);break;case"nowrap":browser=="ie"?a.noWrap=b[1]:a.setAttribute(b[0],b[1]);break;case"className":a.addClassName(b[1]);break;default:a.setAttribute(b[0],b[1])}}})}function domApplyStyle(a,b){$H(b).each(function(b,c){if(!(b[0].length<2)){if(b[0].indexOf("_")===0)return;if(b[0]=="float"){a.style.cssFloat=b[1],a.style.styleFloat=b[1];return}a.style[b[0]]=b[1]}})}function altercss(a,b,c){if(!c&&!Object.isString(b))for(var d in b)Object.isString(d)&&altercss(a,d,b[d]);else{var e,f,g,h=!1,i,j=document.styleSheets.length;while(j--){e=document.styleSheets[j],f=e.rules||e.cssRules;if(!f)return!1;i=f.length;while(i--){g=f[i];if(g.selectorText==a){g.style[b]=c,h=!0;break}}if(!h)try{e.insertRule(a+" { "+b+": "+c+"; }",f.length),h=!0}catch(k){try{e.addRule(a,b+": "+c+";"),h=!0}catch(l){return!1}}if(h)return!0}}}function evaluate(command){return eval(command)}function unescape_rfc2253_DN(a){var b;for(b=a.indexOf("\\");b!=-1;b=a.indexOf("\\",b+1)){var c=a.substr(b+1,2);if(!c.match(/^[0-9A-Fa-f]{2}$/)){a=a.substr(0,b)+a.substr(b+1);continue}var d=parseInt(c,16);if(isNaN(d)||d<192||d>239)continue;var e=parseInt(a.substr(b+4,2),16);if(a.charAt(b+3)!="\\"||isNaN(e)||(e&192)!=128)continue;var f,g;if(d<224)g=(d&31)<<6|e&63,f=6;else{var h=parseInt(a.substr(b+7,2),16);if(a.charAt(b+6)!="\\"||isNaN(h)||(h&192)!=128)continue;g=(d&31)<<12|(e&63)<<6|h&63,f=9}a=a.substr(0,b)+String.fromCharCode(g)+a.substr(b+f)}return a}function widget_traffic_callback(a){function d(){var b=[],c;for(c=0;c<a.confirm.length;c++)b.push(a.confirm[c].text);confirm_dialog({message:b,ok_cb:function(){a.confirm&&delete a.confirm,call_fid(a.FID,{callback:widget_traffic_callback}.extend(a||{}),[])}});return}function c(){}function b(){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\n";alert(c)}}if(a.error&&typeof a.error=="object")b();else{if(a.confirm&&typeof a.confirm=="object"){d();return}a.success&&typeof a.success=="object"&&c()}}function show_grid(a){var b=$("GRID_"+a+"_CONTAINER");b.style.position="relative",b.style.visibility="visible"}function hide_grid(a){var b=$("GRID_"+a+"_CONTAINER");b.style.position="absolute",b.style.visibility="hidden"}function auto_hide_element(a,b){var c;b?c=b:config.hide_element_timeout?c=config.hide_element_timeout:c=1e4,$(a)&&!auto_hide_elements[a]&&(auto_hide_elements[a]=self.setTimeout(function(){$(a)&&(auto_hide_elements[a]&&(self.clearTimeout(auto_hide_elements[a]),auto_hide_elements[a]=null),$(a).innerHTML="")},c))}function ipcalc_netmask_bits_to_array(a){var b=[255,255,255,255],c=3;while(a<32)b[c]<<=1,b[c]&=255,b[c]===0&&c--,a++;return b}function ipcalc_bcast_address(a,b){var c=ipcalc_netmask_bits_to_array(b),d=a.split(".");return d.collect(function(a,b){return a|c[b]^255})}function ipcalc_base_address(a,b){var c=ipcalc_netmask_bits_to_array(b),d=a.split(".");return d.collect(function(a,b){return a&c[b]})}function ipcalc_last_useable(a,b){var c=ipcalc_bcast_address(a,b);c[3]--;return c.join(".")}function ipcalc_first_useable(a,b){var c=ipcalc_base_address(a,b);c[3]++;return c.join(".")}function get_mini_status_icon(a,b){b||(b="status");var c=get_object(a);return domTableRow([domTd({},{},{},domImg({},{src:"core/img/blank1x1.gif",className:c.data[b]?"TRAFFIC_LIGHT_SMALL_GREEN":"TRAFFIC_LIGHT_SMALL_OFF"},{})),domTd({},{},{},domImg({},{src:"core/img/blank1x1.gif",className:c.data[b]?"TRAFFIC_LIGHT_SMALL_OFF":"TRAFFIC_LIGHT_SMALL_RED"},{}))])}function get_status_icon(a,b){b||(b="status");var c=get_object(a),d=Builder.node("div",{title:c.data[b]?_LOC("cESBhXYLFg","Status: Enabled"):_LOC("oCoHvFrBnw","Status: Disabled"),id:"status_slider_small",className:c.data[b]?"status_slider_small_on":"status_slider_small_off"});return $(d)}function object_sort(a){a.sort(function(a,b){var c=a.data.name.toLowerCase(),d=b.data.name.toLowerCase();if(c>d)return 1;if(c<d)return-1;return 0})}function object_sort_ref(a){var b=a.collect(function(a,b){return get_object(a)});object_sort(b);return b.collect(function(a,b){return a.ref})}function namelist(a){var b="";a.each(function(a,c){var d=get_object(a);d&&d.data.name.indexOf("REF_")!==0&&(b+=d.data.name+" ")});return b}function reload_wfe(){location.reload()}function keyDown(a){var b=a||window.event,c=document.all?window.event.keyCode:b.which,d="";b.keyCode>0&&(b.keyCode==13?focus_enter():(d=String.fromCharCode(b.keyCode),b.ctrlKey&&c!=17&&ctrl_keys[d]&&ctrl_keys[d](),b.altKey&&c!=18&&alt_keys[d]&&alt_keys[d]()));return!0}function setDebug(a){window.wdebug=a}function toggleDebug(){window.wdebug=!window.wdebug}function loadScript(a,b,c,d){return core.utils.scriptloader.require(a,b,c,d)}function wizard_flip(a,b){b.each(function(a,b){var c=$("GRID_"+a+"_CONTAINER");c&&(c.style.visibility="hidden")});var c=$("GRID_"+a+"_CONTAINER");c&&(c.style.visibility="visible")}function executive_report_archive_render(){var a,b,c;core.dropdownMap.archive_type&&core.dropdownMap.archive_year&&core.dropdownMap.archive_month&&(a=core.dropdownMap.archive_type.getValue(),b=core.dropdownMap.archive_year.getValue(),c=core.dropdownMap.archive_month.getValue(),a&&b&&c&&req_send({objs:[{FID:"executive_report_archive_render",type:a,year:b,month:c,target:"archive_display"}]}));var d=$("archive_display");d&&(d.innerHTML=_LOC("NeitlFNTDq","Please select a <b>type</b>, a <b>year</b> and a <b>month</b>."))}function log_archive_render(){var a=core.dropdownMap.archive_subsystem,b=core.dropdownMap.archive_year,c=core.dropdownMap.archive_month,d=$("archive_display");if(a&&b&&core.dropdownMap.archive_month){var e=a.getValue(),f=b.getValue(),g=c.getValue();e&&f&&g&&req_send({objs:[{FID:"log_archive_render",subsystem:e,year:f,month:g,target:"archive_display"}]})}d&&(d.innerHTML=_LOC("ETnuGKEIty","Please select a <b>subsystem</b>, a <b>year</b> and a <b>month</b>."))}function clearWindowName(a){while(a.match(/[\s-_]/))a=a.replace(/[\s-_]/,"");return a}function reload_log_form(a){var b={objs:[{FID:"logging_remote_logs",pagestate:a,remotetype:core.dropdownMap.remotetype.getValue()}]};req_send(b)}function fixedEncodeURIComponent(a){return encodeURIComponent(a).replace(/[!'()*]/g,escape)}function open_up2date_progressbar(){_debug("Up2Date Progress Bar Window has been triggered."),up2datepbwin=window.open(target_script+"?SID="+SID+"&up2datepb=1","up2datepbwindow","height=600,width=1000,resizable=yes,location=no,menubar=no,scrollbars=yes,status=no,toolbar=no"),core.openedWindows.push(up2datepbwin)}function manual_download(){var a=core.dropdownMap.manual.getValue();a&&req_send({objs:[{FID:"support_manual_get",language:a}]})}function open_support_window(a,b){var c=window.open(a,b);core.openedWindows.push(c),c.focus()}function rand_string(a){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",c="",d,e;a=a||10;for(d=0;d<a;d++)e=Math.floor(Math.random()*b.length),c+=b.substring(e,e+1);return c}function zeropad(a,b){b=b||5,a=""+a;var c=a,d;for(d=0;d<b-a.split("").length;d++)c="0"+c;return c}function focus_enter(){if(focus_element_id){var a=$(focus_element_id);a&&a.alt.length>0&&evaluate(a.alt)}}function focus_unregister(){focus_element_id=!1}function focus_register(a){focus_element_id=a.id}function toClientTimestamp(a){var b=new Date,c=b.getTimezoneOffset()*60,d=a+serverTimezoneOffset,e=d+c;return e}function $$(){return Selector.findChildElements(document,$A(arguments))}function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}typeof a=="string"&&(a=document.getElementById(a));return Element.extend(a)}function $H(a){if(a instanceof Hash)return a;return new Hash(a)}function $w(a){a=a.strip();return a?a.split(/\s+/):[]}(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){if(a instanceof x)return a;if(!(this instanceof x))return new x(a);this._wrapped=a};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.6.0";var y=x.each=x.forEach=function(a,b,d){if(a==null)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(b.call(d,a[e],e,a)===c)return}else{var g=x.keys(a);for(var e=0,f=g.length;e<f;e++)if(b.call(d,a[g[e]],g[e],a)===c)return}return a};x.map=x.collect=function(a,b,c){var d=[];if(a==null)return d;if(m&&a.map===m)return a.map(b,c);y(a,function(a,e,f){d.push(b.call(c,a,e,f))});return d};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n){d&&(b=x.bind(b,d));return e?a.reduce(b,c):a.reduce(b)}y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o){d&&(b=x.bind(b,d));return e?a.reduceRight(b,c):a.reduceRight(b)}var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)});if(!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;A(a,function(a,e,f){if(b.call(c,a,e,f)){d=a;return!0}});return d},x.filter=x.select=function(a,b,c){var d=[];if(a==null)return d;if(p&&a.filter===p)return a.filter(b,c);y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)});return d},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;if(a==null)return e;if(q&&a.every===q)return a.every(b,d);y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c});return!!e};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;if(a==null)return e;if(r&&a.some===r)return a.some(b,d);y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c});return!!e};x.contains=x.include=function(a,b){if(a==null)return!1;if(s&&a.indexOf===s)return a.indexOf(b)!=-1;return A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,x.property(b))},x.where=function(a,b){return x.filter(a,x.matches(b))},x.findWhere=function(a,b){return x.find(a,x.matches(b))},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-Infinity,e=-Infinity;y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)});return d},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=Infinity,e=Infinity;y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h<e&&(d=a,e=h)});return d},x.shuffle=function(a){var b,c=0,d=[];y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a});return d},x.sample=function(a,b,c){if(b==null||c){a.length!==+a.length&&(a=x.values(a));return a[x.random(a.length-1)]}return x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){if(a==null)return x.identity;if(x.isFunction(a))return a;return x.property(a)};x.sortBy=function(a,b,c){b=B(b);return x.pluck(x.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||c===void 0)return 1;if(c<d||d===void 0)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};c=B(c),y(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)});return e}};x.groupBy=C(function(a,b,c){x.has(a,b)?a[b].push(c):a[b]=[c]}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=B(c);var e=c.call(d,b),f=0,g=a.length;while(f<g){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){if(!a)return[];if(x.isArray(a))return h.call(a);if(a.length===+a.length)return x.map(a,x.identity);return x.values(a)},x.size=function(a){if(a==null)return 0;return a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){if(a==null)return void 0;if(b==null||c)return a[0];if(b<0)return[];return h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){if(a==null)return void 0;if(b==null||c)return a[a.length-1];return h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){if(b&&x.every(a,x.isArray))return i.apply(c,a);y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)});return c};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.partition=function(a,b){var c=[],d=[];y(a,function(a){(b(a)?c:d).push(a)});return[c,d]},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];y(e,function(c,d){if(b?!d||g[g.length-1]!==c:!x.contains(g,c))g.push(c),f.push(a[d])});return f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.contains(b,a)})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){var a=x.max(x.pluck(arguments,"length").concat(0)),b=Array(a);for(var c=0;c<a;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(a==null)return{};var c={};for(var d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d=0,e=a.length;if(c)if(typeof c=="number")d=c<0?Math.max(0,e+c):c;else{d=x.sortedIndex(a,b);return a[d]===b?d:-1}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(a==null)return-1;var d=c!=null;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);var e=d?c:a.length;while(e--)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);while(e<d)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;c=h.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));if(Object(f)===f)return f;return e}},x.partial=function(a){var b=h.call(arguments,1);return function(){var c=0,d=b.slice();for(var e=0,f=d.length;e<f;e++)d[e]===x&&(d[e]=arguments[c++]);while(c<arguments.length)d.push(arguments[c++]);return a.apply(this,d)}},x.bindAll=function(a){var b=h.call(arguments,1);if(b.length===0)throw new Error("bindAll must be passed function names");y(b,function(b){a[b]=x.bind(a[b],a)});return a},x.memoize=function(a,b){var c={};b||(b=x.identity);return function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:x.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=x.now();!h&&c.leading===!1&&(h=j);var k=b-(j-h);d=this,e=arguments,k<=0?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):!g&&c.trailing!==!1&&(g=setTimeout(i,k));return f}},x.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=x.now()-e;b>j?d=setTimeout(i,b-j):(d=null,c||(g=a.apply(h,f)),d||(f=h=null))},j=restArguments(function(j){h=this,f=j,e=x.now(),d||(d=setTimeout(i,b),c&&(g=a.apply(h,f)));return g});j.cancel=function(){clearTimeout(d),d=f=h=null};return j},x.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0,c=a.apply(this,arguments),a=null;return c}},x.wrap=function(a,b){return x.partial(b,a)},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},x.keys=function(a){if(!x.isObject(a))return[];if(v)return v(a);var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=x.keys(a),c=b.length,d=Array(c);for(var e=0;e<c;e++)d[e]=a[b[e]];return d},x.pairs=function(a){var b=x.keys(a),c=b.length,d=Array(c);for(var e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){var b={},c=x.keys(a);for(var d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));y(c,function(c){c in a&&(b[c]=a[c])});return b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]===void 0&&(a[c]=b[c])});return a},x.clone=function(a){if(!x.isObject(a))return a;return x.isArray(a)?a.slice():x.extend({},a)},x.tap=function(a,b){b(a);return a};var F=function(a,b,c,d){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var f=c.length;while(f--)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if(e=="[object Array]"){i=a.length,k=i==b.length;if(k)while(i--)if(!(k=F(a[i],b[i],c,d)))break}else{for(var l in a)if(x.has(a,l)){i++;if(!(k=x.has(b,l)&&F(a[l],b[l],c,d)))break}if(k){for(l in b)if(x.has(b,l)&&!(i--))break;k=!i}}c.pop(),d.pop();return k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(a==null)return!0;if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType===1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!x.has(a,"callee")}),typeof /./!="function"&&(x.isFunction=function(a){return typeof a=="function"}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){a._=b;return this},x.identity=function(a){return a},x.constant=function(a){return function(){return a}},x.property=function(a){return function(b){return b[a]}},x.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},x.times=function(a,b,c){var d=Array(Math.max(0,a));for(var e=0;e<a;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){b==null&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))},x.now=Date.now||function(){return(new Date).getTime()};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){if(b==null)return"";return(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(a==null)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];g.apply(a,arguments);return N.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g,M=/^\s*(\w|\$)+\s*$/;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length;return b}),g+="';\n";var h=c.variable;if(h){if(!M.test(h))throw new Error("variable is not a bare identifier: "+h)}else g="with(obj||{}){\n"+g+"}\n",h="obj";g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(h,"_",g)}catch(i){i.source=g;throw i}if(b)return d(b,x);var j=function(a){return d.call(this,a,x)};j.source="function("+h+"){\n"+g+"}";return j},x.chain=function(a){return x(a).chain()};var N=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments),(a=="shift"||a=="splice")&&c.length===0&&delete c[0];return N.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return N.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}).call(this);var Prototype={Version:"1.5.2.1.1",Browser:{IE:!!window.attachEvent&&!window.opera,Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1},BrowserFeatures:{XPath:!!document.evaluate,ElementExtensions:!!window.HTMLElement,SpecificElementExtensions:document.createElement("div").__proto__!==document.createElement("form").__proto__},ScriptFragment:"<script[^>]*>([\\S\\s]*?)</script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};Array.from=function(a){if(!a)return[];if(a.toArray)return a.toArray();var b=[];for(var c=0,d=a.length;c<d;c++)b.push(a[c]);return b};var $A=Array.from,Class={create:function(){function c(){this.initialize.apply(this,arguments)}var a=null,b=$A(arguments);Object.isFunction(b[0])&&(a=b.shift()),Object.extend(c,Class.Methods),c.superclass=a,c.subclasses=[];if(a){var d=function(){};d.prototype=a.prototype,c.prototype=new d,a.subclasses.push(c)}for(var e=0;e<b.length;e++)c.addMethods(b[e]);c.prototype.initialize||(c.prototype.initialize=Prototype.emptyFunction),c.prototype.constructor=c;return c}};Class.Methods={addMethods:function(a){var b=this.superclass&&this.superclass.prototype,c=Object.keys(a);Object.keys({toString:!0}).length||c.push("toString","valueOf");for(var d=0,e=c.length;d<e;d++){var f=c[d],g=a[f];if(b&&Object.isFunction(g)&&g.argumentNames().first()=="$super"){var h=g,g=function(a){return function(){return b[a].apply(this,arguments)}}(f).wrap(h);g.valueOf=h.valueOf.bind(h),g.toString=h.toString.bind(h)}this.prototype[f]=g}return this}};var Abstract=new Object;Object.extend=function(a,b){for(var c in b)a[c]=b[c];return a},Object.extend(Object,{inspect:function(a){try{if(a===undefined)return"undefined";if(a===null)return"null";return a.inspect?a.inspect():a.toString()}catch(b){if(b instanceof RangeError)return"...";throw b}},toJSON:function(a){var b=typeof a;switch(b){case"undefined":case"function":case"unknown":return;case"boolean":return a.toString()}if(a===null)return"null";if(a.toJSON)return a.toJSON();if(a.ownerDocument!==document){var c=[];for(var d in a){var e=Object.toJSON(a[d]);e!==undefined&&c.push(d.toJSON()+": "+e)}return"{"+c.join(", ")+"}"}},keys:function(a){var b=[];for(var c in a)b.push(c);return b},values:function(a){var b=[];for(var c in a)b.push(a[c]);return b},clone:function(a){return Object.extend({},a)},isElement:function(a){return!!a&&a.nodeType==1},isArray:function(a){return a!==null&&typeof a=="object"&&"splice"in a&&"join"in a},isHash:function(a){return!!(a&&a instanceof Hash)},isFunction:function(a){return typeof a=="function"&&typeof a.call=="function"},isString:function(a){return typeof a=="string"},isNumber:function(a){return typeof a=="number"&&isFinite(a)},isUndefined:function(a){return typeof a=="undefined"}}),Object.extend(Function.prototype,{argumentNames:function(){var a=Function.prototype.toString.call(this).match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,"").split(",");return a.length==1&&!a[0]?[]:a},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var a=this,b=$A(arguments),c=b.shift();return function(){return a.apply(c,b.concat($A(arguments)))}},bindAsEventListener:function(){var a=this,b=$A(arguments),c=b.shift();return function(d){return a.apply(c,[d||window.event].concat(b))}},curry:function(){if(!arguments.length)return this;var a=this,b=$A(arguments);return function(){return a.apply(this,b.concat($A(arguments)))}},delay:function(){var a=this,b=$A(arguments),c=b.shift()*1e3;return window.setTimeout(function(){return a.apply(a,b)},c)},defer:function(){var a=[.01].concat($A(arguments));return this.delay.apply(this,a)},wrap:function(a){var b=this;return function(){return a.apply(this,[b.bind(this)].concat($A(arguments)))}},methodize:function(){if(this._methodized)return this._methodized;var a=this;return this._methodized=function(){return a.apply(null,[this].concat($A(arguments)))}}}),Object.extend(Number.prototype,{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(a){$R(0,this,!0).each(a);return this},toPaddedString:function(a,b){var c=this.toString(b||10);return"0".times(a-c.length)+c},toJSON:function(){return isFinite(this)?this.toString():"null"}}),Date.prototype.toJSON=function(){return'"'+this.getFullYear()+"-"+(this.getMonth()+1).toPaddedString(2)+"-"+this.getDate().toPaddedString(2)+"T"+this.getHours().toPaddedString(2)+":"+this.getMinutes().toPaddedString(2)+":"+this.getSeconds().toPaddedString(2)+'"'};var Try={these:function(){var a;for(var b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a}},PeriodicalExecuter=Class.create();PeriodicalExecuter.prototype={initialize:function(a,b){this.callback=a,this.frequency=b,this.currentlyExecuting=!1,this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1e3)},stop:function(){!this.timer||(clearInterval(this.timer),this.timer=null)},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=!0,this.callback(this)}finally{this.currentlyExecuting=!1}}},Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}}),Object.extend(String.prototype,{gsub:function(a,b){var c="",d=this,e;b=arguments.callee.prepareReplacement(b);while(d.length>0)(e=d.match(a))?(c+=d.slice(0,e.index),c+=String.interpret(b(e)),d=d.slice(e.index+e[0].length)):(c+=d,d="");return c},sub:function(a,b,c){b=this.gsub.prepareReplacement(b),c=c===undefined?1:c;return this.gsub(a,function(a){if(--c<0)return a[0];return b(a)})},scan:function(a,b){this.gsub(a,b);return this},truncate:function(a,b){a=a||30,b=b===undefined?"...":b;return this.length>a?this.slice(0,a-b.length)+b:this},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")},extractScripts:function(){var a=new RegExp(Prototype.ScriptFragment,"img"),b=new RegExp(Prototype.ScriptFragment,"im");return(this.match(a)||[]).map(function(a){return(a.match(b)||["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(script){return eval(script)})},escapeHTML:function(a){var b=arguments.callee;b.text.data=this;if(a)return b.div.innerHTML.split('"').join("&quot;");return b.div.innerHTML},unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags();return a.childNodes[0]?a.childNodes.length>1?$A(a.childNodes).inject("",function(a,b){return a+b.nodeValue}):a.childNodes[0].nodeValue:""},toQueryParams:function(a){var b=this.strip().match(/([^?#]*)(#.*)?$/);if(!b)return{};return b[1].split(a||"&").inject({},function(a,b){if((b=b.split("="))[0]){var c=decodeURIComponent(b.shift()),d=b.length>1?b.join("="):b[0];d!=undefined&&(d=decodeURIComponent(d)),c in a?(a[c].constructor!=Array&&(a[c]=[a[c]]),a[c].push(d)):a[c]=d}return a})},toArray:function(){return this.split("")},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)},times:function(a){var b="";for(var c=0;c<a;c++)b+=this;return b},camelize:function(){var a=this.split("-"),b=a.length;if(b==1)return a[0];var c=this.charAt(0)=="-"?a[0].charAt(0).toUpperCase()+a[0].substring(1):a[0];for(var d=1;d<b;d++)c+=a[d].charAt(0).toUpperCase()+a[d].substring(1);return c},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},underscore:function(){return this.gsub(/::/,"/").gsub(/([A-Z]+)([A-Z][a-z])/,"#{1}_#{2}").gsub(/([a-z\d])([A-Z])/,"#{1}_#{2}").gsub(/-/,"_").toLowerCase()},dasherize:function(){return this.gsub(/_/,"-")},inspect:function(a){var b=this.gsub(/[\x00-\x1f\\]/,function(a){var b=String.specialChar[a[0]];return b?b:"\\u00"+a[0].charCodeAt().toPaddedString(2,16)});if(a)return'"'+b.replace(/"/g,'\\"')+'"';return"'"+b.replace(/'/g,"\\'")+"'"},toJSON:function(){return this.inspect(!0)},unfilterJSON:function(a){return this.sub(a||Prototype.JSONFilter,"#{1}")},isJSON:function(){var a=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(a)},evalJSON:function(a){var b=this.unfilterJSON();try{if(!a||b.isJSON())return JSON.parse(b)}catch(c){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())},include:function(a){return this.indexOf(a)>-1},startsWith:function(a){return this.indexOf(a)===0},endsWith:function(a){var b=this.length-a.length;return b>=0&&this.lastIndexOf(a)===b},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)}}),(Prototype.Browser.WebKit||Prototype.Browser.IE)&&Object.extend(String.prototype,{escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}}),String.prototype.gsub.prepareReplacement=function(a){if(typeof a=="function")return a;var b=new Template(a);return function(a){return b.evaluate(a)}},String.prototype.parseQuery=String.prototype.toQueryParams,Object.extend(String.prototype.escapeHTML,{div:document.createElement("div"),text:document.createTextNode("")});with(String.prototype.escapeHTML)div.appendChild(text);var Template=Class.create();Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/,Template.prototype={initialize:function(a,b){this.template=a.toString(),this.pattern=b||Template.Pattern},evaluate:function(a){return this.template.gsub(this.pattern,function(b){var c=b[1];if(c=="\\")return b[2];return c+String.interpret(a[b[3]])})}};var $break={},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Enumerable={each:function(a){var b=0;try{this._each(function(c){a(c,b++)})}catch(c){if(c!=$break)throw c}return this},eachSlice:function(a,b){var c=-a,d=[],e=this.toArray();while((c+=a)<e.length)d.push(e.slice(c,c+a));return d.map(b)},all:function(a){var b=!0;this.each(function(c,d){b=b&&!!(a||Prototype.K)(c,d);if(!b)throw $break});return b},any:function(a){var b=!1;this.each(function(c,d){if(b=!!(a||Prototype.K)(c,d))throw $break});return b},collect:function(a){var b=[];this.each(function(c,d){b.push((a||Prototype.K)(c,d))});return b},detect:function(a){var b;this.each(function(c,d){if(a(c,d)){b=c;throw $break}});return b},findAll:function(a){var b=[];this.each(function(c,d){a(c,d)&&b.push(c)});return b},grep:function(a,b){var c=[];this.each(function(d,e){if(d){var f=d.toString();f.match(a)&&c.push((b||Prototype.K)(d,e))}});return c},include:function(a){var b=!1;this.each(function(c){if(c==a){b=!0;throw $break}});return b},inGroupsOf:function(a,b){b=b===undefined?null:b;return this.eachSlice(a,function(c){while(c.length<a)c.push(b);return c})},inject:function(a,b){this.each(function(c,d){a=b(a,c,d)});return a},invoke:function(a){var b=$A(arguments).slice(1);return this.map(function(c){return c[a].apply(c,b)})},max:function(a){var b;this.each(function(c,d){c=(a||Prototype.K)(c,d);if(b==undefined||c>=b)b=c});return b},min:function(a){var b;this.each(function(c,d){c=(a||Prototype.K)(c,d);if(b==undefined||c<b)b=c});return b},partition:function(a){var b=[],c=[];this.each(function(d,e){((a||Prototype.K)(d,e)?b:c).push(d)});return[b,c]},pluck:function(a){var b=[];this.each(function(c,d){b.push(c[a])});return b},reject:function(a){var b=[];this.each(function(c,d){a(c,d)||b.push(c)});return b},sortBy:function(a){return this.map(function(b,c){return{value:b,criteria:a(b,c)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}).pluck("value")},toArray:function(){return this.map()},zip:function(){var a=Prototype.K,b=$A(arguments);typeof b.last()=="function"&&(a=b.pop());var c=[this].concat(b).map($A);return this.map(function(b,d){return a(c.pluck(d))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+this.toArray().inspect()+">"}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray}),Prototype.Browser.WebKit&&($A=Array.from=function(a){if(!a)return[];if(typeof a=="function"&&a=="[object NodeList]"||!a.toArray){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(a[c]);return b}return a.toArray()}),Object.extend(Array.prototype,Enumerable),Array.prototype._reverse||(Array.prototype._reverse=Array.prototype.reverse),Object.extend(Array.prototype,{_each:function(a){for(var b=0,c=this.length;b<c;b++)a(this[b])},clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(a){return a!==null})},flatten:function(){return this.inject([],function(a,b){return a.concat(b&&b.constructor==Array?b.flatten():[b])})},without:function(){var a=$A(arguments);return this.select(function(b){return!a.include(b)})},indexOf:function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return b;return-1},reverse:function(a){return(a!==!1?this:this.toArray())._reverse()},reduce:function(){return this.length>1?this:this[0]},uniq:function(a){return this.inject([],function(b,c,d){(0==d||(a?b.last()!=c:!b.include(c)))&&b.push(c);return b})},clone:function(){return[].concat(this)},size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"},toJSON:function(){var a=[];this.each(function(b){var c=Object.toJSON(b);c!==undefined&&a.push(c)});return"["+a.join(", ")+"]"}}),Array.prototype.toArray=Array.prototype.clone,Prototype.Browser.Opera&&(Array.prototype.concat=function(){var a=[];for(var b=0,c=this.length;b<c;b++)a.push(this[b]);for(var b=0,c=arguments.length;b<c;b++)if(arguments[b].constructor==Array)for(var d=0,e=arguments[b].length;d<e;d++)a.push(arguments[b][d]);else a.push(arguments[b]);return a});var Hash=function(a){a instanceof Hash?this.merge(a):Object.extend(this,a||{})};Object.extend(Hash,{toQueryString:function(a){var b=[];b.add=arguments.callee.addPair,this.prototype._each.call(a,function(a){if(!!a.key){var c=a.value;if(c&&typeof c=="object"){c.constructor==Array&&c.each(function(c){b.add(a.key,c)});return}b.add(a.key,c)}});return b.join("&")},toJSON:function(a){var b=[];this.prototype._each.call(a,function(a){var c=Object.toJSON(a.value);c!==undefined&&b.push(a.key.toJSON()+": "+c)});return"{"+b.join(", ")+"}"}}),Hash.toQueryString.addPair=function(a,b,c){a=encodeURIComponent(a),b===undefined?this.push(a):this.push(a+"="+(b==null?"":encodeURIComponent(b)))},Object.extend(Hash.prototype,Enumerable),Object.extend(Hash.prototype,{_each:function(a){for(var b in this){var c=this[b];if(c&&c==Hash.prototype[b])continue;var d=[b,c];d.key=b,d.value=c,a(d)}},keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},merge:function(a){return $H(a).inject(this,function(a,b){a[b.key]=b.value;return a})},remove:function(){var a;for(var b=0,c=arguments.length;b<c;b++){var d=this[arguments[b]];d!==undefined&&(a===undefined?a=d:(a.constructor!=Array&&(a=[a]),a.push(d))),delete this[arguments[b]]}return a},toQueryString:function(){return Hash.toQueryString(this)},inspect:function(){return"#<Hash:{"+this.map(function(a){return a.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:function(){return Hash.toJSON(this)}});if(function(){var a=0,b=function(a){this.key=a};b.prototype.key="foo";for(var c in new b("bar"))a++;return a>1}())Hash.prototype._each=function(a){var b=[];for(var c in this){var d=this[c];if(d&&d==Hash.prototype[c]||b.include(c))continue;b.push(c);var e=[c,d];e.key=c,e.value=d,a(e)}};ObjectRange=Class.create(),Object.extend(ObjectRange.prototype,Enumerable),Object.extend(ObjectRange.prototype,{initialize:function(a,b,c){this.start=a,this.end=b,this.exclusive=c},_each:function(a){var b=this.start;while(this.include(b))a(b),b=b.succ()},include:function(a){if(a<this.start)return!1;if(this.exclusive)return a<this.end;return a<=this.end}});var $R=function(a,b,c){return new ObjectRange(a,b,c)},Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,d){this.each(function(e){if(typeof e[a]=="function")try{e[a].apply(e,[b,c,d])}catch(f){}})}},Object.extend(Ajax.Responders,Enumerable),Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}}),Ajax.Base=function(){},Ajax.Base.prototype={setOptions:function(a){this.options={method:"post",asynchronous:!0,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:""},Object.extend(this.options,a||{}),this.options.method=this.options.method.toLowerCase(),typeof this.options.parameters=="string"&&(this.options.parameters=this.options.parameters.toQueryParams())}},Ajax.Request=Class.create(),Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],Ajax.Request.prototype=Object.extend(new Ajax.Base,{_complete:!1,initialize:function(a,b){this.transport=Ajax.getTransport(),this.setOptions(b),this.request(a)},request:function(a){this.url=a,this.method=this.options.method;var b=Object.clone(this.options.parameters);["get","post"].include(this.method)||(b._method=this.method,this.method="post"),this.parameters=b;if(b=Hash.toQueryString(b))this.method=="get"?this.url+=(this.url.include("?")?"&":"?")+b:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(b+="&_=");try{this.options.onCreate&&this.options.onCreate(this.transport),Ajax.Responders.dispatch("onCreate",this,this.transport),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&setTimeout(function(){this.respondToReadyState(1)}.bind(this),10),this.transport.onreadystatechange=this.onStateChange.bind(this),this.setRequestHeaders(),this.body=this.method=="post"?this.options.postBody||b:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&(a!=4||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};this.method=="post"&&(a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(a.Connection="close"));if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(typeof b.push=="function")for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(b){a[b.key]=b.value})}for(var e in a){if(typeof a[e]!="string")continue;this.transport.setRequestHeader(e,a[e])}},success:function(){return!this.transport.status||this.transport.status>=200&&this.transport.status<300},respondToReadyState:function(a){var b=Ajax.Request.Events[a],c=this.transport,d=this.evalJSON();if(b=="Complete"){try{this._complete=!0,(this.options["on"+this.transport.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(c,d)}catch(e){this.dispatchException(e)}var f=this.getHeader("Content-type");f&&this.isSameOrigin()&&f.strip().match(/^(text|application)\/(x-)?(java|ecma)script(;.*)?$/i)&&this.evalResponse()}try{(this.options["on"+b]||Prototype.emptyFunction)(c,d),Ajax.Responders.dispatch("on"+b,this,c,d)}catch(e){this.dispatchException(e)}b=="Complete"&&(this.transport.onreadystatechange=Prototype.emptyFunction)},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]==(new Template("#{protocol}//#{domain}#{port}")).evaluate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)}catch(b){return null}},evalJSON:function(){try{var a=this.getHeader("X-JSON");return a?a.evalJSON(!this.isSameOrigin()):null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a),Ajax.Responders.dispatch("onException",this,a)}}),Ajax.Updater=Class.create(),Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(a,b,c){this.container={success:a.success||a,failure:a.failure||(a.success?null:a)},this.transport=Ajax.getTransport(),this.setOptions(c);var d=this.options.onComplete||Prototype.emptyFunction;this.options.onComplete=function(a,b){this.updateContent(),d(a,b)}.bind(this),this.request(b)},updateContent:function(){var a=this.container[this.success()?"success":"failure"],b=this.transport.responseText;this.options.evalScripts||(b=b.stripScripts());if(a=$(a))this.options.insertion?new this.options.insertion(a,b):a.update(b);this.success()&&this.onComplete&&setTimeout(this.onComplete.bind(this),10)}}),Ajax.PeriodicalUpdater=Class.create(),Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Base,{initialize:function(a,b,c){this.setOptions(c),this.onComplete=this.options.onComplete,this.frequency=this.options.frequency||2,this.decay=this.options.decay||1,this.updater={},this.container=a,this.url=b,this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this),this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined,clearTimeout(this.timer),(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(a){this.options.decay&&(this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1,this.lastText=a.responseText),this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1e3)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}}),Prototype.BrowserFeatures.XPath?(document._getElementsByXPath=function(a,b){var c=[],d=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var e=0,f=d.snapshotLength;e<f;e++)c.push(d.snapshotItem(e));return c},document.getElementsByClassName=function(a,b){var c=".//*[contains(concat(' ', @class, ' '), ' "+a+" ')]";return document._getElementsByXPath(c,b)}):document.getElementsByClassName=function(a,b){var c=($(b)||document.body).getElementsByTagName("*"),d=[],e,f=new RegExp("(^|\\s)"+a+"(\\s|$)");for(var g=0,h=c.length;g<h;g++){e=c[g];var i=e.className;if(i.length===0)continue;(i==a||i.match(f))&&d.push(Element.extend(e))}return d};if(!window.Element)var Element={};Element.extend=function(a){var b=Prototype.BrowserFeatures;if(!a||!a.tagName||a.nodeType==3||a._extended||b.SpecificElementExtensions||a==window)return a;var c={},d=a.tagName,e=Element.extend.cache,f=Element.Methods.ByTag;b.ElementExtensions||(Object.extend(c,Element.Methods),Object.extend(c,Element.Methods.Simulated)),f[d]&&Object.extend(c,f[d]);for(var g in c){var h=c[g];typeof h=="function"&&!(g in a)&&(a[g]=e.findOrStore(h))}a._extended=Prototype.emptyFunction;return a},Element.extend.cache={findOrStore:function(a){return this[a]=this[a]||function(){return a.apply(null,[this].concat($A(arguments)))}}},Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a),Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){$(a).style.display="none";return a},show:function(a){$(a).style.display="";return a},remove:function(a){a=$(a),a.parentNode.removeChild(a);return a},update:function(a,b){b=typeof b=="undefined"?"":b.toString(),$(a).innerHTML=b.stripScripts(),setTimeout(function(){b.evalScripts()},10);return a},replace:function(a,b){a=$(a),b=typeof b=="undefined"?"":b.toString();if(a.outerHTML)a.outerHTML=b.stripScripts();else{var c=a.ownerDocument.createRange();c.selectNodeContents(a),a.parentNode.replaceChild(c.createContextualFragment(b.stripScripts()),a)}setTimeout(function(){b.evalScripts()},10);return a},inspect:function(a){a=$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var d=c.first(),e=c.last(),f=(a[d]||"").toString();f&&(b+=" "+e+"="+f.inspect(!0))});return b+">"},recursivelyCollect:function(a,b){a=$(a);var c=[];while(a=a[b])a.nodeType==1&&c.push(Element.extend(a));return c},ancestors:function(a){return $(a).recursivelyCollect("parentNode")},descendants:function(a){return $A($(a).getElementsByTagName("*")).each(Element.extend)},firstDescendant:function(a){a=$(a).firstChild;while(a&&a.nodeType!=1)a=a.nextSibling;return $(a)},immediateDescendants:function(a){if(!(a=$(a).firstChild))return[];while(a&&a.nodeType!=1)a=a.nextSibling;if(a)return[a].concat($(a).nextSiblings());return[]},previousSiblings:function(a){return $(a).recursivelyCollect("previousSibling")},nextSiblings:function(a){return $(a).recursivelyCollect("nextSibling")},siblings:function(a){a=$(a);return a.previousSiblings().reverse().concat(a.nextSiblings())},match:function(a,b){typeof b=="string"&&(b=new Selector(b));return b.match($(a))},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var d=a.ancestors();return b?Selector.findElement(d,b,c):d[c||0]},down:function(a,b,c){a=$(a);if(arguments.length==1)return a.firstDescendant();var d=a.descendants();return b?Selector.findElement(d,b,c):d[c||0]},previous:function(a,b,c){a=$(a);if(arguments.length==1)return $(Selector.handlers.previousElementSibling(a));var d=a.previousSiblings();return b?Selector.findElement(d,b,c):d[c||0]},next:function(a,b,c){a=$(a);if(arguments.length==1)return $(Selector.handlers.nextElementSibling(a));var d=a.nextSiblings();return b?Selector.findElement(d,b,c):d[c||0]},getElementsBySelector:function(){var a=$A(arguments),b=$(a.shift());return Selector.findChildElements(b,a)},getElementsByClassName:function(a,b){return document.getElementsByClassName(b,a)},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){if(!a.attributes)return null;var c=Element._attributeTranslations;if(c.values[b])return c.values[b](a,b);c.names[b]&&(b=c.names[b]);var d=a.attributes[b];return d?d.nodeValue:null}return a.getAttribute(b)},getHeight:function(a){return $(a).getDimensions().height},getWidth:function(a){return $(a).getDimensions().width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(!!(a=$(a))){var c=a.className;if(c.length===0)return!1;if(c==b||c.match(new RegExp("(^|\\s)"+b+"(\\s|$)")))return!0;return!1}},addClassName:function(a,b){if(!!(a=$(a))){Element.classNames(a).add(b);return a}},removeClassName:function(a,b){if(!!(a=$(a))){Element.classNames(a).remove(b);return a}},toggleClassName:function(a,b){if(!!(a=$(a))){Element.classNames(a)[a.hasClassName(b)?"remove":"add"](b);return a}},observe:function(){Event.observe.apply(Event,arguments);return $A(arguments).first()},stopObserving:function(){Event.stopObserving.apply(Event,arguments);return $A(arguments).first()},cleanWhitespace:function(a){a=$(a);var b=a.firstChild;while(b){var c=b.nextSibling;b.nodeType==3&&!/\S/.test(b.nodeValue)&&a.removeChild(b),b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a),b=$(b);while(a=a.parentNode)if(a==b)return!0;return!1},scrollTo:function(a){a=$(a);var b=Position.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a),b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];if(!c){var d=document.defaultView.getComputedStyle(a,null);c=d?d[b]:null}if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,b,c){var d,e;a=$(a),d=a.style;for(e in b)typeof e!="function"&&(e=="opacity"?a.setOpacity(b[e]):d[e=="float"||e=="cssFloat"?d.styleFloat===undefined?"cssFloat":"styleFloat":c?e:e.camelize()]=b[e]);return a},setOpacity:function(a,b){a=$(a),a.style.opacity=b==1||b===""?"":b<1e-5?0:b;return a},getDimensions:function(a){a=$(a);var b=$(a).getStyle("display");if(b!="none"&&b!==null)return{width:a.offsetWidth,height:a.offsetHeight};var c=a.style,d=c.visibility,e=c.position,f=c.display;c.visibility="hidden",c.position="absolute",c.display="block";var g=a.clientWidth,h=a.clientHeight;c.display=f,c.position=e,c.visibility=d;return{width:g,height:h}},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b)a._madePositioned=!0,a.style.position="relative",window.opera&&(a.style.top=0,a.style.left=0);return a},undoPositioned:function(a){a=$(a),a._madePositioned&&(a._madePositioned=undefined,a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right="");return a},makeClipping:function(a){a=$(a);if(a._overflow)return a;a._overflow=a.style.overflow||"auto",(Element.getStyle(a,"overflow")||"visible")!="hidden"&&(a.style.overflow="hidden");return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=a._overflow=="auto"?"":a._overflow,a._overflow=null;return a},relativize:function(a){a=$(a);if(Element.getStyle(a,"position")==="relative")return a;if(!a._originalTop){var b=a.outerHTML&&a.innerHTML.blank();b&&(a.innerHTML=" "),Object.extend(a,{_originalTop:a.offsetTop||0,_originalLeft:a.offsetLeft||0,_originalWidth:Element.getStyle(a,"width"),_originalHeight:Element.getStyle(a,"height"),_originalMarginTop:Element.getStyle(a,"marginTop"),_originalMarginLeft:Element.getStyle(a,"marginLeft")}),b&&(a.innerHTML="")}Element.setStyle(a,{position:"relative",width:a._originalWidth,height:a._originalHeight,marginTop:a._originalMarginTop,marginLeft:a._originalMarginLeft});var c=a.positionedOffset(),d=a._originalTop-c.top,e=a._originalLeft-c.left,f=/^(auto|)$/;f.test(a.style.top)||(d+=a._originalTop),f.test(a.style.left)||(e+=a._originalLeft),Element.setStyle(a,{top:d+"px",left:e+"px"});return a},getOffsetParent:function(a){a=$(a);if(a.sourceIndex<1)return $(document.body);var b=a.offsetParent,c=document.documentElement;if(b&&b!==c&&Element.getStyle(b,"position")!=="static")return $(b);while((a=a.parentNode)&&a!==c&&a!==document)if(Element.getStyle(a,"position")!=="static")return $(a);return $(document.body)}},Object.extend(Element.Methods,function(){function c(b,c,d){var e={},f;d==="height"?f=$w("borderTopWidth marginTop paddingTop borderBottomWidth marginBottom paddingBottom"):f=$w("borderLeftWidth marginLeft paddingLeft borderRightWidth marginRight paddingRight"),e[d]=Element.getDimensions(c)[d];for(var g=0,h,i;h=f[g];g++)h.include("margin")?(i=a(b,h),e[h]=i+(a(c,h)-i)+"px"):(i=a(c,h),e[h]=i+"px",e[d]-=i);e[d]+="px",Element.setStyle(b,e)}function b(a){var b=Element.getOffsetParent(a);if(b===document.body&&(a.sourceIndex<1||!a.offsetParent))return!1;return b}function a(a,b){return parseFloat(Element.getStyle(a,b))||0}return{cumulativeScrollOffset:function(a){a=$(a);var b=0,c=0,d=document;Prototype.Browser.Opera&&parseFloat(window.opera.version())<9.5&&a!==document.body&&(d=document.documentElement);if(Element.getStyle(a,"position")!=="fixed")while((a=a.parentNode)&&a.nodeType===1&&a!==d){if(Element.getStyle(a,"position")==="fixed")break;b+=a.scrollTop||0,c+=a.scrollLeft||0}return Element._returnOffset(c,b)},cumulativeOffset:function(a){a=$(a);var c=0,d=0;do c+=a.offsetTop||0,d+=a.offsetLeft||0;while(a=b(a));return Element._returnOffset(d,c)},positionedOffset:function(a){a=$(a);var c=0,d=0;do c+=a.offsetTop||0,d+=a.offsetLeft||0,a=b(a);while(a&&a!==document.body&&Element.getStyle(a,"position")==="static");return Element._returnOffset(d,c)},viewportOffset:function(a){a=$(a);var c,d=a,e=0,f=0;do{e+=d.offsetTop||0,f+=d.offsetLeft||0,c=b(d);if(c===document.body&&Element.getStyle(d,"position")==="absolute")break}while(d=c);var g=Element.cumulativeScrollOffset(a);e-=g.top,f-=g.left;return Element._returnOffset(f,e)},clonePosition:function(a,b){a=$(a),b=$(b);var d=Object.extend({setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0},arguments[2]||{}),e,f=[0,0];Element.getStyle(a,"position")=="absolute"&&(e=Element.getOffsetParent(a),f=Element.viewportOffset(e)),e==document.body&&(f[0]-=document.body.offsetLeft,f[1]-=document.body.offsetTop);var g=Element.viewportOffset(b);d.setWidth&&c(a,b,"width"),d.setHeight&&c(a,b,"height"),d.setLeft&&(a.style.left=g[0]-f[0]+d.offsetLeft+"px"),d.setTop&&(a.style.top=g[1]-f[1]+d.offsetTop+"px");return a}}}()),Object.extend(Element.Methods,{childOf:Element.Methods.descendantOf,childElements:Element.Methods.immediateDescendants}),Element._returnOffset=function(a,b){var c=[a,b];c.left=a,c.top=b;return c},Prototype.Browser.Opera?(Element.Methods._getStyle=Element.Methods.getStyle,Element.Methods.getStyle=function(a,b){switch(b){case"left":case"top":case"right":case"bottom":if(Element._getStyle(a,"position")=="static")return null;default:return Element._getStyle(a,b)}}):Prototype.Browser.IE?(Element.Methods.getStyle=function(a,b){a=$(a),b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();var c=a.style[b];!c&&a.currentStyle&&(c=a.currentStyle[b]);if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!="none")return a["offset"+b.capitalize()]+"px";return null}return c},Element.Methods.setOpacity=function(a,b){a=$(a);var c=a.getStyle("filter"),d=a.style;if(b==1||b===""){d.filter=c.replace(/alpha\([^\)]*\)/gi,"");return a}b<1e-5&&(b=0),d.filter=c.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+b*100+")";return a},Element.Methods.update=function(a,b){a=$(a),b=typeof b=="undefined"?"":b.toString();var c=a.tagName.toUpperCase();if(["THEAD","TBODY","TR","TD"].include(c)){var d=document.createElement("div");switch(c){case"THEAD":case"TBODY":d.innerHTML="<table><tbody>"+b.stripScripts()+"</tbody></table>",depth=2;break;case"TR":d.innerHTML="<table><tbody><tr>"+b.stripScripts()+"</tr></tbody></table>",depth=3;break;case"TD":d.innerHTML="<table><tbody><tr><td>"+b.stripScripts()+"</td></tr></tbody></table>",depth=4}$A(a.childNodes).each(function(b){a.removeChild(b)}),depth.times(function(){d=d.firstChild}),$A(d.childNodes).each(function(b){a.appendChild(b)})}else a.innerHTML=b.stripScripts();setTimeout(function(){b.evalScripts()},10);return a}):Prototype.Browser.Gecko&&(Element.Methods.setOpacity=function(a,b){a=$(a),a.style.opacity=b==1?.999999:b===""?"":b<1e-5?0:b;return a}),Element._attributeTranslations={names:{colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",datetime:"dateTime",accesskey:"accessKey",tabindex:"tabIndex",enctype:"encType",maxlength:"maxLength",readonly:"readOnly",longdesc:"longDesc"},values:{_getAttr:function(a,b){return a.getAttribute(b,2)},_flag:function(a,b){return $(a).hasAttribute(b)?b:null},style:function(a){return a.style.cssText.toLowerCase()},title:function(a){var b=a.getAttributeNode("title");return b.specified?b.nodeValue:null}}},function(){Object.extend(this,{href:this._getAttr,src:this._getAttr,type:this._getAttr,disabled:this._flag,checked:this._flag,readonly:this._flag,multiple:this._flag})}.call(Element._attributeTranslations.values),Element.Methods.Simulated={hasAttribute:function(a,b){var c=Element._attributeTranslations,d;b=c.names[b]||b,d=$(a).getAttributeNode(b);return d&&d.specified}},Element.Methods.ByTag={},Object.extend(Element,Element.Methods),!Prototype.BrowserFeatures.ElementExtensions&&document.createElement("div").__proto__&&(window.HTMLElement={},window.HTMLElement.prototype=document.createElement("div").__proto__,Prototype.BrowserFeatures.ElementExtensions=!0),Element.hasAttribute=function(a,b){if(a.hasAttribute)return a.hasAttribute(b);return Element.Methods.Simulated.hasAttribute(a,b)},Element.addMethods=function(a){function g(a){var b,c={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};c[a]&&(b="HTML"+c[a]+"Element");if(window[b])return window[b];b="HTML"+a+"Element";if(window[b])return window[b];b="HTML"+a.capitalize()+"Element";if(window[b])return window[b];window[b]={},window[b].prototype=document.createElement(a).__proto__;return window[b]}function f(a,b,c){c=c||!1;var d=Element.extend.cache;for(var e in a){var f=a[e];if(!c||!(e in b))b[e]=d.findOrStore(f)}}function e(b){b=b.toUpperCase(),Element.Methods.ByTag[b]||(Element.Methods.ByTag[b]={}),Object.extend(Element.Methods.ByTag[b],a)}var b=Prototype.BrowserFeatures,c=Element.Methods.ByTag;a||(Object.extend(Form,Form.Methods),Object.extend(Form.Element,Form.Element.Methods),Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)}));if(arguments.length==2){var d=a;a=arguments[1]}d?d.constructor==Array?d.each(e):e(d):Object.extend(Element.Methods,a||{}),b.ElementExtensions&&(f(Element.Methods,HTMLElement.prototype),f(Element.Methods.Simulated,HTMLElement.prototype,!0));if(b.SpecificElementExtensions)for(var h in Element.Methods.ByTag){var i=g(h);if(typeof i=="undefined")continue;f(c[h],i.prototype)}Object.extend(Element,Element.Methods),delete Element.ByTag};var Toggle={display:Element.toggle};Abstract.Insertion=function(a){this.adjacency=a},Abstract.Insertion.prototype={initialize:function(a,b){this.element=$(a),this.content=b.stripScripts();if(this.adjacency&&this.element.insertAdjacentHTML)try{this.element.insertAdjacentHTML(this.adjacency,this.content)}catch(c){var d=this.element.tagName.toUpperCase();if(["TBODY","TR"].include(d))this.insertContent(this.contentFromAnonymousTable());else throw c}else this.range=this.element.ownerDocument.createRange(),this.initializeRange&&this.initializeRange(),this.insertContent([this.range.createContextualFragment(this.content)]);setTimeout(function(){b.evalScripts()},10)},contentFromAnonymousTable:function(){var a=document.createElement("div");a.innerHTML="<table><tbody>"+this.content+"</tbody></table>";return $A(a.childNodes[0].childNodes[0].childNodes)}};var Insertion=new Object;Insertion.Before=Class.create(),Insertion.Before.prototype=Object.extend(new Abstract.Insertion("beforeBegin"),{initializeRange:function(){this.range.setStartBefore(this.element)},insertContent:function(a){a.each(function(a){this.element.parentNode.insertBefore(a,this.element)}.bind(this))}}),Insertion.Top=Class.create(),Insertion.Top.prototype=Object.extend(new Abstract.Insertion("afterBegin"),{initializeRange:function(){this.range.selectNodeContents(this.element),this.range.collapse(!0)},insertContent:function(a){a.reverse(!1).each(function(a){this.element.insertBefore(a,this.element.firstChild)}.bind(this))}}),Insertion.Bottom=Class.create(),Insertion.Bottom.prototype=Object.extend(new Abstract.Insertion("beforeEnd"),{initializeRange:function(){this.range.selectNodeContents(this.element),this.range.collapse(this.element)},insertContent:function(a){a.each(function(a){this.element.appendChild(a)}.bind(this))}}),Insertion.After=Class.create(),Insertion.After.prototype=Object.extend(new Abstract.Insertion("afterEnd"),{initializeRange:function(){this.range.setStartAfter(this.element)},insertContent:function(a){a.each(function(a){this.element.parentNode.insertBefore(a,this.element.nextSibling)}.bind(this))}}),Element.ClassNames=Class.create(),Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(a){return a.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){!this.include(a)||this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}},Object.extend(Element.ClassNames.prototype,Enumerable);var Selector=Class.create();Selector.prototype={initialize:function(a){this.expression=a.strip(),this.compileMatcher()},compileMatcher:function(){if(Prototype.BrowserFeatures.XPath&&!/\[[\w-]*?:/.test(this.expression))return this.compileXPathMatcher();var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m;if(Selector._cache[e])this.matcher=Selector._cache[e];else{this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&/\S/.test(e)){le=e;for(var i in ps){p=ps[i];if(m=e.match(p)){this.matcher.push(typeof c[i]=="function"?c[i](m):(new Template(c[i])).evaluate(m)),e=e.replace(m[0],"");break}}}this.matcher.push("return h.unique(n);\n}"),eval(this.matcher.join("\n")),Selector._cache[this.expression]=this.matcher}},compileXPathMatcher:function(){var a=this.expression,b=Selector.patterns,c=Selector.xpath,d,e;if(Selector._cache[a])this.xpath=Selector._cache[a];else{this.matcher=[".//*"];while(a&&d!=a&&/\S/.test(a)){d=a;for(var f in b)if(e=a.match(b[f])){this.matcher.push(typeof c[f]=="function"?c[f](e):(new Template(c[f])).evaluate(e)),a=a.replace(e[0],"");break}}this.xpath=this.matcher.join(""),Selector._cache[this.expression]=this.xpath}},findElements:function(a){a=a||document;if(this.xpath)return document._getElementsByXPath(this.xpath,a);return this.matcher(a)},match:function(a){return this.findElements(document).include(a)},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+">"}},Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(a){if(a[1]=="*")return"";return"[local-name()='"+a[1].toLowerCase()+"' or local-name()='"+a[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:"[@#{1}]",attr:function(a){a[3]=a[5]||a[6];return(new Template(Selector.xpath.operators[a[2]])).evaluate(a)},pseudo:function(a){var b=Selector.xpath.pseudos[a[1]];if(!b)return"";if(typeof b=="function")return b(a);return(new Template(Selector.xpath.pseudos[a[1]])).evaluate(a)},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0 or translate(text(), ' \t\r\n', '') = '')]",checked:"[@checked]",disabled:"[@disabled]",enabled:"[not(@disabled)]",not:function(a){var b=a[6],c=Selector.patterns,d=Selector.xpath,e,a,f,g=[];while(b&&e!=b&&/\S/.test(b)){e=b;for(var h in c)if(a=b.match(c[h])){f=typeof d[h]=="function"?d[h](a):(new Template(d[h])).evaluate(a),g.push("("+f.substring(1,f.length-1)+")"),b=b.replace(a[0],"");break}}return"[not("+g.join(" and ")+")]"},"nth-child":function(a){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",a)},"nth-last-child":function(a){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",a)},"nth-of-type":function(a){return Selector.xpath.pseudos.nth("position() ",a)},"nth-last-of-type":function(a){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",a)},"first-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-of-type"](a)},"last-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](a)},"only-of-type":function(a){var b=Selector.xpath.pseudos;return b["first-of-type"](a)+b["last-of-type"](a)},nth:function(a,b){var c,d=b[6],e;d=="even"&&(d="2n+0"),d=="odd"&&(d="2n+1");if(c=d.match(/^(\d+)$/))return"["+a+"= "+c[1]+"]";if(c=d.match(/^(-?\d*)?n(([+-])(\d+))?/)){c[1]=="-"&&(c[1]=-1);var f=c[1]?Number(c[1]):1,g=c[2]?Number(c[2]):0;e="[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]";return(new Template(e)).evaluate({fragment:a,a:f,b:g})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);   c = false;',className:'n = h.className(n, r, "#{1}", c); c = false;',id:'n = h.id(n, r, "#{1}", c);        c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}"); c = false;',attr:function(a){a[3]=a[5]||a[6];return(new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}"); c = false;')).evaluate(a)},pseudo:function(a){a[6]&&(a[6]=a[6].replace(/"/g,'\\"'));return(new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;')).evaluate(a)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:{laterSibling:/^\s*~\s*/,child:/^\s*>\s*/,adjacent:/^\s*\+\s*/,descendant:/^\s/,tagName:/^\s*(\*|[\w\-]+)(\b|$)?/,id:/^#([\w\-\*]+)(\b|$)/,className:/^\.([\w\-\*]+)(\b|$)/,pseudo:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|\s|(?=:))/,attrPresence:/^\[([\w]+)\]/,attr:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\]]*?)\4|([^'"][^\]]*?)))?\]/},handlers:{concat:function(a,b){for(var c=0,d;d=b[c];c++)a.push(d);return a},mark:function(a){for(var b=0,c;c=a[b];b++)c._counted=!0;return a},unmark:function(a){for(var b=0,c;c=a[b];b++)c._counted=undefined;return a},index:function(a,b,c){a._counted=!0;if(b)for(var d=a.childNodes,e=d.length-1,f=1;e>=0;e--)node=d[e],node.nodeType==1&&(!c||node._counted)&&(node.nodeIndex=f++);else for(var e=0,f=1,d=a.childNodes;node=d[e];e++)node.nodeType==1&&(!c||node._counted)&&(node.nodeIndex=f++)},unique:function(a){if(a.length===0)return a;var b=[],c;for(var d=0,e=a.length;d<e;d++)(c=a[d])._counted||(c._counted=!0,b.push(Element.extend(c)));return Selector.handlers.unmark(b)},descendant:function(a){var b=Selector.handlers;for(var c=0,d=[],e;e=a[c];c++)b.concat(d,e.getElementsByTagName("*"));return d},child:function(a){var b=Selector.handlers;for(var c=0,d=[],e;e=a[c];c++)for(var f=0,g=[],h;h=e.childNodes[f];f++)h.nodeType==1&&h.tagName!="!"&&d.push(h);return d},adjacent:function(a){for(var b=0,c=[],d;d=a[b];b++){var e=this.nextElementSibling(d);e&&c.push(e)}return c},laterSibling:function(a){var b=Selector.handlers;for(var c=0,d=[],e;e=a[c];c++)b.concat(d,Element.nextSiblings(e));return d},nextElementSibling:function(a){while(a=a.nextSibling)if(a.nodeType==1)return a;return null},previousElementSibling:function(a){while(a=a.previousSibling)if(a.nodeType==1)return a;return null},tagName:function(a,b,c,d){c=c.toUpperCase();var e=[],f=Selector.handlers;if(a){if(d){if(d=="descendant"){for(var g=0,h;h=a[g];g++)f.concat(e,h.getElementsByTagName(c));return e}a=this[d](a);if(c=="*")return a}for(var g=0,h;h=a[g];g++)h.tagName.toUpperCase()==c&&e.push(h);return e}return b.getElementsByTagName(c)},id:function(a,b,c,d){var e=$(c),f=Selector.handlers;if(!a&&b==document)return e?[e]:[];if(a){if(d)if(d=="child"){for(var g=0,h;h=a[g];g++)if(e.parentNode==h)return[e]}else if(d=="descendant"){for(var g=0,h;h=a[g];g++)if(Element.descendantOf(e,h))return[e]}else if(d=="adjacent"){for(var g=0,h;h=a[g];g++)if(Selector.handlers.previousElementSibling(e)==h)return[e]}else a=f[d](a);for(var g=0,h;h=a[g];g++)if(h==e)return[e];return[]}return e&&Element.descendantOf(e,b)?[e]:[]},className:function(a,b,c,d){a&&d&&(a=this[d](a));return Selector.handlers.byClassName(a,b,c)},byClassName:function(a,b,c){a||(a=Selector.handlers.descendant([b]));var d=" "+c+" ";for(var e=0,f=[],g,h;g=a[e];e++){h=g.className;if(h.length===0)continue;(h==c||(" "+h+" ").include(d))&&f.push(g)}return f},attrPresence:function(a,b,c){var d=[];for(var e=0,f;f=a[e];e++)Element.hasAttribute(f,c)&&d.push(f);return d},attr:function(a,b,c,d,e){a||(a=b.getElementsByTagName("*"));var f=Selector.operators[e],g=[];for(var h=0,i;i=a[h];h++){var j=Element.readAttribute(i,c);if(j===null)continue;f(j,d)&&g.push(i)}return g},pseudo:function(a,b,c,d,e){a&&e&&(a=this[e](a)),a||(a=d.getElementsByTagName("*"));return Selector.pseudos[b](a,c,d)}},pseudos:{"first-child":function(a,b,c){for(var d=0,e=[],f;f=a[d];d++){if(Selector.handlers.previousElementSibling(f))continue;e.push(f)}return e},"last-child":function(a,b,c){for(var d=0,e=[],f;f=a[d];d++){if(Selector.handlers.nextElementSibling(f))continue;e.push(f)}return e},"only-child":function(a,b,c){var d=Selector.handlers;for(var e=0,f=[],g;g=a[e];e++)!d.previousElementSibling(g)&&!d.nextElementSibling(g)&&f.push(g);return f},"nth-child":function(a,b,c){return Selector.pseudos.nth(a,b,c)},"nth-last-child":function(a,b,c){return Selector.pseudos.nth(a,b,c,!0)},"nth-of-type":function(a,b,c){return Selector.pseudos.nth(a,b,c,!1,!0)},"nth-last-of-type":function(a,b,c){return Selector.pseudos.nth(a,b,c,!0,!0)},"first-of-type":function(a,b,c){return Selector.pseudos.nth(a,"1",c,!1,!0)},"last-of-type":function(a,b,c){return Selector.pseudos.nth(a,"1",c,!0,!0)},"only-of-type":function(a,b,c){var d=Selector.pseudos;return d["last-of-type"](d["first-of-type"](a,b,c),b,c)},getIndices:function(a,b,c){if(a===0)return b>0?[b]:[];return $R(1,c).inject([],function(c,d){0==(d-b)%a&&(d-b)/a>=0&&c.push(d);return c})},nth:function(a,b,c,d,e){if(a.length===0)return[];b=="even"&&(b="2n+0"),b=="odd"&&(b="2n+1");var f=Selector.handlers,g=[],h=[],i;f.mark(a);for(var j=0,k;k=a[j];j++)k.parentNode._counted||(f.index(k.parentNode,d,e),h.push(k.parentNode));if(b.match(/^\d+$/)){b=Number(b);for(var j=0,k;k=a[j];j++)k.nodeIndex==b&&g.push(k)}else if(i=b.match(/^(-?\d*)?n(([+-])(\d+))?/)){i[1]=="-"&&(i[1]=-1);var l=i[1]?Number(i[1]):1,m=i[2]?Number(i[2]):0,n=Selector.pseudos.getIndices(l,m,a.length);for(var j=0,k,o=n.length;k=a[j];j++)for(var p=0;p<o;p++)k.nodeIndex==n[p]&&g.push(k)}f.unmark(a),f.unmark(h);return g},empty:function(a,b,c){for(var d=0,e=[],f;f=a[d];d++){if(f.tagName=="!"||f.firstChild&&!f.innerHTML.match(/^\s*$/))continue;e.push(f)}return e},not:function(a,b,c){var d=Selector.handlers,e,f,g=(new Selector(b)).findElements(c);d.mark(g);for(var h=0,i=[],j;j=a[h];h++)j._counted||i.push(j);d.unmark(g);return i},enabled:function(a,b,c){for(var d=0,e=[],f;f=a[d];d++)f.disabled||e.push(f);return e},disabled:function(a,b,c){for(var d=0,e=[],f;f=a[d];d++)f.disabled&&e.push(f);return e},checked:function(a,b,c){for(var d=0,e=[],f;f=a[d];d++)f.checked&&e.push(f);return e}},operators:{"=":function(a,b){return a==b},"!=":function(a,b){return a!=b},"^=":function(a,b){return a.startsWith(b)},"$=":function(a,b){return a.endsWith(b)},"*=":function(a,b){return a.include(b)},"~=":function(a,b){return(" "+a+" ").include(" "+b+" ")},"|=":function(a,b){return("-"+a.toUpperCase()+"-").include("-"+b.toUpperCase()+"-")}},matchElements:function(a,b){var c=(new Selector(b)).findElements(),d=Selector.handlers;d.mark(c);for(var e=0,f=[],g;g=a[e];e++)g._counted&&f.push(g);d.unmark(c);return f},findElement:function(a,b,c){typeof b=="number"&&(c=b,b=!1);return Selector.matchElements(a,b||"*")[c||0]},findChildElements:function(a,b){var c=b.join(","),b=[];c.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(a){b.push(a[1].strip())});var d=[],e=Selector.handlers;for(var f=0,g=b.length,h;f<g;f++)h=new Selector(b[f].strip()),e.concat(d,h.findElements(a));return g>1?e.unique(d):d}});var Form={reset:function(a){$(a).reset();return a},serializeElements:function(a,b){typeof b!="object"?b={hash:!!b}:Object.isUndefined(b.hash)&&(b.hash=!0);var c,d,e,f,g,h,i,j=b.submit,k=a.inject({},function(a,k){k=$(k),c=k.name,d=k.getValue(),e=k.type,f=e==="image",g=e==="submit"||f,i=e==="checkbox";if(d===null)return a;if(k.disabled)return a;if(e==="file"||e==="reset")return a;if(g&&(j===!1||h||j&&c!==j&&k!==j))return a;if(g){h=!0;if(f){var l=c?c+".":"",m=b.x||0,n=b.y||0;a[l+"x"]=m,a[l+"y"]=n;return a}}else if(!c)return a;c in a?(Object.isArray(a[c])||(a[c]=[a[c]]),a[c].push(d)):a[c]=d;return a});return b.hash?k:Object.toQueryString(k)}};Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){return $A($(a).getElementsByTagName("*")).inject([],function(a,b){Form.Element.Serializers[b.tagName.toLowerCase()]&&a.push(Element.extend(b));return a})},getInputs:function(a,b,c){a=$(a);var d=a.getElementsByTagName("input");if(!b&&!c)return $A(d).map(Element.extend);for(var e=0,f=[],g=d.length;e<g;e++){var h=d[e];if(b&&h.type!=b||c&&h.name!=c)continue;f.push(Element.extend(h))}return f},disable:function(a){a=$(a),Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a),Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){return $(a).getElements().find(function(a){return a.type!="hidden"&&!a.disabled&&["input","select","textarea"].include(a.tagName.toLowerCase())})},focusFirstElement:function(a){a=$(a),a.findFirstElement().activate();return a},request:function(a,b){a=$(a),b=Object.clone(b||{});var c=b.parameters;b.parameters=a.serialize(!0),c&&(typeof c=="string"&&(c=c.toQueryParams()),Object.extend(b.parameters,c)),a.hasAttribute("method")&&!b.method&&(b.method=a.method);return new Ajax.Request(a.readAttribute("action"),b)}},Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}},Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Hash.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus(),a.select&&(a.tagName.toLowerCase()!="input"||!["button","reset","submit"].include(a.type))&&a.select()}catch(b){}return a},disable:function(a){a=$(a),a.blur(),a.disabled=!0;return a},enable:function(a){a=$(a),a.disabled=!1;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(a){switch(a.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(a);default:return Form.Element.Serializers.textarea(a)}},inputSelector:function(a){return a.checked?a.value:"0"},textarea:function(a){return a.value},select:function(a){return this[a.type=="select-one"?"selectOne":"selectMany"](a)},selectOne:function(a){var b=a.selectedIndex;return b>=0?this.optionValue(a.options[b]):null},selectMany:function(a){var b,c=a.length;if(!c)return null;for(var d=0,b=[];d<c;d++){var e=a.options[d];e.selected&&b.push(this.optionValue(e))}return b},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}},Abstract.TimedObserver=function(){},Abstract.TimedObserver.prototype={initialize:function(a,b,c){this.frequency=b,this.element=$(a),this.callback=c,this.lastValue=this.getValue(),this.registerCallback()},registerCallback:function(){setInterval(this.onTimerEvent.bind(this),this.frequency*1e3)},onTimerEvent:function(){var a=this.getValue(),b="string"==typeof this.lastValue&&"string"==typeof a?this.lastValue!=a:String(this.lastValue)!=String(a);b&&(this.callback(this.element,a),this.lastValue=a)}},Form.Element.Observer=Class.create(),Form.Element.Observer.prototype=Object.extend(new Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.Observer=Class.create(),Form.Observer.prototype=Object.extend(new Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}}),Abstract.EventObserver=function(){},Abstract.EventObserver.prototype={initialize:function(a,b){this.element=$(a),this.callback=b,this.lastValue=this.getValue(),this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();this.lastValue!=a&&(this.callback(this.element,a),this.lastValue=a)},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback.bind(this))},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case"checkbox":case"radio":Event.observe(a,"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this))}}},Form.Element.EventObserver=Class.create(),Form.Element.EventObserver.prototype=Object.extend(new Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.EventObserver=Class.create(),Form.EventObserver.prototype=Object.extend(new Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});if(!window.Event)var Event=new Object;Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(a){return $(a.target||a.srcElement)},isLeftClick:function(a){return a.which&&a.which==1||a.button&&a.button==1},pointerX:function(a){return a.pageX||a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)},pointerY:function(a){return a.pageY||a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)},stop:function(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0)},findElement:function(a,b){var c=Event.element(a);while(c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase()))c=c.parentNode;return c},observers:!1,_observeAndCache:function(a,b,c,d){this.observers||(this.observers=[]),a.addEventListener?(this.observers.push([a,b,c,d]),a.addEventListener(b,c,d)):a.attachEvent&&(this.observers.push([a,b,c,d]),a.attachEvent("on"+b,c))},unloadCache:function(){if(!!Event.observers){for(var a=0,b=Event.observers.length;a<b;a++)Event.stopObserving.apply(this,Event.observers[a]),Event.observers[a][0]=null;Event.observers=!1}},observe:function(a,b,c,d){a=$(a),d=d||!1,b=="keypress"&&(Prototype.Browser.WebKit||a.attachEvent)&&(b="keydown"),Event._observeAndCache(a,b,c,d)},stopObserving:function(a,b,c,d){a=$(a),d=d||!1,b=="keypress"&&(Prototype.Browser.WebKit||a.attachEvent)&&(b="keydown");if(a.removeEventListener)a.removeEventListener(b,c,d);else if(a.detachEvent)try{a.detachEvent("on"+b,c)}catch(e){}}}),Prototype.Browser.IE&&Event.observe(window,"unload",Event.unloadCache,!1);var Position={includeScrollOffsets:!1,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},realOffset:function(a){var b=0,c=0;do b+=a.scrollTop||0,c+=a.scrollLeft||0,a=a.parentNode;while(a);return[c,b]},cumulativeOffset:function(a){var b=0,c=0;do{if(!a||a.nodeName=="BODY"||a.nodeName=="HTML")break;a.offsetTop&&(b+=a.offsetTop),a.offsetLeft&&(c+=a.offsetLeft);try{a&&a.offsetParent?a=a.offsetParent:a=!1}catch(d){_debug(d),a=!1}}while(a);return[c,b]},positionedOffset:function(a){var b=0,c=0;do{b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;if(a){if(a.tagName=="BODY")break;var d=Element.getStyle(a,"position");if(d=="relative"||d=="absolute")break}}while(a);return[c,b]},offsetParent:function(a){if(a.offsetParent)return a.offsetParent;if(a==document.body)return a;while((a=a.parentNode)&&a!=document.body)if(Element.getStyle(a,"position")!="static")return a;return document.body},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b,this.ycomp=c,this.offset=this.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var d=this.realOffset(a);this.xcomp=b+d[0]-this.deltaX,this.ycomp=c+d[1]-this.deltaY,this.offset=this.cumulativeOffset(a);return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},page:function(a){var b=0,c=0,d=a;do{b+=d.offsetTop||0,c+=d.offsetLeft||0;if(d.offsetParent==document.body&&Element.getStyle(d,"position")=="absolute")break}while(d=d.offsetParent);d=a;do if(!window.opera||d.tagName=="BODY")b-=d.scrollTop||0,c-=d.scrollLeft||0;while(d=d.parentNode);return[c,b]},clone:function(a,b){var c=Object.extend({setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0},arguments[2]||{});a=$(a);var d=Position.page(a);b=$(b);var e=[0,0],f=null;Element.getStyle(b,"position")=="absolute"&&(f=Position.offsetParent(b),e=Position.page(f)),f==document.body&&(e[0]-=document.body.offsetLeft,e[1]-=document.body.offsetTop),c.setLeft&&(b.style.left=d[0]-e[0]+c.offsetLeft+"px"),c.setTop&&(b.style.top=d[1]-e[1]+c.offsetTop+"px"),c.setWidth&&(b.style.width=a.offsetWidth+"px"),c.setHeight&&(b.style.height=a.offsetHeight+"px")},absolutize:function(a){a=$(a);if(a.style.position!="absolute"){Position.prepare();var b=Position.positionedOffset(a),c=b[1],d=b[0],e=a.clientWidth,f=a.clientHeight;a._originalLeft=d-parseFloat(a.style.left||0),a._originalTop=c-parseFloat(a.style.top||0),a._originalWidth=a.style.width,a._originalHeight=a.style.height,a.style.position="absolute",a.style.top=c+"px",a.style.left=d+"px",a.style.width=e+"px",a.style.height=f+"px"}},relativize:function(a){a=$(a);if(a.style.position!="relative"){Position.prepare(),a.style.position="relative";var b=parseFloat(a.style.top||0)-(a._originalTop||0),c=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=b+"px",a.style.left=c+"px",a.style.height=a._originalHeight,a.style.width=a._originalWidth}}};Prototype.Browser.WebKit&&(Position.cumulativeOffset=function(a){var b=0,c=0;do{b+=a.offsetTop||0,c+=a.offsetLeft||0;if(a.offsetParent==document.body&&Element.getStyle(a,"position")=="absolute")break;a=a.offsetParent}while(a);return[c,b]}),Element.addMethods(),Element.addMethods({hasPosition:function(a,b,c){a=$(a),this.topleft=Element.cumulativeOffset(a),this.bottomright=[this.topleft[0]+a.offsetWidth,this.topleft[1]+a.offsetHeight];return c>=this.topleft[1]&&c<this.bottomright[1]&&b>=this.topleft[0]&&b<this.bottomright[0]},bindEventsTo:function(a){var b;for(b in a)b.match(/^on(.+)/)&&typeof a[b]=="function"&&this.observe(RegExp.$1,a[b].bindAsEventListener(this))},writeAttribute:function(a,b,c){a=$(a);var d={};typeof b=="object"?d=b:d[b]=Object.isUndefined(c)?!0:c;for(var e in d)b=e,c=d[e],c===!1||c===null?a.removeAttribute(e):c===!0?a.setAttribute(e,e):a.setAttribute(e,c);return a},setDataset:function(a,b,c){a=$(a),browser==="ie"?a.writeAttribute("data-"+b,c):a.dataset[b]=c},getDataset:function(a,b){a=$(a);return browser==="ie"&&browser_version<11?a.readAttribute("data-"+b):a.dataset[b]}});var Keys=Class.create();Keys.prototype={MAX_DELAY:500,initialize:function(a,b,c,d){this.timerId=null,this.setKeys(a,b),this.onComplete=c||Prototype.emptyFunction,this.onReset=d||Prototype.emptyFunction,this.reset(),this.start()},setKeys:function(a,b){var c=0,d;b=b.toString().toUpperCase(),this.triggerkey=a,this.members=[],d=b.length;for(;c<d;)this.members[c]=b.charCodeAt(c++);this.keysWord=b},start:function(){this.bindedHandleKeyDown=this.handleKeyDown.bindAsEventListener(this),this.bindedHandleKeyUp=this.handleKeyUp.bindAsEventListener(this),Event.observe(document,"keydown",this.bindedHandleKeyDown),Event.observe(document,"keyup",this.bindedHandleKeyUp)},stop:function(){this.reset(),Event.stopObserving(document,"keydown",this.bindedHandleKeyDown),Event.stopObserving(document,"keyup",this.bindedHandleKeyUp)},handleKeyDown:function(a){a=this.extend_event(a);if(a.keyCode==this.triggerkey)this.lockedOn=!0;else if(this.lockedOn){var b=this.findInArray(this.members,a.keyCode);b==this.currentKey+1?(this.started||(this.started=!0),this.currentKey=b,this.currentKey==this.members.length-1&&this.onComplete()):(this.reset(),this.started&&this.onReset())}},handleKeyUp:function(a){a=this.extend_event(a);if(a.keyCode==this.triggerkey)this.reset(),this.started&&this.onReset();else if(this.lockedOn&&this.started){var b=this.findInArray(this.members,a.keyCode);b==this.currentKey&&this.currentKey--,this.started=!1}},reset:function(){this.currentMember=-1,this.currentKey=-1,this.lockedOn=!1,this.started=!1,this.timerId=null},setResetTimer:function(){this.killResetTimer(),this.timerId=window.setTimeout(this.reset.bind(this),this.MAX_DELAY)},killResetTimer:function(){this.timerId!==null&&(window.clearTimeout(this.timerId),this.timerId=null)},findInArray:function(a,b){var c=a.length,d=0;for(;d<c;d++)if(a[d]==b)return d;return-1},extend_event:function(a){!a&&window.event&&(a=window.event),a.preventDefault||(a.preventDefault=function(){this.returnValue=!1,this.keyCode=0});return a}},Keys.TRIGGERKEYS={SHIFT:16,CTRL:17,ALT:18},Object.extend(Array.prototype,{compare:function(){var a=$A(arguments[0]),b=this.length,c=a.length,d,e=!1;if(b!=c)return!1;for(d=0;d<b;d++){for(y=0;y<c;y++)if(this[d]==a[y]){e=!0;break}if(!e)return!1;e=!1}return!0},diff:function(a){var b=[],c=0,d,e=a.length,f,g=this.length;while(g&&e--){f=g;while(f--&&(d=a[e]!==this[f]));d&&(b[c++]=a[e])}return g?b:a},max:function(){var a=this[0];this.each(function(b){a=Math.max(b,a)}.bind(this));return a},min:function(){var a=this[0];this.each(function(b){a=Math.min(b,a)}.bind(this));return a}}),Array.prototype.some||(Array.prototype.some=function(a){var b=this.length;if(typeof a!="function")throw new TypeError;var c=arguments[1];for(var d=0;d<b;d++)if(d in this&&a.call(c,this[d],d,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(a){var b=this.length,c=[],d=arguments[1],e=0;if(typeof a!="function")throw new TypeError;for(;e<b;e++)if(e in this){var f=this[e];a.call(d,f,e,this)&&c.push(f)}return c}),Hash.prototype.without=function(){var a=$A(arguments),b=$H();this.each(function(c){a.include(c.key)||b.set(c.key,c.value)});return b};var Signal={throwErrors:!0,MT:function(){return!0},connect:function(a,b,c,d,e){e=Object.extend({connectOnce:!1,before:!1,mutate:function(){return arguments}},e||{});if(typeof b=="string"&&typeof d=="string"){var f=a||window,g=c||window,h=b+"__signal_",i=b+"__slots_";if(!f[h]){var j=function(){var a=[];for(var b=0;b<arguments.length;b++)a.push(arguments[b]);a=e.mutate.apply(null,a);var c;e.before||(c=f[h].apply(f,arguments)),f[i].each(function(b){try{b&&b[0]&&b[0][b[1]].apply(b[0],a)}catch(c){if(Signal.throwErrors)throw c}}),e.before&&(c=f[h].apply(f,arguments));return c};(function(){f[i]=$A([]),f[h]=f[b]||Signal.MT,f[b]=j})()}var k=f[i].length>0?e.connectOnce?!f[i].any(function(a){return a[0]==g&&a[1]==d}):!0:!0;k&&f[i].push([g,d])}},connectOnce:function(a,b,c,d,e){Signal.connect(a,b,c,d,Object.extend(e||{},{connectOnce:!0}))},disconnect:function(a,b,c,d,e){e=Object.extend({disconnectAll:!1},e||{});if(typeof b=="string"&&typeof d=="string"){var f=a||window,g=c||window,h=b+"__signal_",i=b+"__slots_";if(f[i])if(e.disconnectAll)f[i]=f[i].collect(function(a){if(a[0]==g&&a[1]==d){a[0]=null;return null}return a}).compact();else{var j=-1;f[i]=f[i].collect(function(a,b){if(a[0]==g&&a[1]==d&&j<0){j=b,a[0]=null;return null}return a}).compact()}}},disconnectAll:function(a,b,c,d,e){Signal.disconnect(a,b,c,d,Object.extend(e||{},{disconnectAll:!0}))}},Resizeable=Class.create({initialize:function(a){var b=Object.extend({top:6,bottom:6,left:6,right:6,minHeight:0,minWidth:0,zindex:1e3,resize:null,duringresize:null},arguments[1]||{});this.element=$(a),this.handle=this.element,Element.makePositioned(this.element),this.options=b,this.active=!1,this.resizing=!1,this.currentDirection="",this.eventMouseDown=this.startResize.bindAsEventListener(this),this.eventMouseUp=this.endResize.bindAsEventListener(this),this.eventMouseMove=this.update.bindAsEventListener(this),this.eventCursorCheck=this.cursor.bindAsEventListener(this),this.eventKeypress=this.keyPress.bindAsEventListener(this),this.registerEvents()},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown),this.unregisterEvents()},registerEvents:function(){Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"mousemove",this.eventMouseMove),Event.observe(document,"keypress",this.eventKeypress),Event.observe(this.handle,"mousedown",this.eventMouseDown),Event.observe(this.element,"mousemove",this.eventCursorCheck)},unregisterEvents:function(){},startResize:function(a){if(Event.isLeftClick(a)){var b=Event.element(a);if(b.tagName&&(b.tagName=="INPUT"||b.tagName=="SELECT"||b.tagName=="BUTTON"||b.tagName=="TEXTAREA"))return;var c=this.directions(a);if(c.length>0){this.active=!0;var d=Position.cumulativeOffset(this.element);this.startTop=d[1],this.startLeft=d[0],this.startWidth=parseInt(Element.getStyle(this.element,"width")),this.startHeight=parseInt(Element.getStyle(this.element,"height")),this.startX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.startY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop,this.currentDirection=c,Event.stop(a)}}},finishResize:function(a,b){this.active=!1,this.resizing=!1,this.options.zindex&&(this.element.style.zIndex=this.originalZ),this.options.resize&&this.options.resize(this.element)},keyPress:function(a){this.active&&a.keyCode==Event.KEY_ESC&&(this.finishResize(a,!1),Event.stop(a))},endResize:function(a){this.active&&this.resizing&&(this.finishResize(a,!0),Event.stop(a)),this.active=!1,this.resizing=!1},draw:function(a){var b=[Event.pointerX(a),Event.pointerY(a)],c=this.element.style,d,e,f,g;this.currentDirection.indexOf("n")!=-1&&(d=this.startY-b[1],e=Element.getStyle(this.element,"margin-top")||"0",f=this.startHeight+d,f>this.options.minHeight&&(c.height=f+"px",c.top=this.startTop-d-parseInt(e,10)+"px")),this.currentDirection.indexOf("w")!=-1&&(d=this.startX-b[0],e=Element.getStyle(this.element,"margin-left")||"0",g=this.startWidth+d,g>this.options.minWidth&&(c.left=this.startLeft-d-parseInt(e,10)+"px",c.width=g+"px")),this.currentDirection.indexOf("s")!=-1&&(f=this.startHeight+b[1]-this.startY,f>this.options.minHeight&&(c.height=f+"px")),this.currentDirection.indexOf("e")!=-1&&(g=this.startWidth+b[0]-this.startX,g>this.options.minWidth&&(c.width=g+"px")),c.visibility=="hidden"&&(c.visibility="")},between:function(a,b,c){return a>=b&&a<c},directions:function(a){var b=[Event.pointerX(a),Event.pointerY(a)],c=Position.cumulativeOffset(this.element),d="";this.between(b[1]-c[1],0,this.options.top)&&(d+="n"),this.between(c[1]+this.element.offsetHeight-b[1],0,this.options.bottom)&&(d+="s"),this.between(b[0]-c[0],0,this.options.left)&&(d+="w"),this.between(c[0]+this.element.offsetWidth-b[0],0,this.options.right)&&(d+="e");return d},cursor:function(a){var b=this.directions(a);b.length>0?b+="-resize":b="",this.element.style.cursor=b},update:function(a){if(this.active){if(!this.resizing){var b=this.element.style;this.resizing=!0,Element.getStyle(this.element,"position")===""&&(b.position="relative"),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0,10),b.zIndex=this.options.zindex)}this.draw(a),this.options.duringresize&&this.options.duringresize(this.element),navigator.appVersion.indexOf("AppleWebKit")>0&&window.scrollBy(0,0),Event.stop(a);return!1}}});document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}},function(a){function g(b){d||(d=f()),e[b]="client"+b,a["get"+b]=function(){return d[e[b]]};return a["get"+b]()}function f(){if(b.WebKit&&!c.evaluate)return document;if(b.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}var b=Prototype.Browser,c=document,d,e={};a.getWidth=g.curry("Width"),a.getHeight=g.curry("Height")}(document.viewport);var DateFormat=Class.create();Object.extend(DateFormat,{MONTH_NAMES:["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],LZ:function(a){return(a<0||a>9?"":"0")+a},compareDates:function(a,b,c,d){var e=DateFormat.parseFormat(a,b),f=DateFormat.parseFormat(c,d);if(e==0||f==0)return-1;if(e>f)return 1;return 0},format:function(a,b){b=b+"";var c="",d=0,e="",f="",g=a.getYear()+"",h=a.getMonth()+1,i=a.getDate(),j=a.getDay(),k=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),n,o,p,q,r,s,t,u,v,w,x,k,y,z,A,B,C=new Object;g.length<4&&(g=""+(g-0+1900)),C.y=""+g,C.yyyy=g,C.yy=g.substring(2,4),C.M=h,C.MM=DateFormat.LZ(h),C.MMM=DateFormat.MONTH_NAMES[h-1],C.NNN=DateFormat.MONTH_NAMES[h+11],C.d=i,C.dd=DateFormat.LZ(i),C.E=DateFormat.DAY_NAMES[j+7],C.EE=DateFormat.DAY_NAMES[j],C.H=k,C.HH=DateFormat.LZ(k),k==0?C.h=12:k>12?C.h=k-12:C.h=k,C.hh=DateFormat.LZ(C.h),k>11?C.K=k-12:C.K=k,C.k=k+1,C.KK=DateFormat.LZ(C.K),C.kk=DateFormat.LZ(C.k),k>11?C.a="PM":C.a="AM",C.m=l,C.mm=DateFormat.LZ(l),C.s=m,C.ss=DateFormat.LZ(m);while(d<b.length){e=b.charAt(d),f="";while(b.charAt(d)==e&&d<b.length)f+=b.charAt(d++);C[f]!=null?c+=C[f]:c+=f}return c},_isInteger:function(a){var b="1234567890",c=0;for(;c<a.length;c++)if(b.indexOf(a.charAt(c))==-1)return!1;return!0},_getInt:function(a,b,c,d){var e,f;for(e=d;e>=c;e--){f=a.substring(b,b+e);if(f.length<c)return null;if(DateFormat._isInteger(f))return f}return null},parseFormat:function(a,b){a=a+"",b=b+"";var c=0,d=0,e="",f="",g="",h,i,j=new Date,k=j.getYear(),l=j.getMonth()+1,m=1,n=j.getHours(),o=j.getMinutes(),p=j.getSeconds(),q="",r,s,t;while(d<b.length){e=b.charAt(d),f="";while(b.charAt(d)==e&&d<b.length)f+=b.charAt(d++);if(f=="yyyy"||f=="yy"||f=="y"){f=="yyyy"&&(h=4),i=4,f=="yy"&&(h=2),i=2,f=="y"&&(h=2),i=4,k=DateFormat._getInt(a,c,h,i);if(k==null)return 0;c+=k.length,k.length==2&&(k>70?k=1900+(k-0):k=2e3+(k-0))}else if(f=="MMM"||f=="NNN"){l=0;for(r=0;r<DateFormat.MONTH_NAMES.length;r++){s=DateFormat.MONTH_NAMES[r];if(a.substring(c,c+s.length).toLowerCase()==s.toLowerCase())if(f=="MMM"||f=="NNN"&&r>11){l=r+1,l>12&&(l-=12),c+=s.length;break}}if(l<1||l>12)return 0}else if(f=="EE"||f=="E")for(r=0;r<DateFormat.DAY_NAMES.length;r++){t=DateFormat.DAY_NAMES[r];if(a.substring(c,c+t.length).toLowerCase()==t.toLowerCase()){c+=t.length;break}}else if(f=="MM"||f=="M"){l=DateFormat._getInt(a,c,f.length,2);if(l==null||l<1||l>12)return 0;c+=l.length}else if(f=="dd"||f=="d"){m=DateFormat._getInt(a,c,f.length,2);if(m==null||m<1||m>31)return 0;c+=m.length}else if(f=="hh"||f=="h"){n=DateFormat._getInt(a,c,f.length,2);if(n==null||n<1||n>12)return 0;c+=n.length}else if(f=="HH"||f=="H"){n=DateFormat._getInt(a,c,f.length,2);if(n==null||n<0||n>23)return 0;c+=n.length}else if(f=="KK"||f=="K"){n=DateFormat._getInt(a,c,f.length,2);if(n==null||n<0||n>11)return 0;c+=n.length}else if(f=="kk"||f=="k"){n=DateFormat._getInt(a,c,f.length,2);if(n==null||n<1||n>24)return 0;c+=n.length,n--}else if(f=="mm"||f=="m"){o=DateFormat._getInt(a,c,f.length,2);if(o==null||o<0||o>59)return 0;c+=o.length}else if(f=="ss"||f=="s"){p=DateFormat._getInt(a,c,f.length,2);if(p==null||p<0||p>59)return 0;c+=p.length}else if(f=="a"){if(a.substring(c,c+2).toLowerCase()=="am")q="AM";else if(a.substring(c,c+2).toLowerCase()=="pm")q="PM";else return 0;c+=2}else{if(a.substring(c,c+f.length)!=f)return 0;c+=f.length}}if(c!=a.length)return 0;if(l==2)if(k%4==0&&k%100!=0||k%400==0){if(m>29)return 0}else if(m>28)return 0;if(l==4||l==6||l==9||l==11)if(m>30)return 0;n<12&&q=="PM"?n=n-0+12:n>11&&q=="AM"&&(n-=12);var u=new Date(k,l-1,m,n,o,p);return u},parse:function(a,b){if(b)return DateFormat.parseFormat(a,b);var c=arguments.length==2?arguments[1]:!1,d=["y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"],e=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],f=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"],g=[d,c?f:e,c?e:f],h=null,i,j,k;for(i=0;i<g.length;i++){j=g[i];for(k=0;k<j.length;k++){h=DateFormat.parseFormat(a,j[k]);if(h!=0)return new Date(h)}}return null}}),DateFormat.prototype={initialize:function(a){this.format=a},parse:function(a){return DateFormat.parseFormat(a,this.format)},format:function(a){return DateFormat.format(a,this.format)}},Date.prototype.format=function(a){return DateFormat.format(this,a)};var Draggables={drags:[],observers:[],register:function(a){this.drags.length===0&&(this.eventMouseUp=this.endDrag.bindAsEventListener(this),this.eventMouseMove=this.updateDrag.bindAsEventListener(this),this.eventKeypress=this.keyPress.bindAsEventListener(this),Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"mousemove",this.eventMouseMove),Event.observe(document,"keypress",this.eventKeypress)),this.drags.push(a)},unregister:function(a){this.drags=this.drags.reject(function(b){return b==a}),this.drags.length===0&&(Event.stopObserving(document,"mouseup",this.eventMouseUp),Event.stopObserving(document,"mousemove",this.eventMouseMove),Event.stopObserving(document,"keypress",this.eventKeypress))},activate:function(a){a.options.delay?this._timeout=setTimeout(function(){Draggables._timeout=null,window.focus(),Draggables.activeDraggable=a}.bind(this),a.options.delay):(window.focus(),this.activeDraggable=a)},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(!!this.activeDraggable){var b=[Event.pointerX(a),Event.pointerY(a)];if(this._lastPointer&&this._lastPointer.inspect()==b.inspect())return;this._lastPointer=b,this.activeDraggable.updateDrag(a,b)}},endDrag:function(a){this._timeout&&(clearTimeout(this._timeout),this._timeout=null);!this.activeDraggable||(this._lastPointer=null,this.activeDraggable.endDrag(a),this.activeDraggable=null)},keyPress:function(a){this.activeDraggable&&this.activeDraggable.keyPress(a)},addObserver:function(a){this.observers.push(a),this._cacheObserverCallbacks()},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b.element==a}),this._cacheObserverCallbacks()},notify:function(a,b,c){this[a+"Count"]>0&&this.observers.each(function(d){d[a]&&d[a](a,b,c)}),b.options[a]&&b.options[a](b,c)},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(a){Draggables[a+"Count"]=Draggables.observers.select(function(b){return b[a]}).length})}},Draggable=Class.create({initialize:function(a){var b={handle:!1,reverteffect:function(a,b,c){var d=Math.sqrt(Math.abs(b^2)+Math.abs(c^2))*.02},endeffect:function(a){var b=Object.isNumber(a._opacity)?a._opacity:1},zindex:1e3,revert:!1,quiet:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,snap:!1,delay:0};(!arguments[1]||Object.isUndefined(arguments[1].endeffect))&&Object.extend(b,{starteffect:function(a){a._opacity=Element.getOpacity(a),Draggable._dragging[a]=!0}});var c=Object.extend(b,arguments[1]||{});this.element=$(a),c.handle&&Object.isString(c.handle)&&(this.handle=this.element.down("."+c.handle,0)),this.handle||(this.handle=$(c.handle)),this.handle||(this.handle=this.element),c.scroll&&!c.scroll.scrollTo&&!c.scroll.outerHTML&&(c.scroll=$(c.scroll),this._isScrollChild=Element.childOf(this.element,c.scroll)),Element.makePositioned(this.element),this.options=c,this.dragging=!1,this.eventMouseDown=this.initDrag.bindAsEventListener(this),Event.observe(this.handle,"mousedown",this.eventMouseDown),this.handle.addClassName("draggable"),Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown),Draggables.unregister(this)},currentDelta:function(){return[parseInt(Element.getStyle(this.element,"left")||"0",10),parseInt(Element.getStyle(this.element,"top")||"0",10)]},initDrag:function(a){if(!!Object.isUndefined(Draggable._dragging[this.element])||!Draggable._dragging[this.element])if(Event.isLeftClick(a)){var b=Event.element(a);if((tag_name=b.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA"))return;var c=[Event.pointerX(a),Event.pointerY(a)],d=this.element.cumulativeOffset();this.offset=[0,1].map(function(a){return c[a]-d[a]}),Draggables.activate(this),Event.stop(a)}},startDrag:function(a){this.dragging=!0,this.delta||(this.delta=this.currentDelta()),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this._originallyAbsolute=this.element.getStyle("position")=="absolute",this._originallyAbsolute||Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element));if(this.options.scroll)if(this.options.scroll==window){var b=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=b.left,this.originalScrollTop=b.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;Draggables.notify("onStart",this,a)},updateDrag:function(a,b){this.dragging||this.startDrag(a),this.options.quiet||Position.prepare(),Draggables.notify("onDrag",this,a),this.draw(b),this.options.change&&this.options.change(this);if(this.options.scroll){this.stopScrolling();var c,d;this.options.scroll==window?(d=this._getWindowScroll(this.options.scroll),c=[d.left,d.top,d.left+d.width,d.top+d.height]):(c=Position.page(this.options.scroll),c[0]+=this.options.scroll.scrollLeft+Position.deltaX,c[1]+=this.options.scroll.scrollTop+Position.deltaY,c.push(c[0]+this.options.scroll.offsetWidth),c.push(c[1]+this.options.scroll.offsetHeight));var e=[0,0];b[0]<c[0]+this.options.scrollSensitivity&&(e[0]=b[0]-(c[0]+this.options.scrollSensitivity)),b[1]<c[1]+this.options.scrollSensitivity&&(e[1]=b[1]-(c[1]+this.options.scrollSensitivity)),b[0]>c[2]-this.options.scrollSensitivity&&(e[0]=b[0]-(c[2]-this.options.scrollSensitivity)),b[1]>c[3]-this.options.scrollSensitivity&&(e[1]=b[1]-(c[3]-this.options.scrollSensitivity)),this.startScrolling(e)}Prototype.Browser.WebKit&&window.scrollBy(0,0),Event.stop(a)},finishDrag:function(a,b){this.dragging=!1;if(this.options.quiet){Position.prepare();var c=[Event.pointerX(a),Event.pointerY(a)]}this.options.ghosting&&(this._originallyAbsolute||Position.relativize(this.element),delete this._originallyAbsolute,Element.remove(this._clone),this._clone=null);var d=!1;b&&(d||(d=!1)),d&&this.options.onDropped&&this.options.onDropped(this.element),Draggables.notify("onEnd",this,a);var e=this.options.revert;e&&Object.isFunction(e)&&(e=e(this.element));var f=this.currentDelta();e&&this.options.reverteffect?(d===0||e!="failure")&&this.options.reverteffect(this.element,f[1]-this.delta[1],f[0]-this.delta[0]):this.delta=f,this.options.zindex&&(this.element.style.zIndex=this.originalZ),this.options.endeffect&&this.options.endeffect(this.element),Draggables.deactivate(this)},keyPress:function(a){a.keyCode==Event.KEY_ESC&&(this.finishDrag(a,!1),Event.stop(a))},endDrag:function(a){!this.dragging||(this.stopScrolling(),this.finishDrag(a,!0),Event.stop(a))},draw:function(a){var b=this.element.cumulativeOffset(),c,d,e;this.options.ghosting&&(c=Position.realOffset(this.element),b[0]+=c[0]-Position.deltaX,b[1]+=c[1]-Position.deltaY),d=this.currentDelta(),b[0]-=d[0],b[1]-=d[1],this.options.scroll&&this.options.scroll!=window&&this._isScrollChild&&(b[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft,b[1]-=this.options.scroll.scrollTop-this.originalScrollTop),e=[0,1].map(function(c){var d=a[c]-b[c]-this.offset[c];return d<=0?1:d}.bind(this)),this.options.snap&&(Object.isFunction(this.options.snap)?e=this.options.snap(e[0],e[1],this):Object.isArray(this.options.snap)?e=e.map(function(a,b){return(a/this.options.snap[b]).round()*this.options.snap[b]}.bind(this)):e=e.map(function(a){return(a/this.options.snap).round()*this.options.snap}.bind(this)));var f=this.element.style;if(!this.options.constraint||this.options.constraint=="horizontal")f.left=e[0]+"px";if(!this.options.constraint||this.options.constraint=="vertical")f.top=e[1]+"px";f.visibility=="hidden"&&(f.visibility="")},stopScrolling:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null,Draggables._lastScrollPointer=null)},startScrolling:function(a){if(!!a[0]||!!a[1])this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed],this.lastScrolled=new Date,this.scrollInterval=setInterval(this.scroll.bind(this),10)},scroll:function(){var current=new Date,delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll))if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1e3;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}else this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1e3,this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1e3;Position.prepare(),Draggables.notify("onDrag",this),this._isScrollChild&&(Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer),Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1e3,Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1e3,Draggables._lastScrollPointer[0]<0&&(Draggables._lastScrollPointer[0]=0),Draggables._lastScrollPointer[1]<0&&(Draggables._lastScrollPointer[1]=0),this.draw(Draggables._lastScrollPointer)),this.options.change&&this.options.change(this)},_getWindowScroll:function(w){var T,L,W,H;with(w.document)w.document.documentElement&&documentElement.scrollTop?(T=documentElement.scrollTop,L=documentElement.scrollLeft):w.document.body&&(T=body.scrollTop,L=body.scrollLeft),w.innerWidth?(W=w.innerWidth,H=w.innerHeight):w.document.documentElement&&documentElement.clientWidth?(W=documentElement.clientWidth,H=documentElement.clientHeight):(W=body.offsetWidth,H=body.offsetHeight);return{top:T,left:L,width:W,height:H}}});Draggable._dragging={},Object.extend(String.prototype,{unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags();return a.childNodes[0]?a.childNodes.length>1?$A(a.childNodes).inject("",function(a,b){return a+b.nodeValue}):a.childNodes[0].nodeValue:""}}),Math.seedRandom=function(a){var b=42,c;if(typeof a=="string"){c=a.length;while(c--)b=(2416*(b+a.charCodeAt(c)*(c+1))+374441)%1771875}else if(typeof a=="number")b=parseInt(a,10)%1771875;else{Math.random=function(){return NaN};return!1}Math.random=function(){b=(2416*b+374441)%1771875;return b/1771875};return!0};var sprintf=function(){function d(a,d,g){var h=b(a,d,g).toString(),i=c(a,d).toString();return h.length>=i.length?i:h}function c(a,b){a=parseFloat(a,10),b&&(a=a.toFixed(b));return a}function b(a,b,c){a=parseFloat(a,10),a=a.toExponential(b),c&&(a=a.toUpperCase());return a}"use strict";var a=/([^%]*)%(\d\$)?('.|0|\x20)?(-)?(\+)?(\d+)?(\.\d+)?(%|b|c|s|i|d|u|o|x|X|e|E|f|F|g|G)(.*)/;return function(){var h,i=[],j,k,l,m,n,o,p,q=-1,r,s=1,t,u=[],v=!1,w=!1;if(!(!arguments||arguments.length<1)){h=arguments[0];while(i=a.exec(h)){j=i[1],l=i[2]?parseInt(i[2].substring(0,1),10):!1,m=i[3]?i[3].substring(1):" ",n=i[4]||!1,w=i[5]==="+",o=i[6]?parseInt(i[6],10):!1,q=i[7]?parseInt(i[7].substring(1),10):!1,p=i[8],k=i[9];if(l&&l<1&&l>arguments.length-1)return;if(l)t=arguments[l],v=!0;else{if(v&&p!=="%")return;t=arguments[s++]}switch(p){case"%":r="__pct__",s--;break;case"b":r=Math.abs(parseInt(t,10)).toString(2);break;case"c":r=String.fromCharCode(parseInt(t,10));break;case"s":r=t,q&&(r=r.substring(0,q));break;case"i":case"d":r=parseInt(t,10)||0,w&&r>0&&(r="+"+r);break;case"u":r=Math.abs(parseInt(t,10));break;case"o":r=parseInt(t,10).toString(8),w&&r>0&&(r="+"+r);break;case"x":r=parseInt(t,10).toString(16).toLowerCase(),w&&r>0&&(r="+"+r);break;case"X":r=parseInt(t,10).toString(16).toUpperCase(),w&&r>0&&(r="+"+r);break;case"e":r=b(t,q,!1),w&&r>0&&(r="+"+r);break;case"E":r=parseFloat(t,10),r=r.toExponential(q).toUpperCase(),w&&r>0&&(r="+"+r);break;case"F":case"f":r=c(t,q),w&&r>0&&(r="+"+r);break;case"g":r=d(t,q,!1),w&&r>0&&(r="+"+r);break;case"G":r=d(t,q,!0),w&&r>0&&(r="+"+r)}o&&r.toString().length<o&&(u.length=o-r.toString().length+1,n==="-"?r=r+u.join(m):r=u.join(m)+r),h=j+r+k}return h.replace(/__pct__/g,"%")}}}();(function(){"use strict";var a=Object.prototype,b=a.__defineGetter__,c=a.__defineSetter__,d=a.__lookupGetter__,e=a.__lookupSetter__,f=a.hasOwnProperty;b&&c&&d&&e&&(Object.defineProperty||(Object.defineProperty=function(a,g,h){if(arguments.length<3)throw new TypeError("Arguments not optional");g+="";if(f.call(h,"value")){!d.call(a,g)&&!e.call(a,g)&&(a[g]=h.value);if(f.call(h,"get")||f.call(h,"set"))throw new TypeError("Cannot specify an accessor and a value")}if(!(h.writable&&h.enumerable&&h.configurable))throw new TypeError("This implementation of Object.defineProperty does not support false for configurable, enumerable, or writable.");h.get&&b.call(a,g,h.get),h.set&&c.call(a,g,h.set);return a}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(a,b){if(arguments.length<2)throw new TypeError("Arguments not optional.");b+="";var c={configurable:!0,enumerable:!0,writable:!0},g=d.call(a,b),h=e.call(a,b);if(!f.call(a,b))return c;if(!g&&!h){c.value=a[b];return c}delete c.writable,c.get=c.set=undefined,g&&(c.get=g),h&&(c.set=h);return c}),Object.defineProperties||(Object.defineProperties=function(a,b){var c;for(c in b)f.call(b,c)&&Object.defineProperty(a,c,b[c])}))})();if(!document.documentElement.dataset&&(!Object.getOwnPropertyDescriptor(Element.prototype,"dataset")||!Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get)){var propDescriptor={enumerable:!0,get:function(){"use strict";var a,b=this,c,d,e,f,g,h=this.attributes,i=h.length,j=function(a){return a.charAt(1).toUpperCase()},k=function(){return this},l=function(a,b){return typeof b!="undefined"?this.setAttribute(a,b):this.removeAttribute(a)};try{({}).__defineGetter__("test",function(){}),c={}}catch(m){c=document.createElement("div")}for(a=0;a<i;a++){g=h[a];if(g&&g.name&&/^data-\w[\w\-]*$/.test(g.name)){d=g.value,e=g.name,f=e.substr(5).replace(/-./g,j);try{Object.defineProperty(c,f,{enumerable:this.enumerable,get:k.bind(d||""),set:l.bind(b,e)})}catch(n){c[f]=d}}}return c}};try{Object.defineProperty(Element.prototype,"dataset",propDescriptor)}catch(e){propDescriptor.enumerable=!1,Object.defineProperty(Element.prototype,"dataset",propDescriptor)}}var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(a){var b;a=a.toUpperCase();var c=this.NODEMAP[a]||"div",d=document.createElement(c);try{d.innerHTML="<"+a+"></"+a+">"}catch(e){}var f=d.firstChild||null;f&&f.tagName.toUpperCase()!=a&&(f=f.getElementsByTagName(a)[0]),f||(f=document.createElement(a));if(!!f){if(arguments[1])if(this._isStringOrNumber(arguments[1])||arguments[1]instanceof Array||arguments[1].tagName)this._children(f,arguments[1]);else{b=this._attributes(arguments[1],a);if(b.length){try{d.innerHTML="<"+a+" "+b+"></"+a+">"}catch(e){}f=d.firstChild||null;if(!f){f=document.createElement(a);for(attr in arguments[1])f[attr=="class"?"className":attr]=arguments[1][attr]}f.tagName.toUpperCase()!=a&&(f=d.getElementsByTagName(a)[0])}(a==="TD"||a==="TH")&&arguments[1].style&&(f.style.cssText=arguments[1].style)}arguments[2]&&this._children(f,arguments[2]);return $(f)}},_text:function(a){return document.createTextNode(a)},ATTR_MAP:{className:"class",htmlFor:"for"},_attributes:function(a,b){var c=[];for(attribute in a)attribute!=="extend"&&a[attribute]&&(attribute!=="style"||b!=="TD"&&b!=="TH")&&c.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+a[attribute].toString().escapeHTML().gsub(/"/,"&quot;")+'"');return c.join(" ")},_children:function(a,b){b.tagName?a.appendChild(b):typeof b=="object"?b.flatten().each(function(b){typeof b=="object"?a.appendChild(b):Builder._isStringOrNumber(b)&&a.appendChild(Builder._text(b))}):Builder._isStringOrNumber(b)&&a.appendChild(Builder._text(b))},_isStringOrNumber:function(a){return typeof a=="string"||typeof a=="number"},build:function(a){var b=this.node("div");$(b).update(a.strip());return b.down()},dump:function(a){typeof a!="object"&&typeof a!="function"&&(a=window);var b="A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR".split(/\s+/);b.each(function(b){a[b]=function(){return Builder.node.apply(Builder,[b].concat($A(arguments)))}})}},Rico={Version:"1.1.2",prototypeVersion:parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1])};if(typeof Prototype=="undefined"||Rico.prototypeVersion<1.3)throw"Rico requires the Prototype JavaScript framework >= 1.3";Rico.ArrayExtensions=[],Object.prototype.extend?Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend:(Object.prototype.extend=function(a){return Object.extend.apply(this,[this,a])},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Object.prototype.extend),Array.prototype.push&&(Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.push),Array.prototype.remove||(Array.prototype.remove=function(a){if(isNaN(a)||a>this.length)return!1;for(var b=0,c=0;b<this.length;b++)b!=a&&(this[c++]=this[b]);this.length-=1},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.remove),Array.prototype.removeItem||(Array.prototype.removeItem=function(a){for(var b=0;b<this.length;b++)if(this[b]==a){this.remove(b);break}},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.removeItem),Array.prototype.indices||(Array.prototype.indices=function(){var a=[];for(index in this){var b=!1;for(var c=0;c<Rico.ArrayExtensions.length;c++)if(this[index]==Rico.ArrayExtensions[c]){b=!0;break}b||(a[a.length]=index)}return a},Rico.ArrayExtensions[Rico.ArrayExtensions.length]=Array.prototype.indices),window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__&&(Document.prototype.loadXML||(Document.prototype.loadXML=function(a){var b=(new DOMParser).parseFromString(a,"text/xml");while(this.hasChildNodes())this.removeChild(this.lastChild);for(var c=0;c<b.childNodes.length;c++)this.appendChild(this.importNode(b.childNodes[c],!0))}),Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)})),document.getElementsByTagAndClassName=function(a,b){a==null&&(a="*");var c=document.getElementsByTagName(a)||document.all,d=[];if(b==null)return c;for(var e=0;e<c.length;e++){var f=c[e],g=f.className.split(" ");for(var h=0;h<g.length;h++)if(g[h]==b){d.push(f);break}}return d},Rico.Color=Class.create(),Rico.Color.prototype={initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a,this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,b.b)},darken:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){var a=this.asHSB();return this.asHSB().b>.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}},Rico.Color.createFromHex=function(a){if(a.length==4){var b=a,a="#";for(var c=1;c<4;c++)a+=b.charAt(c)+b.charAt(c)}a.indexOf("#")===0&&(a=a.substring(1));var d=a.substring(0,2),e=a.substring(2,4),f=a.substring(4,6);return new Rico.Color(parseInt(d,16),parseInt(e,16),parseInt(f,16))},Rico.Color.createColorFromBackground=function(a){var b=RicoUtil.getElementsComputedStyle($(a),"backgroundColor","background-color");if(b=="transparent"&&a.parentNode)return Rico.Color.createColorFromBackground(a.parentNode);if(b==null)return new Rico.Color(255,255,255);if(b.indexOf("rgb(")===0){var c=b.substring(4,b.length-1),d=c.split(",");return new Rico.Color(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]))}return b.indexOf("#")===0?Rico.Color.createFromHex(b):new Rico.Color(255,255,255)},Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(b===0)d=parseInt(c*255+.5),e=d,f=d;else{var g=(a-Math.floor(a))*6,h=g-Math.floor(g),i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h));switch(parseInt(g)){case 0:d=c*255+.5,e=k*255+.5,f=i*255+.5;break;case 1:d=j*255+.5,e=c*255+.5,f=i*255+.5;break;case 2:d=i*255+.5,e=c*255+.5,f=k*255+.5;break;case 3:d=i*255+.5,e=j*255+.5,f=c*255+.5;break;case 4:d=k*255+.5,e=i*255+.5,f=c*255+.5;break;case 5:d=c*255+.5,e=i*255+.5,f=j*255+.5}}return{r:parseInt(d),g:parseInt(e),b:parseInt(f)}},Rico.Color.RGBtoHSB=function(a,b,c){var d,e,f,g=a>b?a:b;c>g&&(g=c);var h=a<b?a:b;c<h&&(h=c),f=g/255,g!==0?e=(g-h)/g:e=0;if(e===0)d=0;else{var i=(g-a)/(g-h),j=(g-b)/(g-h),k=(g-c)/(g-h);a==g?d=k-j:b==g?d=2+i-k:d=4+j-i,d=d/6,d<0&&(d=d+1)}return{h:d,s:e,b:f}},Rico.Corner={round:function(a,b){var a=$(a);this._setOptions(b);var c=this.options.color;this.options.color=="fromElement"&&(c=this._background(a));var d=this.options.bgColor;this.options.bgColor=="fromParent"&&(d=this._background(a.offsetParent)),this._roundCornersImpl(a,c,d)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c),this._isTopRounded()&&this._roundTopCorners(a,b,c),this._isBottomRounded()&&this._roundBottomCorners(a,b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b),d="border-left: "+c,e="border-right: "+c,f="style='"+d+";"+e+"'";a.innerHTML="<div "+f+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){var d=this._createCorner(c);for(var e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0,a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){var d=this._createCorner(c);for(var e=this.options.numSlices-1;e>=0;e--)d.appendChild(this._createCornerSlice(b,c,e,"bottom"));a.style.paddingBottom=0,a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a,f.display="block",f.height="1px",f.overflow="hidden",f.fontSize="1px";var g=this._borderColor(a,b);this.options.border&&c===0?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth="0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=g):g&&(f.borderColor=g,f.borderStyle="solid",f.borderWidth="0px 1px"),!this.options.compact&&c==this.options.numSlices-1&&(f.height="2px"),this._setMargin(e,c,d),this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},Object.extend(this.options,a||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top"))return"";if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0)return"";if(this.options.corners.indexOf("tl")>=0)return"left";if(this.options.corners.indexOf("tr")>=0)return"right";return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom"))return"";if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0)return"";if(this.options.corners.indexOf("bl")>=0)return"left";if(this.options.corners.indexOf("br")>=0)return"right";return""},_borderColor:function(a,b){return a=="transparent"?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){var d=this._marginSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.marginLeft=d+"px",a.style.marginRight="0px"):e=="right"?(a.style.marginRight=d+"px",a.style.marginLeft="0px"):(a.style.marginLeft=d+"px",a.style.marginRight=d+"px")},_setBorder:function(a,b,c){var d=this._borderSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth="0px"):e=="right"?(a.style.borderRightWidth=d+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth=d+"px"),this.options.border!=!1&&(a.style.borderLeftWidth=d+"px"),a.style.borderRightWidth=d+"px"},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent()))return 1;if(this.options.compact)return d[a];if(this.options.blend)return c[a];if(this.options.border)return e[a];if(this._isTransparent())return b[a];return 0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(a.indexOf(arguments[b])>=0)return!0;return!1},_blend:function(a,b){var c=Rico.Color.createFromHex(a);c.blend(Rico.Color.createFromHex(b));return c},_background:function(a){try{return Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return a.childNodes.length==1&&a.childNodes[0].nodeType==3}},Rico.DragAndDrop=Class.create(),Rico.DragAndDrop.prototype={initialize:function(){this.dropZones=[],this.draggables=[],this.currentDragObjects=[],this.dragElement=null,this.lastSelectedDraggable=null,this.currentDragObjectVisible=!1,this.interestedInMotionEvents=!1,this._mouseDown=this._mouseDownHandler.bindAsEventListener(this),this._mouseMove=this._mouseMoveHandler.bindAsEventListener(this),this._mouseUp=this._mouseUpHandler.bindAsEventListener(this),this._touchStart=this._mouseDownHandler.bindAsEventListener(this),this._touchMove=this._mouseMoveHandler.bindAsEventListener(this),this._touchEnd=this._mouseUpHandler.bindAsEventListener(this)},registerDropZone:function(a){this.dropZones[this.dropZones.length]=a,this.dropZones=this.dropZones.uniq()},deregisterDropZone:function(a){var b=[],c=0;for(var d=0;d<this.dropZones.length;d++)this.dropZones[d]!=a&&(b[c++]=this.dropZones[d]);this.dropZones=b},clearDropZones:function(){this.dropZones=[]},registerDraggable:function(a){this.draggables[this.draggables.length]=a,this._addMouseDownHandler(a)},clearSelection:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].deselect();this.currentDragObjects=[],this.lastSelectedDraggable=null},hasSelection:function(){return this.currentDragObjects.length>0},setStartDragFromElement:function(a,b){this.origPos=RicoUtil.toDocumentPosition(b),this.startx=a.screenX-this.origPos.x,this.starty=a.screenY-this.origPos.y,this.interestedInMotionEvents=this.hasSelection(),this._terminateEvent(a)},updateSelection:function(a,b){b||this.clearSelection(),a.isSelected()?(this.currentDragObjects.removeItem(a),a.deselect(),a==this.lastSelectedDraggable&&(this.lastSelectedDraggable=null)):(this.currentDragObjects[this.currentDragObjects.length]=a,a.select(),this.lastSelectedDraggable=a)},_mouseDownHandler:function(a){arguments.length===0&&(a=event);var b=a.which!=undefined;!(b&&a.which!=1||!b&&a.button!=1);var c=a.target?a.target:a.srcElement,d=c.mydraggable,e=c;while(typeof d=="undefined"&&e.parentNode)e=e.parentNode,d=e.mydraggable;if(d!=null){this.updateSelection(d,a.ctrlKey);if(this.hasSelection())for(var f=0;f<this.dropZones.length;f++)this.dropZones[f].clearPositionCache();this.setStartDragFromElement(a,d.getMouseDownHTMLElement())}},_mouseMoveHandler:function(a){var b=a.which!=undefined;if(!!this.interestedInMotionEvents){if(!this.hasSelection())return;this.currentDragObjectVisible||this._startDrag(a),this.activatedDropZones||this._activateRegisteredDropZones(),this._updateDraggableLocation(a),this._updateDropZonesHover(a),this._terminateEvent(a)}},_makeDraggableObjectVisible:function(a){if(!!this.hasSelection()){var b;this.currentDragObjects.length>1?b=this.currentDragObjects[0].getMultiObjectDragGUI(this.currentDragObjects):b=this.currentDragObjects[0].getSingleObjectDragGUI(),RicoUtil.getElementsComputedStyle(b,"position")!="absolute"&&(b.style.position="absolute",b.style.zIndex=1001),(b.parentNode==null||b.parentNode.nodeType==11)&&document.body.appendChild(b),this.dragElement=b,this._updateDraggableLocation(a),this.currentDragObjectVisible=!0}},_leftOffset:function(a){var b=Event.pointerX(a);if(this.startDragOffsetX<0)return b;return b-this.startDragOffsetX},_topOffset:function(a){var b=Event.pointerY(a);if(this.startDragOffsetY<0)return b;return b-this.startDragOffsetY},_updateDraggableLocation:function(a){var b=this.dragElement.style;b.left=a.screenX+this._leftOffset(a)-this.startx+"px",b.top=a.screenY+this._topOffset(a)-this.starty+"px"},_updateDropZonesHover:function(a){var b=this.dropZones.length,c;while(b--)c=this.dropZones[b],this._mousePointInDropZone(a,c)?c.canAccept(this.currentDragObjects)&&c.showHover(a):c.hideHover(a)},_startDrag:function(a){for(var b=0,c=this.currentDragObjects.length;b<c;b++)this.currentDragObjects[b].startDrag();el=Event.element(a),elCoords=Position.cumulativeOffset(el),this.startDragOffsetX=Event.pointerX(a)-elCoords[0],this.startDragOffsetY=Event.pointerY(a)-elCoords[1],this._makeDraggableObjectVisible(a)},_mouseUpHandler:function(a){if(!!this.hasSelection()){var b=a.which!=undefined;!(b&&a.which!=1||!b&&a.button!=1),this.interestedInMotionEvents=!1;if(this.dragElement==null){this._terminateEvent(a);return}this._placeDraggableInDropZone(a)?this._completeDropOperation(a):(this._terminateEvent(a),new Rico.Effect.Position(this.dragElement,this.origPos.x,this.origPos.y,100,10,{complete:this._doCancelDragProcessing.bind(this)})),Event.stopObserving(document.body,"mousemove",this._mouseMove),Event.stopObserving(document.body,"touchmove",this._touchMove),Event.stopObserving(document.body,"mouseup",this._mouseUp),Event.stopObserving(document.body,"touchend",this._touchEnd)}},_retTrue:function(){return!0},_completeDropOperation:function(a){this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&this.dragElement.parentNode!==null&&this.dragElement.parentNode.removeChild(this.dragElement),this._deactivateRegisteredDropZones(),this._endDrag(),this.clearSelection(),this.dragElement=null,this.currentDragObjectVisible=!1,this._terminateEvent(a)},_doCancelDragProcessing:function(){this._cancelDrag(),this.dragElement!=this.currentDragObjects[0].getMouseDownHTMLElement()&&this.dragElement&&this.dragElement.parentNode!==null&&this.dragElement.parentNode.removeChild(this.dragElement),this._deactivateRegisteredDropZones(),this.dragElement=null,this.currentDragObjectVisible=!1},_placeDraggableInDropZone:function(a){var b=!1,c=this.dropZones.length,d;while(c--){d=this.dropZones[c];if(this._mousePointInDropZone(a,d)&&d.canAccept(this.currentDragObjects)){d.hideHover(),d.accept(this.currentDragObjects,a),b=!0;break}}return b},_cancelDrag:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].cancelDrag()},_endDrag:function(){for(var a=0;a<this.currentDragObjects.length;a++)this.currentDragObjects[a].endDrag()},_mousePointInDropZone:function(a,b){var c=b.getHTMLElement();Element.extend(c);return Position.within(c,this._leftOffset(a),this._topOffset(a))},_addMouseDownHandler:function(a){htmlElement=a.getMouseDownHTMLElement(),htmlElement!==null&&(htmlElement.draggable=a,Event.observe(htmlElement,"mousedown",this._onmousedown.bindAsEventListener(this)),Event.observe(htmlElement,"mousedown",this._mouseDown),Event.observe(htmlElement,"touchstart",this._ontouchstart.bindAsEventListener(this)),Event.observe(htmlElement,"touchstart",this._touchStart))},_activateRegisteredDropZones:function(){var a=this.dropZones.length;for(var b=0;b<a;b++){var c=this.dropZones[b];c.canAccept(this.currentDragObjects)&&c.activate()}this.activatedDropZones=!0},_deactivateRegisteredDropZones:function(){var a=this.dropZones.length;for(var b=0;b<a;b++)this.dropZones[b].deactivate();this.activatedDropZones=!1},_onmousedown:function(){Event.observe(document.body,"mousemove",this._mouseMove),Event.observe(document.body,"mouseup",this._mouseUp)},_ontouchstart:function(){Event.observe(document.body,"touchmove",this._touchMove),Event.observe(document.body,"touchend",this._touchEnd)},_terminateEvent:function(a){a.stopPropagation!=undefined?a.stopPropagation():a.cancelBubble!=undefined&&(a.cancelBubble=!0),a.preventDefault!=undefined?a.preventDefault():a.returnValue=!1},initializeEventHandlers:function(){typeof document.implementation!="undefined"&&document.implementation.hasFeature("HTML","1.0")&&document.implementation.hasFeature("Events","2.0")&&document.implementation.hasFeature("CSS","2.0")?(document.addEventListener("mouseup",this._mouseUpHandler.bindAsEventListener(this),!1),document.addEventListener("mousemove",this._mouseMoveHandler.bindAsEventListener(this),!1),document.addEventListener("touchend",this._mouseUpHandler.bindAsEventListener(this),!1),document.addEventListener("touchmove",this._mouseMoveHandler.bindAsEventListener(this),!1)):(document.attachEvent("onmouseup",this._mouseUpHandler.bindAsEventListener(this)),document.attachEvent("onmousemove",this._mouseMoveHandler.bindAsEventListener(this)),document.attachEvent("ontouchend",this._mouseUpHandler.bindAsEventListener(this)),document.attachEvent("ontouchmove",this._mouseMoveHandler.bindAsEventListener(this)))}};var dndMgr=new Rico.DragAndDrop;Rico.Draggable=Class.create(),Rico.Draggable.prototype={initialize:function(a,b){this.type=a,this.htmlElement=$(b),this.selected=!1},getMouseDownHTMLElement:function(){return this.htmlElement},select:function(){this.selected=!0;if(!this.showingSelected){var a=this.getMouseDownHTMLElement(),b=Rico.Color.createColorFromBackground(a);b.isBright()?b.darken(.033):b.brighten(.033),this.saveBackground=RicoUtil.getElementsComputedStyle(a,"backgroundColor","background-color"),a.style.backgroundColor=b.asHex(),this.showingSelected=!0}},deselect:function(){this.selected=!1;if(!!this.showingSelected){var a=this.getMouseDownHTMLElement();a.style.backgroundColor=this.saveBackground,this.showingSelected=!1}},isSelected:function(){return this.selected},startDrag:function(){},cancelDrag:function(){},endDrag:function(){},getSingleObjectDragGUI:function(){return this.htmlElement},getMultiObjectDragGUI:function(a){return this.htmlElement},getDroppedGUI:function(){return this.htmlElement},toString:function(){return this.type+":"+this.htmlElement+":"}},Rico.Dropzone=Class.create(),Rico.Dropzone.prototype={initialize:function(a){this.htmlElement=$(a),this.absoluteRect=null},getHTMLElement:function(){return this.htmlElement},clearPositionCache:function(){this.absoluteRect=null},getAbsoluteRect:function(){if(this.absoluteRect==null){var a=this.getHTMLElement(),b=RicoUtil.toViewportPosition(a),c=a.scrollTop,d=a.scrollLeft;this.absoluteRect={top:b.y+(c?c:0),left:b.x,bottom:b.y+(c?c:0)+a.offsetHeight,right:b.x+a.offsetWidth}}return this.absoluteRect},activate:function(){var a=this.getHTMLElement();if(a!=null&&!this.showingActive){this.showingActive=!0,this.saveBackgroundColor=a.style.backgroundColor;var b="#ffea84",c=Rico.Color.createColorFromBackground(a);c==null?a.style.backgroundColor=b:(c.isBright()?c.darken(.2):c.brighten(.2),a.style.backgroundColor=c.asHex())}},deactivate:function(){var a=this.getHTMLElement();a!=null&&!!this.showingActive&&(a.style.backgroundColor=this.saveBackgroundColor,this.showingActive=!1,this.saveBackgroundColor=null)},showHover:function(){var a=this.getHTMLElement();a!=null&&!this.showingHover&&(this.saveBorderWidth=a.style.borderWidth,this.saveBorderStyle=a.style.borderStyle,this.saveBorderColor=a.style.borderColor,this.showingHover=!0,a.style.borderWidth="1px",a.style.borderStyle="solid",a.style.borderColor="#ffff00")},hideHover:function(){var a=this.getHTMLElement();a!=null&&!!this.showingHover&&(a.style.borderWidth=this.saveBorderWidth,a.style.borderStyle=this.saveBorderStyle,a.style.borderColor=this.saveBorderColor,this.showingHover=!1)},canAccept:function(a){return!0},accept:function(a){var b=this.getHTMLElement();if(b!=null){n=a.length;for(var c=0;c<n;c++){var d=a[c].getDroppedGUI();RicoUtil.getElementsComputedStyle(d,"position")=="absolute"&&(d.style.position="static",d.style.top="",d.style.top=""),b.appendChild(d)}}}},Rico.Effect={},Rico.Effect.SizeAndPosition=Class.create(),Rico.Effect.SizeAndPosition.prototype={initialize:function(a,b,c,d,e,f,g,h){this.element=$(a),this.x=b,this.y=c,this.w=d,this.h=e,this.duration=f,this.steps=g,this.options=arguments[7]||{},this.sizeAndPosition()},sizeAndPosition:function(){if(this.isFinished())this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=this.element.offsetLeft,c=this.element.offsetTop,d=this.element.offsetWidth,e=this.element.offsetHeight;this.x=this.x||b,this.y=this.y||c,this.w=this.w||d,this.h=this.h||e;var f=this.steps>0?(this.x-b)/this.steps:0,g=this.steps>0?(this.y-c)/this.steps:0,h=this.steps>0?(this.w-d)/this.steps:0,i=this.steps>0?(this.h-e)/this.steps:0;this.moveBy(f,g),this.resizeBy(h,i),this.duration-=a,this.steps--,this.timer=setTimeout(this.sizeAndPosition.bind(this),a)}},isFinished:function(){return this.steps<=0},moveBy:function(a,b){var c=this.element.offsetLeft,d=this.element.offsetTop,e=parseInt(a),f=parseInt(b),g=this.element.style;e!==0&&(g.left=c+e+"px"),f!==0&&(g.top=d+f+"px")},resizeBy:function(a,b){var c=this.element.offsetWidth,d=this.element.offsetHeight,e=parseInt(a),f=parseInt(b),g=this.element.style;e!==0&&(g.width=c+e+"px"),f!==0&&(g.height=d+f+"px")}},Rico.Effect.Size=Class.create(),Rico.Effect.Size.prototype={initialize:function(a,b,c,d,e,f){new Rico.Effect.SizeAndPosition(a,null,null,b,c,d,e,f)}},Rico.Effect.Position=Class.create(),Rico.Effect.Position.prototype={initialize:function(a,b,c,d,e,f){new Rico.Effect.SizeAndPosition(a,b,c,null,null,d,e,f)}},Rico.Effect.Round=Class.create(),Rico.Effect.Round.prototype={initialize:function(a,b,c){var d=document.getElementsByTagAndClassName(a,b);for(var e=0;e<d.length;e++)Rico.Corner.round(d[e],c)}},Rico.Effect.FadeTo=Class.create(),Rico.Effect.FadeTo.prototype={initialize:function(a,b,c,d,e){this.element=$(a),this.opacity=b,this.duration=c,this.steps=d,this.options=arguments[4]||{},this.fadeTo()},fadeTo:function(){if(this.isFinished())this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=this.getElementOpacity(),c=this.steps>0?(this.opacity-b)/this.steps:0;this.changeOpacityBy(c),this.duration-=a,this.steps--,this.timer=setTimeout(this.fadeTo.bind(this),a)}},changeOpacityBy:function(a){var b=this.getElementOpacity(),c=Math.max(0,Math.min(b+a,1));this.element.ricoOpacity=c,this.element.style.filter="alpha(opacity:"+Math.round(c*100)+")",this.element.style.opacity=c},isFinished:function(){return this.steps<=0},getElementOpacity:function(){if(this.element.ricoOpacity==undefined){var a=RicoUtil.getElementsComputedStyle(this.element,"opacity");this.element.ricoOpacity=a!=undefined?a:1}return parseFloat(this.element.ricoOpacity)}},Rico.Effect.AccordionSize=Class.create(),Rico.Effect.AccordionSize.prototype={initialize:function(a,b,c,d,e,f,g){this.e1=$(a),this.e2=$(b),this.start=c,this.end=d,this.duration=e,this.steps=f,this.options=arguments[6]||{},this.accordionSize()},accordionSize:function(){if(this.isFinished())this.e1.style.height=this.start+"px",this.e2.style.height=this.end+"px",this.options.complete&&this.options.complete(this);else{this.timer&&clearTimeout(this.timer);var a=Math.round(this.duration/this.steps),b=this.steps>0?(parseInt(this.e1.offsetHeight)-this.start)/this.steps:0;this.resizeBy(b),this.duration-=a,this.steps--,this.timer=setTimeout(this.accordionSize.bind(this),a)}},isFinished:function(){return this.steps<=0},resizeBy:function(a){var b=this.e1.offsetHeight,c=this.e2.offsetHeight,d=parseInt(a);a!==0&&(this.e1.style.height=b-d+"px",this.e2.style.height=c+d+"px")}};var RicoUtil={getElementsComputedStyle:function(a,b,c){arguments.length==2&&(c=b);var d=$(a);if(d.currentStyle)return d.currentStyle[b]},createXmlDocument:function(){if(document.implementation&&document.implementation.createDocument){var a=document.implementation.createDocument("","",null);a.readyState==null&&(a.readyState=1,a.addEventListener("load",function(){a.readyState=4,typeof a.onreadystatechange=="function"&&a.onreadystatechange()},!1));return a}if(window.ActiveXObject)return Try.these(function(){return new ActiveXObject("MSXML2.DomDocument")},function(){return new ActiveXObject("Microsoft.DomDocument")},function(){return new ActiveXObject("MSXML.DomDocument")},function(){return new ActiveXObject("MSXML3.DomDocument")})||!1;return null},getContentAsString:function(a){return a.xml!=undefined?this._getContentAsStringIE(a):this._getContentAsStringMozilla(a)},_getContentAsStringIE:function(a){var b="";for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.nodeType==4?b+=d.nodeValue:b+=d.xml}return b},_getContentAsStringMozilla:function(a){var b=new XMLSerializer,c="";for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];e.nodeType==4?c+=e.nodeValue:c+=b.serializeToString(e)}return c},toViewportPosition:function(a){return this._toAbsolute(a,!0)},toDocumentPosition:function(a){return this._toAbsolute(a,!1)},_toAbsolute:function(a,b){if(navigator.userAgent.toLowerCase().indexOf("msie")==-1)return this._toAbsoluteMozilla(a,b);var c=0,d=0,e=a;while(e){var f=0,g=0;if(e!=a){var f=parseInt(this.getElementsComputedStyle(e,"borderLeftWidth")),g=parseInt(this.getElementsComputedStyle(e,"borderTopWidth"));f=isNaN(f)?0:f,g=isNaN(g)?0:g}c+=e.offsetLeft-e.scrollLeft+f,d+=e.offsetTop-e.scrollTop+g;try{e=e.offsetParent}catch(h){e=!1}}b&&(c-=this.docScrollLeft(),d-=this.docScrollTop());return{x:c,y:d}},_toAbsoluteMozilla:function(a,b){var c=0,d=0,e=a;while(e)c+=e.offsetLeft,d+=e.offsetTop,e=e.offsetParent;e=a;while(e&&e!=document.body&&e!=document.documentElement)e.scrollLeft&&(c-=e.scrollLeft),e.scrollTop&&(d-=e.scrollTop),e=e.parentNode;b&&(c-=this.docScrollLeft(),d-=this.docScrollTop());return{x:c,y:d}},docScrollLeft:function(){return window.pageXOffset?window.pageXOffset:document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body?document.body.scrollLeft:0},docScrollTop:function(){return window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body?document.body.scrollTop:0}},Window=Class.create();Window.keepMultiModalWindow=!0,Window.hasEffectLib=typeof Effect!="undefined",Window.resizeEffectDuration=.4,Window.prototype={initialize:function(){var a,b=0;arguments.length>0&&(typeof arguments[0]=="string"?(a=arguments[0],b=1):a=arguments[0]?arguments[0].id:null),a||(a="window_"+(new Date).getTime()),$(a)&&alert("Window "+a+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor"),this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:!0,closable:!0,minimizable:!0,maximizable:!0,draggable:!0,userData:null,showEffect:Element.show,hideEffect:Element.hide,showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&nbsp;",url:null,onload:Prototype.emptyFunction,width:200,height:300,opacity:!1,recenterAuto:!0,wiredDrag:!1,closeCallback:null,destroyOnClose:!1,gridX:1,gridY:1},arguments[b]||{}),core.tools.clearDndSelection(),this.options.blurClassName&&(this.options.focusClassName=this.options.className),typeof this.options.top=="undefined"&&typeof this.options.bottom=="undefined"&&(this.options.top=this._round(Math.random()*500,this.options.gridY)),typeof this.options.left=="undefined"&&typeof this.options.right=="undefined"&&(this.options.left=this._round(Math.random()*500,this.options.gridX)),this.options.effectOptions&&(Object.extend(this.options.hideEffectOptions,this.options.effectOptions),Object.extend(this.options.showEffectOptions,this.options.effectOptions),this.options.showEffect==Element.Appear&&(this.options.showEffectOptions.to=this.options.opacity)),Window.hasEffectLib&&(this.options.showEffect==Effect.Appear&&(this.options.showEffectOptions.to=this.options.opacity),this.options.hideEffect==Effect.Fade&&(this.options.hideEffectOptions.from=this.options.opacity)),this.options.hideEffect==Element.hide&&(this.options.hideEffect=function(){Element.hide(this.element),this.options.destroyOnClose&&this.destroy()}.bind(this)),this.options.parent!=document.body&&(this.options.parent=$(this.options.parent)),this.element=this._createWindow(a),this.element.win=this,this.eventMouseDown=this._initDrag.bindAsEventListener(this),this.eventMouseUp=this._endDrag.bindAsEventListener(this),this.eventMouseMove=this._updateDrag.bindAsEventListener(this),this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this),this.eventMouseDownContent=this.toFront.bindAsEventListener(this),this.eventResize=this._recenter.bindAsEventListener(this),this.topbar=$(this.element.id+"_top"),this.bottombar=$(this.element.id+"_bottom"),this.content=$(this.element.id+"_content"),Event.observe(this.topbar,"mousedown",this.eventMouseDown),Event.observe(this.bottombar,"mousedown",this.eventMouseDown),Event.observe(this.content,"mousedown",this.eventMouseDownContent),Event.observe(window,"load",this.eventOnLoad),Event.observe(window,"resize",this.eventResize),Event.observe(window,"scroll",this.eventResize),Event.observe(this.options.parent,"scroll",this.eventResize);if(this.options.draggable){var c=this;[this.topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(a){a.observe("mousedown",c.eventMouseDown),a.addClassName("top_draggable")}),[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(a){a.observe("mousedown",c.eventMouseDown),a.addClassName("bottom_draggable")})}this.options.resizable&&(this.sizer=$(this.element.id+"_sizer"),Event.observe(this.sizer,"mousedown",this.eventMouseDown)),this.useLeft=null,this.useTop=null,typeof this.options.left!="undefined"?(this.element.setStyle({left:parseFloat(this.options.left)+"px"}),this.useLeft=!0):(this.element.setStyle({right:parseFloat(this.options.right)+"px"}),this.useLeft=!1),typeof this.options.top!="undefined"?(this.element.setStyle({top:parseFloat(this.options.top)+"px"}),this.useTop=!0):(this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"}),this.useTop=!1),this.storedLocation=null,this.options.opacity&&this.setOpacity(this.options.opacity),this.options.zIndex&&this.setZIndex(this.options.zIndex),this.options.destroyOnClose&&this.setDestroyOnClose(!0),this._getWindowBorderSize(),this.width=this.options.width,this.height=this.options.height,this.visible=!1,this.constraint=!1,this.constraintPad={top:0,left:0,bottom:0,right:0},this.width&&this.height&&this.setSize(this.options.width,this.options.height),this.setTitle(this.options.title),Windows.register(this)},destroy:function(){this._notify("onDestroy"),Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown),Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown),Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent),Event.stopObserving(window,"load",this.eventOnLoad),Event.stopObserving(window,"resize",this.eventResize),Event.stopObserving(window,"scroll",this.eventResize),Event.stopObserving(this.content,"load",this.options.onload);if(this._oldParent){var a=this.getContent(),b=null;for(var c=0,d=a.childNodes.length;c<d;c++){b=a.childNodes[c];if(b.nodeType==1)break;b=null}b&&this._oldParent.appendChild(b),this._oldParent=null}this.sizer&&Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown),this.options.url&&(this.content.src=null),this.iefix&&Element.remove(this.iefix),Element.remove(this.element),Windows.unregister(this)},setCloseCallback:function(a){this.options.closeCallback=a},getContent:function(){return this.content},setContent:function(a,b,c){var d=$(a);typeof a!="string"?d=a:d=$(a);if(null==d)throw"Unable to find element '"+a+"' in DOM";this._oldParent=d.parentNode;var e=null,f=null;b&&(e=Element.getDimensions(d)),c&&(f=Element.cumulativeOffset(d));var g=this.getContent();this.setHTMLContent(""),g=this.getContent(),g.appendChild(d),d.show(),b&&this.setSize(e.width,e.height),c&&this.setLocation(f[1]-this.heightN,f[0]-this.widthW)},setHTMLContent:function(a){if(this.options.url){this.content.src=null,this.options.url=null;var b='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>';$(this.getId()+"_table_content").innerHTML=b,this.content=$(this.element.id+"_content")}this.getContent().innerHTML=a},setAjaxContent:function(a,b,c,d){this.showFunction=c?"showCenter":"show",this.showModal=d||!1,b=b||{},this.setHTMLContent(""),this.onComplete=b.onComplete,this._onCompleteHandler||(this._onCompleteHandler=this._setAjaxContent.bind(this)),b.onComplete=this._onCompleteHandler,new Ajax.Request(a,b),b.onComplete=this.onComplete},_setAjaxContent:function(a){Element.update(this.getContent(),a.responseText),this.onComplete&&this.onComplete(a),this.onComplete=null,this[this.showFunction](this.showModal)},setURL:function(a){this.options.url&&(this.content.src=null),this.options.url=a;var b="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+a+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=b,this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url?this.options.url:null},refresh:function(){this.options.url&&($(this.element.getAttribute("id")+"_content").src=this.options.url)},setCookie:function(a,b,c,d,e){a=a||this.element.id,this.cookie=[a,b,c,d,e];var f=WindowUtilities.getCookie(a);if(f){var g=f.split(","),h=g[0].split(":"),i=g[1].split(":"),j=parseFloat(g[2]),k=parseFloat(g[3]),l=g[4],m=g[5];this.setSize(j,k),l=="true"?this.doMinimize=!0:m=="true"&&(this.doMaximize=!0),this.useLeft=h[0]=="l",this.useTop=i[0]=="t",this.element.setStyle(this.useLeft?{left:h[1]}:{right:h[1]}),this.element.setStyle(this.useTop?{top:i[1]}:{bottom:i[1]})}},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=!0},setConstraint:function(a,b){this.constraint=a,this.constraintPad=Object.extend(this.constraintPad,b||{}),this.useTop&&this.useLeft&&this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))},_initDrag:function(a){if(Event.element(a)!=this.sizer||!this.isMinimized()){if(Event.element(a)!=this.sizer&&this.isMaximized())return;Prototype.Browser.IE&&this.heightN===0&&this._getWindowBorderSize(),this.pointer=[this._round(Event.pointerX(a),this.options.gridX),this._round(Event.pointerY(a),this.options.gridY)],this.options.wiredDrag?this.currentDrag=this._createWiredElement():this.currentDrag=this.element;if(Event.element(a)==this.sizer)this.doResize=!0,this.widthOrg=this.width,this.heightOrg=this.height,this.bottomOrg=parseFloat(this.element.getStyle("bottom")),this.rightOrg=parseFloat(this.element.getStyle("right")),this._notify("onStartResize");else{this.doResize=!1;var b=$(this.getId()+"_close");if(b&&Position.within(b,this.pointer[0],this.pointer[1])){this.currentDrag=null;return}this.toFront();if(!this.options.draggable)return;this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,!1),Event.observe(document,"mousemove",this.eventMouseMove,!1),WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity),document.body.ondrag=function(){return!1},document.body.onselectstart=function(){return!1},this.currentDrag.show(),Event.stop(a)}},_round:function(a,b){return b==1?a:a=Math.floor(a/b)*b},_updateDrag:function(a){var b=[this._round(Event.pointerX(a),this.options.gridX),this._round(Event.pointerY(a),this.options.gridY)];b[0]<0&&(b[0]=0),b[1]<0&&(b[1]=0);var c=b[0]-this.pointer[0],d=b[1]-this.pointer[1];if(this.doResize){var e=this.widthOrg+c,f=this.heightOrg+d;c=this.width-this.widthOrg,d=this.height-this.heightOrg,this.useLeft?e=this._updateWidthConstraint(e):this.currentDrag.setStyle({right:this.rightOrg-c+"px"}),this.useTop?f=this._updateHeightConstraint(f):this.currentDrag.setStyle({bottom:this.bottomOrg-d+"px"}),this.setSize(e,f),this._notify("onResize")}else{this.pointer=b;if(this.useLeft){var g=parseFloat(this.currentDrag.getStyle("left"))+c,h=this._updateLeftConstraint(g);this.pointer[0]+=h-g,this.currentDrag.setStyle({left:h+"px"})}else this.currentDrag.setStyle({right:parseFloat(this.currentDrag.getStyle("right"))-c+"px"});if(this.useTop){var i=parseFloat(this.currentDrag.getStyle("top"))+d,j=this._updateTopConstraint(i);this.pointer[1]+=j-i,this.currentDrag.setStyle({top:j+"px"})}else this.currentDrag.setStyle({bottom:parseFloat(this.currentDrag.getStyle("bottom"))-d+"px"});this._notify("onMove")}this.iefix&&this._fixIEOverlapping(),this._removeStoreLocation(),Event.stop(a)},_endDrag:function(a){WindowUtilities.enableScreen("__invisible__"),this.doResize?this._notify("onEndResize"):this._notify("onEndMove"),Event.stopObserving(document,"mouseup",this.eventMouseUp,!1),Event.stopObserving(document,"mousemove",this.eventMouseMove,!1),Event.stop(a),this._hideWiredElement(),this._saveCookie(),document.body.ondrag=null,document.body.onselectstart=null},_updateLeftConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width;a<this.constraintPad.left&&(a=this.constraintPad.left),a+this.width+this.widthE+this.widthW>b-this.constraintPad.right&&(a=b-this.constraintPad.right-this.width-this.widthE-this.widthW)}return a},_updateTopConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height,c=this.height+this.heightN+this.heightS;a<this.constraintPad.top&&(a=this.constraintPad.top),a+c>b-this.constraintPad.bottom&&(a=b-this.constraintPad.bottom-c)}return a},_updateWidthConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width,c=parseFloat(this.element.getStyle("left"));c+a+this.widthE+this.widthW>b-this.constraintPad.right&&(a=b-this.constraintPad.right-c-this.widthE-this.widthW)}return a},_updateHeightConstraint:function(a){if(this.constraint&&this.useLeft&&this.useTop){var b=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height,c=parseFloat(this.element.getStyle("top"));c+a+this.heightN+this.heightS>b-this.constraintPad.bottom&&(a=b-this.constraintPad.bottom-c-this.heightN-this.heightS)}return a},_createWindow:function(a){var b=this.options.className,c=$(Builder.node("div",{id:a,className:"dialog"})),d,e=this.options.closable?"<div class='"+b+"_close' id='"+a+"_close' onclick='Windows.close(\""+a+"\", event)'> </div>":"",f=this.options.minimizable?"<div class='"+b+"_minimize' id='"+a+"_minimize' onclick='Windows.minimize(\""+a+"\", event)'> </div>":"",g=this.options.maximizable?"<div class='"+b+"_maximize' id='"+a+"_maximize' onclick='Windows.maximize(\""+a+"\", event)'> </div>":"",h=this.options.resizable?"class='"+b+"_sizer' id='"+a+"_sizer'":"class='"+b+"_se'",i="../themes/default/blank.gif";this.options.url?d='<iframe frameborder="0" name="'+a+'_content"  id="'+a+'_content" src="'+this.options.url+'"> </iframe>':d='<div id="'+a+'_content" class="'+b+'_content"> </div>',c.innerHTML=e+f+g+"\n      <table id='"+a+"_row1' class=\"top table_window\">\n        <tr>\n          <td class='"+b+"_nw'></td>\n          <td class='"+b+"_n'><div id='"+a+"_top' class='"+b+"_title title_window'>"+this.options.title+"</div></td>\n          <td class='"+b+"_ne'></td>\n        </tr>\n      </table>\n      <table id='"+a+"_row2' class=\"mid table_window\">\n        <tr>\n          <td class='"+b+"_w'></td>\n            <td id='"+a+"_table_content' class='"+b+"_content' valign='top'>"+d+"</td>\n          <td class='"+b+"_e'></td>\n        </tr>\n      </table>\n        <table id='"+a+"_row3' class=\"bot table_window\">\n        <tr>\n          <td class='"+b+"_sw'></td>\n            <td class='"+b+"_s'><div id='"+a+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>\n            <td "+h+"></td>\n        </tr>\n      </table>\n    ",Element.hide(c),this.options.parent.insertBefore(c,this.options.parent.firstChild),Event.observe($(a+"_content"),"load",this.options.onload);return c},changeClassName:function(a){var b=this.options.className,c=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(d){this._toggleClassName($(c+d),b+d,a+d)}.bind(this)),this._toggleClassName($(c+"_top"),b+"_title",a+"_title"),$$("#"+c+" td").each(function(c){c.className=c.className.sub(b,a)}),this.options.className=a},_toggleClassName:function(a,b,c){a&&(a.removeClassName(b),a.addClassName(c))},setLocation:function(a,b){a=this._updateTopConstraint(a),b=this._updateLeftConstraint(b);var c=this.currentDrag||this.element;c.setStyle({top:a+"px"}),c.setStyle({left:b+"px"}),this.useLeft=!0,this.useTop=!0},getLocation:function(){var a={};this.useTop?a=Object.extend(a,{top:this.element.getStyle("top")}):a=Object.extend(a,{bottom:this.element.getStyle("bottom")}),this.useLeft?a=Object.extend(a,{left:this.element.getStyle("left")}):a=Object.extend(a,{right:this.element.getStyle("right")});return a},getSize:function(){return{width:this.width,height:this.height}},setSize:function(a,b,c){a=parseFloat(a),b=parseFloat(b),!this.minimized&&a<this.options.minWidth&&(a=this.options.minWidth),!this.minimized&&b<this.options.minHeight&&(b=this.options.minHeight),this.options.maxHeight&&b>this.options.maxHeight&&(b=this.options.maxHeight),this.options.maxWidth&&a>this.options.maxWidth&&(a=this.options.maxWidth);if(this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&c)new Effect.ResizeWindow(this,null,null,a,b,{duration:Window.resizeEffectDuration});else{this.width=a,this.height=b;var d=this.currentDrag?this.currentDrag:this.element;d.setStyle({width:a+this.widthW+this.widthE+"px"}),d.setStyle({height:b+this.heightN+this.heightS+"px"});if(!this.currentDrag||this.currentDrag==this.element){var e=$(this.element.id+"_content");e.setStyle({height:b+"px"}),e.setStyle({width:a+"px"})}}},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,!0)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,!0)},toFront:function(){this.element.style.zIndex<Windows.maxZIndex&&this.setZIndex(Windows.maxZIndex+1),this.iefix&&this._fixIEOverlapping()},getBounds:function(a){(!this.width||!this.height||!this.visible)&&this.computeBounds();var b=this.width,c=this.height;a||(b+=this.widthW+this.widthE,c+=this.heightN+this.heightS);var d=Object.extend(this.getLocation(),{width:b+"px",height:c+"px"});return d},computeBounds:function(){if(!this.width||!this.height){var a=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className);this.height?this.width=a+5:this.height=a+5}this.setSize(this.width,this.height),this.centered&&this._center(this.centerTop,this.centerLeft)},show:function(a){this.visible=!0;if(a){if(typeof this.overlayOpacity=="undefined"){var b=this;setTimeout(function(){b.show(a)},10);return}Windows.addModalWindow(this),this.modal=!0,this.setZIndex(Windows.maxZIndex+1),Windows.unsetOverflow(this)}else this.element.style.zIndex||this.setZIndex(Windows.maxZIndex+1);this.oldStyle&&this.getContent().setStyle({overflow:this.oldStyle}),this.computeBounds(),this._notify("onBeforeShow"),this.options.showEffect!=Element.show&&this.options.showEffectOptions?this.options.showEffect(this.element,this.options.showEffectOptions):this.options.showEffect(this.element),this._checkIEOverlapping(),WindowUtilities.focusedWindow=this,this._notify("onShow")},showCenter:function(a,b,c){this.centered=!0,this.centerTop=b,this.centerLeft=c,this.show(a)},isVisible:function(){return this.visible},_center:function(a,b){var c=WindowUtilities.getWindowScroll(this.options.parent),d=WindowUtilities.getPageSize(this.options.parent);typeof a=="undefined"&&(a=(d.windowHeight-(this.height+this.heightN+this.heightS))/2),a+=c.top,typeof b=="undefined"&&(b=(d.windowWidth-(this.width+this.widthW+this.widthE))/2),b+=c.left,this.setLocation(a,b),this.toFront()},_recenter:function(a){if(this.centered){var b=WindowUtilities.getPageSize(this.options.parent),c=WindowUtilities.getWindowScroll(this.options.parent);if(this.pageSize&&this.pageSize.windowWidth==b.windowWidth&&this.pageSize.windowHeight==b.windowHeight&&this.windowScroll.left==c.left&&this.windowScroll.top==c.top)return;this.pageSize=b,this.windowScroll=c,$("overlay_modal")&&$("overlay_modal").setStyle({height:b.pageHeight+"px"}),this.options.recenterAuto&&this._center(this.centerTop,this.centerLeft)}},hide:function(){this.visible=!1,this.modal&&(Windows.removeModalWindow(this),Windows.resetOverflow()),this.oldStyle=this.getContent().getStyle("overflow")||"auto",this.getContent().setStyle({overflow:"hidden"}),this.options.hideEffect(this.element,this.options.hideEffectOptions),this.iefix&&this.iefix.hide(),this.doNotNotifyHide||this._notify("onHide")},close:function(){if(this.visible){if(this.options.closeCallback&&!this.options.closeCallback(this))return;if(this.options.destroyOnClose){var a=this.destroy.bind(this);if(this.options.hideEffectOptions.afterFinish){var b=this.options.hideEffectOptions.afterFinish;this.options.hideEffectOptions.afterFinish=function(){b(),a()}}else this.options.hideEffectOptions.afterFinish=function(){a()}}Windows.updateFocusedWindow(),this.doNotNotifyHide=!0,this.hide(),this.doNotNotifyHide=!1,this._notify("onClose")}},minimize:function(){if(!this.resizing){var a=$(this.getId()+"_row2");if(!this.minimized){this.minimized=!0;var b=a.getDimensions().height;this.r2Height=b;var c=this.element.getHeight()-b;this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,null,null,null,this.height-b,{duration:Window.resizeEffectDuration}):(this.height-=b,this.element.setStyle({height:c+"px"}),a.hide());if(!this.useTop){var d=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:d+b+"px"})}}else{this.minimized=!1;var b=this.r2Height;this.r2Height=null;if(this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow)new Effect.ResizeWindow(this,null,null,null,this.height+b,{duration:Window.resizeEffectDuration});else{var c=this.element.getHeight()+b;this.height+=b,this.element.setStyle({height:c+"px"}),a.show()}if(!this.useTop){var d=parseFloat(this.element.getStyle("bottom"));this.element.setStyle({bottom:d-b+"px"})}this.toFront()}this._notify("onMinimize"),this._saveCookie()}},maximize:function(){if(!this.isMinimized()&&!this.resizing){Prototype.Browser.IE&&this.heightN===0&&this._getWindowBorderSize();if(this.storedLocation!==null)this._restoreLocation(),this.iefix&&this.iefix.hide();else{this._storeLocation(),Windows.unsetOverflow(this);var a=WindowUtilities.getWindowScroll(this.options.parent),b=WindowUtilities.getPageSize(this.options.parent),c=a.left,d=a.top;if(this.options.parent!=document.body){a={top:0,left:0,bottom:0,right:0};var e=this.options.parent.getDimensions();b.windowWidth=e.width,b.windowHeight=e.height,d=0,c=0}this.constraint&&(b.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right),b.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom),c+=Math.max(0,this.constraintPad.left),d+=Math.max(0,this.constraintPad.top));var f=b.windowWidth-this.widthW-this.widthE,g=b.windowHeight-this.heightN-this.heightS;this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,d,c,f,g,{duration:Window.resizeEffectDuration}):(this.setSize(f,g),this.element.setStyle(this.useLeft?{left:c}:{right:c}),this.element.setStyle(this.useTop?{top:d}:{bottom:d})),this.toFront(),this.iefix&&this._fixIEOverlapping()}this._notify("onMaximize"),this._saveCookie()}},isMinimized:function(){return this.minimized},isMaximized:function(){return this.storedLocation!==null},setOpacity:function(a){Element.setOpacity&&Element.setOpacity(this.element,a)},setZIndex:function(a){this.element.setStyle({zIndex:a}),Windows.updateZindex(a,this)},setTitle:function(a){if(!a||a=="")a="&nbsp;";Element.update(this.element.id+"_top",a)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(a){var b=$(this.getId()+"_bottom");typeof a=="object"?this.bottombar.firstChild?this.bottombar.replaceChild(a,this.bottombar.firstChild):this.bottombar.appendChild(a):this.bottombar.innerHTML=a},_checkIEOverlapping:function(){!this.iefix&&navigator.appVersion.indexOf("MSIE")>0&&navigator.userAgent.indexOf("Opera")<0&&this.element.getStyle("position")=="absolute"&&(this.iefix=Builder.node("iframe",{id:this.element.id+"_iefix",style:"display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);",src:"javascript:false;",frameborder:"0",scrolling:"no"}),this.element.parentNode.appendChild(this.iefix)),this.iefix&&setTimeout(this._fixIEOverlapping.bind(this),50)},_fixIEOverlapping:function(){try{Position.clone(this.element,this.iefix),this.iefix.style.zIndex=this.element.style.zIndex-1,this.iefix.show()}catch(a){}},_getWindowBorderSize:function(a){var b=this._createHiddenDiv(this.options.className+"_n");this.heightN=Element.getDimensions(b).height,b.parentNode.removeChild(b);var b=this._createHiddenDiv(this.options.className+"_s");this.heightS=Element.getDimensions(b).height,b.parentNode.removeChild(b);var b=this._createHiddenDiv(this.options.className+"_e");this.widthE=Element.getDimensions(b).width,b.parentNode.removeChild(b);var b=this._createHiddenDiv(this.options.className+"_w");this.widthW=Element.getDimensions(b).width,b.parentNode.removeChild(b);var b=document.createElement("div");b.className="overlay_"+this.options.className,document.body.appendChild(b);var c=this;setTimeout(function(){c.overlayOpacity=$(b).getStyle("opacity"),b.parentNode.removeChild(b)},10),Prototype.Browser.IE&&(this.heightS=$(this.getId()+"_row3").getDimensions().height,this.heightN=$(this.getId()+"_row1").getDimensions().height),Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420&&this.setSize(this.width,this.height),this.doMaximize&&this.maximize(),this.doMinimize&&this.minimize()},_createHiddenDiv:function(a){var b=document.body,c=document.createElement("div");c.setAttribute("id",this.element.id+"_tmp"),c.className=a,c.style.display="none",c.innerHTML="",b.insertBefore(c,b.firstChild);return c},_storeLocation:function(){this.storedLocation==null&&(this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:this.element.getStyle("top"),bottom:this.element.getStyle("bottom"),left:this.element.getStyle("left"),right:this.element.getStyle("right"),width:this.width,height:this.height})},_restoreLocation:function(){this.storedLocation!==null&&(this.useLeft=this.storedLocation.useLeft,this.useTop=this.storedLocation.useTop,this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration}):(this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right}),this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom}),this.setSize(this.storedLocation.width,this.storedLocation.height)),Windows.resetOverflow(),this._removeStoreLocation())},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){if(this.cookie){var a="";this.useLeft?a+="l:"+(this.storedLocation?this.storedLocation.left:this.element.getStyle("left")):a+="r:"+(this.storedLocation?this.storedLocation.right:this.element.getStyle("right")),this.useTop?a+=",t:"+(this.storedLocation?this.storedLocation.top:this.element.getStyle("top")):a+=",b:"+(this.storedLocation?this.storedLocation.bottom:this.element.getStyle("bottom")),a+=","+(this.storedLocation?this.storedLocation.width:this.width),a+=","+(this.storedLocation?this.storedLocation.height:this.height),a+=","+this.isMinimized(),a+=","+this.isMaximized(),WindowUtilities.setCookie(a,this.cookie)}},_createWiredElement:function(){if(!this.wiredElement){Prototype.Browser.IE&&this._getWindowBorderSize();var a=document.createElement("div");a.className="wired_frame "+this.options.className+"_wired_frame",a.style.position="absolute",this.options.parent.insertBefore(a,this.options.parent.firstChild),this.wiredElement=$(a)}this.useLeft?this.wiredElement.setStyle({left:this.element.getStyle("left")}):this.wiredElement.setStyle({right:this.element.getStyle("right")}),this.useTop?this.wiredElement.setStyle({top:this.element.getStyle("top")}):this.wiredElement.setStyle({bottom:this.element.getStyle("bottom")});var b=this.element.getDimensions();this.wiredElement.setStyle({width:b.width+"px",height:b.height+"px"}),this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30});return this.wiredElement},_hideWiredElement:function(){!!this.wiredElement&&!!this.currentDrag&&(this.currentDrag==this.element?this.currentDrag=null:(this.useLeft?this.element.setStyle({left:this.currentDrag.getStyle("left")}):this.element.setStyle({right:this.currentDrag.getStyle("right")}),this.useTop?this.element.setStyle({top:this.currentDrag.getStyle("top")}):this.element.setStyle({bottom:this.currentDrag.getStyle("bottom")}),this.currentDrag.hide(),this.currentDrag=null,this.doResize&&this.setSize(this.width,this.height)))},_notify:function(a){this.options[a]?this.options[a](this):Windows.notify(a,this)}};var Windows={windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:100,overlayShowEffectOptions:{duration:.5},overlayHideEffectOptions:{duration:.5},addObserver:function(a){this.removeObserver(a),this.observers.push(a)},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b==a})},notify:function(a,b){this.observers.each(function(c){c[a]&&c[a](a,b)})},getWindow:function(a){return this.windows.detect(function(b){return b.getId()==a})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=this.windows.length>=2?this.windows[this.windows.length-2]:null},register:function(a){this.windows.push(a)},addModalWindow:function(a){this.modalWindows.length===0?WindowUtilities.disableScreen(a.options.className,"overlay_modal",a.overlayOpacity,a.getId(),a.options.parent):(Window.keepMultiModalWindow?($("overlay_modal").style.zIndex=Windows.maxZIndex+1,Windows.maxZIndex+=1,WindowUtilities._hideSelect(this.modalWindows.last().getId())):this.modalWindows.last().element.hide(),WindowUtilities._showSelect(a.getId())),this.modalWindows.push(a)},removeModalWindow:function(a){this.modalWindows.pop(),this.modalWindows.length===0?WindowUtilities.enableScreen():Window.keepMultiModalWindow?(this.modalWindows.last().toFront(),WindowUtilities._showSelect(this.modalWindows.last().getId())):this.modalWindows.last().element.show()},register:function(a){this.windows.push(a)},unregister:function(a){this.windows=this.windows.reject(function(b){return b==a})},closeAll:function(){this.windows.each(function(a){Windows.close(a.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen(),this.modalWindows.each(function(a){a&&a.close()})},minimize:function(a,b){var c=this.getWindow(a);c&&c.visible&&c.minimize(),Event.stop(b)},maximize:function(a,b){var c=this.getWindow(a);c&&c.visible&&c.maximize(),Event.stop(b)},close:function(a,b){var c=this.getWindow(a);c&&c.close(),b&&Event.stop(b)},blur:function(a){var b=this.getWindow(a);!b||(b.options.blurClassName&&b.changeClassName(b.options.blurClassName),this.focusedWindow==b&&(this.focusedWindow=null),b._notify("onBlur"))},focus:function(a){var b=this.getWindow(a);!b||(this.focusedWindow&&this.blur(this.focusedWindow.getId()),b.options.focusClassName&&b.changeClassName(b.options.focusClassName),this.focusedWindow=b,b._notify("onFocus"))},unsetOverflow:function(a){this.windows.each(function(a){a.oldOverflow=a.getContent().getStyle("overflow")||"auto",a.getContent().setStyle({overflow:"hidden"})}),a&&a.oldOverflow&&a.getContent().setStyle({overflow:a.oldOverflow})},resetOverflow:function(){this.windows.each(function(a){a.oldOverflow&&a.getContent().setStyle({overflow:a.oldOverflow})})},updateZindex:function(a,b){a>this.maxZIndex&&(this.maxZIndex=a,this.focusedWindow&&this.blur(this.focusedWindow.getId())),this.focusedWindow=b,this.focusedWindow&&this.focus(this.focusedWindow.getId())}},Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(a,b){if(a&&typeof a!="string")Dialog._runAjaxRequest(a,b,Dialog.confirm);else{a=a||"",b=b||{};var c=b.okLabel?b.okLabel:"Ok",d=b.cancelLabel?b.cancelLabel:"Cancel";b=Object.extend(b,b.windowParameters||{}),b.windowParameters=b.windowParameters||{},b.className=b.className||"alert";var e="class ='"+(b.buttonClass?b.buttonClass+" ":"")+" ok_button'",f="class ='"+(b.buttonClass?b.buttonClass+" ":"")+" cancel_button'",a="\n      <div class='"+b.className+"_message'>"+a+"</div>\n        <div class='"+b.className+"_buttons'>\n          <input type='button' value='"+c+"' onclick='Dialog.okCallback()' "+e+"/>\n          <input type='button' value='"+d+"' onclick='Dialog.cancelCallback()' "+f+"/>\n        </div>\n    ";return this._openDialog(a,b)}},alert:function(a,b){if(a&&typeof a!="string")Dialog._runAjaxRequest(a,b,Dialog.alert);else{a=a||"",b=b||{};var c=b.okLabel?b.okLabel:"Ok";b=Object.extend(b,b.windowParameters||{}),b.windowParameters=b.windowParameters||{},b.className=b.className||"alert";var d="class ='"+(b.buttonClass?b.buttonClass+" ":"")+" ok_button'",a="\n      <div class='"+b.className+"_message'>"+a+"</div>\n        <div class='"+b.className+"_buttons'>\n          <input type='button' value='"+c+"' onclick='Dialog.okCallback()' "+d+"/>\n        </div>";return this._openDialog(a,b)}},info:function(a,b){if(a&&typeof a!="string")Dialog._runAjaxRequest(a,b,Dialog.info);else{a=a||"",b=b||{},b=Object.extend(b,b.windowParameters||{}),b.windowParameters=b.windowParameters||{},b.className=b.className||"alert";var a="<div id='modal_dialog_message' class='"+b.className+"_message'>"+a+"</div>";b.showProgress&&(a+="<div id='modal_dialog_progress' class='"+b.className+"_progress'>  </div>"),b.ok=null,b.cancel=null;return this._openDialog(a,b)}},setInfoMessage:function(a){$("modal_dialog_message").update(a)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(a,b){var c=b.className;!b.height&&!b.width&&(b.width=WindowUtilities.getPageSize(b.options.parent||document.body).pageWidth/2);if(b.id)this.dialogId=b.id;else{var d=new Date;this.dialogId="modal_dialog_"+d.getTime(),b.id=this.dialogId}if(!b.height||!b.width){var e=WindowUtilities._computeSize(a,this.dialogId,b.width,b.height,5,c);b.height?b.width=e+5:b.height=e+5}b.effectOptions=b.effectOptions,b.resizable=b.resizable||!1,b.minimizable=b.minimizable||!1,b.maximizable=b.maximizable||!1,b.draggable=b.draggable||!1,b.closable=b.closable||!1;var f=new Window(b);f.getContent().innerHTML=a,f.showCenter(!0,b.top,b.left),f.setDestroyOnClose(),f.cancelCallback=b.onCancel||b.cancel,f.okCallback=b.onOk||b.ok;return f},_getAjaxContent:function(a){Dialog.callFunc(a.responseText,Dialog.parameters)},_runAjaxRequest:function(a,b,c){a.options==null&&(a.options={}),Dialog.onCompleteFunc=a.options.onComplete,Dialog.parameters=b,Dialog.callFunc=c,a.options.onComplete=Dialog._getAjaxContent,new Ajax.Request(a.url,a.options)},okCallback:function(){var a=Windows.focusedWindow;if(!a.okCallback||a.okCallback(a))$$("#"+a.getId()+" input").each(function(a){a.onclick=null}),a.close()},cancelCallback:function(){var a=Windows.focusedWindow;$$("#"+a.getId()+" input").each(function(a){a.onclick=null}),a.close(),a.cancelCallback&&a.cancelCallback(a)}};Prototype.Browser.WebKit&&(Prototype.Browser.WebKitVersion=parseFloat(navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/))[1]));var WindowUtilities={getWindowScroll:function(parent){var T,L,W,H;parent=parent||document.body;if(parent!=document.body)T=parent.scrollTop,L=parent.scrollLeft,W=parent.scrollWidth,H=parent.scrollHeight;else{var w=window;with(w.document)w.document.documentElement&&documentElement.scrollTop?(T=documentElement.scrollTop,L=documentElement.scrollLeft):w.document.body&&(T=body.scrollTop,L=body.scrollLeft),w.innerWidth?(W=w.innerWidth,H=w.innerHeight):w.document.documentElement&&documentElement.clientWidth?(W=documentElement.clientWidth,H=documentElement.clientHeight):(W=body.offsetWidth,H=body.offsetHeight)}return{top:T,left:L,width:W,height:H}},getPageSize:function(a){a=a||document.body;var b,c,d,e;if(a!=document.body)b=a.getWidth(),c=a.getHeight(),e=a.scrollWidth,d=a.scrollHeight;else{var f,g;window.innerHeight&&window.scrollMaxY?(f=document.body.scrollWidth,g=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(f=document.body.scrollWidth,g=document.body.scrollHeight):(f=document.body.offsetWidth,g=document.body.offsetHeight),self.innerHeight?(b=self.innerWidth,c=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(b=document.documentElement.clientWidth,c=document.documentElement.clientHeight):document.body&&(b=document.body.clientWidth,c=document.body.clientHeight),g<c?d=c:d=g,f<b?e=b:e=f}return{pageWidth:e,pageHeight:d,windowWidth:b,windowHeight:c}},disableScreen:function(a,b,c,d,e){WindowUtilities.initLightbox(b,a,function(){this._disableScreen(a,b,c,d)}.bind(this),e||document.body)},_disableScreen:function(a,b,c,d){var e=$(b),f=WindowUtilities.getPageSize(document.body);d&&Prototype.Browser.IE&&(WindowUtilities._hideSelect(),WindowUtilities._showSelect(d)),e.style.height=f.pageHeight+"px",e.style.display="none",b=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayShowEffectOptions?(e.overlayOpacity=c,new Effect.Appear(e,Object.extend({from:0,to:c},Windows.overlayShowEffectOptions))):e.style.display="block"},enableScreen:function(a){a=a||"overlay_modal";var b=$(a);b&&(a=="overlay_modal"&&Window.hasEffectLib&&Windows.overlayHideEffectOptions?new Effect.Fade(b,Object.extend({from:b.overlayOpacity,to:0},Windows.overlayHideEffectOptions)):(b.style.display="none",b.parentNode.removeChild(b)),a!="__invisible__"&&WindowUtilities._showSelect())},_hideSelect:function(a){Prototype.Browser.IE&&(a=a==null?"":"#"+a+" ",$$(a+"select").each(function(a){WindowUtilities.isDefined(a.oldVisibility)||(a.oldVisibility=a.style.visibility?a.style.visibility:"visible",a.style.visibility="hidden")}))},_showSelect:function(a){Prototype.Browser.IE&&(a=a==null?"":"#"+a+" ",$$(a+"select").each(function(a){if(WindowUtilities.isDefined(a.oldVisibility)){try{a.style.visibility=a.oldVisibility}catch(b){a.style.visibility="visible"}a.oldVisibility=null}else a.style.visibility&&(a.style.visibility="visible")}))},isDefined:function(a){return typeof a!="undefined"&&a!==null},initLightbox:function(a,b,c,d){if($(a))Element.setStyle(a,{zIndex:Windows.maxZIndex+1}),Windows.maxZIndex++,c();else{var e=document.createElement("div");e.setAttribute("id",a),e.className="overlay_"+b,e.style.display="none",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=Windows.maxZIndex+1,Windows.maxZIndex++,e.style.width="100%",d.insertBefore(e,d.firstChild),Prototype.Browser.WebKit&&a=="overlay_modal"?setTimeout(function(){c()},10):c()}},setCookie:function(a,b){document.cookie=b[0]+"="+escape(a)+(b[1]?"; expires="+b[1].toGMTString():"")+(b[2]?"; path="+b[2]:"")+(b[3]?"; domain="+b[3]:"")+(b[4]?"; secure":"")},getCookie:function(a){var b=document.cookie,c=a+"=",d=b.indexOf("; "+c);if(d==-1){d=b.indexOf(c);if(d!==0)return null}else d+=2;var e=document.cookie.indexOf(";",d);e==-1&&(e=b.length);return unescape(b.substring(d+c.length,e))},_computeSize:function(a,b,c,d,e,f){var g=document.body,h=document.createElement("div");h.setAttribute("id",b),h.className=f+"_content",d?h.style.height=d+"px":h.style.width=c+"px",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.display="none",h.innerHTML=a,g.insertBefore(h,g.firstChild);var i;d?i=$(h).getDimensions().width+e:i=$(h).getDimensions().height+e,g.removeChild(h);return i}},WindowCloseKey={keyCode:Event.KEY_ESC,init:function(a){a&&(WindowCloseKey.keyCode=a),Event.observe(document,"keydown",this._closeCurrentWindow.bindAsEventListener(this))},_closeCurrentWindow:function(a){var b=a||window.event,c=b.which||b.keyCode,d=top.Windows.focusedWindow;c==WindowCloseKey.keyCode&&d&&(d.cancelCallback?top.Dialog.cancelCallback():d.okCallback?top.Dialog.okCallback():top.Windows.close(top.Windows.focusedWindow.getId()))}},focus_element_id=!1,_LOC=function(){var a=loc_data;return function(b,c){if(a&&a[b])return a[b];return c||b}}(),update_online_help_link=function(){function c(c){c.popupName?(b=core.popupMap[c.popupName],b.helpButton.href=c.helplink):(b=$$(".OHELP_LINK"),b&&b.each(function(a,b){a.setAttribute("href",c.helplink)})),a[c.helpuuid]=c.helplink}var a={},b;return function(b,d){core.display_current=b,a[b]?c({helplink:a[b],helpuuid:b,popupName:d}):req_send({objs:[{FID:"update_online_help_link",helpuuid:b,popupName:d,callback:c}]})}}(),up2datepbwin,start_download=function(){var a={};return function(b){var c=new RegExp(/(^.+\/)(.+)/),d=c.exec(b),e=d[2],f=d[1],g;if(e.match(/\.log$/)&&(browser!="ie"||core.tools.getIEVersion()>8)&&!core.tools.isTouchDevice()){var h=e.replace(/[^A-Za-z]/g,"");a[e]=window.open(encodeURI(b),h+(new Date).getTime(),"height=600,width=1000,resizable=yes,location=no,menubar=no,scrollbars=yes,status=no,toolbar=no")}else e.match(/\.log$/)&&core.tools.isTouchDevice()?(g=new Window({className:"astaro",width:300,height:100,title:_LOC("MzHeotXcoa","Download:")+" "+e}),g.show(),g.setContent(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("span",{},[Builder.node("a",{href:encodeURI(b)},[Builder.node("img",{src:"core/img/icons/download_big.png",align:"left"}),_LOC("XsklKPzmKC","Please touch this link for a while and then click 'Open in new Tab'.")])])]))):window.frames.download.location.href=f+fixedEncodeURIComponent(e)}}();(function(a){function e(a){return function(c,e){var f;b[a]||(b[a]=new d({type:a})),f=b[a],f.open(c,e)}}var b={},c,d;c=function(a){this.options=Object.extend({type:"live",logId:!1,onclose:function(){}},a||{}),this.readyState=!1,this.isReload=!1},c.prototype=function(){function e(){typeof this.win.setTitle=="function"||typeof this.win.setTitle=="object"?(req_send({objs:[{FID:this.options.type==="live"?"log_init":"query_init",log_id:this.options.logId,query_id:this.options.logId,callback:d.bind(this)}]}),this.options.type==="live"&&Event.observe($(this.win.document.getElementById("reloadButton")),"click",this.reload.bind(this))):a.setTimeout(e.bind(this),1e3)}function d(a){this.token=a.token,this.readyState=!0,this.isReload?this.isReload=!1:(this.win.setTitle(a.logname),this.win.addEventListener?this.win.addEventListener("beforeunload",this.close.bind(this)):this.win.attachEvent&&this.win.attachEvent("onbeforeunload",this.close.bind(this))),a.lines&&c.call(this,a)}function c(a){a&&a.token&&a.lines&&this.win&&a.lines.each(this.win.addLine)}function b(a){return window.open(a==="live"?"logwin.html":"querylogwin.html","logwindow"+(new Date).getTime(),"height=600,width=1000,resizable=yes,location=no,menubar=no,scrollbars=yes,status=no,toolbar=no")}return{open:function(){this.win=b(this.options.type),a.setTimeout(e.bind(this),1)},reload:function(){this.readyState=!1,this.isReload=!0,this.win.reset(),req_send({objs:[{FID:"log_kill",token:this.token},{FID:this.options.type==="live"?"log_init":"query_init",log_id:this.options.logId,query_id:this.options.logId,callback:d.bind(this)}]})},getCallObject:function(){var a,b;b=this.win.document.getElementById("stringfilter"),a=b?b.value:"";return{FID:"log_tail",stringfilter:a,token:this.token,web_table_output:this.options.web_table_output,log_id:this.options.logId,callback:c.bind(this)}},isReady:function(){if(this.readyState&&this.win&&this.win.closed){this.close();return!1}return this.readyState},close:function(){this.readyState=!1,this.options.onclose(),req_send({objs:[{FID:"log_kill",token:this.token}]})}}}(),d=function(a){this.options=Object.extend({type:"live"},a||{}),this.logfiles=[],this.started=!1},d.prototype=function(){function e(){this.started=!1,a.clearTimeout(this.loopTimeout)}function d(){this.started=!0,b.call(this)}function b(){var c=this.logfiles.length,d,f=[],g,h,i;if(!c)e.call(this);else{while(c--)d=this.logfiles[c],d.isReady()&&(i=d.getCallObject(),f.push(i));f.length?req_send({objs:f,background:!0,onfinal:function(){this.loopTimeout=a.setTimeout(b.bind(this),1e3)}.bind(this)}):this.loopTimeout=a.setTimeout(b.bind(this),1e3)}}return{open:function(a,b){var e=this.logfiles.length,f;while(e--)if(this.logfiles[e].options.logId===a)return!1;f=new c({logId:a,web_table_output:b?1:0,type:this.options.type,onclose:function(){var b=this.logfiles.length;while(b--)if(this.logfiles[b].options.logId===a){this.logfiles.splice(b,1);return!1}}.bind(this)}),this.logfiles.push(f),f.open(),this.started||d.call(this);return!0},terminate:function(){var a=this.logfiles.length;e.call(this);while(a--)try{this.logfiles[a].win.close()}catch(b){}}}}(),a.open_logfile_live=e("live"),a.open_logfile_query=e("query"),a.terminate_logfiles=function(){b.query&&b.query.terminate(),b.live&&b.live.terminate()}})(window);var _debug=function(){function b(b){if(a)try{window.console.info(b)}catch(c){}}var a=window.console&&window.console.log&&window.console.debug&&window.console.assert;return function(a,c,d){if(!wdebug&&!d)return!0;try{var e="",f,g=new Date,h=c?"P":"C",i=g.toLocaleString()+" "+h+" "+"["+SID+"]";typeof a=="object"&&a.length?e+=Object.toJSON(a):typeof a=="object"&&!a.length?e+=Object.toJSON(a):e+=a,_debug.caller?f=_debug.caller.name:f="__global__",f&&(i+=" >> called from function: "+f),b(e+"\r\n---------------------------------------"+i)}catch(j){}}}(),logged_in=!1;Event.observe(document,"keydown",keyDown.bindAsEventListener());var get_grey_status_icon=function(){return function(a){return Builder.node("div",{title:_LOC("UqgaMxMYWG","Inactive"),id:"status_slider"+(a?"_small":""),className:"status_slider_small_inactive"})}}(),auto_hide_elements={},update_browser_title=function(){return function(a){document.title=a.unescapeHTML()}}(),infopop_down_timer,wait_popup=function(){var a=!1,b=!1,c;return function(d,e,f){a||(a=$("pleasewait")),f&&!b&&(b=Builder.node("div",{}),a.appendChild(b)),f&&(b.style.width=f>100?100:f+"%");if(a){d?(c||(c=document.createElement("span"),a.appendChild(c)),c.innerHTML=e,a.style.zIndex=1e3,a.style.visibility="visible",a.style.left=Math.floor($("right").getWidth()/2-a.getWidth()/2+$("right").cumulativeOffset()[0])+"px"):(a.style.zIndex=0,a.style.visibility="hidden",c.nodeValue="",b.style.width="0%");return a.style.visibility=="visible"}return!1}}(),popupCounter=0,interactionPopupIsOpen=!1;Event.observe(window,"keyup",function(a){a.keyCode&&a.keyCode==27&&core.alertMap.length&&interactionPopup({open:!1,iPopup:core.alertMap.pop().id})});var license_info_texts={DEFAULT:_LOC("HgzpgNfQeX","Licensing Info - This page is disabled as you either do not have a relevant subscription or the relevant subscription has expired!"),HOMEUSE:_LOC("QDaMnbLcue","Licensing Info - This page is disabled as you only have a Home User License!"),HOMEUSESOME:_LOC("LuoQMaBHOb","Licensing Info - Some features are disabled as you only have a Home User License!"),FEATURE:_LOC("IRBeTXjIhf","Licensing Info - This feature is disabled as you either do not have a relevant subscription or the relevant subscription has expired!"),SOMEFEAT:_LOC("rRHceuJIoe","Licensing Info - Some features are disabled as you either do not have a relevant subscription or the relevant subscription has expired!"),MSP:_LOC("AWBBaQRhIu","Licensing Info - License installation is disabled as MSP Licensing is activated!"),MSPCM:_LOC("YcdeoFInoM","Licensing Info - Deactivation of Central Management, changing of SUM host and features are disabled as MSP Licensing is activated!")},license_restriction=function(){return function(a){var b=Object.extend({text:license_info_texts.DEFAULT,text_id:"DEFAULT",reset:!1,element:"",tabset_name:cur_tabset,tabset_index:cur_tabs[cur_tabset]},a||{});b.text_id&&b.text_id!=="DEFAULT"&&(b.text=license_info_texts[b.text_id]);if(b.element)license_exception(b.element,b.text,b.reset);else{tab_fade_in(b.tabset_name,b.tabset_index),b.element="TABSET_"+b.tabset_name+"_CONTENT",license_exception(b.element,b.text,b.reset);try{document.getElementsByClassName("status_slider_on").each(function(a){a.className="status_slider_off",a.setAttribute("oldstatus","GREEN")}),document.getElementsByClassName("status_slider_off").each(function(a){a.className="status_slider_off",a.setAttribute("oldstatus","RED")})}catch(c){_debug(c)}}}}(),license_exception=function(){var a=0;return function(b,c,d){if(d){a=0;return!0}input_deactivate(b);var e;typeof c=="undefined"?e=license_info_texts.FEATURE:e=c,a>0&&typeof c=="undefined"&&(e=license_info_texts.SOME);if($("license_exception"))$("license_exception").innerHTML=e;else{var f='<div class="license_exception" id="license_exception">'+e+"</div>";new Insertion.Top("display",f)}a++}}();(function(a){if(window.File&&window.FileReader&&window.FileList&&window.Blob){function b(a,b){this.file=a,this.output=[],this.reader=new FileReader,this.licenseInfo={},this.licenseOptions={},this.netsec={},this.websec={},this.mailsec={},this.webappsec={},this.basicguard={},this.wireless={},this.sandstorm={},this.endpoint={},this.premsupp={},this.stdsupp={},this.ama={},this.reader.onload=function(a){var c,d,e,f;this.fileContent=a.target.result,this.fileLines=this.fileContent.split(/\r|\n/),c=this.fileLines.length;for(d=0;d<c;d++){e=this.fileLines[d].split(" = ");if(e[0]==="[LicenseInfo]"){f="LI";continue}f==="LI"&&e[1]&&(this.licenseInfo[e[0]]=e[1]);if(e[0]==="[LicenseOptions]"){f="LO";continue}f==="LO"&&e[1]&&(this.licenseOptions[e[0]]=e[1]);if(e[0]==="[NetworkSecurity]"){f="NETSEC";continue}f==="NETSEC"&&e[1]&&(this.netsec[e[0]]=e[1]);if(e[0]==="[WebSecurity]"){f="WEBSEC";continue}f==="WEBSEC"&&e[1]&&(this.websec[e[0]]=e[1]);if(e[0]==="[MailSecurity]"){f="MAILSEC";continue}f==="MAILSEC"&&e[1]&&(this.mailsec[e[0]]=e[1]);if(e[0]==="[WebApplicationSecurity]"){f="WEBAPPSEC";continue}f==="WEBAPPSEC"&&e[1]&&(this.webappsec[e[0]]=e[1]);if(e[0]==="[BasicGuard]"){f="BASICGUARD";continue}f==="BASICGUARD"&&e[1]&&(this.basicguard[e[0]]=e[1]);if(e[0]==="[WirelessSecurity]"){f="WIRELESS";continue}f==="WIRELESS"&&e[1]&&(this.wireless[e[0]]=e[1]);if(e[0]==="[Sandstorm]"){f="SANDSTORM";continue}f==="SANDSTORM"&&e[1]&&(this.sandstorm[e[0]]=e[1]);if(e[0]==="[EndpointAntiVirus]"){f="ENDPOINT";continue}f==="ENDPOINT"&&e[1]&&(this.endpoint[e[0]]=e[1]);if(e[0]==="[PremiumSupport]"){f="PREMSUPP";continue}f==="PREMSUPP"&&e[1]&&(this.premsupp[e[0]]=e[1]);if(e[0]==="[StandardSupport]"){f="STDSUPP";continue}f==="STDSUPP"&&e[1]&&(this.stdsupp[e[0]]=e[1]);if(e[0]==="[AMA Service]"){f="AMA";continue}f==="AMA"&&e[1]&&(this.ama[e[0]]=e[1])}b&&b(this)}.bind(this),this.reader.readAsText(this.file)}b.prototype=function(){return{getFileInfo:function(){},getLicenseInfo:function(){return this.licenseInfo},getLicenseOptions:function(){return this.licenseOptions},getNetSec:function(){return this.netsec},getWebSec:function(){return this.websec},getMailSec:function(){return this.mailsec},getWebAppSec:function(){return this.webappsec},getSandstorm:function(){return this.sandstorm},getBasicGuard:function(){return this.basicguard},getWireless:function(){return this.wireless},getEndpoint:function(){return this.endpoint},getPremSupp:function(){return this.premsupp},getStdSupp:function(){return this.stdsupp},getAma:function(){return this.ama}}}(),a.getLicenseDetails=function(a,c){function d(a){}var e=a.files,f=new b(e[0],c||d);return f}}else a.getLicenseDetails=function(){return!1}})(window);var core={Version:"1",alertMap:[],tableMap:{},tableMapOffsets:{},dropdownMap:{},uploadMap:{},popupMap:{},listMap:{},buttonMap:{},minitableMap:{},formMap:{},usageMap:{},dynTabs:{},reportMap:{},calendarMap:{},openedWindows:[],dynIncPath:"core/js/dynamic_includes/",iPopupMap:[],utils:{},userPreferences:{},feed:!1,ipv6:!0,meta_objects:{},display_current:"",capslock_observer:!1,tools:{},terms_of_use:null,popularity:null},SID=0,_cookie=null,ap=!1,loc="",loc_data=!1,cur_display_req=!1,cur_tab_req=!1,usefx=!0,browser=browser||"gecko",iconext=iconext||".png",wdebug=wdebug||0,dynIncPath="core/js/dynamic_includes/",dynIncMaxRetries=1,alt_keys={V:function(){wdebug=!wdebug}},ctrl_keys={},simpleErrors={__DEFAULT:_LOC("OGhjbyVrxF","You did not enter all required data, or one or more settings are syntactically invalid."),UPLINK_DEFAULT_GW:_LOC("IDMFqrXviH","Default gateways only allowed on Uplink Interfaces."),SIX2FOUR_DEFAULT_GW:_LOC("ebUlYAWAId","Can't enable IPv6 Default Gateway, 6to4<br>and Tunnel Broker at the same time.")},dnd_setup=!1;core.Events=function(){"use strict";var a={};return{observe:function(b,c,d){a[b]||(a[b]=[]),typeof c=="function"&&a[b].push({cb:c,single:!!d})},stopObserving:function(b,c){var d,e;if(a[b]){d=a[b].length;for(e=0;e<d;e++)a[b][e].cb===c&&a[b].splice(e,1)}},fire:function(b,c){var d,e;if(a[b]){d=a[b].length;for(e=0;e<d;e++)a[b][e].cb(c),a[b][e].single&&a[b].splice(e,1)}}}}(),core.utils.scriptloader=function(){function require(scriptFile,force,returnToEval,asynchronous,onFail){var result=0,i=0;if(typeof scriptFile=="object"&&scriptFile.length&&asynchronous){var current=scriptFile.shift();onFail=require.curry(scriptFile,force,returnToEval,asynchronous,onFail),scriptFile=current}_debug("trying to get "+scriptFile+"\nforce: "+force+"\nreturnToEval: "+returnToEval);if(includedFiles404[scriptFile])return-1;if(!!includedFiles[scriptFile]&&!force){if(returnToEval)return includedFiles[scriptFile];eval(includedFiles[scriptFile]);return 1}try{scriptRequest=new Ajax.Request(scriptFile+"?rnd="+Math.random(),{method:"get",asynchronous:!!asynchronous,onSuccess:function(transport){try{includedFiles[scriptFile]=transport.responseText;if(returnToEval){result=transport.responseText;return}eval(transport.responseText),result=1;return}catch(e){_debug(e),result=-1;return}},on404:function(a){includedFiles404[scriptFile]=!0,_debug("File <"+scriptFile+"> not found. This must not be an error, maybe the module is optional or not yet configured ."),result=-1,typeof onFail=="function"&&onFail();return}})}catch(e){_debug(e)}return result}var includedFiles404={},includedFiles={},scriptRequest;return{require:require}}(),core.utils.uuid=function(){var a={};return function(b,c,d){typeof a[b]=="undefined"?req_send({objs:[{FID:"uuid",uuid:b,callback:function(e){e.uuid_check?a[b]=!1:(a[b]=!0,c.apply(window,d))}}]},!1):a[b]===!0&&c.apply(window,d)}}(),core.utils.init_user_preferences=function(a){core.userPreferences=a,core.utils.apply_user_preferences()},core.utils.apply_user_preferences=function(){$H(core.userPreferences.shortcuts).each(function(a,b){!Object.isArray(a[1])||a[1].length<2?(_debug("Key Code for shortcut "+a[0]+" does not exist stopping shortcut"),app["dnd_show_"+a[0]].stop()):a[0]!=="searchbox"?a[1][0]!=="OFF"?(app["dnd_show_"+a[0]].stop(),app["dnd_show_"+a[0]].setKeys(Keys.TRIGGERKEYS[a[1][0]],a[1][1]),app["dnd_show_"+a[0]].start()):(_debug("Stopping shortcut for "+a[0]+" overlay"),app["dnd_show_"+a[0]].stop()):a[1][0]!=="OFF"?app.focus_searchbox.setKeys(Keys.TRIGGERKEYS[a[1][0]],a[1][1]):(_debug("Stopping shortcut for searchbox"),app.focus_searchbox.stop())})},core.utils.transformers={bits:function(a,b){var c=1024,d=["","k","M","G","T","P"],e=0,f=0,g=0;if(Object.isArray(a)){b=core.utils.transformers.bits(a.max())[1],f=a.length;while(f--)a[f]=core.utils.transformers.bits(a[f],b);return[a,b]}if(b){g=d.indexOf(b);for(f=0;f<g;f++)a/=c;return a}while(a>c)a/=c,e++;return[a,d[e]]},metric:function(a){var b=1e3,c=["","k","M","G","T","P"],d=0;while(a>b)a/=b,d++;return[a,c[d]]}},core.tools.toggleFieldset=function(){var a={},b=function(b,c,d,e,f){a[c].toggled?(b.hide(),d.src=f.src,d.title=_LOC("JXDpQeSeTK","Show Content")):(b.show(),d.src=e.src,d.title=_LOC("mYVqmBuSgm","Hide Content"))},c=new Image,d=new Image,e=!1,f=function(){d.src="core/img/table_content_collapse.png",c.src="core/img/table_content_expand.png",e=!0};return function(g){if(!g.anchor||!g.target)return!1;var h=g.anchor,i=g.target,j=new Image,k=h.name||h.id;e||f(),a[k]||(a[k]={toggled:!0,anchor:!1,target:i}),g.forcedflt&&(a[k].toggled=g.dflt!=="expanded"),a[k].anchor!==h&&(h.setStyle({position:"relative",cssFloat:"right",cursor:"pointer"}),j.src=d.src,j.title=_LOC("zVsQKeThRx","Hide Content"),h.appendChild(j),a[k].anchor=h,b(i,k,j,d,c),Event.observe(h,"click",function(c,d,e,f,g){a[d].toggled=!a[d].toggled,b(c,d,e,f,g)}.curry(i,k,j,d,c)))}}(),core.tools.observeElementsByClassName=function(a,b,c){document.getElementsByClassName(a).each(function(a){Event.observe($(a),b,c)})},core.tools.getScrollbarWidth=function(){var a=!1;return function(){if(!a){var b=$(Builder.node("div",{style:"overflow:hidden;display:none;height:50px;width:100px;"},Builder.node("div",{style:"height:200px;width:10px;"}))),c=0,d=0;document.body.appendChild(b),c=b.getWidth(),b.setStyle({overflowY:"scroll"}),d=b.getWidth(),a=c-d,document.body.removeChild(b)}return a}}(),core.tools.htmlEntityDecode=function(){var a=document.createElement("textarea");return function(b){if(!b)return"";a.innerHTML=String(b).replace(/</g,"&lt;").replace(/>/g,"&gt;");return a.value}}(),core.tools.getIEVersion=function(){var a=-1;if(navigator.appName=="Microsoft Internet Explorer"){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");c.exec(b)!==null&&(a=parseFloat(RegExp.$1))}return function(){return a}}(),core.tools.isTouchDevice=function(){var a="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;return function(){return a}}(),core.tools.cookiesEnabled=typeof navigator.cookieEnabled!="undefined"?navigator.cookieEnabled:function(){var a=!1,b=document.cookie;document.cookie="test",a=document.cookie.indexOf("test")!=-1,document.cookie=b;return a}(),core.tools.terms_of_use=function(a){core.terms_of_use=new Window({className:"astaro",width:710,height:500,resizable:!1,draggable:!1,minimizable:!1,maximizable:!1,destroyOnClose:!0,closable:!1}),core.terms_of_use.setHTMLContent(a),core.terms_of_use.showCenter(!0)},core.tools.popularity=function(a,b){core.popularity=new Window({className:"astaro",width:410,height:200,resizable:!1,draggable:!1,minimizable:!1,maximizable:!1,destroyOnClose:!0,closable:!1,title:b}),core.popularity.setHTMLContent(a),core.popularity.showCenter(!0)},core.tools.clearDndSelection=function(){dndMgr&&typeof dndMgr=="object"&&dndMgr.hasSelection()&&dndMgr.clearSelection()},core.utils.gotoLastScrollPos=function(){var a,b=function(b){a=document.documentElement.scrollTop};return function(c){c?b():document.documentElement.scrollTop=a}}(),core.utils.greyimage=function(){var a=document.createElement("canvas"),b=!!a.getContext&&!!a.getContext("2d"),c,d={};if(!b)return function(a){return a};c=a.getContext("2d");return function(b){if(d[b.src])return d[b.src];var e=b.width,f=b.height,g,h,i,j,k,l;a.width=e,a.height=f,c.drawImage(b,0,0),g=c.getImageData(0,0,e,f);for(h=0;h<g.height;h++)for(i=0;i<g.width;i++)j=i*4*g.width+h*4,l=(g.data[j]+g.data[j+1]+g.data[j+2])/3,g.data[j]=l,g.data[j+1]=l,g.data[j+2]=l;c.putImageData(g,0,0,0,0,g.width,g.height),d[b.src]=a.toDataURL();return d[b.src]}}(),core.Slider=Class.create({initialize:function(a,b,c){var d=this;Object.isArray(a)?this.handles=a.collect(function(a){return $(a)}):this.handles=[$(a)],this.track=$(b),this.options=c||{},this.axis=this.options.axis||"horizontal",this.increment=this.options.increment||1,this.step=parseInt(this.options.step||"1",10),this.range=this.options.range||$R(0,1),this.value=0,this.values=this.handles.map(function(){return 0}),this.spans=this.options.spans?this.options.spans.map(function(a){return $(a)}):!1,this.options.startSpan=$(this.options.startSpan||null),this.options.endSpan=$(this.options.endSpan||null),this.restricted=this.options.restricted||!1,this.maximum=this.options.maximum||this.range.end,this.minimum=this.options.minimum||this.range.start,this.alignX=parseInt(this.options.alignX||"0",10),this.alignY=parseInt(this.options.alignY||"0",10),this.trackLength=this.maximumOffset()-this.minimumOffset(),this.handleLength=this.isVertical()?this.handles[0].offsetHeight!==0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,""):this.handles[0].offsetWidth!==0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""),this.active=!1,this.dragging=!1,this.disabled=!1,this.options.disabled&&this.setDisabled(),this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):!1,this.allowedValues&&(this.minimum=this.allowedValues.min(),this.maximum=this.allowedValues.max()),this.eventMouseDown=this.startDrag.bindAsEventListener(this),this.eventMouseUp=this.endDrag.bindAsEventListener(this),this.eventMouseMove=this.update.bindAsEventListener(this),this.handles.each(function(a,b){b=d.handles.length-1-b,d.setValue(parseFloat((Object.isArray(d.options.sliderValue)?d.options.sliderValue[b]:d.options.sliderValue)||d.range.start),b),a.makePositioned().observe("mousedown",d.eventMouseDown)}),this.track.observe("mousedown",this.eventMouseDown),Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"mousemove",this.eventMouseMove),this.initialized=!0},dispose:function(){var a=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown),Event.stopObserving(document,"mouseup",this.eventMouseUp),Event.stopObserving(document,"mousemove",this.eventMouseMove),this.handles.each(function(b){Event.stopObserving(b,"mousedown",a.eventMouseDown)})},setDisabled:function(){this.disabled=!0},setEnabled:function(){this.disabled=!1},getNearestValue:function(a){if(this.allowedValues){if(a>=this.allowedValues.max())return this.allowedValues.max();if(a<=this.allowedValues.min())return this.allowedValues.min();var b=Math.abs(this.allowedValues[0]-a),c=this.allowedValues[0];this.allowedValues.each(function(d){var e=Math.abs(d-a);e<=b&&(c=d,b=e)});return c}if(a>this.range.end)return this.range.end;if(a<this.range.start)return this.range.start;return a},getLabelText:function(){return this.options.labels[this.getValue()]},getValue:function(){return this.values.length>1?this.values:this.value},setValue:function(a,b){this.active||(this.activeHandleIdx=b||0,this.activeHandle=this.handles[this.activeHandleIdx],this.updateStyles()),b=b||this.activeHandleIdx||0,this.initialized&&this.restricted&&(b>0&&a<this.values[b-1]&&(a=this.values[b-1]),b<this.handles.length-1&&a>this.values[b+1]&&(a=this.values[b+1])),a=this.getNearestValue(a),this.values[b]=a,this.value=this.values[0],this.handles[b].style[this.isVertical()?"top":"left"]=this.translateToPx(a),this.drawSpans(),(!this.dragging||!this.event)&&this.updateFinished()},setValueBy:function(a,b){this.setValue(this.values[b||this.activeHandleIdx||0]+a,b||this.activeHandleIdx||0)},translateToPx:function(a){return Math.round((this.trackLength-this.handleLength)/(this.range.end-this.range.start)*(a-this.range.start))+"px"},translateToValue:function(a){this.trackLength||(this.trackLength=this.maximumOffset()-this.minimumOffset());return a/(this.trackLength-this.handleLength)*(this.range.end-this.range.start)+this.range.start},getRange:function(a){var b=this.values.sortBy(Prototype.K);a=a||0;return $R(b[a],b[a+1])},minimumOffset:function(){return this.isVertical()?this.alignY:this.alignX},maximumOffset:function(){return this.isVertical()?(this.track.offsetHeight!==0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!==0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX},isVertical:function(){return this.axis=="vertical"},drawSpans:function(){var a=this;this.spans&&$R(0,this.spans.length-1).each(function(b){a.setSpan(a.spans[b],a.getRange(b))}),this.options.startSpan&&this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value)),this.options.endSpan&&this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum))},setSpan:function(a,b){this.isVertical()?(a.style.top=this.translateToPx(b.start),a.style.height=this.translateToPx(b.end-b.start+this.range.start)):(a.style.left=this.translateToPx(b.start),a.style.width=this.translateToPx(b.end-b.start+this.range.start))},updateStyles:function(){this.handles.each(function(a){Element.removeClassName(a,"selected")}),Element.addClassName(this.activeHandle,"selected")},startDrag:function(a){if(Event.isLeftClick(a)){if(!this.disabled){this.active=!0;var b=Event.element(a),c=[Event.pointerX(a),Event.pointerY(a)],d=b,e;if(d==this.track)e=Position.cumulativeOffset(this.track),this.event=a,this.setValue(this.translateToValue((this.isVertical()?c[1]-e[1]:c[0]-e[0])-this.handleLength/2)),e=Position.cumulativeOffset(this.activeHandle),this.offsetX=c[0]-e[0],this.offsetY=c[1]-e[1];else{while(this.handles.indexOf(b)==-1&&b.parentNode)b=b.parentNode;this.handles.indexOf(b)!=-1&&(this.activeHandle=b,this.activeHandleIdx=this.handles.indexOf(this.activeHandle),this.updateStyles(),e=Position.cumulativeOffset(this.activeHandle),this.offsetX=c[0]-e[0],this.offsetY=c[1]-e[1])}}Event.stop(a)}},update:function(a){this.active&&(this.dragging||(this.dragging=!0),this.draw(a),Prototype.Browser.WebKit&&window.scrollBy(0,0),Event.stop(a))},draw:function(a){var b=[Event.pointerX(a),Event.pointerY(a)],c=Position.cumulativeOffset(this.track);b[0]-=this.offsetX+c[0],b[1]-=this.offsetY+c[1],this.event=a,this.setValue(this.translateToValue(this.isVertical()?b[1]:b[0])),infopop_up(a.element,"test"),this.initialized&&this.options.onSlide&&this.options.onSlide(this.values.length>1?this.values:this.value,this)},endDrag:function(a){this.active&&this.dragging&&(this.finishDrag(a,!0),Event.stop(a)),this.active=!1,this.dragging=!1},finishDrag:function(a,b){this.active=!1,this.dragging=!1,this.updateFinished()},updateFinished:function(){this.initialized&&this.options.onChange&&(typeof this.options.onChange!="function"?eval(this.options.onChange):this.options.onChange(this.values.length>1?this.values:this.value,this)),this.event=null}}),core.input={elements:[],hideElements:[],create:function(a){var b;a.id||(a.id=this.getId(a.type,a.name));try{b=core.input.factory.create(a)}catch(c){_debug(c)}this.elements.push(b);return b},getId:function(a,b){return"ELEMENT_"+b}},core.input.factory={errorMessages:{typeMissing:"no type defined in options",typeNotImplemented:"this type is not implemented",typeNotAFunction:"this type is not a Class"},create:function(a){if(!a.type)throw new Error(this.errorMessages.typeMissing);if(!core.input[a.type])throw new Error(this.errorMessages.typeNotImplemented);if(typeof core.input[a.type]!="function")throw new Error(this.errorMessages.typeNotAFunction);return new core.input[a.type](a)}},core.input.abstractParent=Class.create({initialize:function(a){this.options=Object.extend({type:"text",value:"",style:"",labelStyle:"width:#{labelWidth};padding:#{labelPadding};float:left;vertical-align:middle;",labelPadding:"0px",labelWidth:"170px",container:"display",id:"__default",name:"__default",label:"",bgColor:"",state:{},readonly:!1},a||{}),this.value=this.options.value},getValue:function(){this.setValue($(this.inputElement).getValue());return this.value},setValue:function(a){this.value=a,this.inputElement.value=a},setError:function(a){this.errorElement=Builder.node("div",{style:"color:red;font-size:12px;"},a),this.htmlElement.appendChild(this.errorElement),this.htmlElement.style.border="1px solid red";return this},setState:function(){var a;this.options.state&&Object.keys(this.options.state).length>0&&(a=this.options.state[this.value],a&&(a.hide&&a.hide.each(function(a){core.input.hideElements.push(a),core.input.hideElements=core.input.hideElements.uniq(),core.elements.hideElements.push(a),core.elements.hideElements=core.input.hideElements.uniq()}.bind(this)),a.setval&&$H(a.setval).each(function(a){var b=$(core.input.elements.find(function(b){return b.options.name===a.key}));b.setValue(a.value),b.onChange()})))},dfltHide:function(){core.input.hideElements.indexOf(this.options.name)>=0&&(this.hide(),core.input.hideElements=core.input.hideElements.without(this.options.name))},hide:function(){$(this.htmlElement).hide()},show:function(){$(this.htmlElement).show()},onChange:function(){var crtState;this.options.state&&this.options.state[this.value]&&(crtState=this.options.state[this.value],crtState.hide&&$A(crtState.hide).each(function(a){core.elements.elements.each(function(b){b.value.each(function(b){b.options&&b.options.name==a&&b.show()}.bind(this))}.bind(this))}.bind(this)),crtState.setval&&$H(crtState.setval).each(function(a){var b=$(core.input.elements.find(function(b){return b.options.name===a.key}));b.setValue(a.value),b.onChange()})),this.getValue(),this.options.state&&this.options.state[this.value]&&(crtState=this.options.state[this.value],crtState.hide&&$A(crtState.hide).each(function(a){core.elements.elements.each(function(b){b.value.each(function(b){b.options&&b.options.name==a&&b.hide()}.bind(this))}.bind(this))}.bind(this)),crtState.setval&&$H(crtState.setval).each(function(a){var b=$(core.input.elements.find(function(b){return b.options.name===a.key}));b.setValue(a.value),b.onChange()})),this.options.onChange&&(typeof this.options.onChange=="string"?(eval("window.tempfunctions[window.tempfunctions.length]="+this.options.onChange),window.tempfunctions[window.tempfunctions.length-1].bind(this)()):this.options.onChange()),typeof this.options.container.notify=="function"&&this.options.container.notify(this)},isOk:function(){return!!this.getValue()},toJSON:function(){return Object.toJSON(this.value)},toHTML:function(){return this.htmlElement}}),core.input.text=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"text",id:"__default_text_element",name:"__default_text_element"},a||{})),this.options.readonly?this.inputElement=Builder.node("span",{style:(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")+"border-width:0px;"+(this.options.readonly?"":"padding: 2px 0px;")+"margin: 0px;"+"float:right;"+"vertical-align:middle;"},this.value||""):this.inputElement=Builder.node("input",{id:this.options.id,type:"text",value:this.value||null,name:this.options.name||null,style:this.options.style,className:"input_text_default"}),this.options.label!==""?this.htmlElement=Builder.node("div",{style:"width:100%;clear:both;vertical-align:middle;line-height:23px;margin:auto;"+(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")+(this.options.padding?"padding:"+this.options.padding+";":"")},[Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label),this.inputElement]):this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),this.options.readonly||Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement)}}),core.input.password=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"password",id:"__default_password_element",name:"__default_password_element"},a)),this.inputElement=Builder.node("input",{id:this.options.id,type:"password",value:this.value,name:this.options.name,style:this.options.style,className:"input_pass_default",readonly:this.options.readonly}),this.options.label!==""?this.htmlElement=Builder.node("div",{style:"width:100%;clear:both;vertical-align:middle;line-height:23px;margin:auto;"+(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")},[Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label),this.inputElement]):this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement)}}),core.input.checkbox=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"checkbox",labelStyle:"width:#{labelWidth};padding:#{labelPadding};overflow:none;vertical-align:middle;",labelWidth:"250px",style:"width:14px;height:14px;vertical-align:middle;",id:"__default_checkbox_element",name:"__default_checkbox_element",labelOrient:"ll"},a)),this.value=this.options.value||"0",this.options.readonly?this.inputElement=Builder.node("img",{id:this.options.id,style:"padding-top:2px;line-height:23px;vertical-align:middle;margin:auto;",width:"14px",height:"14px",src:this.value=="1"?"core/img/icons/check.png":"core/img/icons/cancel.png"}):this.inputElement=Builder.node("input",{id:this.options.id,type:"checkbox",value:this.value||"0",checked:this.value&&this.value=="1"?!0:!1,name:this.options.name||null,style:this.options.style||null});if(this.options.label!==""){var b=[this.inputElement,Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label)];this.options.labelOrient=="lr"&&(b=[Builder.node("label",{style:"width:"+(this.options.labelWidth?this.options.labelWidth:"170px")+";"+"float:left;"+(this.options.labelPadding?"padding:"+this.options.labelPadding+";":""),htmlFor:this.inputElement.id},this.options.label),this.inputElement]),this.htmlElement=Builder.node("div",{style:"width:"+(this.options.width||"100%")+";"+"height:23px;"+"clear:both;"+"vertical-align:middle;"+"line-height:23px;margin:auto;"+(this.options["float"]?"float:"+this.options["float"]+";":"")+(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")+(this.options.marginBottom?"margin-bottom:"+this.options.marginBottom+"px;":"")},b)}else this.htmlElement=this.inputElement;this.setState(),this.dfltHide(),Element.observe(this.inputElement,"click",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){if(this.options.readonly)return null;this.setValue(this.inputElement.checked?"1":"0");return this.value}}),core.input.fieldset=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"fieldset",legend:"",value:{},id:"__default_fieldset_element",name:"__default_fieldset_element"},a)),this.htmlElement=Builder.node("fieldset"),this.legendElement=Builder.node("legend",{},[this.options.label]),this.htmlElement.appendChild(this.legendElement),this.inputs=[],this.options.elements&&this.options.elements.each(function(a){a.container=this.htmlElement,a.value=this.value[a.name],this.inputs.push(core.input.create(a))}.bind(this)),this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){this.inputs.each(function(a){this.options.value[a.options.name]=a.getValue()}.bind(this)),this.value=this.options.value;return this.value}}),core.input.checkboxgroup=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"checkboxgroup",value:[],id:"__default_checkboxgroup_element",name:"__default_checkboxgroup_element",data:[]},a)),this.htmlElement=Builder.node("div",{style:this.options.style||null}),this.inputs=[],this.options.labels&&this.options.values&&this.options.values.each(function(a){this.options.data.push({label:this.options.labels[a],value:a})}.bind(this)),this.options.data&&this.options.data.each(function(a){a.container=this.htmlElement,a.type="checkbox",a.name=a.value,this.value.indexOf(a.value)>=0&&(a.value="1"),this.inputs.push(core.input.create(a))}.bind(this)),this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){this.options.value=[],this.inputs.each(function(a){a.getValue()=="1"&&this.options.value.push(a.options.name)}.bind(this)),this.value=this.options.value;return this.value}}),core.input.hidden=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"hidden",id:"__default_hidden_element",name:"__default_hidden_element"},a)),this.value=this.options.value||"0",this.inputElement=Builder.node("input",{id:this.options.id,type:this.options.type,value:this.value||null,name:this.options.name||null,style:this.options.style||null}),this.htmlElement=this.inputElement,Element.observe(this.inputElement,"change",this.onChange.bind(this)),this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){if(this.options.readonly)return null;return String(this.value)}}),core.input.integer=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({id:"__default_integer_element",name:"__default_integer_element",labelOrient:"ll",state:{}},a)),this.inputElement=Builder.node("input",{id:this.options.id,type:"text",value:this.value,name:this.options.name,style:this.options.style,className:"input_integer_default",readonly:this.options.readonly});if(this.options.label!==""){var b=[Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label),this.inputElement];this.options.labelOrient=="lr"&&(b=[Builder.node("label",{style:"width:250px;overflow:none;vertical-align:middle;",htmlFor:this.inputElement.id},this.options.label),this.inputElement]),this.htmlElement=Builder.node("div",{style:"width:100%;clear:both;vertical-align:middle;line-height:23px;margin:auto;"+(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")},b)}else this.htmlElement=this.inputElement;this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement),Element.observe(this.inputElement,"change",this.onChange.bind(this)),Element.observe(this.inputElement,"keypress",this.checkKey.bindAsEventListener(this))},checkKey:function(a){this.value=$(this.options.id).value;var b=window.event?window.event.keyCode:a?a.which:0,c=String.fromCharCode(b);/\d/.test(c)?(this.value=this.value+c,Event.stop(a)):b!=8&&b!==0&&Event.stop(a),$(this.options.id).value=this.value}}),core.input.dropdown=Class.create(core.input.abstractParent,{initialize:function($super,options){$super(Object.extend({type:"dropdown",value:"__pleaseselect",labelPadding:"0px",id:"__default_dropdown_element",name:"__default_dropdown_element",data:[],mandantory:!1},options)),this.options.readonly?this.inputElement=Builder.node("div"):this.inputElement=Builder.node("select",{id:this.options.id,value:this.value,name:this.options.name,style:this.options.style,className:"input_dropdown_default"}),this.options.mandantory||this.options.data.unshift({label:this.options.readonly?"not selected":_LOC("MDuZaBRVww",":: Please select ::"),value:"__pleaseselect"}),this.options.top&&this.options.top.each(function(a,b){this.options.data.unshift({label:a.label,value:a.value})}.bind(this));var objects=!1;this.options.objects?objects=eval(this.options.objects):this.options["class"]&&(objects=get_objects(this.options["class"],this.options.types)),objects&&objects.each(function(a,b){a.hidden||this.options.data.push({label:a.data.name,value:a.ref})}.bind(this)),this.options.labels&&this.options.values&&this.options.values.each(function(a){this.options.data.push({label:this.options.labels[a],value:a})}.bind(this));try{this.options.data&&this.options.data.each(function(a){if(!this.options.readonly)if(!a.data)$(this.inputElement).options[this.inputElement.length]=this._createOption(a,this.options.value==a.value);else{var b=Builder.node("optgroup",{},a.label);a.data.each(function(a){b.appendChild(this._createOption(a,this.options.value==a.value))}.bind(this)),$(this.inputElement).appendChild(b)}else this.options.value==a.value&&(this.inputElement=Builder.node("span",{style:this.options.bgColor?"background-color:"+this.options.bgColor+";":"border:0px solid black;padding: 0px;margin: 0px;float:right;vertical-align:middle;"},a.label))}.bind(this))}catch(e){_debug(e)}this.options.label!==""?this.htmlElement=Builder.node("div",{style:"width:100%;clear:both;vertical-align:middle;line-height:23px;margin:auto;"+(this.options.bgColor?"background-color:"+this.options.bgColor+";":"")},[Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label),this.inputElement]):this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),this.options.readonly||Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement),this.inputElement.value=this.options.value,this.options.readonly||(this.inputElement.className="input_dropdown_default")},_createOption:function(a,b){var c=null,d;a.icon&&(c="background-image:url("+a.icon+");"+"background-repeat:no-repeat;");try{a.label&&a.value&&(d=new Option(a.label,a.value,b,b),d.style.fontSize="14px")}catch(e){_debug(e)}return d},getValue:function(){if($F(this.inputElement)=="__pleaseselect"){this.setValue("");return""}this.setValue($(this.inputElement).getValue());return this.value}}),core.input.radiogroup=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"radiogroup",value:"0",style:"vertical-align:middle;border:0;margin:0px 3px 0px 5px;",id:"__default_radiogroup_element",name:"__default_radiogroup_element"},a)),this.value=this.options.value=this.options.value.toString(),this.inputElement=Builder.node("div",{}),this.options.data&&this.options.data.each(function(a){var b=Builder.node("div",{style:"vertical-align:middle;line-height:19px;"});a.value||(a.value="0"),b.appendChild(Builder.node("input",{type:"radio",style:this.options.style||null,value:a.value,name:this.options.name,id:this.options.id+"_"+a.value,checked:a.value==this.options.value?"checked":null})),b.appendChild(Builder.node("label",{htmlFor:this.options.id+"_"+a.value,style:"vertical-align:middle;line-height:19px;"},a.label)),this.inputElement.appendChild(b)}.bind(this)),this.options.label!==""?this.htmlElement=Builder.node("table",{style:"margin:0;padding:0;border:0;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{},Builder.node("label",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding}),htmlFor:this.inputElement.id},this.options.label)),Builder.node("td",{},this.inputElement)]))):this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement),this.inputElement.value=this.options.value},getValue:function(){$A(document.getElementsByName(this.options.name)).each(function(a){a.checked&&(this.value=a.value)}.bind(this));return this.value}}),core.input.list=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"list",id:"__default_list_element",name:"__default_list_element"},a)),this.value=this.options.value,this.inputElement=Builder.node("div",{style:"margin:0;padding:0;border:0;"}),this.options.label!==""?this.htmlElement=Builder.node("div",{style:"text-align: left;clear : both;background-color:"+this.options.bgColor+";"},Builder.node("table",{style:"margin:0;padding:0;border:0;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"td_no_border"},Builder.node("span",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding})},this.options.label)),Builder.node("td",{},this.inputElement)])))):this.htmlElement=this.inputElement,this.options.readonly&&(this.options.noadd=!0,this.options.noedit=!0,this.options.nodelete=!0),list_init(this.options,this.inputElement),this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){this.value=this.inputElement.list.memberValues();return this.value}}),core.input.upload=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"upload",labelStyle:"width:#{labelWidth};padding:#{labelPadding};float:left;height:18px;vertical-align:middle;",style:"background-color:#bbbbbb;height:18px;width:133px;overflow:hidden;position:relative;white-space:nowrap;padding:1px 2px 0px 2px;border:1px solid #aaaaaa;float:left;",id:"__default_upload_element",name:"__default_upload_element"},a)),this.value=this.options.filename=this.options.value,this.options.onchange=function(a){this.setValue(a),a.indexOf(".ebf")>=0&&(this.addAuthentication(),this.fileIsEncrypted=!0),this.onChange()}.bind(this),this.fileuploadElement=Builder.node("div",{id:this.options.id,value:this.value,name:this.options.name}),this.hiddenElement=Builder.node("input",{type:"hidden",value:this.value,name:this.options.name}),$(this.options.container).appendChild(this.hiddenElement),upload_init(this.fileuploadElement,this.options),this.addAuthFields=!0,this.options.filename.indexOf(".ebf")>=0&&(this.addAuthentication(),this.fileIsEncrypted=!0),this.inputElement=core.uploadMap[this.options.name],this.options.label!==""?this.htmlElement=Builder.node("div",{style:"width:100%;clear:both;"},[Builder.node("span",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding})},this.options.label),this.fileuploadElement]):this.htmlElement=this.fileuploadElement,this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},addAuthentication:function(){this.addAuthFields&&(this.auth_pwfield=core.input.create({type:"password",name:this.options.name+"_auth_password",label:_LOC("LSMMxXbBAR","Password"),container:this.fileuploadElement}),this.auth_pwrepeatfield=core.input.create({type:"password",name:this.options.name+"_auth_password_repeat",label:_LOC("puceMFVlLg","Repeat password"),container:this.fileuploadElement}))},setValue:function(a){this.hiddenElement.value=a,!this.inputElement;return},getValue:function(){return this.inputElement?this.inputElement.getValue():this.options.value||""},getPassword:function(){return this.auth_pwfield.getValue()},getPasswordRepeat:function(){return this.auth_pwrepeatfield.getValue()},openPopup:function(){this.uploadId=rand_string(10),this.popup=(new core.popup({name:"POPUP_UPLOAD_"+this.options.name,"class":"upload",anchor:this.folderIcon,update_type:"upload",update_name:this.options.name,upload_id:this.uploadId})).bind(this)}}),core.input.dnd=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"dnd",id:"__default_dnd_element",name:"__default_dnd_element"},a)),this.inputElement=Builder.node("div",{style:"margin:0;padding:0;border:0;"}),this.options.label!==""?this.htmlElement=Builder.node("div",{style:"text-align: left;clear : both;background-color:"+this.options.bgColor+";"},Builder.node("table",{style:"margin:0;padding:0;border:0;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"td_no_border"},Builder.node("span",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding})},this.options.label)),Builder.node("td",{},this.inputElement)])))):this.htmlElement=this.inputElement,this.dropzone=dnd_dropzone_init(this.options,this.inputElement),this.setState(),this.dfltHide(),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){this.value=this.dropzone.members;return this.value}}),core.input.singlednd=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"singlednd",id:"__default_singlednd_element",name:"__default_singlednd_element"},a)),this.inputElement=Builder.node("div",{style:"margin:0;padding:0;border:0;"}),this.options.label!==""?this.htmlElement=Builder.node("table",{style:"margin:0;padding:0;border:0;",cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{style:"margin:0;padding:0;border:0;"},Builder.node("span",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding})},this.options.label)),Builder.node("td",{},this.inputElement)]))):this.htmlElement=this.inputElement,this.dropzone=dnd_dropzone_single_init(this.options,this.inputElement),$(this.options.container).appendChild(this.htmlElement)},getValue:function(){this.value=this.dropzone.member;return this.value}}),core.input.spinner=Class.create(core.input.abstractParent,{initialize:function($super,a){}}),core.input.maskedInput=Class.create(),core.input.maskedInput.prototype=Object.extend(new core.input.abstractParent,{masks:{date_iso:{format:"    -  -  ",regex:/\d/},date_us:{format:"  /  /    ",regex:/\d/},date_de:{format:"  .  .    ",regex:/\d/},time:{format:"  :  :  ",regex:/\d/},phone:{format:"(   )   -    ",regex:/\d/},ssn:{format:"   -  -    ",regex:/\d/},visa:{format:"    -    -    -    ",regex:/\d/},ip:{format:"   .   .   .   ",regex:/\d/}},initialize:function(a){this.options=Object.extend({type:"maskedInput",id:"__default_text_element",name:"__default_text_element",mask:"ip"},a||{}),this.value=this.options.value,this.inputElement=Builder.node("input",{id:this.options.id,type:"text",value:this.value,name:this.options.name,style:this.options.style}),this.options.label!==""?this.htmlElement=Builder.node("div",[Builder.node("span",{style:(new Template(this.options.labelStyle||null)).evaluate({labelWidth:this.options.labelWidth,labelPadding:this.options.labelPadding})},this.options.label),this.inputElement]):this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement),Element.observe(this.htmlElement,"keypress",this.applyMask.bindAsEventListener(this))},applyMask:function(a){var b=this.masks[this.options.mask],c=this.getPrintableKey(a);if(c){var d=String.fromCharCode(c),e=this.value+d;this.value||(e=d);var f=e.length;b.regex.test(d)&&f<=b.format.length&&(b.format.charAt(f-1)!=" "&&(e=this.value+b.format.charAt(f-1)+d),this.value=e,$(this.options.id).value=e),Event.stop(a)}},getPrintableKey:function(a){var b=window.event?window.event.keyCode:a?a.which:0;return b>=32||b<127?b:!1}}),core.input.progressbar=Class.create(core.input.abstractParent,{initialize:function($super,a){$super(Object.extend({type:"text",id:"__default_progressbar_element",name:"__default_progressbar_element"},a||{})),this.inputElement=Builder.node("div",{id:this.options.id,name:this.options.name||null,style:this.options.style,className:"wizard_progressbar"},Builder.node("div",{style:"width:"+this.value+"%;"})),this.htmlElement=this.inputElement,this.setState(),this.dfltHide(),this.options.readonly||Element.observe(this.inputElement,"change",this.onChange.bind(this)),$(this.options.container).appendChild(this.htmlElement)}}),core.elements={elements:new Hash,hideElements:[],errorMessages:{typeMissing:"no type defined in options",typeNotImplemented:"this type is not implemented",typeNotAFunction:"this type is not a Class",NSNotImplemented:"this namespace is not implemented"},create:function(a){var b,c,d,e;try{if(!a.type)throw new Error(this.errorMessages.typeMissing);e=a.type.split(":"),c=e[0],d=e[1],a.id||(a.id=this.getId(c,d,a.name));if(!core[c]||typeof core[c].create!="function")throw new Error(this.errorMessages.NSNotImplemented);a.type=d,b=core[c].create(a)}catch(f){_debug(f)}this.elements[c]||(this.elements[c]=[]),this.elements[c].push(b);return b},reset:function(){this.elements=new Hash,this.hideElements=[];return!0},getId:function(a,b,c){return"ELEMENT_"+a+"_"+b+"_"+c},getElementsByNS:function(a){return this.elements[a]?this.elements[a]:[]}},core.html={create:function(a){return new core.html.element(a)}},core.html.element=Class.create(),core.html.element.prototype={isContainer:!0,initialize:function(a){this.options=Object.extend({container:"display",bgColor:null,className:null,style:null},a),this.options.style+=this.options.bgColor?"background-color:"+this.options.bgColor:null,this.htmlElement=this.toHTML(),$(this.options.container).appendChild(this.htmlElement),this.options.elements&&this.options.elements.each(function(a){a.container=$(this.htmlElement),core.elements.create(a)}.bind(this)),this.dfltHide();return this},toHTML:function(){this.options.className?this.htmlElement=Builder.node(this.options.type,{className:this.options.className}.extend(this.options)):this.htmlElement=Builder.node(this.options.type,{style:this.options.style||null}.extend(this.options)),this.options.html&&(this.htmlElement.innerHTML=this.options.html),this.options.tooltip&&(Event.observe($(this.htmlElement),"mouseover",function(){infopop_up($(this.htmlElement),this.options.tooltip)}.bind(this)),Event.observe($(this.htmlElement),"mouseout",infopop_down));return this.htmlElement},dfltHide:function(){core.elements.hideElements.indexOf(this.options.name)>=0&&(this.hide(),core.elements.hideElements=core.elements.hideElements.without(this.options.name))},hide:function(){$(this.htmlElement).hide()},show:function(){$(this.htmlElement).show()}},core.forms={create:function(a){if(core.forms[a.type])return new core.forms[a.type](a)}},core.forms.fieldset=Class.create(),core.forms.fieldset.prototype={config:{style:{label:"float:left; padding: 1px 4px 0px 4px; height: 18px; vertical-align: middle;white-space: nowrap;"}},initialize:function(a){this.options=Object.extend({container:"display",label:"",applyFid:""},a||{}),$(this.options.container).appendChild(this.toHTML()),this.options.elements&&(this.elements=[],this.options.elements.each(function(a){a.container=$(this.containerElement),this.elements.push(core.elements.create(a))}.bind(this))),this.values=new Hash,this.dfltHide();return this},toHTML:function(){this.containerElement=Builder.node("div"),this.labelElement=Builder.node("div",{style:this.config.style.label},this.options.label),this.nElement=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{},[this.labelElement]),Builder.node("td",{className:"forms_fieldset_n"},[Builder.node("img",{src:"core/img/fieldset_top_left_end.gif"})])]))),this.options.applyFid&&(this.applyButton=Builder.node("button",{type:"button",className:"forms_fieldset_button_apply"},[Builder.node("img",{src:"core/img/icons/check.png",width:"16",height:"16",alt:_LOC("BlGZosyneg","apply"),className:"forms_fieldset_button_apply_image"}),Builder.node("div",{className:"forms_fieldset_button_apply_text"},_LOC("bHiHpIbEaS","apply"))]),Event.observe(this.applyButton,"click",function(){alert("Calling "+this.options.applyFid),this.elements.each(function(a){try{this.values[a.options.name]=a.getValue()}catch(b){}}.bind(this))}.bind(this))),this.htmlElement=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"forms_fieldset_nw"},[]),Builder.node("td",{},[this.nElement]),Builder.node("td",{className:"forms_fieldset_ne"},[])]),Builder.node("tr",{},[Builder.node("td",{className:"forms_fieldset_w"},[]),Builder.node("td",{className:"forms_fieldset_c"},[this.containerElement,this.options.applyFid?Builder.node("hr"):null,this.options.applyFid?this.applyButton:null]),Builder.node("td",{className:"forms_fieldset_e"},[])]),Builder.node("tr",{},[Builder.node("td",{className:"forms_fieldset_sw"},[]),Builder.node("td",{className:"forms_fieldset_s"},[]),Builder.node("td",{className:"forms_fieldset_se"},[])])]));return this.htmlElement},dfltHide:function(){core.elements.hideElements.indexOf(this.options.name)>=0&&(this.hide(),core.elements.hideElements=core.elements.hideElements.without(this.options.name))},hide:function(){$(this.htmlElement).hide()},show:function(){$(this.htmlElement).show()}},core.widget={create:function(a){if(core.widget[a.type])return new core.widget[a.type](a)}},core.widget.tooltip=function(a){this.options=Object.extend({},a||{})},core.widget.tooltip.prototype={show:function(){infopop_at(this.options.element,this.options.html)},hide:function(){infopop_down()},toHTML:function(){!this.options.element||(this.options.element=$this.options.element,Event.observe(this.options.element,"mouseover",this.show.bind(this)),Event.observe(this.options.element,"mouseout",this.hide.bind(this)))}},core.button=function(a){var b="ng",c="",d="",e;this.options=Object.extend({label:_LOC("VtQySQFGgI","Submit")},a||{}),this.element=$(a.container)||$(Builder.node("div")),this.options.classname&&(b=this.options.classname+" ng"),this.options.small&&(b+="small"),this.options.verysmall&&(b+="verysmall"),this.options.icon&&(b+="icon",d='<img src="'+this.options.icon+'">'),this.options.force_nobold&&this.element.addClassName("nobold"),this.element.addClassName(b+"button"),this.options.width&&this.options.width!=="resize"&&(c+="width:"+(this.options.width-11)+"px;"),this.options.button_float&&(c+="float:"+this.options.button_float+";"),this.options.margin&&(c+="margin:"+this.options.margin+";"),this.options.maxWidth&&(c+="max-width:"+this.options.maxWidth+";"),this.options.minWidth&&(c+="min-width:"+this.options.minWidth+";"),this.options.label&&(d+=this.options.label),this.element.style.cssText=c,this.element.innerHTML=d,this.element.setAttribute("title",this.options.title||this.options.label),this.enable(),this.options.onclick&&this.element.observe("click",function(){this.enabled&&evaluate.apply(this,[this.options.onclick])}.bind(this)),this.options.onclickfunc&&Event.observe(this.element,"click",function(){this.enabled&&this.options.onclickfunc()}.bind(this)),this.element.button=this,this.htmlElement=this.element,this.options.registerAs=this.options.registerAs||this.options.name,this.register();return this},core.button.prototype=function(){return{disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},hide:function(){this.element.hide()},show:function(){this.element.show()},register:function(){this.options.registerAs&&(core.buttonMap[this.options.registerAs]||(core.buttonMap[this.options.registerAs]=[]),core.buttonMap[this.options.registerAs].push(this))}}}(),core.form=Class.create(),core.form.prototype={initialize:function(req){var htmlElement,tbody,This=this,button_save_icon,button_save,button_cancel,button_close,button_confirm_cancel,action_buttons,obj;this.enlarge_help=!1,this.req=req,this.form_name=this.req.options.name,this.inPopup=this.req.options.popup||!1,this.elements={},this.inline_help=!1,htmlElement=document.createElement("table"),this.htmlElement=htmlElement,this.htmlElement.setAttribute("cellspacing","0",0),this.htmlElement.setAttribute("cellpadding","0",0),this.htmlElement.id="FORM_"+this.form_name+"_TABLE",this.htmlElement.form=this,this.htmlElement.style.tableLayout="fixed",this.req.options.form_width&&(this.htmlElement.style.width=this.req.options.form_width-10+"px"),tbody=document.createElement("tbody"),tbody.id="FORM_"+this.form_name+"_TABLE_TBODY",this.htmlElement.appendChild(tbody),button_save_icon="core/img/icons/check.png",this.req.options.button_save&&this.req.options.button_save.icon&&(button_save_icon=this.req.options.button_save.icon),button_save=new core.button({label:this.req.options.button_save?this.req.options.button_save.label:_LOC("JwGjvdiQQU","Save"),onclickfunc:function(){This.req.save_action?eval(This.req.save_action):form_submit(This.req.options.name)},icon:button_save_icon,registerAs:this.req.options.name,button_float:"right"}),button_cancel=new core.button({label:_LOC("dShoXawBVz","Cancel"),onclickfunc:function(){form_cancel(This.req.options.name)},icon:"core/img/icons/cancel.png",registerAs:this.req.options.name,button_float:"right"}),button_cancel.element.style.marginLeft="8px",button_close=new core.button({label:_LOC("STKicJlWiv","Close"),onclickfunc:function(){form_cancel(This.req.options.name)},icon:"core/img/icons/check.png",registerAs:this.req.options.name,button_float:"right"}),this.button_confirm_ok=new core.button({label:_LOC("uWPDdHkFJj","OK"),icon:"core/img/icons/check.png",onclickfunc:function(){}.bind(this),registerAs:this.req.options.name+"_CONFIRM",button_float:"right"}),button_confirm_cancel=new core.button({label:_LOC("SaZEjgnkbd","Cancel"),icon:"core/img/icons/cancel.png",onclickfunc:function(){this.messageElement.update(),core.buttonMap[this.form_name]&&core.buttonMap[this.form_name].each(function(a,b){a.show(),a.enable()}),core.buttonMap[this.form_name+"_CONFIRM"]&&core.buttonMap[this.form_name+"_CONFIRM"].each(function(a,b){a.hide()})}.bind(this),registerAs:this.req.options.name+"_CONFIRM",button_float:"right"}),button_confirm_cancel.element.style.marginLeft="8px",action_buttons=[button_cancel,button_save,button_confirm_cancel,this.button_confirm_ok];if(this.req.options.obj_ref){obj=get_object(this.req.options.obj_ref);if(obj&&obj.lock||obj["class"]=="ca")this.obj_locked=1,action_buttons=[button_close]}action_buttons.each(function(a){$("FORM_"+this.req.options.name+"_BUTTONS").appendChild(a.element)}.bind(this)),this.button_confirm_ok.hide(),button_confirm_cancel.hide(),this.messageElement=$("FORM_"+this.req.options.name+"_MESSAGE"),this.messageElement.alert=function(a){this.update(),this.style.width=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.style.maxWidth=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{border:"0",valign:"top",align:"left",src:"core/img/icons/warning.png",style:"padding-right:5px"})),Builder.node("td",{},Builder.node("div",{style:"word-wrap:break-word;"}).update(a))]))))}.bind(this.messageElement),this.messageElement.info=function(a){this.update(),this.style.width=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.style.maxWidth=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{border:"0",valign:"top",align:"left",src:"core/img/icons/info.png",style:"padding-right:5px"})),Builder.node("td",{},Builder.node("div",{style:"color:green;word-wrap:break-word;"}).update(a))]))))}.bind(this.messageElement),this.messageElement.confirm=function(a){this.update(),this.style.width=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.style.maxWidth=$(this.id.replace("_MESSAGE","_BUTTONS")).up(1).getWidth()+"px",this.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{border:"0",valign:"top",align:"left",src:"core/img/icons/confirm.png",style:"padding-right:5px"})),Builder.node("td",{},Builder.node("div",{style:"word-wrap:break-word;"}).update(a))]))))}.bind(this.messageElement);return this},cancel:function(){this.req.closeJs&&eval(this.req.closeJs),core.formMap[this.form_name]=null},changeLayout:function(a,b,c){var d=this.req.layout.length;while(d--)this.req.layout[d].name==a&&this.req.layout[d][b]&&(this.req.layout[d][b]=c)},_get_layout:function(){var a=this,b={},c=function(b){var c="",d,e,f;b.type==="upload"&&(c=core.uploadMap[b.name].getValue()),b.type==="minitable"&&(c=core.minitableMap[b.name].getValue());if(b.type==="dropzone")c=dndMgr.getDropZone("FORM_"+a.form_name+"_ELEMENT_"+b.name).getMembers();else if(b.type==="dropzone_single")f=dndMgr.getDropZone("FORM_"+a.form_name+"_ELEMENT_"+b.name).member,c=f||"";else if(b.type==="list")d=$("FORM_"+a.form_name+"_ELEMENT_"+b.name),d?c=d.list.memberValues():c=[];else if(b.type==="list_cb")d=$("FORM_"+a.form_name+"_ELEMENT_"+b.name),d?c=d.list.memberValues():c=[];else{var g=$("FORM_"+a.form_name+"_ELEMENT_"+b.name);if(g){b.type=="text"&&(c=g.value.strip()),b.type=="hidden"&&(c=g.value),b.type=="textarea"&&(c=g.value),b.type=="password"&&(c=g.value),b.type=="dropdown"&&(c=g.options[g.selectedIndex].value,c=="__pleaseselect"&&(c="")),b.type=="checkbox"&&(c=g.checked?1:0),b.type=="toggle"&&(c=g.opened?1:0),b.type=="date"&&(e=$A(g.getElementsByTagName("select")),c=e[0].options[e[0].selectedIndex].value+"-"+e[1].options[e[1].selectedIndex].value+"-"+e[2].options[e[2].selectedIndex].value),b.type=="time"&&(e=$A(g.getElementsByTagName("select")),c=e[0].options[e[0].selectedIndex].value+":"+e[1].options[e[1].selectedIndex].value+":00");if(b.type=="checkbox_group"||b.type=="checkbox_group_div"){var h=$A(g.getElementsByTagName("input"));c=h.collect(function(a){if(a.checked)return a.value;return null}).compact()}}}return c}.bind(this);for(var d=0;d<this.req.layout.length;d++){var e=this.req.layout[d];if(Object.isArray(e))for(var f=0;f<e.length;f++)e[f].type!="toggle_end"&&(b[e[f].name]=c(e[f]));else e.type==="rules_editor"?$H(core.formRuleEditor.getAllElements(e.options)).each(function(a){b[a.key]=c(a.value)}):e.type!="toggle_end"&&(b[e.name]=c(e))}return b},submit:function(_confirmation){var elements={};elements=this._get_layout(),typeof _confirmation!="undefined"&&(elements._confirmation=_confirmation);var load_this={objs:[{FID:this.req.submit,passthru:this.req.passthru,elements:elements,form_name:this.form_name,dyntab_opts:this.req.options.dyntab_opts?this.req.options.dyntab_opts:{},callback:this.req.saveCallback||"form_submit_result",propertyFilterValue:this.req.options.propertyFilterValue,ack:_confirmation||null}]};this.req.options.obj_src&&(load_this.objs[0].obj_src=eval(this.req.options.obj_src)),this.req.options.update_type&&this.req.options.update_name&&(load_this.objs[0].update_type=this.req.options.update_type,load_this.objs[0].update_name=this.req.options.update_name),core.buttonMap[this.form_name]&&core.buttonMap[this.form_name].each(function(a,b){a.disable()}),req_send(load_this)},submit_result:function(callback_req){var toEval,simple=!1,eext=!1,bbel=function(a){var b=!1;a.name&&a.name==cfield&&(b=!0),!b&&a.field&&a.field==cfield&&(b=!0);if(!b&&Object.isArray(a)){var c=a.length;while(c--){realelement=a[c];if(realelement.name&&realelement.name==cfield||realelement.field&&realelement.field==cfield){b=!0;break}}b||(realelement=!1)}b&&border_blink(this.req.options.name,realelement||a)}.bind(this);if(callback_req.manual_js)core.buttonMap[this.form_name]&&core.buttonMap[this.form_name].each(function(a,b){a.enable()});else{if(callback_req.error){core.buttonMap[this.form_name]&&core.buttonMap[this.form_name].each(function(a,b){a.enable()});if(typeof callback_req.error=="object"){Object.isArray(callback_req.error)&&callback_req.error.length==2&&typeof callback_req.error[0]=="string"&&(_debug("WARNING! Old-style error message detected!"),callback_req.error=[{field:[callback_req.error[1].attr]||null,msgtype:callback_req.error[1].msgtype||null,value:callback_req.error[1].value||null,text:callback_req.error[1].name||null}]);var errlen=callback_req.error.length,errmess=[];while(errlen--){callback_req.error[errlen].msgtype&&(simple=callback_req.error[errlen].msgtype),eext=callback_req.error[errlen];if(eext&&eext.field&&eext.field[0]){var flen=eext.field.length;while(flen--){var cfield=eext.field[flen],realelement=!1;this.req.layout.each(bbel)}}eext&&eext.text&&errmess.push(eext.text)}if(errmess.length){this.messageElement.alert(errmess.reverse().join("<br><br>"));if(this.req.execute&&this.req.execute.post){toEval=this.req.execute.post;while(toEval.search(/__TOGGLING/)>=0)toEval=toEval.replace(/__TOGGLING/,"error");eval(toEval)}return}}else simple=callback_req.error;simple.match(/^[A-Z0-9_]+$/)?this.messageElement.alert(simpleErrors[simple]||simpleErrors.__DEFAULT):this.messageElement.alert(simple);if(this.req.execute&&this.req.execute.post){toEval=this.req.execute.post;while(toEval.search(/__TOGGLING/)>=0)toEval=toEval.replace(/__TOGGLING/,"error");eval(toEval)}return}if(callback_req.success){core.buttonMap[this.form_name]&&core.buttonMap[this.form_name].each(function(a,b){a.enable()});if(callback_req.update_type&&callback_req.update_name){callback_req.update_type=="dashboard"&&reload_display(),callback_req.update_type=="dynamic_dropdown"&&(dropdown=core.dropdownMap[callback_req.update_name],dropdown&&dropdown.appendOption({label:callback_req.label,value:callback_req.success,selected:!0})),callback_req.update_type=="dropdown"&&dropdown_update(callback_req.update_name,callback_req.success),callback_req.update_type=="dropzone_single"&&dnd_dropzone_single_update(callback_req.update_name,callback_req.success),callback_req.update_type=="dropzone"&&dnd_dropzone_update(callback_req.update_name,callback_req.success),callback_req.update_type=="table"&&(core.tableMap[callback_req.update_name].updateItem(callback_req.success,callback_req.moveTo),callback_req.setPropertyFilterTo&&core.tableSearchValues[callback_req.update_name]&&core.tableSearchValues[callback_req.update_name].propertyFilter&&(core.tableSearchValues[callback_req.update_name].propertyFilter=callback_req.setPropertyFilterTo),reload_display()),callback_req.update_type=="minitable"&&(core.minitableMap[callback_req.update_name].updateItem(callback_req.success),callback_req.callback_js&&eval(callback_req.callback_js)),callback_req.update_type=="list"&&(core.listMap[callback_req.update_name].createMember(callback_req.label||callback_req.success,typeof callback_req.new_member_pos=="undefined"?-1:callback_req.new_member_pos,callback_req.success,typeof callback_req.editOn=="undefined"?null:callback_req.editOn,typeof callback_req.checked=="undefined"?null:callback_req.checked),core.listMap[callback_req.update_name].track_added&&core.listMap[callback_req.update_name].added.push(callback_req.success)),callback_req.update_type==="ngtable"&&core.NgTable.update(callback_req.update_name,callback_req.success);var html_tags=["div","a"];html_tags.indexOf(callback_req.update_type)!=-1&&$$("#"+callback_req.update_name).each(function(a,b){a.update(callback_req.label||callback_req.elements.name),a.title=callback_req.elements.name})}this.req.options.showSuccessMessage?(core.buttonMap[this.form_name+"_CONFIRM"].each(function(a,b){a.hide()}),core.buttonMap[this.form_name].each(function(a,b){a.show()}),this.messageElement.info('<p style="margin-top:0;margin-bottom:0;">'+callback_req.success[0].text+"</p>")):this.cancel()}else if(callback_req.confirm){core.buttonMap[this.form_name].each(function(a,b){a.hide()}),core.buttonMap[this.form_name+"_CONFIRM"].each(function(a,b){a.show()}),this.button_confirm_ok.options.onclickfunc=function(){var a=callback_req.ack,b=a.length;while(b--)if(callback_req.ack&&a[b].attrs[0]=="remove"&&this.elements[a[b].attr]&&this.elements[a[b].attr].list){var c=this.elements[a[b].attr].list,d=c.members();if(a[b].remove){var e=a[b].remove.split(","),f=d.length;while(f--){var g=d[f];e.indexOf(g.value)>=0&&c.remove(g,!0)}}}this.submit(callback_req.ack||1),this.messageElement.update()}.bind(this),this.button_confirm_ok.enable();var i=callback_req.confirm.length,msg="";while(i--){if(callback_req.confirm[i].field){callback_req.confirm[i].field=callback_req.confirm[i].field.uniq();var fieldi=callback_req.confirm[i].field.length;while(fieldi--)callback_req.confirm[i].field[fieldi]&&border_blink_element(callback_req.confirm[i].field[fieldi])}msg+='<p style="margin-top:0;'+(i?"":"margin-bottom:0;")+'">'+callback_req.confirm[i].text+"</p>"}this.messageElement.confirm(msg);if(this.req.execute&&this.req.execute.post){toEval=this.req.execute.post;while(toEval.search(/__TOGGLING/)>=0)toEval=toEval.replace(/__TOGGLING/,"error");eval(toEval)}return}this.req.options.showSuccessMessage||this.cancel()}},obj_key_err:function(a,b,c){c||(c=!1);var d=!1;switch(b){case"src_low":case"src_high":case"dst_low":case"dst_high":d=_LOC("hsCitjbStG","One of the entered numbers is not a valid port number (range 1-65535).");break;case"email_primary":case"email_secondary":switch(a){case"EMAIL_ADDR_UNIQUE":d=_LOC("DHqcPgpmOm","One of the specified email addresses is already in use for another user.");break;default:d=(c?c:"")+" "+_LOC("SKHyFNRUqM","is not a valid email address.")}}return d},update:function(){var a=this.req;remove_license_exceptions();var b=this.htmlElement.firstChild,c=$A(b.getElementsByTagName("tr"));c.each(function(a,b){if(browser=="ie")while(a.firstChild){var c=a.firstChild;c.innerHTML="",a.removeChild(c)}$(a)&&$(a).remove()}),this.req.layout.each(function(a,c){var d;a.type==="rules_editor"?d=(new core.formRuleEditor({form:this,options:a.options,selectedValues:a.selectedValues,operatorValue:a.operatorValue})).getHtml():Object.isArray(a)?d=this.template_multi(a):d=this.template_simple(a),b.appendChild(d),a.licensed===0&&license_exception(d.id,license_info_texts.SOMEFEAT)}.bind(this)),this.render();try{this.htmlElement.rows[0].down(3).focus()}catch(d){_debug(d)}},render:function(change_name,toggle){var req=this.req,This=this,tbody=this.htmlElement.firstChild,hidden={},toggled={},disabled={},disable_options={},new_defaults=!1,new_values=!1,update_options={},_render=function(element,idx,multi){var thisRow=$A(tbody.getElementsByTagName("tr")).detect(function(a){return a.id=="FORM_"+This.form_name+"_ROW_"+element.name}),esol,tmpVal,row,next,i,tmpElement;element.depends&&hidden[element.depends]&&(hidden[element.name]=1),element.depends&&toggled[element.depends]&&(toggled[element.name]=1),element.disabled&&(disabled[element.name]=1);if(element.syncOptionsWith&&this.elements){disable_options[element.name]||(disable_options[element.name]=[]),esol=element.syncOptionsWith.length;while(esol--)this.elements[element.syncOptionsWith[esol]]&&$(this.elements[element.syncOptionsWith[esol]])&&(tmpVal=$F(this.elements[element.syncOptionsWith[esol]]),tmpVal!="__pleaseselect"&&disable_options[element.name].push(tmpVal))}if(update_options[element.name]&&element.name!=change_name)switch(element.type){case"dropdown":if(element.options&&element.options[update_options[element.name]]){element.values=element.options[update_options[element.name]].values,element.labels=element.options[update_options[element.name]].labels,this.template_simple(element),row=this.elements[element.name].row,thisRow&&tbody.removeChild(thisRow),thisRow=row,next=!1;for(i=idx+1;i<this.req.layout.length;i++){tmpElement=this.req.layout[i],Object.isArray(tmpElement)&&(tmpElement=tmpElement[0]),next=$("FORM_"+this.form_name+"_ROW_"+tmpElement.name);if(next&&!hidden[tmpElement.name])break}next?tbody.insertBefore(row,next):tbody.appendChild(row)}}if(hidden[element.name])multi?$(this.elements[element.name]).hide():$(thisRow)&&(this.elements[element.name].row=$(thisRow).remove());else{toggled[element.name]?multi?$(this.elements[element.name]).hide():$(thisRow)&&(this.elements[element.name].row=$(thisRow).hide()):multi?$(this.elements[element.name]).show():$(thisRow)&&(this.elements[element.name].row=$(thisRow).show());if(!$(thisRow)&&!multi){row=this.elements[element.name].row,next=!1;for(i=idx+1;i<this.req.layout.length;i++){tmpElement=this.req.layout[i],Object.isArray(tmpElement)&&(tmpElement=tmpElement[0]),next=$("FORM_"+this.form_name+"_ROW_"+tmpElement.name);if(next&&!hidden[tmpElement.name])break}update_options[element.name]||(next?tbody.insertBefore(row,next):tbody.appendChild(row)),toggled[element.name]&&(this.elements[element.name].row=$(row).hide())}if(disable_options[element.name])switch(element.type){case"dropdown":var options=$A(this.elements[element.name].options),l=options.length;while(l--)options[l].disabled=!1,browser=="ie"&&(options[l].style.color="#000000");disable_options[element.name].each(function(a){options.each(function(b){b.value==a&&(b.disabled=!0,browser=="ie"&&(b.style.color="#CCCCCC"))})})}var thiselem=$("FORM_"+this.form_name+"_ELEMENT_"+element.name);disabled[element.name]||this.obj_locked?input_deactivate("FORM_"+this.form_name+"_ELEMENT_"+element.name,this.obj_locked?!0:!1):input_activate("FORM_"+this.form_name+"_ELEMENT_"+element.name);var newval=!1;new_defaults&&new_defaults[element.name]&&(this.req.layout[idx].dflt=new_defaults[element.name],newval=get_default_value(this.req,element)),new_values&&(new_values[element.name]||new_values[element.name]==="")&&(newval=new_values[element.name]);if(newval||newval==="")switch(element.type){case"dropdown":for(i=0;i<thiselem.options.length;i++)if(thiselem.options[i].value==newval){thiselem.options[i].selected=!0;break}break;case"fixed":thiselem.innerHTML=newval;break;case"checkbox":newval=="1"?thiselem.checked=!0:thiselem.checked=!1;break;case"text":case"hidden":case"password":thiselem.value=newval}if(element.state){var cur_value=!1;element.type=="dropdown"&&(cur_value=thiselem.options[thiselem.selectedIndex].value),element.type=="checkbox"&&(thiselem.checked?cur_value="1":cur_value="0"),element.type=="text"&&(cur_value=thiselem.value),element.type=="toggle"&&(cur_value=thiselem.opened?"1":"0"),element.type=="hidden"&&(cur_value=thiselem.value);var selector;cur_value.match(/^_ipv4_/)?selector="_ipv4_":cur_value.match(/^_ipv6_/)?selector="_ipv6_":selector=!element.state[cur_value]&&element.state["*"]?"*":cur_value,selector&&element.state[selector]&&(element.state[selector].hide&&element.state[selector].hide.each(function(a){hidden[a]=1}),element.state[selector].toggle&&element.state[selector].toggle.each(function(a){toggled[a]=1}),element.state[selector].dflt&&change_name==element.name&&(new_defaults=element.state[selector].dflt),element.state[selector].disable&&element.state[selector].disable.each(function(a){disabled[a]=1}),element.state[selector].setval&&change_name==element.name&&(new_values={},element.state[selector].setval.each(function(change){var newval=!1,toEval=change.js;if(toEval){while(toEval.search(/__CUR_VALUE/)>=0)toEval=toEval.replace(/__CUR_VALUE/,cur_value);while(toEval.search(/__CHANGENAME/)>=0)toEval=toEval.replace(/__CHANGENAME/,change_name);while(toEval.search(/__TOGGLING/)>=0)toEval=toEval.replace(/__TOGGLING/,toggle);newval=eval(toEval)}if(newval||newval==="")new_values[change.element]=newval})),element.state[selector].options&&element.state[selector].options.each(function(a){update_options[a]=cur_value}),element.state[selector].layout&&element.state[selector].layout.each(function(a){this.changeLayout(a.name,a.attribute,a.value);switch(a.attribute){case"icon":this.elements[a.name]&&this.elements[a.name].src&&(this.elements[a.name].src=a.value)}}.bind(this)))}element.licensed===0&&license_exception("FORM_"+This.form_name+"_ROW_"+element.name,license_info_texts.SOMEFEAT)}}.bind(this),j=0,layoutLen=this.req.layout.length,element,i=0,elementLen,toEval;for(;j<layoutLen;j++){element=this.req.layout[j];if(Object.isArray(element)){elementLen=element.length;for(i=0;i<elementLen;i++)_render(element[i],j,i>0)}else element.type!=="rules_editor"&&_render(element,j,!1)}this.inline_help&&this.enlarge_help&&(this.inline_help.style.width="18px");if(req.execute&&req.execute.post){toEval=req.execute.post;while(toEval.search(/__TOGGLING/)>=0)toEval=toEval.replace(/__TOGGLING/,toggle);eval(toEval)}},template_simple:function(a){var b=document.createElement("tr");b.id="FORM_"+this.form_name+"_ROW_"+a.name,a.type=="toggle"&&(this.toggle=!0,Event.observe(b,"click",function(){this.elements[a.name].changeState(),this.render(a.name,"toggle")}.bind(this))),a.type=="toggle_end"&&(this.toggle=!1),a.wrap||b.appendChild(Builder.node("td",{className:(this.toggle?"FORM_toggle_toggled_border_left"+(a.type=="toggle"?"_top":a.type=="toggle_end"?"_end":""):"")+" width_4px"})),this._makeElement(a,b,!a.caption),a.name&&(this.elements[a.name].container=b.id,this.elements[a.name].row=b),a.wrap||b.appendChild(Builder.node("td",{className:(this.toggle?"FORM_toggle_toggled_border_right"+(a.type=="toggle"?"_top":a.type=="toggle_end"?"_end":""):"")+" width_4px"}));return b},template_multi:function(a){var b=document.createElement("tr"),c=0,d=document.createElement("td"),e=document.createElement("tr"),f=document.createElement("td"),g=Builder.node("tbody",{}),h=Builder.node("table",{style:"width:1%;",cellspacing:"0"},g);d.style.width="0px",d.style.verticalAlign="top",b.id="FORM_"+this.form_name+"_ROW_"+a[0].name,f.appendChild(h),b.appendChild(Builder.node("td",{className:(this.toggle?"FORM_toggle_toggled_border_left":"")+" width_4px"}));for(c=0;c<a.length;c++)a[c].useFullWidth&&(h.style.width="auto"),c==0?(this._makeElement(a[c],b,!a[c].caption,e,f),b.appendChild(f)):this._makeElement(a[c],e,!a[c].caption,!1,!1,!0),a[c].name&&(this.elements[a[c].name].container=b.id,this.elements[a[c].name].row=b);g.appendChild(e),this.inline_help&&(a.hr&&(d.style.borderTop="2px groove #ffffff",d.style.paddingTop="4px"),b.appendChild(d)),b.appendChild(Builder.node("td",{className:(this.toggle?"FORM_toggle_toggled_border_right":"")+" width_4px"})),a.type=="toggle_end"&&(this.toggle=!1);return b},_makeElement:function(a,b,c,d,e,f){var g=document.createElement("td"),h,i,j,k,l;g.setAttribute("align","right",0),g.style.padding="0px 2px 4px 2px",g.style.overflow="hidden",loc==="english"?h=Builder.node("span",{style:"white-space:nowrap;"}):h=Builder.node("div",{className:"ellipsis",title:a.caption?a.caption.replace(/<(.?.?)br(.?.?)>/g,"\n").replace(/<(.*?)>/g,""):""}),h.innerHTML=a.caption||"",g.appendChild(h),g.setAttribute("nowrap","nowrap",1),a.caption_align&&g.setAttribute("align",a.caption_align),a.fix_width&&(g.style.width=a.fix_width+"px"),i=document.createElement("td"),i.setAttribute("align","left",0),i.style.padding="0px 2px 4px 2px",k=e?e:i,a.element_align&&i.setAttribute("align",a.element_align),l=$(this.renderInput(a)),a.name&&(this.elements[a.name]=l),i.appendChild(l),i.style.width=(a.style&&a.style.width?parseInt(a.style.width,10):a.width||l.getWidth()||160)+4+"px",j=document.createElement("td"),j.style.width="0px",j.style.verticalAlign="top",this.inline_help||(this.inline_help=$(j)),a.inlinehelp&&(this.enlarge_help=!0,this.req.options.form_width=this.req.options.form_width+18,j.appendChild($(this.helpIcon(a,f)))),a.blink=function(){};switch(a.type){case"text":case"hidden":case"fixed":case"password":case"date":case"time":case"upload":case"dropzone_single":break;case"textarea":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),g=!1);break;case"toggle":a.label&&(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),i.setAttribute("valign","middle"),i.appendChild(domSpan({paddingLeft:"2px",verticalAlign:"middle"},{},{},a.label))),i.style.padding="0px 2px 2px",i.className="FORM_toggle",j.className="FORM_toggle",g=!1;break;case"toggle_end":k.setAttribute("colSpan","2"),i.setAttribute("align","left"),i.setAttribute("valign","middle"),i.style.padding="0px",i.className="FORM_toggle_end",j.className="FORM_toggle_end",g=!1;break;case"checkbox":a.label&&(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),i.setAttribute("valign","middle"),i.appendChild(domSpan({paddingLeft:"2px"},{},{},a.label)),g=!1);break;case"checkbox_group":g.setAttribute("valign","top",0),a.caption||(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),g=!1);break;case"checkbox_group_div":k.setAttribute("colSpan","2"),g=!1;break;case"list":g.setAttribute("valign","top",0),c&&!a.element_align&&(k.setAttribute("colSpan","2"),i.setAttribute("align","right"),g=!1);break;case"list_cb":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","right"),g=!1);break;case"html":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),g=!1);break;case"iframe":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","left"),g=!1);break;case"minitable":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","right"),g=!1);break;case"dropzone":g.setAttribute("valign","top",0),c&&(k.setAttribute("colSpan","2"),i.setAttribute("align","right"),g=!1);break;case"dropdown":c&&!a.element_align&&(k.setAttribute("colSpan","2"),i.setAttribute("align","right"),g=!1)}c&&(g=!1);if(a.wrap){var m=domTd({},{colSpan:"4"},{},domTableRow(j?[g,i,j]:[g,i],a.wrap_width?{width:a.wrap_width+"px"}:!1));a.hr&&(m.style.borderTop="2px groove #ffffff",m.style.paddingTop="4px"),b.appendChild(m)}else a.hr&&(g&&(g.style.borderTop="2px groove #ffffff",g.style.paddingTop="4px"),i&&(i.style.borderTop="2px groove #ffffff",i.style.paddingTop="4px"),j&&(j.style.borderTop="2px groove #ffffff",j.style.paddingTop="4px")),g&&b.appendChild(g),d?(d.appendChild(i),j&&d.appendChild(j)):(b.appendChild(i),j&&b.appendChild(j));return},renderInput:function(a){var b=core.dynIncPath+"_formInput_"+a.type,c=dynIncPath+"_formInput_"+a.type;this["renderInputFunctions__"+a.type]||(loadScript(b+".min.js",!1,0)>=0||loadScript(c+".min.js",!1,0)>=0||loadScript(b+".js",!1,0)>=0||loadScript(c+".js",!1,0)>=0?this["renderInputFunctions__"+a.type]=core.form.prototype["renderInputFunctions__"+a.type]:_debug("loading rendering function "+a.type+" failed. Unknown reason"));try{return this["renderInputFunctions__"+a.type](a)}catch(d){_debug("rendering failed: "+d);return!1}},helpIcon:function(a,b){if(a.inlinehelp)try{return domImg({},{style:b?"margin-top: -1px; margin-left: -1px;":"",src:"core/img/blank1x1.gif",className:a.inlineHelpClassName||"TABLEOBJITEM_BUTTON_inlinehelp"},{onmouseover:function(){infopop_up(this,a.inlinehelp,!1,!1,!0,null,null,400)},onmouseout:function(){infopop_down()}})}catch(c){_debug("rendering failed: "+c);return!1}}};var border_blink_map={},border_blink_timer={};core.formRuleEditor=Class.create({initialize:function(a){var b=this;this.config=Object.extend({options:!1,form:!1,selectedValues:!1},a||{}),this.options={},this.selectedValues=this.config.selectedValues,this.operatorValue=this.config.operatorValue,this.optionNames=[],this.form=this.config.form,this.elements={},this.headings=[],this.selections=[],this.operators=[],$A(this.config.options).each(function(a){var c=a.input.name;b.optionNames.push(c),b.options[c]=a});return this},getHtml:function(){var a,b,c=document.createElement("tr"),d=Builder.node("tbody",{}),e=Builder.node("table",{border:"0",cellspacing:"0"},d),f;for(a=0;a<this.optionNames.length;a++){f=this._makeHeading(a),this.headings.push(f),this._registerEvents(f),d.appendChild(f),a>this.selectedValues.length&&$(f).hide();for(b=0;b<this.optionNames.length;b++)f=this.form.template_simple(this.getInputElement(Object.clone(this.options[this.optionNames[b]].input),a)),d.appendChild(f),this.elements[this.optionNames[b]]=this.elements[this.optionNames[b]]||[],this.elements[this.optionNames[b]].push(f),this.selectedValues[a]!==this.optionNames[b]&&$(f).hide()}this._syncSelectionOptions();return c.appendChild(e)},_syncSelectionOptions:function(){var a=$A(this.selections).filter(function(a){return a.value!=="__pleaseselect"}).map(function(a){return a.value});this.selections.each(function(b){b.id!==name&&$A(b.options).each(function(c){c.value!==b.value&&a.indexOf(c.value)!=-1?(c.disabled=!0,browser==="ie"&&(c.style.color="#CCCCCC")):(c.disabled=!1,browser==="ie"&&(c.style.color="#000000"))})})},onSelectChange:function(a){var b=this,c=a.target,d=c.id,e=c.value,f=parseInt(d.substring(d.lastIndexOf("_")+1,d.length));b._syncSelectionOptions();e==="__pleaseselect"?b.onDelete({target:c}):(this.optionNames.each(function(a){b.elements[a][f][a===e?"show":"hide"]()}),++f<this.headings.length&&this.headings[f].show())},onOperatorChange:function(a){var b=a.target.value;this.operators.each(function(a){a.value=b})},onDelete:function(a){var b=this,c=a.target.id,d,e=parseInt(c.substring(c.lastIndexOf("_")+1,c.length)),f,g;for(d=e;d<b.selections.length;d++){f=b.selections[d],g=b.selections[d+1];if(g&&g.value!="__pleaseselect")f.value=g.value,g.value="__pleaseselect",b.onSelectChange({target:f});else{f.value!=="__pleaseselect"&&(f.value="__pleaseselect"),b.headings[d+1]&&b.headings[d+1].hide(),b.optionNames.each(function(a){b.elements[a][d].hide()}),b._syncSelectionOptions();return}}},getInputElement:function(a,b){a.name=a.name.gsub(/_\d+/,"")+"_"+b;return a},_registerEvents:function(a){var b,c,d;$(a).descendants().each(function(a){a.tagName==="SELECT"?(a.id.include("operator")&&(b=a),a.id.include("selection")&&(c=a)):a.tagName==="DIV"&&a.id.include("ELEMENT_delete")&&(d=a)}),c&&(Event.observe(c,"change",this.onSelectChange.bind(this)),this.selections.push(c)),b&&(Event.observe(b,"change",this.onOperatorChange.bind(this)),this.operators.push(b)),d&&Event.observe(d,"click",this.onDelete.bind(this))},_makeHeading:function(a){var b,c={},d=!!a,e={dflt:this.operatorValue?this.operatorValue:"OR",labels:{AND:"and",OR:"or"},values:["AND","OR"],style:{width:"50px"},type:"dropdown",name:"operator_"+a},f={name:"spacer_1",type:"html",dflt:'<img src="core/img/blank1x1.gif" style="width:50px;height:1px;border-width:0px;">'},g={addPleaseSelect:1,dflt:this.selectedValues[a]||!1,style:"200px",syncOptionsWith:!1,type:"dropdown",values:this.optionNames,name:"selection_"+a},h={icon:"core/img/icons/delete.png",label:"Delete",type:"inlinebutton",name:"delete_"+a,width:70};for(b=0;b<this.optionNames.length;b++)c[this.optionNames[b]]=this.options[this.optionNames[b]].label;g.labels=c;return this.form.template_multi([d?e:f,g,h])}}),core.formRuleEditor.getAllElements=function(a){var b=a.map(function(a){return a.input.name}),c,d,e={},f;for(c=0;c<b.length;c++){for(d=0;d<b.length;d++)f=b[c]+"_"+d,e[f]=Object.clone(a[c].input),Object.extend(e[f],{name:f});e["selection_"+c]={name:"selection_"+c,type:"dropdown"},c!=0&&(e["operator_"+c]={name:"operator_"+c,type:"dropdown"})}return e},core.dropdown=Class.create(),core.dropdown.prototype={initialize:function(a){this.options=Object.extend({container:!1,values:[],labels:{},icons:{},optionsDisabled:{},optionGroups:[]},a||{}),this.options.container=$(this.options.container)||!1,this.htmlElement=document.createElement("select"),this.htmlElement=$(this.htmlElement),this.options.onchange?this.htmlElement.observe("change",function(){Object.isString(this.options.onchange)?evaluate.apply(this,[this.options.onchange]):this.options.onchange(),refresh_timeout_offline()}.bind(this)):this.options.state&&this.htmlElement.observe("change",function(){this.processState(),refresh_timeout_offline()}.bind(this)),this.options.style&&domApplyStyle(this.htmlElement,this.options.style),this.fill(),this.options.disabled&&this.disable(),this.htmlElement.self=this,core.dropdownMap[this.options.name]=this,this.options.container&&(this.options.container.appendChild(this.htmlElement),this.options.container.style.width=this.htmlElement.getWidth()+"px"),this.processState();return this},processState:function(){var a=this.getValue();if(!a||a=="__pleaseselect")return!0;this.options.state&&(this.options.state[a]?evaluate(this.options.state[a]):this.options.state["*"]&&evaluate(this.options.state["*"]))},setChangeHandler:function(a){this.htmlElement.onchange=a},addOption:function(a,b,c){this.values.indexOf(a)<0&&(this.options.values.push(a),b&&(this.options.labels[a]=b),c&&(this.options.value=a),this.fill())},deleteOption:function(a){this.options.values.indexOf(a)>0&&(this.options.labels[a]=null,this.options.icons[a]=null,this.options.values.splice(this.options.values.indexOf(a),1),this.options.value=this.options.value==a?"":a,this.fill())},clearOptions:function(){this.options.values=[],this.options.labels={},this.options.icons={},this.options.value=null,this.fill()},refill:function(a){this.options.values=a.values?a.values:[],this.options.labels=a.labels?a.labels:{},this.options.icons=a.icons?a.icons:{},this.options.value=a.value?a.value:"",this.fill()},fill:function(){var a=this,b=$A(this.htmlElement.getElementsByTagName("option")),c=!1;b.each(function(a,b){this.htmlElement.removeChild(a)}.bind(this)),this.labels={},this.values=[],this.options.value||(this.values.push("__pleaseselect"),this.labels.__pleaseselect=_LOC("kTKOmIvVOk",":: Please select ::"),this.options.value="__pleaseselect"),this.options.top&&this.options.top.each(function(b,c){a.values.push(b.value),a.labels[b.value]=typeof b.label=="string"?b.label.escapeHTML():b.label}),this.options.objects?c=evaluate(this.options.objects):this.options["class"]&&(c=get_objects(this.options["class"],this.options.types)),c&&c.each(function(b,c){b.hidden||(a.values.push(b.ref),a.labels[b.ref]=b.data.name)}),this.options.values&&this.options.values.each(function(b,c){a.values.push(b),a.labels[b]=a.options.labels[b]||b}),this.values.each(function(a,b){this.appendOption(a,this.labels[a],this.options.value==a)}.bind(this)),this.options.optionGroups&&this.options.optionGroups.length!==0&&this.options.optionGroups.each(function(a,b){this.appendOptionGroup(a)}.bind(this))},getValue:function(){var a=$F(this.htmlElement);if(a=="__pleaseselect")return!1;return a},getGroup:function(){return this.htmlElement.options[this.htmlElement.selectedIndex].group||!1},getIndex:function(){var a=this.htmlElement.selectedIndex;return a},setValue:function(a,b){if(b)$(this.htmlElement).value=a;else{if(!a||a==="")a="__pleaseselect";this.htmlElement.selectedIndex=a}},getValues:function(){var a=this,b=[],c=0,d=this.htmlElement.options.length;for(;c<d;)b.push(this.htmlElement.options[c++].value);return b},reset:function(){this.htmlElement.options[0].value=="__pleaseselect"&&(this.htmlElement.options.selectedIndex=0)},appendOption:function(a,b,c){b=typeof b=="string"?b.unescapeHTML():b,this.htmlElement.options[this.htmlElement.options.length]=new Option(b,a);var d=this.htmlElement.options[this.htmlElement.options.length-1];this.options.icons[a]&&(d.style.backgroundImage="url("+this.options.icons[a]+")",d.style.backgroundRepeat="no-repeat",d.style.paddingLeft=(this.options.iconWidth||16)+2*(this.options.iconOffsetHorizontal||4)+"px",d.style.backgroundPosition=(this.options.iconOffsetHorizontal||"0")+"px "+(this.options.iconOffsetTop||"0")+"px"),c&&(d.defaultSelected=!0,d.selected=!0),this.options.optionsDisabled[a]&&(d.disabled=!0,d.style.color="graytext"),Event.observe(this.htmlElement,"change",function(){if(["disabled",!0].indexOf(this.options[this.selectedIndex].getAttribute("disabled"))>-1){var a=0,b=0,c;for(c in this.options)if(c.defaultSelected){a=b++;break}this.selectedIndex=a}}.bind(this.htmlElement))},appendOptionGroup:function(a){var b=document.createElement("optgroup"),c=this.options.value;b.label=a.group,this.htmlElement.appendChild(b),a.options.each(function(d,e){var f=document.createElement("option");c&&d.value===c?c=d.value:c=!1,b.appendChild(f),f.value=d.value,d.label=typeof d.label=="string"?d.label.unescapeHTML():d.label,f.text=d.label,f.group=a.group,c&&(f.defaultSelected=!0,f.selected=!0)})},disable:function(){this.htmlElement.disabled=!0},enable:function(){this.htmlElement.disabled=!1}},core.myDndMgr=Class.create(),core.myDndMgr.prototype=(new Rico.DragAndDrop).extend({registerDropZone:function(a){for(var b=0;b<this.dropZones.length;b++)this.dropZones[b].zoneId==a.zoneId&&this.deregisterDropZone(this.dropZones[b]);this.dropZones[this.dropZones.length]=a},deregisterDropZone:function(a){var b=[],c=0;for(var d=0;d<this.dropZones.length;d++)this.dropZones[d].zoneId!=a.zoneId&&(b[c++]=this.dropZones[d]);this.dropZones=b},debug:function(){for(var a=0,b=this.dropZones.length;a<b;)_debug(this.dropZones[a++].zoneId)},_leftOffset:function(a){var b=a.changedTouches&&a.changedTouches.length?a.changedTouches[0].pageX:Event.pointerX(a);return b},_topOffset:function(a){var b=a.changedTouches&&a.changedTouches.length?a.changedTouches[0].pageY:Event.pointerY(a);return b},_updateDraggableLocation:function(a){var b=this.dragElement.style;b.left=this._leftOffset(a)-Math.round(this.dragElement.offsetWidth/3)+"px",b.top=this._topOffset(a)-Math.round(this.dragElement.offsetHeight/2)+"px",b.cursor="pointer"},getDropZone:function(a){for(var b=0,c=this.dropZones.length;b<c;b++)if(this.dropZones[b].zoneId==a)return this.dropZones[b];return!1}});var singleDropzone=Class.create();singleDropzone.prototype=(new Rico.Dropzone).extend({initialize:function(a,b,c,d,e,f,g){this.zoneId=a,this.htmlElement=document.createElement("div"),this.htmlElement.className="DRAGDROP_DROPZONE_container_single",this.htmlElement.style.width=f+"px",this.htmlElement.style.height=g+"px",this.htmlElement.id="DROPZONE_"+a+"_ELEMENT",this.acceptClass=b,this.acceptTypes=c,this.blacklistProperties=d,this.restricted=e,this.absoluteRect=null,this.member="",this.noeditable=!1,this.htmlElement.dropzone=this},activate:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_single_active"},deactivate:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_single_inactive"},showHover:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_single_hover"},hideHover:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_single_hidehover"},accept:function(a){this.add(a[0].obj.ref)},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},canAccept:function(a){if(this.disabled)return!1;if(a.length>1)return!1;var b=this.acceptClass,c=this.acceptTypes,d=this.blacklistProperties&&this.blacklistProperties.length>1?this.blacklistProperties:!1,e=this.member;return a.all(function(a,f){if(a.obj["class"]!=b)return!1;if(c&&c.indexOf("*")<0&&c.indexOf(a.obj.type)<0)return!1;if(d){var g=!0;d.each(function(b,c){a.obj.data[b[0]]==b[1]&&(g=!1)});if(!g)return!1}if(e==a.obj.ref)return!1;return!0})},add:function(a){var b,c,d,e;this._remove(),b=Builder.node("img",{src:"core/img/icons/trash.png",style:"margin-right:6px;margin-left:2px;cursor:pointer;",valign:"top",id:"__DND_"+this.zoneId+"_DROPPED_"+a+"_trash_icon"}),Event.observe(b,"click",function(){this.disabled||this._remove(!0)}.bind(this)),c=dnd_gui(a,1,!1,this.restricted),c.style.backgroundColor="white",d=domRow([b,c]),d.id="__DND_"+this.zoneId+"_DROPPED_"+a,d.style.backgroundColor="white",Event.observe($(d),"dblclick",function(){this.disabled||this._edit(a)}.bind(this)),e=get_object(a),e&&!e.hidden&&(this.htmlElement.appendChild(d),this.member=a)},_edit:function(a){if(!this.noeditable)var b=new core.popup({name:"POPUP_EDIT_"+this.zoneId,obj_ref:a,anchor:"__DND_"+this.zoneId+"_DROPPED_"+a,update_type:"dropzone_single",update_name:this.zoneId})},_remove:function(){this.member&&$("__DND_"+this.zoneId+"_DROPPED_"+this.member)&&(this.htmlElement.removeChild($("__DND_"+this.zoneId+"_DROPPED_"+this.member)),this.member="")}});var myDropzone=Class.create();myDropzone.prototype=(new Rico.Dropzone).extend({initialize:function(a,b,c,d,e,f,g,h,i,j){this.zoneId=a,h?this._insert=this._insertSorted:this._insert=this._insertUnsorted,this.sorted=!!h,this.sortable=!!i,this.maxWidth=f,this.htmlElement=document.createElement("div"),this.htmlElement.style.width=f+"px",this.htmlElement.style.height=g+"px",this.htmlElement.style.textAlign="left",this.htmlElement.className="DRAGDROP_DROPZONE_container_multi",this.htmlElement.id="DROPZONE_"+a+"_ELEMENT",this.acceptClass=b,this.acceptTypes=c,this.blacklistProperties=d,this.restricted=e,this.absoluteRect=null,this.noeditable=!1,Event.observe($(this.htmlElement),"scroll",this.clearPositionCache.bind(this)),this.members=[],this.memberElements={},this.extend(j),this.htmlElement.dropzone=this},activate:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_multi_active"},deactivate:function(){this.htmlElement.className="DRAGDROP_DROPZONE_container_multi_inactive"},showHover:function(a){this.htmlElement.className="DRAGDROP_DROPZONE_container_multi_hover";if(!this.sorted){var b=this.htmlElement.scrollTop,c=a.touches&&a.touches.length?a.touches[0].clientX:Event.pointerX(a),d=(a.touches&&a.touches.length?a.touches[0].clientX:Event.pointerY(a))+b;a&&this.memberElements&&$H(this.memberElements).each(function(a){Position.within(a.value,c,d)?Position.cumulativeOffset($(a.value))[1]+parseInt($(a.value).getHeight()/2,10)>d?a.value.showMarkerBefore():a.value.showMarkerAfter():a.value.hideMarkers()}.bind(this))}},hideHover:function(a){this.htmlElement.className="DRAGDROP_DROPZONE_container_multi_hidehover",this.sorted||this.memberElements&&$H(this.memberElements).each(function(a){a.value.hideMarkers()}.bind(this))},accept:function(a,b){if(b&&this.memberElements){var c=this.htmlElement.scrollTop,d=b.changedTouches&&b.changedTouches.length?b.changedTouches[0].clientX:Event.pointerX(b),e=(b.changedTouches&&b.changedTouches.length?b.changedTouches[0].clientY:Event.pointerY(b))+c;$H(this.memberElements).each(function(a){Position.within(a.value,d,e)&&(Position.cumulativeOffset($(a.value))[1]+parseInt($(a.value).getHeight()/2,10)>e?this.beforeThis=a.key:this.afterThis=a.key,typeof a.value.hideMarkers=="function"&&a.value.hideMarkers())}.bind(this))}for(var f=0,g=a.length;f<g;){var h=a[f++].obj;this.afterAddAction&&window[this.afterAddAction]&&window[this.afterAddAction](h),this._insert(h)}this.afterThis=undefined,this.beforeThis=undefined},disable:function(){this.disabled=!0,browser=="ie"&&($(this.zoneId).down(1).style.filter="alpha(opacity=50)")},enable:function(){this.disabled=!1,browser=="ie"&&($(this.zoneId).down(1).style.filter="alpha(opacity=100)")},canAccept:function(a){if(this.disabled)return!1;var b=this.acceptClass,c=this.acceptTypes,d=this.blacklistProperties,e=this.members;return a.all(function(a,f){if(a.obj["class"]!=b)return!1;if(c&&c.indexOf("*")<0&&c.indexOf(a.obj.type)<0)return!1;if(d){var g=!0;d.each(function(b,c){a.obj.data[b[0]]==b[1]&&(g=!1)});if(!g)return!1}if(e.indexOf(a.obj.ref)>=0)return!1;return!0})},_colorize:function(){var a=this.memberElements;this.members.each(function(b,c){a[b].style.backgroundColor=dnd_bgcolors[c%2]})},_remove:function(a){this.members.splice(this.members.indexOf(a),1),delete this.memberElements[a],this.htmlElement.removeChild($("__DND_"+this.zoneId+"_DROPPED_"+a)),this._colorize(),this.sortable&&this._updateMovers()},_edit:function(a){if(!this.noeditable){this.disabled=!0,this.popupOpened=!0;var b=new core.popup({name:"POPUP_EDIT_"+this.zoneId,obj_ref:a,anchor:"__DND_"+this.zoneId+"_DROPPED_"+a,update_type:"dropzone",update_name:this.zoneId,onclose:function(){this.disabled=!1,this.popupOpened=!1}.bind(this)})}},update:function(a){var b,c=this.memberElements[a],d,e=get_object(a);if(e&&this.members[this.members.indexOf(a)]&&this.memberElements[a]&&c)b=this._createGui(e),b.style.cssText=c.style.cssText,this.htmlElement.replaceChild(b,c),this.memberElements[a]=b;else if(e)this._insert(e);else return!1},_createGui:function(a){var b=Builder.node("img",{src:"core/img/icons/trash.png",style:"margin-right: 6px;margin-left:2px;cursor:pointer;",id:"__DND_"+this.zoneId+"_DROPPED_"+a.ref+"_trash_icon"}),c,d,e,f,g;Event.observe($(b),"click",function(){this.disabled||this._remove(a.ref,!0)}.bind(this)),c=this.dnd_gui(a.ref,2,!1,this.restricted),d=domRow([b,c]),Event.observe($(d),"dblclick",function(c){var d=Event.findElement(c,"img");d=!!d&&d===b,!d&&!this.disabled&&this._edit(a.ref)}.bind(this)),this.sortable&&(c.className="ellipsis",c.style.maxWidth=this.maxWidth-24-32+"px",e=Builder.node("img",{src:"core/img/icons/move_up.png",width:"16px",height:"16px",style:"cursor:pointer;margin:0px;float:left;",id:"__DND_"+this.zoneId+"_DROPPED_"+a.ref+"_up_icon"}),f=Builder.node("img",{src:"core/img/icons/move_down.png",width:"16px",height:"16px",style:"cursor:pointer;margin:0px;float:right;",id:"__DND_"+this.zoneId+"_DROPPED_"+a.ref+"_down_icon"}),g=Builder.node("div",{style:"width:32px;"},[e,f]),b.attrs={width:"24px"},g.attrs={width:"32px"},d=domRow([b,c,g]),$(d).down().style.width="100%",d.up=$(e),d.down=$(f),Event.observe(d.up,"click",function(){this.disabled||this._moveItemUp(a.ref)}.bind(this)),Event.observe(d.down,"click",function(){this.disabled||this._moveItemDown(a.ref)}.bind(this)),d.hideDown=function(){this.down.hide()}.bind(d),d.hideUp=function(){this.up.hide()}.bind(d),d.showDown=function(){this.down.show()}.bind(d),d.showUp=function(){this.up.show()}.bind(d)),d.id="__DND_"+this.zoneId+"_DROPPED_"+a.ref,this.sorted||(d.showMarkerBefore=function(){this.style.borderTop="2px solid green",this.style.borderBottom="0px"}.bind(d),d.showMarkerAfter=function(){this.style.borderBottom="2px solid green",this.style.borderTop="0px"}.bind(d),d.hideMarkers=function(){this.style.borderTop="0px",this.style.borderBottom="0px"}.bind(d)),d.item=c;return d},_moveItemUp:function(a){this.htmlElement.insertBefore(this.memberElements[a],this.memberElements[a].previousSibling);var b=this.members.indexOf(a);this.members[b]=this.members[b-1],this.members[b-1]=a,this._colorize(),this._updateMovers()},_moveItemDown:function(a){this.htmlElement.insertBefore(this.memberElements[a],this.memberElements[a].nextSibling.nextSibling);var b=this.members.indexOf(a);this.members[b]=this.members[b+1],this.members[b+1]=a,this._colorize(),this._updateMovers()},_insertSorted:function(a){var b=this._createGui(a),c=this.members.detect(function(b,c){var d=get_object(b);if(d.hidden)return!1;if(d.data.name.toLowerCase()>=a.data.name.toLowerCase())return!0;return!1});c?(a.hidden||this.htmlElement.insertBefore(b,this.memberElements[c]),this.members.splice(this.members.indexOf(c),1,a.ref,c)):(a.hidden||this.htmlElement.appendChild(b),this.members.push(a.ref)),this.memberElements[a.ref]=b,this._colorize(),this.sortable&&this._updateMovers()},_insertUnsorted:function(a){var b=this._createGui(a);this.beforeThis?(a.hidden||this.htmlElement.insertBefore(b,this.memberElements[this.beforeThis]),this.members.splice(this.members.indexOf(this.beforeThis),1,a.ref,this.beforeThis)):this.afterThis?(this.memberElements[this.afterThis].nextSibling?a.hidden||this.htmlElement.insertBefore(b,this.memberElements[this.afterThis].nextSibling):a.hidden||this.htmlElement.appendChild(b),this.members.splice(this.members.indexOf(this.afterThis),1,this.afterThis,a.ref)):(a.hidden||this.htmlElement.appendChild(b),this.members.push(a.ref)),this.memberElements[a.ref]=b,this._colorize(),this.sortable&&this._updateMovers()},_updateMovers:function(){if(this.members.length>1){this.memberElements[this.members[0]].hideUp(),this.memberElements[this.members[0]].showDown();if(this.members.length>2)for(var a=1;a<=this.members.length-2;a++)this.memberElements[this.members[a]].showUp(),this.memberElements[this.members[a]].showDown();this.memberElements[this.members[this.members.length-1]].hideDown(),this.memberElements[this.members[this.members.length-1]].showUp()}else this.memberElements[this.members[0]].hideUp(),this.memberElements[this.members[0]].hideDown()}});var myDraggable=Class.create();myDraggable.removeOnDrop=!1,myDraggable.prototype=(new Rico.Draggable).extend({initialize:function(a,b){this.obj=a,b.members||(b.members=[]),this.htmlElement=$(dnd_gui({obj_ref:this.obj.ref,sidebar:!0})),this.htmlElement.id="__DND_DRAGGABLE_"+a.ref,b.appendChild(this.htmlElement),b.members.push(this.obj.ref),this.htmlElement.addClassName("dnd_alternate"),dnd_cnt[a["class"]]++,this.selected=!1,this.htmlElement.mydraggable=this},select:function(){this.selected=!0,this.realBgColor=this.htmlElement.style.backgroundColor,this.htmlElement.style.backgroundColor="#ffffff"},deselect:function(){this.selected=!1,this.htmlElement.style.backgroundColor=""},getSingleObjectDragGUI:function(){var a=document.createElement("div");a.style.cssText="background-color:white;border:1px solid black;white-space:nowrap;z-index:50;",a.style.width=this.htmlElement.offsetWidth-10+"px",a.appendChild(dnd_gui(this.obj.ref,2,!0));return a},getMultiObjectDragGUI:function(a){var b=document.createElement("div");b.style.cssText="background-color:white;border:1px solid black;white-space:nowrap;z-index:50;",b.style.width=this.htmlElement.offsetWidth-10+"px",a.each(function(a,c){b.appendChild(dnd_gui(a.obj.ref,2,!0))});return b}});var dnd_helpers=function(){var a,b;a=Class.create(null,{dnd_gui:function(a){var b=$(arguments),c,d;typeof a=="object"?b=[]:a=Object.extend({obj_ref:b[0]||"",outerPadding:b[1]||0,noInfo:b[2]||!1,restricted:b[3]||!1,sidebar:b[4]||!1}),c=get_object(a.obj_ref);if(!c)return!1;d=Builder.node("div",{style:"vertical-align:middle;overflow:hidden;cursor:pointer;white-space:nowrap;"}),d.icon=Builder.node("img",{src:get_icon(c.ref,!1,!1,a.restricted),style:"display:inline;vertical-align:middle;"+(a.outerPadding?"padding:"+a.outerPadding+"px 2px "+a.outerPadding+"px 2px;":"padding:4px 2px 4px 2px;")+"height: 16px;"+"width: 16px;"}),d.caption=$(Builder.node("div",{style:"display:inline;vertical-align:middle;white-space:nowrap;"+(a.outerPadding?"padding:"+a.outerPadding+"px 2px "+a.outerPadding+"px 0px;":"padding:4px 2px 4px 0px;")})).update(c.data.name),d.info=!1,d.infoAnchor=!1,d.info=c.data.name+(c.data.comment?"<br />"+c.data.comment:"")+(get_value(c.ref)?"<br />"+get_value(c.ref):"");if(d.info){d.infoAnchor=Builder.node("div",{style:"position:relative;overflow:hidden;height:0px;width:0px;margin-left:20px;"})}d.appendChild(d.icon),d.appendChild(d.caption),d.info&&d.infoAnchor&&(d.appendChild(d.infoAnchor),d.onmouseover=function(){c=get_object(a.obj_ref),d.info=c.data.name+(c.data.comment?"<br />"+c.data.comment:"")+(get_value(c.ref)?"<br />"+get_value(c.ref):""),infopop_up(d.infoAnchor,d.info,!1,a.sidebar)},d.onmouseout=infopop_down);return d},getMembers:function(){return this.members}}),b=function(a,b){obj=get_object(a),b.info=obj.data.name,infopop_up(b.infoAnchor,b.info,!1,null,null,b.info.length>50?200:!1)};return{filter_action_tags:new(Class.create(a,{getMembers:function(){var a={};$H(this.memberElements).each(function(b){a[b.key]=b.value.item.dropdown.value});return a},_insert:function(a){var b=this;a.type?(b[b.sorted?"_insertSorted":"_insertUnsorted"].call(b,a),b.memberElements[a.ref].item.dropdown.changeHandler()):$H(a).each(function(a){var c=get_object(a.key);!c||(b[b.sorted?"_insertSorted":"_insertUnsorted"].call(b,c),b.memberElements[a.key].item.dropdown.value=a.value,b.memberElements[a.key].item.dropdown.changeHandler())})},dnd_gui:function(a){var c=$(arguments),d,e,f=parseInt(this.htmlElement.style.width)-42,g=300;typeof a=="object"?c=[]:a=Object.extend({obj_ref:c[0]||"",outerPadding:c[1]||0,noInfo:c[2]||!1,restricted:c[3]||!1,sidebar:c[4]||!1}),d=get_object(a.obj_ref);if(!d)return!1;e=Builder.node("div",{style:"vertical-align:middle;overflow:hidden;cursor:pointer;white-space:nowrap;width:"+f+"px;padding-top:1px;padding-bottom:1px"}),e.icon=Builder.node("img",{src:get_icon(d.ref,!1,!1,a.restricted),style:"float:left;vertical-align:middle;"+(a.outerPadding?"padding:"+a.outerPadding+"px 2px "+a.outerPadding+"px 2px;":"padding:4px 2px 4px 2px;")+"height: 16px;"+"width: 16px;"}),e.caption=$(Builder.node("div",{style:"float:left;vertical-align:middle;white-space:nowrap;text-overflow:ellipsis; overflow:hidden;max-width:"+g+"px;"+(a.outerPadding?"padding:"+a.outerPadding+"px 2px "+a.outerPadding+"px 0px;":"padding:4px 2px 4px 0px;")})).update(d.data.name),e.dropdown=Builder.node("select",{style:"float:right;"},[Builder.node("option",{value:"allow","class":"web_action_allow"},"Allow"),Builder.node("option",{value:"warn","class":"web_action_warn"},"Warn"),Builder.node("option",{value:"block","class":"web_action_block"},"Block"),Builder.node("option",{value:"quota","class":"web_action_quota"},"Quota")]),e.dropdown.value="allow",e.dropdown.changeHandler=function(){this.className="web_action_"+this.value},Event.observe(e.dropdown,"change",e.dropdown.changeHandler),e.info=!1,e.infoAnchor=!1,e.info=d.data.name+(d.data.comment?"<br />"+d.data.comment:"")+(get_value(d.ref)?"<br />"+get_value(d.ref):"");if(e.info){e.infoAnchor=Builder.node("div",{style:"position:relative;overflow:hidden;height:0px;width:0px;margin-left:20px;"})}e.appendChild(e.icon),e.appendChild(e.caption),e.appendChild(e.dropdown),e.info&&e.infoAnchor&&(e.appendChild(e.infoAnchor),e.caption.onmouseover=function(){b(a.obj_ref,e)},e.onmouseout=infopop_down);return e}})),lsl_tags:new(Class.create(a,{dnd_gui:function($super,a){gui=$super(a),gui.info&&gui.infoAnchor&&(gui.appendChild(gui.infoAnchor),gui.onmouseover=function(){b(a,gui)},gui.onmouseout=infopop_down);return gui}})),"default":new a}}(),dnd_gui=function(a){return dnd_helpers["default"].dnd_gui(a)},dndMgr=new core.myDndMgr;dndMgr.initializeEventHandlers(),Event.observe(window,"scroll",function(){typeof $("dnd_frame").restyle=="function"&&$("dnd_frame").restyle()}),core.wizard={wizards:new Hash,providers:new Hash,ASG_Network:function(a){$("menu").hide(),$("display").update(),this.providers.ASG_Network=new core.wizard.AjaxProvider("ASG_Network",a),this.wizards.ASG_Network=new core.wizard.manager({provider:this.providers.ASG_Network,onCancel:function(){$("menu").show(),core.menu.action("dashboard"),call_fid("unset_offer_wizard")},onFinish:function(){core.wizard.wizards.ASG_Network.options.provider.currentStep=="restore_upload"?logout():($("menu").show(),core.menu.action("dashboard"),call_fid("unset_offer_wizard"))}})},Migration:function(a){$("menu").hide(),$("display").update(),this.providers.Migration=new core.wizard.AjaxProvider("Migration",a),core.utils.scriptloader.require([dynIncPath+"_migrationWizard.js"],!1,0,!0),this.wizards.Migration=new core.wizard.manager({provider:this.providers.Migration,onCancel:function(){$("menu").show(),core.menu.link("ir_management","up2date","migration_wizard_start")},onFinish:function(){this.onCancel()},hide_button:!0,hide_progress:!0})}},core.wizard.Provider=Class.create(),core.wizard.Provider.prototype={data:{title:"Wizard",data:{},finish:0,steps:[],displays:{},help:"no Help defined"},initialize:function(){},first:function(a){},next:function(a){},back:function(a){},finish:function(a){},update:function(a,b){this.data.data[b]&&a&&(this.data.data[b]=Object.extend(this.data.data[b],a)),this.currentStep=b}},core.wizard.AjaxProvider=Class.create(),core.wizard.AjaxProvider.prototype=Object.extend(new core.wizard.Provider,{initialize:function(a,b){this.init=Object.extend({},b||{}),this.setName(a)},setName:function(a){this.name=a},_callFID:function(a){var b={data:this.data};b.callback="core.wizard.providers."+this.name+"._"+a+"CB",b.wizard={name:this.name,init:this.init},call_fid("wizard_"+a,b)},first:function(a){this.firstCallback=a,this._callFID("first")},_firstCB:function(a){this.data=a.data,this.firstCallback(this.data)},next:function(a){this.nextCallback=a,this._callFID("next")},_nextCB:function(a){this.data=a.data,a.error&&(this.data.error=a.error),this.nextCallback(this.data)},back:function(a){this.backCallback=a,this._callFID("back")},_backCB:function(a){this.data=a.data,this.backCallback(this.data)},finish:function(a){this.finishCallback=a,this._callFID("finish")},_finishCB:function(a){this.data=a.data,a.error&&(this.data.error=a.error),this.finishCallback(this.data)}}),core.wizard.manager=Class.create(),core.wizard.manager.prototype={config:{},initialize:function(a){this.options=Object.extend({provider:core.wizard.AjaxProvider,onCancel:Prototype.emptyFunction,onFinish:Prototype.emptyFunction,container:"display"},a||{}),this.that=this,this.options.provider.first(this.show.bind(this))},show:function(a){a=Object.extend({container:this.options.container},a||{}),this.containerDiv?this.containerDiv.update(""):(this.containerDiv=Builder.node("div"),$(a.container).appendChild(this.containerDiv)),this.options.miniWizard&&(a.miniWizard=!0),this.display=new core.wizard.display(a,this),$(this.containerDiv).appendChild(this.display.toHTML()),this.images||(this.images=[],$H(a.displays).each(function(a){var b=a.value,c;b.image&&(c=new Image(1,1),c.src=b.image,this.images.push(c))}.bind(this)))},cancel:function(){confirm(_LOC("GAISAbEoLh","Are you sure to exit this wizard?"))&&($(this.containerDiv).update(""),this.options.onCancel())},next:function(a,b){var c=1;this.options.provider.name!=undefined&&this.options.provider.name.match(/migration/i)&&(typeof a.alert_text=="string"&&a.alert_text&&migration_error_win_wizard(a.alert_text),typeof a.confirm_text=="string"&&a.confirm_text&&(core.wizard.providers.Migration.data.next_page!=undefined&&core.wizard.providers.Migration.data.next_page?delete core.wizard.providers.Migration.data.next_page:(c=0,migration_confirm_win_wizard(a.confirm_text)))),c&&(this.options.provider.update(a,b),this.options.provider.next(this.show.bind(this)))},back:function(a,b){this.options.provider.update(a,b),this.options.provider.back(this.show.bind(this))},finish:function(a,b){this.options.provider.update(a,b),this.options.provider.finish(this.finish_cb.bind(this))},finish_cb:function(a){a.error?this.show(a):($(this.containerDiv).update(""),this.options.onFinish())}},core.wizard.display=Class.create(),core.wizard.display.prototype=function(){function ProgressBar(a){this.options=Object.extend({value:10,maxValue:100,hidden:!1},a||{}),this.barElement=Builder.node("div"),this.htmlElement=Builder.node("div",{className:"wizard_progressbar",style:this.options.hidden?"display: none;":""},this.barElement),this.update(this.options.value)}ProgressBar.prototype={update:function(a){var b=Math.min(a/this.options.maxValue*100,100);this.barElement.style.width=parseInt(b,10)+"%"},toHTML:function(){return this.htmlElement}};return{initialize:function(a,b){this.options=Object.extend({title:"",activeStep:1,steps:[],help:"",elements:[],data:{}},a||{}),this.activeStep=this.options.steps.last(),this.options.data[this.activeStep]?this.options.data=this.options.data[this.activeStep]:this.options.data={},this.options.miniWizard&&(this.toHTML=this.toMiniHTML),this.manager=b},next:function(){Object.extend(this.options.data,this.contentWindow.serialize()),this.manager.next(this.options.data,this.activeStep)},back:function(){try{Object.extend(this.options.data,this.contentWindow.serialize())}catch(a){_debug(a)}this.manager.back(this.options.data,this.activeStep)},cancel:function(){this.manager.cancel()},finish:function(){Object.extend(this.options.data,this.contentWindow.serialize()),this.manager.finish(this.options.data,this.activeStep)},doCheck:function(){var a=this.options.displays[this.activeStep].buttons,b=this.contentWindow.isMandantoryElementsOk();this.options.finish||a&&!a.next||!b?$(this.nextButton)&&(Form.Element.disable(this.nextButton),this.manager.options.hide_button?this.nextButton.hide():input_deactivate($(this.nextButton))):$(this.nextButton)&&(Form.Element.enable(this.nextButton),this.manager.options.hide_button?this.nextButton.show():input_activate($(this.nextButton))),!this.options.finish||a&&!a.finish||!b?$(this.finishButton)&&(Form.Element.disable(this.finishButton),this.manager.options.hide_button?this.finishButton.hide():input_deactivate($(this.finishButton))):$(this.finishButton)&&(Form.Element.enable(this.finishButton),this.manager.options.hide_button?this.finishButton.show():input_activate($(this.finishButton)));var c=this.options.displays[this.activeStep].hideNext!==undefined?this.options.displays[this.activeStep].hideNext:0,d=this.options.displays[this.activeStep].disableNext!==undefined?this.options.displays[this.activeStep].disableNext:0;(c||d)&&$(this.nextButton)&&(c?(Form.Element.disable(this.nextButton),this.manager.options.hide_button?this.nextButton.hide():input_deactivate($(this.nextButton))):d&&input_deactivate($(this.nextButton)))},toHTML:function(){var title=this.options.title,helpText=this.options.help,middleTable,activeStepButtons=this.options.displays[this.activeStep].buttons,contentCells=[],licensed=this.options.licensed!==0;this.options.displays[this.activeStep].title&&(title=this.options.displays[this.activeStep].title),this.titleElement=Builder.node("div",{className:"wizard_titleElement"},Builder.node("div",{className:"wizard_title"},title)),this.options.help||(helpText=this.options.displays[this.activeStep].help),this.helpWindow=new core.wizard.display.helpWindow(helpText),this.options.displays[this.activeStep].elements.each(function(a){a.help&&this.helpWindow.addElementHelp(a.help)}.bind(this)),this.messageElement=Builder.node("div",{style:"color:red;padding:0 5px;float:left;text-align:left;width:270px;"}),this.messageElement.alert=function(a){this.update(),this.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{border:"0",valign:"top",align:"left",src:"core/img/icons/warning.png",style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(a)]))))}.bind(this.messageElement),this.messageElement.confirm=function(a){this.update(),this.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{border:"0",valign:"top",align:"left",src:"core/img/icons/confirm.png",style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(a)]))))}.bind(this.messageElement),this.contentWindow=new core.wizard.display.contentWindow(this.options.displays[this.activeStep].elements,this.options.data,this),this.buttonCell=Builder.node("div",{className:"wizard_buttonCell"},[this.messageElement]),this.options.displays[this.activeStep].image?(this.stepImage=Builder.node("img",{src:this.options.displays[this.activeStep].image}),contentCells=[Builder.node("td",{className:"wizard_leftContentColumn"},this.stepImage),Builder.node("td",{className:"wizard_mainContentColumn"},[this.contentWindow.toHTML(),this.buttonCell])]):(this.progressBar=new ProgressBar({value:this.options.steps.length,maxValue:this.options.displays[this.activeStep].branch_steps,hidden:this.manager.options.hide_progress}),contentCells=[Builder.node("td",{className:"wizard_mainContentColumn"},[this.contentWindow.toHTML(),this.progressBar.toHTML(),this.buttonCell])]),contentCells.push(Builder.node("td",{className:"wizard_rightContentColumn"})),middleTable=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"width: 100%;"},Builder.node("tbody",{},Builder.node("tr",{},[contentCells]))),this.helpWindow.isHelp()?(this.helpColElement=Builder.node("td",{rowspan:"1",className:"wizard_help"},[this.helpWindow.toHTML()]),this.helpColElement.setAttribute("rowSpan",3)):this.helpColElement="",this.middleElement=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"width: 100%;"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{},[Builder.node("div",{style:"width:100%;"},[middleTable])]),this.helpColElement])])),this.backButton=Builder.node("div",{style:"width:80px;"}),button_init(this.backButton,{margin:"0px 3px 3px 0px",label:_LOC("wzPaSqGKUt","Back"),icon:"core/img/icons/move_left.png",width:120}),this.options.steps.length===1||activeStepButtons&&!activeStepButtons.back?(Form.Element.disable(this.backButton),input_deactivate($(this.backButton))):Element.observe(this.backButton,"click",this.back.bind(this));var nextText=_LOC("wtOaLReatf","Next"),nextSize=120;this.options.displays[this.activeStep].labelNext&&(nextText=this.options.displays[this.activeStep].labelNext,nextSize="resize"),this.nextButton=Builder.node("div",{style:"width:80px;"}),button_init(this.nextButton,{margin:"0px 3px 3px 0px",label:nextText,icon:"core/img/icons/move_right.png",width:nextSize,minWidth:"120px",maxWidth:"none"}),this.options.finish||activeStepButtons&&!activeStepButtons.next?(Form.Element.disable(this.nextButton),input_deactivate($(this.nextButton))):Element.observe(this.nextButton,"click",this.next.bind(this)),this.cancelButton=Builder.node("div",{style:"width:80px;"}),button_init(this.cancelButton,{margin:"0px 3px 3px 0px",label:_LOC("TXMkkbNFDc","Cancel"),icon:"core/img/icons/cancel.png",width:120}),Element.observe(this.cancelButton,"click",this.cancel.bind(this)),this.finishButton=Builder.node("div",{style:"width:80px;"}),button_init(this.finishButton,{margin:"0px 3px 3px 0px",label:_LOC("BvjbINCRHb","Finish"),icon:"core/img/icons/check.png",width:120}),this.options.finish||activeStepButtons&&activeStepButtons.finish?Element.observe(this.finishButton,"click",this.finish.bind(this)):(Form.Element.disable(this.finishButton),input_deactivate($(this.finishButton))),this.buttonCell.appendChild(Builder.node("div",{style:"display: block;"},[this.cancelButton,this.backButton,this.nextButton,this.finishButton])),this.htmlElement=domTableCol([domTd("","","",this.titleElement),domTd("","","",this.middleElement)],""),this.htmlElement.style.width="100%",this.options.title.match(/migration/i)||this.options.error&&this.contentWindow.handleErrors(this.options.error,this.messageElement),this.options.errors&&window.setTimeout(function(){_debug(this.options.errors),this.options.errors[1].text?alert(this.options.errors[1].text):eval(this.options.errors)}.bind(this),100),this.doCheck(),remove_license_exceptions(),licensed||(license_exception(),input_deactivate(this.contentWindow.htmlElement));return this.htmlElement},toMiniHTML:function(){var title=this.options.title;this.options.displays[this.activeStep].title&&(title=this.options.displays[this.activeStep].title),this.titleElement=Builder.node("div",{className:"miniWizard_titleElement"},Builder.node("div",{className:"miniWizard_title"},title)),this.contentWindow=new core.wizard.display.contentWindow(this.options.displays[this.activeStep].elements,this.options.data,this),this.contentElement=this.contentWindow.toHTML("#EEEEEE"),this.contentElement.style.height="100%",this.middleElement=Builder.node("div",{style:"padding:10px;background-color:#EEEEEE;border-left: 1px solid black;border-right: 1px solid black;"},[this.contentElement]),this.buttonCell=Builder.node("div",{className:"miniWizard_buttonCell"}),this.backButton=Builder.node("button",{type:"button",className:"miniWizard_button_back"},[Builder.node("img",{src:"core/img/icons/move_left.png",width:"16",height:"16",alt:_LOC("CPFQrXuidZ","back"),className:"wizard_button_back_image"}),Builder.node("div",{className:"wizard_button_text"},_LOC("LDbviFOKBE","Back"))]),this.options.steps.length==1?Form.Element.disable(this.backButton):Element.observe(this.backButton,"click",this.back.bind(this)),this.nextButton=Builder.node("button",{type:"button",className:"miniWizard_button_next"},[Builder.node("img",{src:"core/img/icons/move_right.png",width:"16",height:"16",alt:_LOC("ivQTxvdSmY","next"),className:"wizard_button_next_image"}),Builder.node("div",{className:"wizard_button_text"},_LOC("GCiONpNjsq","Next"))]),this.options.finish?Form.Element.disable(this.nextButton):Element.observe(this.nextButton,"click",this.next.bind(this)),this.cancelButton=Builder.node("button",{type:"button",className:"miniWizard_button_cancel"},[Builder.node("img",{src:"core/img/icons/cancel.png",width:"16",height:"16",alt:_LOC("tSJFtjKxjV","cancel"),className:"wizard_button_cancel_image"}),Builder.node("div",{className:"wizard_button_text"},_LOC("vwyuvnQEDR","Cancel"))]),Element.observe(this.cancelButton,"click",this.cancel.bind(this)),this.finishButton=Builder.node("button",{type:"button",className:"miniWizard_button_finish"},[Builder.node("img",{src:"core/img/icons/check.png",width:"16",height:"16",alt:_LOC("KleHVmrVBP","finish"),className:"wizard_button_finish_image"}),Builder.node("div",{className:"wizard_button_text"},_LOC("SOhnKDvLyB","Finish"))]),this.options.finish?Element.observe(this.finishButton,"click",this.finish.bind(this)):Form.Element.disable(this.finishButton),this.buttonCell.appendChild(this.cancelButton),this.buttonCell.appendChild(this.backButton),this.buttonCell.appendChild(this.nextButton),this.buttonCell.appendChild(this.finishButton),this.htmlElement=domTableCol([domTd("","","",this.titleElement),domTd("","","",this.middleElement),domTd("","","",this.buttonCell)],""),this.htmlElement.style.width="100%",this.options.errors&&window.setTimeout(function(){eval(this.options.errors)}.bind(this),100);return this.htmlElement}}}(),core.wizard.display.contentWindow=Class.create(),core.wizard.display.contentWindow.prototype={config:{styles:{htmlElement:"background-color:#{bgColor};width:100%;height:580px;overflow-y:hidden;",bgColor:"#FFFFFF"}},initialize:function(a,b,c){this.data=b,this.elements=a,this.parent=c,this.contentFormId="__FORM"},toHTML:function(a){var b=this;a||(a=this.config.styles.bgColor),this.contentForm=Builder.node("form",{id:this.contentFormId,style:"width:100%"}),this.contentForm.notify=function(a){b.parent.doCheck()},Event.observe(this.contentForm,"submit",function(a){Event.stop(a);return!1}.bindAsEventListener(this)),this.htmlElement=Builder.node("div",{style:(new Template(this.config.styles.htmlElement)).evaluate({bgColor:a})},this.contentForm),this.inputs=[],core.elements.reset(),this._render(this.elements,this.contentForm);return this.htmlElement},_assignData:function(a){this.data[a.name]&&(a.value=this.data[a.name]),a.elements&&a.elements.each(function(a){this._assignData(a)}.bind(this));return a},_render:function(a,b){var c=this;a.each(function(a){a=Object.clone(a),a=this._assignData(a),a.container=b;try{core.elements.create(a)}catch(c){_debug(c)}}.bind(this)),this.inputs=core.elements.getElementsByNS("input")},isMandantoryElementsOk:function(){var a=this.inputs,b=a.length,c,d=!0;while(b--){c=a[b];if(!c)continue;d=c.options&&c.options.mandantory?c.isOk&&c.isOk():!0}return d},serialize:function(){this.values=new Hash,this.inputs.each(function(a){try{this.values[a.options.name]=a.getValue(),a.options.type=="upload"&&a.fileIsEncrypted&&(this.values[a.options.name+"_pwd"]=a.getPassword(),this.values[a.options.name+"_pwd_repeat"]=a.getPasswordRepeat())}catch(b){_debug(b),_debug(a)}}.bind(this));return this.values},toJSON:function(){return Object.toJSON(this.serialize())},handleErrors:function(a,b){var c=a.length,d,e,f;while(c--){b?typeof b.alert=="function"?$(b).alert(a[c].text):$(b).update(a[c].text):alert(a[c].text);if(a[c].field){d=this.inputs.length;while(d--)e=this.inputs[d],e&&e.options.name===a[c].field[0]&&(f=e.options.id.replace("ELEMENT_",""),f&&window.setTimeout(function(){border_blink_element(f)},100))}}}},core.wizard.display.stepsWindow=Class.create(),core.wizard.display.stepsWindow.prototype={initialize:function(a,b){this.steps=a,this.activeStep=b},toHTML:function(){var a=Builder.node("ol",{style:"margin:0px;"});this.steps.each(function(b){var c;b.value==this.activeStep?c=Builder.node("li",{},Builder.node("b",{},b.title)):c=Builder.node("li",{},b.title),a.appendChild(c)}.bind(this)),this.htmlElement=Builder.node("div",{style:"background-color: white;"},a);return this.htmlElement}},core.wizard.display.helpWindow=Class.create(),core.wizard.display.helpWindow.prototype={config:{width:{expanded:"200px",collapsed:"10px"},image:{src:{expanded:"core/img/wizard_help_collapse.gif",collapsed:"core/img/wizard_help_expand.gif"},height:"592px",width:"10px",style:"float:right;display:inline;cursor:help;padding:3px 0px 3px 0px;background-color:#666666;"},text:{style:"padding: 10px 15px 10px 5px;text-align: justify;background-color:white;height:561px;border:0px;margin:0px;"},elementHelp:{style:{ul:"padding:10px;margin:0;border:0;",li:"border-bottom: 1px solid blue;color:blue;cursor:pointer;"}},htmlElement:{style:"height:598px;background-color: white;margin:3px 2px 1px 0px;vertical-align:top;width:10px;"}},initialize:function(a){this.text=a||"",this.elementHelp=[]},isHelp:function(){if(this.text||this.elementHelp.length)return!0;return!1},update:function(a){this.text=a||"",this.htmlElement=this.toHTML()},expand:function(){this.htmlElement.style.width=this.config.width.expanded,this.imageElement.src=this.config.image.src.expanded,this.textElement.show(),this.isExpanded=!0},collapse:function(){this.htmlElement.style.width=this.config.width.collapsed,this.imageElement.src=this.config.image.src.collapsed,this.textElement.hide(),this.isExpanded=!1},addElementHelp:function(a){this.elementHelp.push(Object.extend({headline:"",text:""},a||{}))},toHTML:function(){this.textElement=Builder.node("div",{style:this.config.text.style}),this.textElement.innerHTML=this.text,this.elementHelp.length&&(this.elementHelpUl=Builder.node("ul",{style:this.config.elementHelp.style.ul}),this.elementHelp.each(function(a){a.html=Builder.node("li",{},[Builder.node("div",{style:this.config.elementHelp.style.li},a.headline)]),a.html.helpText=Builder.node("div",{style:"height: 0px;"}),a.html.helpText.innerHTML=a.text,a.html.appendChild(a.html.helpText),$(a.html.helpText).hide(),a.expanded=!1,Event.observe(a.html,"click",function(){a.expanded?(a.html.helpText.hide(),a.expanded=!1):(a.html.helpText.show(),a.expanded=!0)}.bind(this)),this.elementHelpUl.appendChild(a.html)}.bind(this)),this.textElement.appendChild(this.elementHelpUl)),this.imageElement=Builder.node("img",{src:this.config.image.src.collapsed,height:this.config.image.height,width:this.config.image.width,style:this.config.image.style}),this.htmlElement=Builder.node("div",{style:this.config.htmlElement.style},[this.imageElement,this.textElement]),$(this.textElement).hide(),this.isExpanded=!1,Event.observe(this.imageElement,"click",function(){this.isExpanded?this.collapse():this.expand()}.bind(this));return this.htmlElement}};var tabs={},cur_tabs={},cur_tabset="",tabset_update_traffic=function(){var a=function(a,b){var c=a.traffic[0];a.traffic.length>2&&(c=a.traffic[0]+"_"+a.traffic[1]),tab_traffic(b.result,c)};return function(){tabs[cur_tabset]&&tabs[cur_tabset].length&&tabs[cur_tabset].each(function(b){Object.isArray(b.traffic)&&call_fid("get_tab_traffic_status",{traffic:b.traffic,callback:a.curry(b)})})}}();core.popup=Class.create(),core.popup.prototype={initialize:function(a){var b=this,c,d,e,f,g,h;this.options=a,core.tools.clearDndSelection(),this.options.type||(this.options.type="__UNSET"),this.editObj=!1,this.formReq=!1;if(this.options.obj_ref||this.options.obj_clone){c=get_object(this.options.obj_ref);if(!c){this.close();return!1}if(c.lock&&(c.lock!="acc"||!popup_type_whitelist[c.class]||popup_type_whitelist[c.class].indexOf(c.type)==-1)){this.close();return!1}this.options.obj_clone||(this.editObj=c),ctMap[c["class"]]&&(this.formReq=ctMap[c["class"]][c.type]||ctMap[c["class"]]["*"])}else this.options["class"]&&(this.formReq=ctMap[this.options["class"]][this.options.type]||ctMap[this.options["class"]]["*"],this.options.types&&this.options.types.length==1&&ctMap[this.options["class"]][this.options.types[0]]&&(this.formReq=ctMap[this.options["class"]][this.options.types[0]]));if(!this.formReq){alert(_LOC("eaQsBzZQgg","Can't find form to add or edit this object, sorry.")),this.close();return!1}this.helpButton=domA({},{className:"OHELP_LINK",target:"help"},{},domImg({cursor:"pointer"},{src:"core/img/icons/form_help.png",width:"19px"},{})),this.closeButton=domTd({width:"19px"},{align:"right"},{},domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",width:"19px",className:"FORM_close"},{onclick:function(){b.close()}})),this.titlebar=domTd({},{align:"left",className:"FORM_header"},{},domTableRow([domTd({},{align:"left",className:"FORM_header_left"},{},""),domTd({},{align:"left",className:"FORM_header_center"},{},domTableRow([domTd({},{},{},domSpan({},{id:"popup_title"},{},this.options.title||(this.editObj?this.formReq.txt_edit:this.formReq.txt_add))),this.options.help?domTd({width:"19px"},{align:"right"},{},this.helpButton):"",this.closeButton],{width:"100%"})),domTd({},{align:"left",className:"FORM_header_right"},{},"")],{width:"100%"})),this.htmlElement=domTableCol([this.titlebar,domTd({padding:"8px",backgroundColor:"#f7f7f7"},{},{},domDiv({},{id:this.options.name+"_CONTENT"},{}))]),$(this.htmlElement).setStyle({position:"absolute",top:"0px",left:"0px",boxShadow:"0 0 7px #666666",minWidth:"260px",width:(this.options.width||260)+"px"}),$("popup_master").appendChild(this.htmlElement),Position.clone(this.options.anchor,this.htmlElement,{setWidth:!1,setHeight:!1}),this.options.leftSide?this.htmlElement.style.left=parseInt(this.htmlElement.style.left,10)-(this.options.width||260)+"px":document.viewport&&(d=document.viewport.getWidth(),f=this.options.width||260,this.options.center?(h=d/2-f/2,g=$("content_wrapper").cumulativeOffset()[1]||92,this.htmlElement.style.top=g+"px",this.htmlElement.style.left=h+"px"):(e=Position.page(this.options.anchor),d-e[0]<f&&(this.htmlElement.style.left=d-f+"px"))),this.formReq.options=this.options.passthru||{},this.formReq.passthru=this.options.passthru||{},this.formReq.options.name="FORM_"+this.options.name,this.formReq.options.update_type=this.options.update_type,this.formReq.options.update_name=this.options.update_name,this.options.browser_type&&this.options.browser_type!==""&&(this.formReq.options.browser_type=this.options.browser_type),this.options.browser_ref&&this.options.browser_ref!==""&&(this.formReq.options.browser_ref=this.options.browser_ref),this.formReq.options.types=this.options.types,this.formReq.closeJs="core.popupMap['"+this.options.name+"'].close();",this.editObj&&(this.formReq.options.obj_src='"'+this.editObj.ref+'"',this.formReq.options.obj_ref=this.editObj.ref),this.options.obj_clone&&(this.formReq.options.obj_clone='"'+c.ref+'"',this.formReq.options.obj_ref=c.ref),this.options.upload_id&&(this.formReq.options.upload_id=this.options.upload_id),this.formReq.target=this.options.name+"_CONTENT",req_send({objs:[this.formReq]}),core.popupMap[this.options.name]=this,this.options.modal&&WindowUtilities.disableScreen("astaro","overlay_modal_"+this.options.name,.5,"popup_master",$("popup_master")),this.htmlElement.self=this,new Draggable(this.htmlElement,{handle:this.titlebar}),this.options.help&&(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/.test(this.options.help)?update_online_help_link(this.options.help,this.options.name):$("OHELP_TOPBAR_LINK")&&(this.helpButton.href=$("OHELP_TOPBAR_LINK").href)),this.htmlElement.style.zIndex=++Windows.maxZIndex,core.menu.addListener("click",this.close.bind(this),!0);return this},close:function(){var a=0,b=$("popup_master"),c=b.childNodes.length;for(;a<c;a++)this.htmlElement&&b.childNodes[a]&&b.childNodes[a].self&&b.childNodes[a].self==this&&b.removeChild(this.htmlElement);this.options.modal&&WindowUtilities.enableScreen("overlay_modal_"+this.options.name),this.options.onclose&&this.options.onclose()}},core.ngPopup=Class.create(Window,{initialize:function($super,a){var b,c=!1,d=!1,e=window.innerWidth;core.tools.clearDndSelection(),!e&&document.documentElement&&document.documentElement.clientWidth&&(e=document.documentElement.clientWidth),this.options=Object.extend({"class":!1,type:"__UNSET",obj_ref:!1},a||{}),this.options.anchor&&(b=$(this.options.anchor).cumulativeOffset(),this.options.top=b[1],this.options.openLeft?this.options.right=e-b[0]:this.options.left=b[0]),this.editObj=!1;if(this.options.obj_ref){d=get_object(this.options.obj_ref);if(!d)return!1;if(d.lock)return!1;this.editObj=d,ctMap[d["class"]]&&(c=ctMap[d["class"]][d.type]||ctMap[d["class"]]["*"])}else this.options["class"]&&(c=ctMap[this.options["class"]][this.options.type]||ctMap[this.options["class"]]["*"],this.options.types&&this.options.types.length==1&&ctMap[this.options["class"]][this.options.types[0]]&&(c=ctMap[this.options["class"]][this.options.types[0]]));if(!c){alert(_LOC("xKVVVKYtRj","Can't find form to add or edit this object, sorry."));return!1}this.options.title=this.editObj?c.txt_edit:c.txt_add,c.options=this.options.passthru||{},c.passthru=this.options.passthru||{},c.options.name="FORM_"+this.options.name,c.options.update_type=this.options.update_type,c.options.update_name=this.options.update_name,c.closeJs='core.popupMap["'+this.options.name+'"].close();',c.execute={post:"core.popupMap."+this.options.name+".updateWidth();"+"core.popupMap."+this.options.name+".updateHeight();"},this.options.browser_type&&this.options.browser_type!==""&&(c.options.browser_type=this.options.browser_type),this.options.browser_ref&&this.options.browser_ref!==""&&(c.options.browser_ref=this.options.browser_ref),c.options.types=this.options.types,this.editObj&&(c.options.obj_src='"'+this.editObj.ref+'"',c.options.obj_ref=this.editObj.ref),this.options.upload_id&&(c.options.upload_id=this.options.upload_id),$super(Object.extend({className:"astaro",resizable:!1,onShow:function(){this.updateWidth(),this.updateHeight()}.bind(this)},this.options||{})),c.target=this.getContent().id,this.options.saveCallback&&(c.saveCallback=this.options.saveCallback),req_send({objs:[c]}),core.popupMap[this.options.name]=this,a.centered?this.showCenter(a.modal):this.show(a.modal)}});var lastEdited=!1;core.list=Class.create(),core.list.prototype={config:{imExportDelimiters:{"\n":"New Line",";":"; (Semicolon)",",":", (Comma)"}},initialize:function(a,b){var c=this;this.options=Object.extend({width:200,tooltips:{}},a||{}),this.tooltips=this.options.tooltips,this.afcLicensed=b,this.bgcolors=["#f7f7f7","#e4e4e7"],a.bgcolors&&(this.bgcolors=a.bgcolors),this.meta=a.meta||!1,this.name=a.name,this.unordered=!!a.unordered,this.noedit=!!a.noedit,this.nodelete=!!a.nodelete,this.nodeleteall=!!a.nodeleteall,this.remove_confirm=a.remove_confirm||!1,this.remove_fid=a.remove_fid||!1,this.onchange=a.onchange||!1,this.track_deleted=a.track_deleted_references||!1,this.track_added=a.track_added_references||!1,this.retainArrayOrder=a.retain_array_order||!1,this.auto_save=a.auto_save?a.auto_save.evalJSON(!0):!1,this.auto_delete=a.auto_delete||!1,this.track_deleted&&(this.deleted=[]),this.track_added&&(this.added=[]);if(a.checkboxes||a.sliders)this.checked=a.value===""?[]:a.value;a.checkboxes?(this.checkboxes=!0,this.checkedMembers=0):this.checkboxes=!1,a.sliders&&(this.sliders=!0),a.values&&a.labels&&(this.values=a.values,this.labels=a.labels,a.checkboxes||(this.value=!1,a.value=!1)),this.folderAction=!1,a.folder&&(this.folderAction=a.folder),this.specialAction=!1,a.special_action&&(this.specialAction=a.special_action),this.width=a.width?a.width:200,this.height=a.height?a.height:100,this.htmlElement=$(Builder.node("div",{id:"LIST_ELEMENT_"+a.name})),this.htmlElement.className="LIST_ELEMENT",this.htmlElement.setStyle({width:this.width+"px",height:this.height+"px",textAlign:"left"}),this.boxsize=this.width,this.noreorder=!0,this.listMembers=[],this.noOnChange=!1,this.values&&this.labels?this.importOk(this.values,this.labels,!0):a.value&&this.importOk(a.value,!1,!0),this.noreorder&&(this._reorder(),this.noreorder=!1);return this},openImportPopup:function(a){if(!this.disabled){var b=Event.findElement(a,"td");this.options&&this.options.name&&this.options.importer_modal&&WindowUtilities.disableScreen("astaro","overlay_modal_"+this.options.name,.5,"popup_master",$("popup_master"));if(!this.importPopup){this.closePopupButton=Builder.node("img",{src:"core/img/blank1x1.gif",width:"19px","class":"FORM_close",style:"float:right;cursor:pointer;"}),Event.observe(this.closePopupButton,"click",this.closeImportPopup.bind(this));var c=Builder.node("div",{style:"float:left;width:50%;"});$(c).update(_LOC("KxMcGUeoEQ","Import")),this.importPopupTitleBar=Builder.node("div",{className:"FORM_header"},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",style:"width:100%;line-height:21px;"},Builder.node("tbody",Builder.node("tr"),[Builder.node("td",{className:"FORM_header_left"}),Builder.node("td",{className:"FORM_header_center"},[c,this.closePopupButton]),Builder.node("td",{className:"FORM_header_right"})]))]),this.importArea=Builder.node("textarea",{cols:40,rows:6,style:"width:200px;"}),typeof FileReader=="function"&&(this.importArea.addEventListener("dragenter",function(a){a.stopPropagation(),a.preventDefault()},!1),this.importArea.addEventListener("dragover",function(a){a.stopPropagation(),a.preventDefault()},!1),this.importArea.addEventListener("drop",function(a){var b=a.dataTransfer,c=b.files,d=c.length;a.stopPropagation(),a.preventDefault();if(!c)return!1;var e=function(a){this.importArea.value="",window.setTimeout(function(){this.importArea.value=a.target.result}.bind(this),150)}.bind(this);for(var f=0;f<d;f++){var g=c[f],h=new FileReader;h.index=f,h.file=g,this.importArea.value="",h.addEventListener("loadend",e,!1),h.readAsText(g)}}.bind(this),!1)),this.importPopupContent=Builder.node("div",{style:"padding:2px;width:100%;"},Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"padding:2px 20px 2px 10px;width:100%;"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"valign_top"},_LOC("ivGZiMKAqk","Import text")),Builder.node("td",{},this.importArea)])]))),this.importStartButton=new core.button({name:"import_start",icon:"core/img/icons/plus.png",label:_LOC("mydICNbpvh","Import")}),this.importStartButton.htmlElement.style.styleFloat="right",this.importStartButton.htmlElement.style.cssFloat="right",Event.observe(this.importStartButton.htmlElement,"click",this.startImport.bind(this)),this.importCancelButton=new core.button({name:"import_cancel",icon:"core/img/icons/cancel.png",label:_LOC("KCiqZgKOuM","Cancel")}),this.importCancelButton.htmlElement.style.styleFloat="right",this.importCancelButton.htmlElement.style.cssFloat="right";var d=Builder.node("div",{style:"width:10px;float:right;"});$(d).update("&nbsp;"),Event.observe(this.importCancelButton.htmlElement,"click",this.closeImportPopup.bind(this)),this.importPopupButtons=Builder.node("div",{style:"padding:2px;width:100%;text-align:right;",align:"right"},Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"padding:2px 20px 2px 10px;width:100%;"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{},[this.importCancelButton.htmlElement,d,this.importStartButton.htmlElement])])))),this.importPopup=Builder.node("div",{className:"importPopup",style:"left:"+Position.positionedOffset(b)[0]+"px;"+"width:300px;"+"position:absolute;"+"z-index:99;"},[this.importPopupTitleBar,this.importPopupContent,Builder.node("div",{style:"width:290px;margin-left:5px;height:1px;border-top:1px dotted #7b7b7b;"},Builder.node("img",{src:"core/img/blank1x1.gif",height:1,width:1})),this.importPopupButtons]),Event.observe(this.importStartButton,"click",this.startImport.bind(this)),this.importPopup.style.zIndex=++Windows.maxZIndex,$("popup_master").appendChild(this.importPopup),Position.clone(b,this.importPopup,{setWidth:!1,setHeight:!1}),new Draggable(this.importPopup,{handle:this.importPopupTitleBar})}else this.importPopup.style.zIndex=++Windows.maxZIndex,$(this.importPopup).show()}},closeImportPopup:function(){try{this.importArea&&$(this.importArea)&&($(this.importArea).value=""),this.importPopup&&$(this.importPopup)&&$(this.importPopup).hide(),this.options&&this.options.name&&this.options.importer_modal&&WindowUtilities.enableScreen("overlay_modal_"+this.options.name)}catch(a){_debug(a)}},startImport:function(){if(!this.importStarted){this.importStarted=!0;var a=$F(this.importArea).stripScripts(),b=!1,c=[];$H(this.config.imExportDelimiters).keys().each(function(d){c=a.split(d);if(c.length>1){b=!0;throw $break}return}.bind(this));if(!b){var d=a.strip();d&&(c=[d])}req_send({objs:[{FID:"list_check_datatype",check:Object.extend({list:c},this.meta),callback:"core.listMap."+this.name+".startImport_cb"}]})}},startImport_cb:function(a){var b=a.check.result[0],c="";a.check.result[1].length&&a.check.result[1][0]!==""&&(c=_LOC("IqZwXobpOx","Following values can't be imported:")+"<br /><br />",c+=a.check.result[1].join("<br />")+"<br /><br />"),b.length?this.importOk(b):(c+=_LOC("ctbkItlkhw","There is nothing to import"),this.importStarted=!1),c&&alert(c)},_importOne:function(a){var b=Math.floor(this.importIteration++*100/this.importTotal*100),c=this.importArray.length>100?100:this.importArray.length;a?wait_popup(!0,_LOC("bBBXWAVLBV","Please be patient")+", &quot;"+this.options.title+"&quot;-"+_LOC("pNUppKmDJx","list is being generated!")+"<br />"+b+"%",b):wait_popup(!0,_LOC("PxIWFCToMv","Please wait, importing.")+"<br />"+b+"%",b);while(c--){var d=this.importArray.shift();if(!d)break;d=d.toString().strip();var e=this.listMembers,f=e.length,g=d;a&&this.importLabels&&this.importLabels[d]&&(g=this.importLabels[d]);var h=new core.simpleListItem({text:g,value:d,list:this,tooltip:this.tooltips[d]||!1,afcLicensed:this.afcLicensed});this.htmlElement.appendChild(h.htmlElement),this.listMembers.push(h)}if(this.importArray.length)window.setTimeout(this._importOne.curry(a).bind(this),1);else{wait_popup(!0,_LOC("agcFpoxbQz","Please wait, finalizing import"));var i=this.listMembers.length;if(this.htmlElement.scrollHeight&&this.htmlElement.scrollHeight>$(this.htmlElement).getHeight()&&!this.scrollbarShown){var j=$(this.listMembers[0].textBox).getWidth();for(var k=0;k<i;k++){var l=$(this.listMembers[k].textBox);j>0&&(l.style.width=j-16+"px")}this.scrollbarShown=!0}for(var m=0;m<i;m++)$(this.listMembers[m].htmlElement).style.backgroundColor=this.bgcolors[m%2];this.importStarted=!1,this.closeImportPopup(),wait_popup(!1),this.importIteration=0,this.importTotal=0,this.importArray=[],this._reorder(),!a&&!this.noOnChange&&this.onchange&&evaluate(this.onchange)}},importOk:function(a,b,c){this.importArray=$A(a).clone(),this.importLabels=Object.clone(b)||!1,this.importTotal=a.length,this.importIteration=1,window.setTimeout(this._importOne.curry(!!c).bind(this),1);return!0},importNotOk:function(){},openExportPopup:function(a){if(!this.disabled){var b=Event.findElement(a,"td");this.options&&this.options.name&&this.options.exporter_modal&&WindowUtilities.disableScreen("astaro","overlay_modal_"+this.options.name,.5,"popup_master",$("popup_master"));if(!this.exportPopup){this.closeExportPopupButton=Builder.node("img",{src:"core/img/blank1x1.gif",width:"19px","class":"FORM_close",style:"float:right;cursor:pointer;"}),Event.observe(this.closeExportPopupButton,"click",this.closeExportPopup.bind(this));var c=Builder.node("div",{style:"float:left;width:50%;"});$(c).update(_LOC("aMvGUQSvCy","Export")),this.exportPopupTitleBar=Builder.node("div",{className:"FORM_header"},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",style:"width:100%;line-height:21px;"},Builder.node("tbody",Builder.node("tr"),[Builder.node("td",{className:"FORM_header_left"}),Builder.node("td",{className:"FORM_header_center"},[c,this.closeExportPopupButton]),Builder.node("td",{className:"FORM_header_right"})]))]),this.exportArea=Builder.node("textarea",{cols:40,rows:6,style:"width:200px;"}),this.exportDelimiterDropdown=new core.dropdown({name:"import_delimiter",value:"\n",values:$H(this.config.imExportDelimiters).keys(),labels:this.config.imExportDelimiters,style:{width:"100px"}}),Event.observe(this.exportDelimiterDropdown.htmlElement,"change",this.startExport.bind(this)),this.exportPopupContent=Builder.node("div",{style:"padding:2px;width:100%;"},Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"padding:2px 20px 2px 10px;width:100%;"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"valign_top"},_LOC("oTaSuRwsEw","Delimiter")),Builder.node("td",{},this.exportDelimiterDropdown.htmlElement)]),Builder.node("tr",{className:"height_ten_pixel"},[Builder.node("td",{colSpan:"2"})]),Builder.node("tr",{},[Builder.node("td",{className:"valign_top"},_LOC("cdhpWBkTUV","Exported text")),Builder.node("td",{},this.exportArea)])]))),this.exportCloseButton=new core.button({name:"export_close",icon:"core/img/icons/cancel.png",label:"Close"}),this.exportCloseButton.htmlElement.style.cssFloat="right",this.exportCloseButton.htmlElement.style.styleFloat="right",Event.observe(this.exportCloseButton.htmlElement,"click",this.closeExportPopup.bind(this)),this.exportPopupButtons=Builder.node("div",{style:"padding:2px;width:100%;text-align:right;",align:"right"},Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"padding:2px 10px 2px 10px;width:100%;"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{},this.exportCloseButton.htmlElement)])))),this.exportPopup=Builder.node("div",{className:"importPopup",style:"left:"+Position.positionedOffset(b)[0]+"px;"+"width:300px;"+"position:absolute;"+"z-index:99;"},[this.exportPopupTitleBar,this.exportPopupContent,Builder.node("div",{style:"width:290px;margin-left:5px;height:1px;border-top:1px dotted #7b7b7b;"},Builder.node("img",{src:"core/img/blank1x1.gif",height:1,width:1})),this.exportPopupButtons]),this.exportPopup.style.zIndex=++Windows.maxZIndex,$("popup_master").appendChild(this.exportPopup),Position.clone(b,this.exportPopup,{setWidth:!1,setHeight:!1}),new Draggable(this.exportPopup,{handle:this.exportPopupTitleBar})}else this.exportPopup.style.zIndex=++Windows.maxZIndex,$(this.exportPopup).show();this.startExport()}},closeExportPopup:function(){this.options&&this.options.name&&this.options.exporter_modal&&WindowUtilities.enableScreen("overlay_modal_"+this.options.name),$(this.exportPopup).remove(),this.exportPopup=null},startExport:function(){var a=$F(this.exportDelimiterDropdown.htmlElement);a=="LF"&&(a="\n"),$(this.exportArea).value=this.memberValues().join(a)},doFolderAction:function(a){if(!this.disabled){var b=Event.findElement(a,"td"),c=!1,d=function(){input_activate(b),this.foldericondisabled=!1}.bind(this),e;if(this.foldericondisabled)return!1;input_deactivate(b),this.foldericondisabled=!0;if(this.folderAction)if(Object.isString(this.folderAction))evaluate(this.folderAction);else if(this.folderAction.type)switch(this.folderAction.type){case"app_selector":app&&app.AppSelector&&(this.appSelector=new app.AppSelector({target:this.folderAction.options.secondaryTarget?[this,this.options.form.elements[this.folderAction.options.secondaryTarget].list]:this,anchor:b,values:this.values,labels:this.labels,form:this.options.form||!1,onclose:d}.extend(this.folderAction.options||{})));break;case"directory_browser":this.folderAction.options.refref&&(c=$(this.folderAction.options.refref).value),this.folderAction.options.form?(core.buttonMap[this.options.form.form_name].each(function(a){a.disable()}),this.options.form&&this.options.form.req.options.update_type==="table"&&input_deactivate(core.tableMap[this.options.form.req.options.update_name].formCloseButton),e=function(){core.buttonMap[this.options.form.form_name].each(function(a){a.enable()}),core.tableMap[this.options.form.req.options.update_name]&&input_activate(core.tableMap[this.options.form.req.options.update_name].formCloseButton),d()}.bind(this)):e=d,this.options.form&&this.options.form.form_name&&(this.folderAction.options.form=this.options.form.form_name),directory_browser_init(this.folderAction.options.list,this.folderAction.options.type||$(this.folderAction.options.typeref).value,this.folderAction.options.ref||c||"",this.folderAction.options.form,e);break;default:_debug("unknown folder-action: "+this.folderAction.type)}}},doSpecialAction:function(b){var c,d,e;if(!this.disabled&&this.specialAction&&this.specialAction.type)switch(this.specialAction.type){case"openForm":this.disabled||(a=new core.popup({name:"POPUP_"+this.name,"class":this.specialAction["class"],types:this.specialAction.types,anchor:this.specialAction.anchor,modal:this.specialAction.modal,help:this.specialAction.help,passthru:this.specialAction.passthru,center:this.specialAction.center,width:this.specialAction.width,update_type:"list",update_name:this.name}));break;case"openUpload":this.disabled||(d={name:rand_string(10),allowedExtensions:this.specialAction.allowedExtensions},core.uploadMap[d.name]=new core.upload(d),e=core.uploadMap[d.name],e.options.onchange=function(a){this.createMember(a,-1,a+"/"+d.name,!1)}.bind(this),e.folderIcon=this.specialAction.anchor,e.openPopup());break;case"openKeyringUploadForm":this.disabled||(d={name:rand_string(10),allowedExtensions:this.specialAction.allowedExtensions},core.uploadMap[d.name]=new core.upload(d),e=core.uploadMap[d.name],e.options.onchange=function(){call_fid("openpgp_list_keyring",{filename:d.name,callback:function(a){var b,c,d,e,f=[];if(a&&a.result){b=a.result.length;while(b--){c=a.result[b],d=c.uids.length;while(d--)e=c.uids[d],f.push(e.realname+" &lt;"+e.email+"&gt;");this.createMember(f.join("; "),-1,c.fingerprint,!1),f=[]}core.formMap.TABLE_emailpki_pgp_FORM.req.passthru=a.passthru}}.bind(this)})}.bind(this),e.folderIcon=this.specialAction.anchor,e.openPopup());break;case"generateExtraCodes":10-this.members().length&&generate_otp_codes("extra_codes",10-this.members().length);break;default:_debug("unknown special_action: "+this.specialAction.type)}},members:function(){return this.listMembers},memberValues:function(){var a=this.members();if(this.checkboxes)return a.collect(function(a,b){if(a.checkbox&&a.checkbox.checked)return a.checkbox.value;return null}).compact();if(this.sliders){var b=a.collect(function(a,b){if(a.checked)return a.value;return null}).compact(),c=a.collect(function(a,b){if(a.value)return a.value}).compact();return{checked:b,all:c}}return a.collect(function(a,b){if(a.value)return a.value;return null}).compact()},filter:function(){var a,b,c=!1,d,e=function(){var f;b=100;try{while(b--)a>0?(a--,this.listMembers[a].value.search(d)<0?$(this.listMembers[a].htmlElement).hide():$(this.listMembers[a].htmlElement).show()):c=!1;a>0&&window.setTimeout(e.bind(this),1)}catch(g){alert(g),c=!1}};return function(b){c||(c=!0,a=this.listMembers.length,d=b,window.setTimeout(e.bind(this),1))}}(),refill:function(a,b){this.remove_all(),typeof b=="object"?(this.values=b.values,this.labels=b.labels,this.importOk(b.values,b.labels,!0)):a.each(function(a,b){this.values&&this.labels?this.createMember(this.labels[a],-1,a):this.createMember(a,-1,a)}.bind(this))},createMember:function(a,b,c,d,e){var f=this.members();b<0&&(b=f.length),e&&this.checked.push(c);var g=new core.simpleListItem({text:a,value:c,list:this,editOn:d,afcLicensed:this.afcLicensed,tooltip:this.tooltips[c]||!1});f[b]?(this.htmlElement.insertBefore(g.htmlElement,f[b].htmlElement),this.listMembers.splice(b,0,g)):(this.htmlElement.appendChild(g.htmlElement),this.listMembers[this.listMembers.length]=g),!this.noreorder&&!d&&this._reorder()},checkboxAction:function(a){a.setStatus(),this.unordered||this._reorder()},remove_all:function(){function c(a){typeof a=="object"&&this.htmlElement.removeChild(a.htmlElement)}function b(a){var b=[{label:_LOC("iVICSeegMM","OK"),"default":!0,exec:a},{label:_LOC("QbnuuAVQcR","Cancel"),exec:function(){}}],c=interactionPopup({open:!0,text:_LOC("LYzjskvyzI","Do you really want to delete all entries?"),buttons:b})}var a;return function(d){this.disabled||(a=this.members(),d?b(function(){a.each(c.bind(this)),this.listMembers=[]}.bind(this)):(a.each(c.bind(this)),this.listMembers=[]))}}(),remove:function(a,b){var c=this.members();c.indexOf(a)!=-1&&(c.splice(c.indexOf(a),1),this.htmlElement.removeChild(a.htmlElement)),b||(this._reorder(),!this.noOnChange&&this.onchange&&evaluate(this.onchange)),this.track_deleted&&this.deleted.push(a.value)},removeByValue:function(a,b){var c=this.members(),d;d=c.detect(function(b,c){return b.value===a}),d&&this.remove(d,b);return},move:function(a,b){var c=this.members(),d=c.indexOf(a),e=d+b,f=[],g=0,h;c.each(function(b,g){g!=d&&f.push(b),g==e&&f.splice(e,0,a),g==e-1&&e==c.length&&f.push(a)});for(g=0;g<this.htmlElement.childNodes.length;g++)this.htmlElement.removeChild(this.htmlElement.childNodes[g]);this.listMembers=f;for(g=0,h=this.listMembers.length;g<h;g++)this.htmlElement.appendChild(this.listMembers[g].htmlElement);lastEdited=a.value,this._reorder()},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},_reorder:function(){var a=this,b=this.members(),c=[],d=[],e=[],f=[],g=this.listMembers.length,h=-1,i,j,k,l,m,n=-1,o;if(this.htmlElement.scrollHeight&&this.htmlElement.scrollHeight>=$(this.htmlElement).getHeight()&&!this.scrollbarShown){while(++h<g)i=this.listMembers[h],j=$(i.textBox),k=j.getWidth(),k>0&&(j.style.width=k-16+"px");this.scrollbarShown=!0}if(this.unordered){l=this.members(),m=l.length;while(++n<m)o=l[n],o.htmlElement.style.backgroundColor=this.bgcolors[n%2]}else{if(this.retainArrayOrder){l=this.members(),m=l.length;while(++n<m){o=l[n],o.up.style.visibility="visible",o.down.style.visibility="visible",o.order&&(o.order.innerHTML=n+1,o.order.style.visibility="visible"),o.htmlElement.style.backgroundColor=this.bgcolors[n%2];if(m==1){o.up.style.visibility="hidden",o.down.style.visibility="hidden";return}n==0?o.up.style.visibility="hidden":n==m-1&&(o.down.style.visibility="hidden")}return}b.each(function(b,g){var h=d.indexOf(b.value),i=f.indexOf(b.value);h>=0||i>=0?a.htmlElement.removeChild(b.htmlElement):b.checked?(c.push(b),d.push(b.value)):b.checkbox?(e.push(b),f.push(b.value)):(b.up&&(b.up.style.visibility="visible"),b.down&&(b.down.style.visibility="visible"),b.htmlElement.style.fontWeight="normal",e.push(b),f.push(b.value))}),this.checkedMembers=c.length,this.unCheckedMembers=e.length,b=[],c.each(function(c,d){c.order&&(c.order.innerHTML=b.length+1,c.order.style.visibility="visible"),c.up&&(a.checkedMembers==1||d===0?c.up.style.visibility="hidden":c.up.style.visibility="visible"),c.down&&(a.checkedMembers==1||d==a.checkedMembers-1?c.down.style.visibility="hidden":c.down.style.visibility="visible"),c.htmlElement.style.backgroundColor=a.bgcolors[b.length%2],b.push(c)}),e.each(function(c,d){c.order&&(a.checkboxes||a.sliders?c.order.style.visibility="hidden":(c.order.style.visibility="visible",c.order.innerHTML=d+1)),c.up&&(a.checkboxes||a.sliders||d===0)&&(c.up.style.visibility="hidden"),c.down&&(a.checkboxes||a.sliders||d==a.unCheckedMembers-1)&&(c.down.style.visibility="hidden"),c.htmlElement.style.backgroundColor=a.bgcolors[b.length%2],b.push(c)}),this.listMembers=b;var p=this.listMembers.length,q;for(;this.htmlElement.childNodes.length;)this.htmlElement.removeChild(this.htmlElement.childNodes[0]);for(q=0;q<p;)this.listMembers[q].value==lastEdited?(this.listMembers[q].textBox.style.color="darkgreen",lastEdited=!1):this.listMembers[q].textBox.style.color="black",this.htmlElement.appendChild(this.listMembers[q++].htmlElement)}}},core.simpleListItem=Class.create({initialize:function(a){this.options=Object.extend({text:!1,value:!1,list:!1,editOn:!1,afcLicensed:!1,tooltip:!1},a||{});var b=this;this.afcLicensed=this.options.afcLicensed,this.text=this.options.text,this.value=this.options.value,this.list=this.options.list,this.isEditable=!this.list.noedit,this.ordered=!this.list.unordered,this.boxsize=this.list.boxsize,this.textBoxSize=this.boxsize,this.list.scrollbarShown&&(this.textBoxSize-=core.tools.getScrollbarWidth()),this.htmlElement=Builder.node("div",{className:"listMember",style:"padding:2px 0px 2px 0px;width:100%;"}),this.textBox=Builder.node("div",{style:"overflow:hidden;font-size:10px;margin:0px;"}),this.textBox.innerHTML=this.text,this.trash=!1,this.list.nodelete||(this.trash=Builder.node("img",{src:"core/img/icons/trash.png",style:"margin:0px 2px 0px 2px;cursor:pointer;",width:"16",height:"16",className:"listMember_btnTrash"}),Event.observe(this.trash,"click",function(){var a;if(!this.list.disabled){if(this.list.auto_delete){req_send({objs:[{FID:this.list.remove_fid?this.list.remove_fid:"obj_delete",obj_ref:this.value,callback:"list_delete_result",passthru:{remove_confirm:this.list.remove_confirm},update_type:"list",update_name:this.list.name}]});return}this.list.remove(this)}}.bind(this)),this.textBoxSize-=18);if(this.list.checkboxes||this.list.sliders)this.checkbox=this.checked=!1,this.list.checked.indexOf(this.value)!=-1&&(this.checked=!0,this.list.checkedMembers++);this.list.checkboxes&&(this.checkbox=document.createElement("input"),this.checkbox.setAttribute("type","checkbox",0),this.checkbox.setAttribute("value",this.value,0),this.checkbox.setAttribute("class","listMemberCb",0),this.checkbox.className="listMemberCb",browser=="ie"&&(this.checkbox.style.width="14px"),this.checkbox.style.margin="0px",this.checkbox.style.marginRight="2px",this.checked&&(this.checkbox.checked=!0,this.checkbox.defaultChecked=!0,this.textBox.style.fontWeight="bold"),this.checkbox.onclick=function(){this.list.noreorder||this.list.checkboxAction(this)}.bind(this),this.textBoxSize-=16),this.slider=!1;if(this.list.sliders){this.slider=Builder.node("div",{id:"status_slider_small"}),this.slider.style.margin="0px",this.slider.style.marginRight="4px",this.slider.style.marginLeft="4px",this.textBoxSize-=42;var c=this.list.checked.indexOf(this.value)!=-1;this.slider.title=c?_LOC("XcBNhtRtOA","Status: Enabled"):_LOC("cHerJoaoNA","Status: Disabled"),this.slider.className=c?"status_slider_small_on":"status_slider_small_off",this.slider.style.cursor="pointer",this.slider.onclick=function(){if(!this.list.disabled)if(!this.list.auto_save)this.list.checkboxAction(this);else{this.list.checkboxAction(this);var a=Object.extend({callback:function(a){if(a.error){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\n";alert(c)}typeof a.error=="string"&&alert(a.error),this.list.checkboxAction(this)}else{if(a.confirm&&a.confirm.length){var e=[],b;for(b=0;b<a.confirm.length;b++)e.push(a.confirm[b].text);confirm_dialog({message:e,modal:this.list.options.modal,ok_cb:function(){delete a.confirm,req_send({objs:[a]})},cancel_cb:function(){this.list.checkboxAction(this)}.bind(this)});return}if(a.success)return}}.bind(this)},this.list.auto_save.data||{});call_fid(this.list.auto_save.fid,a,this.list.auto_save.elements)}}.bind(this)}this.up=this.down=this.order=!1,this.ordered&&(this.up=Builder.node("img",{src:"core/img/icons/move_up.png",width:"16",height:"16",style:"margin:0px;cursor:pointer;",className:"listMember_btnUp"}),Event.observe(this.up,"click",function(){if(!this.list.disabled)if(!this.list.auto_save)this.list.move(this,-1);else{this.list.move(this,-1);var a=Object.extend({callback:function(a){if(a.error){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\n";alert(c)}typeof a.error=="string"&&alert(a.error),this.list.move(this,1)}else{if(a.confirm&&a.confirm.length){var e=[],b;for(b=0;b<a.confirm.length;b++)e.push(a.confirm[b].text);confirm_dialog({message:e,modal:this.list.options.modal,ok_cb:function(){delete a.confirm,req_send({objs:[a]})},cancel_cb:function(){this.list.move(this,1)}.bind(this)});return}if(a.success)return}}.bind(this)},this.list.auto_save.data||{});call_fid(this.list.auto_save.fid,a,this.list.auto_save.elements)}}.bind(this)),this.down=Builder.node("img",{src:"core/img/icons/move_down.png",width:"16",height:"16",style:"margin:0px;cursor:pointer;",className:"listMember_btnDown"}),Event.observe(this.down,"click",function(){if(!this.list.disabled)if(!this.list.auto_save)this.list.move(this,1);else{this.list.move(this,1);var a=Object.extend({callback:function(a){if(a.error){if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1;while(b--)c+=a.error[b].text+"\n";alert(c)}typeof a.error=="string"&&alert(a.error),this.list.move(this,-1)}else{if(a.confirm&&a.confirm.length){var e=[],b;for(b=0;b<a.confirm.length;b++)e.push(a.confirm[b].text);confirm_dialog({message:e,modal:this.list.options.modal,ok_cb:function(){delete a.confirm,req_send({objs:[a]})},cancel_cb:function(){this.list.move(this,-1)}.bind(this)});return}if(a.success)return}}.bind(this)},this.list.auto_save.data||{});call_fid(this.list.auto_save.fid,a,this.list.auto_save.elements)}}.bind(this)),this.order=Builder.node("div",{style:"font-weight:bold;font-size:10px;width:16px;text-align:right;margin:0px 2px 0px 0px;"}),this.order.innerHTML=this.list.listMembers.length+(this.options.editOn?1:0),this.textBoxSize-=58),this.textBox.style.width=this.textBoxSize+"px",this.htmlElement.appendChild(domRow([this.trash,this.order,this.checkbox,this.slider,this.textBox,this.up,this.down])),this.htmlElement.style.cursor=this.list.options.row_cursor||"pointer",this.isEditable&&(this.textBox.ondblclick=function(){this.list.disabled||this.edit()}.bind(this)),this.options.editOn&&this.edit(),this.afcLicensed===!1&&this.text.match(/AFC\ /)&&(this.htmlElement.id="AFC_"+this.value,window.setTimeout(input_deactivate.curry(this.htmlElement.id),50)),this.options.tooltip&&(this.tooltipAnchor=Builder.node("div",{style:"position:relative;overflow:hidden;height:0px;width:0px;margin-left:20px;"}),this.htmlElement.appendChild(this.tooltipAnchor),Event.observe(this.htmlElement,"mouseover",function(){infopop_up(this.tooltipAnchor,this.options.tooltip)}.bind(this)));return this},setStatus:function(){var a=this.list.retainArrayOrder?"visible":"hidden";this.checked?(this.checked=!1,this.checkbox.checked=!1,this.checkbox.defaultChecked=!1,this.textBox.style.fontWeight="normal",this.slider&&(this.slider.title=_LOC("QWSyOlLbhS","Status: Disabled"),this.slider.className="status_slider_small_off")):(this.checked=!0,this.checkbox.checked=!0,this.checkbox.defaultChecked=!0,a="visible",this.textBox.style.fontWeight="bold",this.slider&&(this.textBox.style.fontWeight="normal",this.slider.title=_LOC("bGMJUYahna","Status: Enabled"),this.slider.className="status_slider_small_on")),this.up&&(this.up.style.visibility=a),this.down&&(this.down.style.visibility=a),this.order&&(this.order.style.visibility=a),lastEdited=this.value},edit:function(){var a,b,c,d=this;this.value&&typeof this.value=="string"&&(this.value=this.value.unescapeHTML()),a=Builder.node("input",{type:"text",value:this.value,id:"ELEMENT_simpleListItem_edit",style:"margin-right: 2px;font-size: 10px;height:14px;border: 1px solid #666666;padding: 1px;"}),Event.observe(a,"blur",function(){a.value.strip()===""&&this.list.remove(this,!0)}.bind(this)),Event.observe(a,"keyup",function(b){b.keyCode&&(b.keyCode==27||b.keyCode==13)&&a.value.strip()===""&&this.list.remove(this,!0)}.bindAsEventListener(this)),b=Builder.node("input",{type:"button",value:_LOC("yieTpzJeVC","Apply"),style:"background: url(core/img/button_grey_mid.png) repeat-x left -2px #bbbbbb;width: 45px;font-size: 10px;height: 18px;border: 1px solid #666666;border-left: 1px solid #999999;border-top: 1px solid #999999;"}),browser=="ie"&&(b.style.marginTop="1px"),b.onclick=a.action=function(){d.edit_apply(a.value.escapeHTML())},a.This=d,a.alt='$("ELEMENT_simpleListItem_edit").action()',focus_register(a),this.textBox.ondblclick=function(){},this.textBox.innerHTML="",this.textBox.appendChild(domRow([a,b])),window.setTimeout(function(){c=$(this.textBox).getWidth()-$(b).up().getWidth()-7,a.style.width=c+"px",a.focus()}.bind(this),1)},edit_apply:function(a){var b=this;a=a.replace(/^\s+/,""),a=a.replace(/\s+$/,"");var c=!1;if(!a)this.list.remove(this,!0);else{if(a!=this.value){c=!0,members=this.list.members(),alreadyMember=members.detect(function(b,c){if(b.value==a)return!0;return!1});if(alreadyMember){alert(_LOC("DrxBPgxiNR","List entry already exists."));return}}this.value=a,this.textBox.innerHTML=this.value,this.textBox.ondblclick=function(){b.edit()},c&&this.list._reorder(),!this.list.noOnChange&&this.list.onchange&&evaluate(this.list.onchange)}}}),core.table=function(){function d(a){var b=0,d=[],e=0,f="",g;if(a.error&&a.error.length){g=a.error.length;for(;b<g;)f+=a.error[b++].text+"\n";alert(f)}if(a.confirm&&a.confirm.length){g=a.confirm.length;for(;e<g;)d.push(a.confirm[e++].text);confirm_dialog({message:d,ok_cb:c.curry(a)})}a.success&&reload_display()}function c(a){a.error&&delete a.error,a.confirm&&delete a.confirm,a.success&&delete a.success,call_fid(a.FID,{callback:d}.extend(a||{}),[])}"use strict";var a=_LOC("tUwEbndLWC","search"),b={};return function(d){function q(a){if(a&&!a.noSort)return a.field||a.fnc||a.ref.ref||a.ref;return!1}function p(a){if(a.noSort)return!1;if(a.field)return"field";if(a.ref)return"field";if(a.fnc)return"fnc"}function j(a){m.shown&&!$(Event.element(a)).up(".table_mass_action_menu")&&$(e.displayBox).hasChildNodes()&&($(e.displayBox).removeChild(m),m.shown=!1,Event.stopObserving($(document),"click",j))}var e=this,f,g,h=!1,i;this.options=Object.extend({width:770,height:558,bgcolors:["TABLEOBJITEM_odd","TABLEOBJITEM_even"],numDisplay:25,object_usage_information:!0,object_members_information:!1,confirmDelete:!0,skipPageSteps:!1},d||{}),this.options.no_edit||(f={objs:[{FID:this.options.form_fid,preload:!0}]},window.setTimeout(req_send.curry(f),100)),this.options.afcLicensed=typeof this.options.afcLicensed=="undefined"?null:this.options.afcLicensed?!0:!1,this.options.sandboxLicensed=typeof this.options.sandboxLicensed=="undefined"?null:this.options.sandboxLicensed?!0:!1,this.options.numDisplay!=="all"?this.numDisplay=parseInt(this.options.numDisplay,10):this.numDisplay="all",this.options.skipPageSteps&&(this.numDisplay_init=this.numDisplay),this.desc=_LOC("GjMioivIsj","desc"),this.asc=_LOC("iycwtaSTDl","asc"),this.fields=[],this.labels={},this.tableObjItems=[],this.tableObjItemsByRef={},this.dynTabFilter=!1,this.options.dyntab_set&&(this.dynTabFilter=new core.dropdown(this.options.dyntab_set),this.dynTabFilter.setChangeHandler(function(){var a=e.options.dyntab_set.tab_num,b=e.dynTabFilter.getValue();tab_switch_cnt(e.options.dyntab_set.dyntab_opts[b],e.options.dyntab_set.tabset_name,a),refresh_timeout_offline()})),this.options.property_filter&&(this.options.property_filter.style&&(this.options.property_filter.style.width="200px"),this.propertyFilter=new core.dropdown(this.options.property_filter),this.propertyFilter.setChangeHandler(function(){this.setFilter(),refresh_timeout_offline()}.bind(this))),this.options.string_filter&&(this.searchBoxEmptyText=a,!window.HTMLDataListElement||(this.datalist=Builder.node("datalist",{id:"stringFilterDatalist"})),this.stringFilter=Builder.node("input",{id:"stringFilter",type:"text",className:"tableStringFilter",value:a,list:"stringFilterDatalist"},[]),this.stringFilter.resetButton=$(Builder.node("img",{className:Prototype.Browser.WebKit?"objecttable_searchbox_ResetButton_chrome":"objecttable_searchbox_ResetButton",alt:_LOC("ppLPMyAHUY","Reset"),title:_LOC("zXrVsDpqKa","Reset"),src:"core/img/blank1x1.gif"})).hide().observe("click",function(){var a=$(this.stringFilter);a.value="",$(g).click(),a.focus()}.bind(this)),$(this.stringFilter).observe("focus",function(){focus_register(this),$F(this)===a&&($(this).value="",$(this.resetButton).show())}.bind(this.stringFilter)),$(this.stringFilter).observe("blur",function(){focus_unregister(this),$F(this)===""&&($(this).value=a,this.resetButton.hide())}.bind(this.stringFilter)),this.stringFilter.alt2=function(){e.setFilter()},this.stringFilter.alt='$("stringFilter").alt2();',g=Builder.node("div",{style:"display: block;"}),button_init(g,{label:_LOC("ISvrKrkfpJ","Find"),small:1,width:60,button_float:"left",textAlign:"center"}),browser=="ie"&&browser_version=="6"?g.style.height="19px":browser=="safari"&&(g.style.height="20px"),$(g).observe("click",function(){this.setFilter(),refresh_timeout_offline()}.bind(this)),this.stringFilterBox=Builder.node("table",{style:"position:relative;",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",Builder.node("tr",[Builder.node("td",{className:"objecttable_searchbox"},[this.stringFilter,this.stringFilter.resetButton,this.datalist]),Builder.node("td",g)])))),this.options.skipPageSteps||(this.pagerSteps=new core.dropdown({values:["all","10","25","50","100","250","500"],labels:{all:_LOC("XqLlgyBSoN","All"),10:"10",25:"25",50:"50",100:"100",250:"250",500:"500"},value:this.numDisplay,style:{width:"55px"}}),this.pagerSteps.setChangeHandler(function(){e.changePager()})),this.pagerInfo=domSpan({},{},{},"0-0 of 0"),this.prevButton=new core.button({icon:"core/img/icons/move_left.png",label:!1,title:_LOC("FePXdXNtyx","Previous"),width:34,onclickfunc:this.prev.bind(this)}),this.prevButton.disable(),this.nextButton=new core.button({icon:"core/img/icons/move_right.png",label:!1,title:_LOC("dDaTdNffDc","Next"),width:34,onclickfunc:this.next.bind(this)}),this.nextButton.disable(),h=!1,i=this.options.extra_button,i&&typeof i=="string"?h=new core.button({label:i,title:this.options.extra_title?this.options.extra_title:i,icon:this.options.extra_button_icon||"core/img/icons/livelog.png",width:this.options.extra_button_resize?"resize":200,onclick:this.options.extra_button_action}):i&&typeof i=="object"&&(h=new core.button({label:i.label,icon:i.icon||"core/img/icons/livelog.png",width:i.width||200,height:i.height||27,onclick:i.action,name:i.name})),this.controlBox=domTableRow([domTd({},{align:"left",valign:"top"},{},domTableCol([domTd({height:"24px",paddingBottom:"4px"},{valign:"top"},{},this.options.new_label?(new core.button({label:this.options.new_label,icon:"core/img/icons/plus.png",width:this.options.new_label_resize?"resize":200,onclickfunc:function(){e.openForm(!1)}})).element:domSpan({},{},{},"&nbsp;")),domTd({height:"24px"},{valign:"top"},{},h?h.element:domSpan({},{},{},"&nbsp;"))])),domTd({verticalAlign:"top"},{align:"right",valign:"top"},{},domTableRow([domTd({paddingRight:"16px",verticalAlign:"top"},{valign:"top"},{},domTableCol([this.dynTabFilter?domTd({},{},{},domTableRow([this.options.dyn_filter_label?domTd({height:"24px",paddingRight:"3px",fontWeight:"bold"},{valign:"middle"},{},domSpan({},{},{},""+this.options.dyn_filter_label)):!1,domTd({height:"24px"},{valign:"top"},{},this.dynTabFilter.htmlElement)])):!1,this.propertyFilter?domTd({height:"24px"},{valign:"top"},{},this.propertyFilter.htmlElement):!1,this.stringFilter?domTd({height:"24px"},{valign:"top"},{},this.stringFilterBox):!1])),domTd({},{align:"right"},{},domTableCol([domTd({height:"24px"},{valign:"top",align:"right"},{},domTableRow([domTd({},{},{},this.prevButton.element),domTd({},{},{},this.nextButton.element)])),domTd({height:"24px"},{valign:"top"},{},domTableRow([this.options.skipPageSteps?!1:domTd({height:"24px",paddingTop:"4px",width:"110px"},{valign:"middle"},{},domTableRow([domTd({width:"60px"},{},{},domSpan({},{},{},_LOC("ITEptoXOQE","Display:"))),domTd({width:"48px",marginRight:"2px"},{},{},this.pagerSteps.htmlElement)])),domTd({paddingLeft:"5px",paddingRight:"5px"},{},{},domSpan({},{},{},"")),domTd({height:"24px",paddingTop:"4px",width:this.options.skipPageSteps?"200px":"90px"},{align:this.options.skipPageSteps?"right":"right",valign:"middle",nowrap:"nowrap"},{},this.pagerInfo)]))]))]))],{height:"52px",width:"100%"});if(this.options.mass_actions){this.checkallChkBox=$(Builder.node("input",{type:"checkbox",title:_LOC("fItZLzFSso","Select all on this page"),style:"float:left;margin:0;vertical-align:middle;padding:0;"})),Event.observe(this.checkallChkBox,"click",function(){var a=this.shown.length,b,c;while(a--)b=this.shown[a],c=this.tableObjItemsByRef[b.ref],!b.lock&&!b.no_mass&&c&&this.shown[a].displayed&&(c.checked=this.checkallChkBox.checked,c.checkItemCheckBox.checked=this.checkallChkBox.checked)}.bind(this));var k=function(a){var b=this.options.mass_actions[a.getAttribute("action")||0],d,e=this.getCheckedItems();if(!e.length){alert(_LOC("CZbXajdyME","Please select at least one item."));return!1}b.form?d=new core.ngPopup({name:"POPUP_mass_actions_form_"+b.form.name,width:b.form.width||300,"class":b.form["class"],type:b.form.type,passthru:{refs:e},centered:!0,modal:!0}):c({FID:b.fid,refs:e}.extend(b.params||{}))}.bind(this),l=[];$A(this.options.mass_actions).each(function(a,b){l.push($(Builder.node("li",{action:b,style:"cursor:pointer;"})).update(a.label))});var m=$(Builder.node("div",{className:"table_mass_action_menu"},[Builder.node("ul",{},l)])),n=$(Builder.node("div",{style:this.options.mass_action_hide_text?"width:27px":"",className:"table_mass_action_menu_button"},[Builder.node("span",{style:"float:left;line-height:13px;vertical-align:middle;"},this.options.mass_action_hide_text?"":_LOC("XSjCjdcJqn","Action")),Builder.node("img",{style:this.options.mass_actions_menu_override&&this.options.mass_actions_menu_override.replace_with_image?"margin-top:-2px;margin-left:3px;":"float:right;height:13px;",src:this.options.mass_actions_menu_override&&this.options.mass_actions_menu_override.replace_with_image?this.options.mass_actions_menu_override.replace_with_image:"core/img/icons/actions.png"})]));this.options.mass_actions_menu_override&&this.options.mass_actions_menu_override.with_first_action?Event.observe(n,"click",k.curry($(Builder.node("li",{action:0})))):Event.observe(n,"click",function(a){m.shown?($(this.displayBox).removeChild(m),m.shown=!1,Event.stopObserving($(document),"click",j)):($(this.displayBox).appendChild(m),Position.clone(n,m,{offsetTop:20,offsetLeft:-5,setWidth:!1}),m.shown=!0,Event.stop(a),Event.observe($(document),"click",j))}.bind(this)),l.each(function(a){Event.observe(a,"click",k.curry(a))}),this.massActions=$(Builder.node("td",{style:this.options.mass_action_hide_text?"width:53px":"",className:"table_mass_action_menu_cell"},[this.checkallChkBox,n]))}var o=[Builder.node("td",{className:"table_columns_header_left"},[]),this.massActions||Builder.node("td",{className:"table_mass_action_menu_cell"}),Builder.node("td",{className:"table_columns_header_divider"},[])];this.sortDir=core.tableSorting.dir||"asc",this.sortBy=core.tableSorting.column||!1,this.sortMethod=core.tableSorting.method?p(core.tableSorting.method):!1;if(this.options.use_legacy_sorting){if(this.options.sortable_by){if(!this.sortBy){var r=0,s=this.options.sortable_by.length,t,u=this.options.sortable_by[0];for(;r<s;){t=this.options.sortable_by[r++],t.field&&(t.field==="name"&&(u=t),t.field==="position"&&(u=t));if(t["default"]){u=t;break}}this.sortMethod=p(u),this.sortBy=q(u)}this.options.sortable_by.each(function(a,b){b||(this.sortMethod=this.sortMethod||p(a),this.sortBy=this.sortBy||q(a));var c=Builder.node("td",{className:a.noSort?"table_no_sort_column_cell":"table_sort_column_cell",style:a.width?"width:"+a.width+";":null},[a.noSort?!1:Builder.node("img",{src:this.sortDir=="desc"?"core/img/dashboard/arrow_down.png":"core/img/dashboard/arrow_up.png",style:"float:right;height:4px;padding-top:5px;",title:this.sortDir=="desc"?_LOC("QDNDQsVlOV","Descending"):_LOC("ZjyZYzkSgn","Ascending")}),Builder.node("span",{style:"float:left;"+(a.width?"":"max-width:55px;"),className:"ellipsis",title:a.label},a.label)]);c.column=q(a),o.push(c),this.options.hide_last_header_column&&b==this.options.sortable_by.size()-1?null:o.push(Builder.node("td",{className:"table_columns_header_divider"},[])),Event.observe(c,"click",function(){o.each(function(a){a=$(a),a.down()&&a.down().tagName==="IMG"&&a.down().src&&a.down().hide()}),$(c).down().show(),!c.sortDir||c.sortDir=="asc"?(c.sortDir="desc",c.down().src="core/img/dashboard/arrow_down.png"):(c.sortDir="asc",c.down().src="core/img/dashboard/arrow_up.png"),!this.sortDir||this.sortDir=="asc"?this.sortDir="desc":this.sortDir="asc",this.sortMethod=p(a),this.sortBy=q(a),core.tableSorting.dir=this.sortDir,core.tableSorting.column=this.sortBy,core.tableSorting.method=this.sortMethod,this.fill()}.bind(this))}.bind(this)),o.each(function(a){a=$(a);(!a.column||a.column!=this.sortBy)&&a.down()&&a.down().src&&a.down().hide()}.bind(this))}o.push(Builder.node("td",{},[]))}else{if(this.options.sortable_by){if(!this.sortBy){var r=0,s=this.options.sortable_by.length,t,u=this.options.sortable_by[0],v;for(;r<s;){t=this.options.sortable_by[r++],t.field&&(t.field==="name"&&(u=t),t.field==="position"&&(u=t));if(t["default"]){u=t;break}}this.sortMethod=p(u),this.sortBy=q(u)}this.options.sortable_by.each(function(a,b){b||(this.sortMethod=this.sortMethod||p(a),this.sortBy=this.sortBy||q(a));if(a.field||a.fnc||a.ref)this.fields[b+1]=a.field||a.fnc||a.ref.ref,a.label&&((a.field||a.fnc||a.ref.ref)!=this.sortBy?this.labels[a.field||a.fnc||a.ref.ref]=a.label:this.sortDir&&this.sortDir=="desc"?(this.labels[a.field||a.fnc||a.ref.ref]=a.label+" "+this.desc,this.fields[0]="reverse",this.labels.reverse=a.label+" "+this.asc):(this.labels[a.field||a.fnc||a.ref.ref]=a.label+" "+this.asc,this.fields[0]="reverse",this.labels.reverse=a.label+" "+this.desc))}.bind(this)),this.fields[0]||this.fields.shift()}b={values:this.fields,labels:this.labels,value:this.sortBy,name:"sort_by"},b.style={width:"100px","float":"left","margin-left":"3px"};var w=new core.dropdown(b),x=0;w.htmlElement.observe("change",function(a){w.htmlElement.value=="reverse"?(!this.sortDir||this.sortDir=="asc"?this.sortDir="desc":this.sortDir="asc",x=1):(this.sortBy=w.htmlElement.value,x=0),this.fields=[],this.labels={},s=this.options.sortable_by.length;for(r=0;r<s;r++){t=this.options.sortable_by[r];if(t.field||t.fnc||t.ref)this.fields[r+1]=t.field||t.fnc||t.ref.ref,t.label&&((t.field||t.fnc||t.ref.ref)!=this.sortBy?this.labels[t.field||t.fnc||t.ref.ref]=t.label:(this.sortDir&&this.sortDir=="desc"?(this.labels[t.field||t.fnc||t.ref.ref]=t.label+" "+this.desc,this.fields[0]="reverse",this.labels.reverse=t.label+" "+this.asc):(this.labels[t.field||t.fnc||t.ref.ref]=t.label+" "+this.asc,this.fields[0]="reverse",this.labels.reverse=t.label+" "+this.desc),this.sortMethod=p(t)))}core.tableSorting.dir=this.sortDir,core.tableSorting.column=this.sortBy,core.tableSorting.method=this.sortMethod,this.fill(x),b.values=this.fields,b.labels=this.labels,b.value=this.sortBy,core.dropdownMap.sort_by.refill(b)}.bind(this)),v=_LOC("JyIcMyyCGj","Sort by:");var y=$(Builder.node("div",{style:"float:left;margin-left:2px;"}));s&&(y.appendChild(Builder.node("span",{style:"float:left;line-height:18px;vertical-align:middle;"},v)),y.appendChild(w.htmlElement)),o.push(Builder.node("td",{className:"table_sort_column_cell",style:"width:auto;cursor:default;"},y))}o.push(Builder.node("td",{className:"table_columns_header_right"},[]));if(this.options.sortable_by||this.options.mass_actions)this.columnBox=Builder.node("div",{style:"width:"+parseInt(this.options.width+2,10)+"px;"},[Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",style:"width:100%;margin:0 5px;table-layout:fixed;"},[Builder.node("tbody",{},[Builder.node("tr",{className:"table_columns_header_center"},o)])])]);this.itemBox=domDiv({height:"501px"},{},{}),this.scrollBox=domDiv({position:"relative",height:"501px",overflow:"auto",margin:"0px 5px 0px 5px",border:"1px #ccc solid",borderTopWidth:"0px",width:this.options.width+"px"},{},{},this.itemBox),Event.observe(this.scrollBox,"scroll",function(){core.tableScrollOffset[this.options.name]=this.scrollBox.scrollTop}.bind(this)),this.displayBox=domDiv({position:"relative"},{},{},domTableRow([domTd({},{valign:"top"},{},domTableCol([domTd({},{},{},this.columnBox||!1),domTd({},{},{},this.scrollBox)]))])),this.htmlElement=domTableCol([this.controlBox?domTd({paddingBottom:"4px"},{},{},this.controlBox):!1,domTd({},{},{},this.displayBox)]),this.objs=[];if(this.options.obj_refs)this.options.obj_refs.each(function(a,b){var c=get_object(a);if(!c)_debug(a+": obj not found!");else{if(c.hidden)return;c.position=e.options.position_adjust?b-e.options.position_adjust:b,e.objs.push(c)}});else if(this.options.obj_src){var z=evaluate.apply(this,[this.options.obj_src]);z&&z.each(function(a,b){a.hidden||(a.position=e.options.position_adjust?b-e.options.position_adjust:b,e.objs.push(a))})}else this.options.obj_data&&this.options.obj_data.each(function(a){e.objs.push(a)});this.propertyFilter&&this.options.property_filter.propertyPath&&this.objs.each(function(a,b){var c=a;this.options.property_filter.propertyPath.each(function(a,b){c=c[a]}),c&&this.propertyFilter.addOption(c,null,!1)}.bind(this)),this.shown=this.objs,typeof core.tableMapOffsets[this.options.name]=="undefined"?(this.offset=0,core.tableMapOffsets[this.options.name]=0):(_debug("found paging info"),this.offset=core.tableMapOffsets[this.options.name]),this.numItems=this.objs.length;var A=core.tableSearchValues[this.options.name],B=!1;if(A){this.stringFilter&&A.stringFilter&&(this.stringFilter.value=A.stringFilter,this.stringFilter.value!==a&&$(this.stringFilter.resetButton).show());if(this.propertyFilter&&A.propertyFilter)for(var C=0;C<this.propertyFilter.htmlElement.options.length;C++)this.propertyFilter.htmlElement.options[C].value==A.propertyFilter&&(this.propertyFilter.htmlElement.value=A.propertyFilter);(A.propertyFilter||A.stringFilter)&&this.setFilter()}else this.propertyFilter&&this.options.property_filter.value&&this.setFilter();this.numItems===0?this._showEmpty():this.fill(),window.setTimeout(this.setOverflows.bind(this),50);return this}}(),core.table.prototype={formPreLoad:function(){req_send({objs:[{FID:this.options.form_fid,options:{name:"TABLE_"+this.options.name+"_FORM",update_type:"table",update_name:this.options.name,dyntab_opts:this.options.dyntab_opts?this.options.dyntab_opts:!1}}]})},maximize:function(){var a=document.viewport.getHeight(),b=a-Position.cumulativeOffset(this.displayBox)[1];b<550&&(b=550),b-=57,$(this.scrollBox).style.height=b+"px",$(this.itemBox).style.height=b+"px"},setOverflows:function(){var a=0,b="TABLEOBJITEM_odd";if(!$(b))if($("TABLEOBJITEM_even"))b="TABLEOBJITEM_even";else return;document.getElementsByClassName(b).each(function(b,c){a=a<b.getDimensions().width?b.getDimensions().width:a}),document.getElementsByClassName(b).each(function(a,b){a.style.width="100%",a.parentNode.style.width=a.style.width}),a>(this.formOpen?this.options.width-this.options.form_width:this.options.width)?(Element.removeClassName(this.scrollBox,"noHorizontalScroll"),this.scrollBox.style.overflow="auto"):(this.scrollBox.style.overflow="",this.scrollBox.style.overflowY="auto",Element.addClassName(this.scrollBox,"noHorizontalScroll"))},_showEmpty:function(){var a=!1;this.stringFilter&&this.stringFilter.value!==this.searchBoxEmptyText&&(a=!0),this.numItems===0&&(this.options.empty_text||a)&&this.itemBox.appendChild(domDiv({textAlign:"center",backgroundColor:"#dddddd",width:"60%",border:"1px solid #666666",position:"absolute",left:"20%",top:"20%",padding:"10px 10px 10px 10px"},{},{},domSpan({},{id:"OBJ_TABLE_empty_text"},{},a?_LOC("WeYczQQeTJ","Your search did not match any items."):this.options.empty_text)))},doReverse:function(){this.sortBy&&this.shown.reverse()},doSort:function(){this.checkallChkBox&&(this.checkallChkBox.checked=!1),this.sortBy&&this.shown.sort(function(a,b){function c(a,b,c){var d=function(a,b){var c=0,d=0;a.isArray&&(c=a[0]),b.isArray&&(d=b[0]),typeof a=="string"&&typeof b=="string"&&(c=a.toUpperCase(),d=b.toUpperCase()),c=a,d=b;if(c<d)return-1;if(c>d)return 1;return 0};if(typeof b.data[a]!="undefined"&&typeof c.data[a]!="undefined")return d(b.data[a],c.data[a]);if(typeof b[a]!="undefined"&&typeof c[a]!="undefined")return d(b[a],c[a]);if(typeof b.data[a]=="undefined"&&typeof c.data[a]!="undefined")return d("",c.data[a]);if(typeof b.data[a]!="undefined"&&typeof c.data[a]=="undefined")return d(b.data[a],"");return 0}var d;switch(this.sortMethod){case"fnc":if(core.table.sorters[this.sortBy])d=core.table.sorters[this.sortBy];else{_debug("sorter core.tables.sorters."+this.sortBy+" is undefined!");return}break;case"field":d=c.curry(this.sortBy);break;case"ref":d=function(a,b){var d=this.sortBy.ref,e=this.sortBy.field,f,g;if(typeof a.data[d]!="undefined"&&typeof b.data[d]!="undefined")f=backend_objects[a.data[d]],g=backend_objects[b.data[d]];else if(typeof a[d]!="undefined"&&typeof b[d]!="undefined")f=backend_objects[a[d]],g=backend_objects[b[d]];else return!1;return c(e,f,g)}.bind(this)}return this.sortDir=="asc"?d(a,b):d(b,a)}.bind(this))},disJoinOptions:function(a){var b=[],c=a.length;for(var d=0;d<c;d++){if(typeof a[d]=="undefined")continue;typeof a[d]=="string"?b=b.concat(a[d].replace(/&rarr;/g,"|").replace(/&nbsp;/g,"").replace(/<\/li><li>/g,"|").replace(/<br>/g,"|").replace(/ \/ /g,"|").replace(/, /g,"|").split("|")):b=b.concat(a[d])}return b},fill:function(a){var b=this.offset,c=0,d,e=this,f=[];this.tableObjItems=[],a?this.doReverse():this.doSort(),this.shown.each(function(a){a.displayed=!1}),this.numDisplay!=="all"?c=this.offset+this.numDisplay:c=this.shown.length;for(;b<c;)d=this.shown[b++],d?f.push(d):f.push(!1);while(this.itemBox.firstChild)this.itemBox.removeChild(this.itemBox.firstChild);var g=[];f.each(function(a,b){var c=!1;if(a!==!1){if(!this.tableObjItemsByRef[a.ref]||browser=="ie")this.tableObjItemsByRef[a.ref]=new core.tableObjItem(this,a);c=this.tableObjItemsByRef[a.ref],this.stringFilter&&(g=g.concat(this.disJoinOptions(c.getStringFilter().slice()))),this.itemBox.appendChild(c.htmlElement),c.setVisibleIndex(a.position?a.position+1:this.offset+(b+1)),this.options.tint?a.lock!==undefined&&a.lock.toLowerCase()=="acc"||a.ref.match(/^REF_ACC_/)?c.itemContainer.style.backgroundColor="#c2dcec":a.data.auto&&a.data.auto=="auto"?c.itemContainer.style.backgroundColor="#edd3c2":(c.obj.data[this.options.tint]&&(c.groupIndicator.style.backgroundColor=get_tint_color(c.obj.data[this.options.tint])),c.itemContainer.className=this.options.bgcolors[b%2]):c.itemContainer.className=this.options.bgcolors[b%2],a.displayed=!0}}.bind(this)),g.sort().reverse(),this.updateDatalist(g),this.doPager(),browser!="ie"&&browser_version<7&&(this.scrollBox.scrollTop=0),this.setOverflows()},doPager:function(){var a=this.options.skipPageSteps?this.offset+this.numDisplay_init:this.offset+this.numDisplay;if(a>this.numItems||this.numDisplay==="all")a=this.numItems;this.offset&&this.offset+1>a?this.prev():(this.numItems>0?this.pagerInfo.innerHTML=this.offset+1+"-"+a+" of "+this.numItems:(this.pagerInfo.innerHTML="0-0 of 0",this._showEmpty()),a==this.numItems?this.nextButton.disable():this.nextButton.enable(),this.offset===0?this.prevButton.disable():this.prevButton.enable())},changePager:function(){var a=this.pagerSteps.getValue();a=="all"?this.numDisplay=this.numItems:this.numDisplay=parseInt(a,10),this.offset=0,this.numItems=this.shown.length,this.fill(),core.tableDisplayNum[this.options.name]=a},prev:function(){this.offset>0&&(this.offset-=this.numDisplay,this.offset<0&&(this.offset=0)),core.tableMapOffsets[this.options.name]=this.offset,this.fill()},next:function(){this.offset<this.numItems-this.numDisplay&&(this.offset+=this.numDisplay),core.tableMapOffsets[this.options.name]=this.offset,this.fill()},setFilter:function(a){var b=!1,c=!1;this.options.property_filter&&this.options.property_filter.optionGroups&&(b=this.options.property_filter&&this.options.property_filter.optionGroups),core.tableSearchValues[this.options.name]||(core.tableSearchValues[this.options.name]={}),this.propertyFilterValue="_all";if(this.propertyFilter&&this.propertyFilter.getValue()!=="_all"){this.propertyFilterValue=this.propertyFilter.getValue();if(b){c=this.propertyFilter.getGroup();if(c){var d=b.length,e=!1;while(d--)e=b[d],e.group===c&&(this.options.property_filter.propertyPath=e.propertyPath,d=!1)}}core.tableSearchValues[this.options.name].propertyFilter!=this.propertyFilterValue&&(this.offset=0,core.tableMapOffsets[this.options.name]=0,core.tableSearchValues[this.options.name].propertyFilter=this.propertyFilterValue)}else core.tableSearchValues[this.options.name].propertyFilter=null;this.stringFilterValue="",this.stringFilter&&a&&(this.stringFilter.value=a),this.stringFilter&&this.stringFilter.value?(this.stringFilterValue=this.stringFilter.value.toLowerCase(),core.tableSearchValues[this.options.name].stringFilter!=this.stringFilterValue&&(this.offset=0,core.tableMapOffsets[this.options.name]=0,core.tableSearchValues[this.options.name].stringFilter=this.stringFilterValue)):core.tableSearchValues[this.options.name].stringFilter=null,this.shown=[],input_deactivate($(this.stringFilter)),wait_popup(!0,_LOC("XhyLInyIbM","Please wait, searching...")),this._filterCurrent=0,this._filter()},_filter:function(){var a,b,c,d=function(a){if(this.propertyFilterValue!="_all"&&this.propertyFilterValue!="_showselected"&&this.propertyFilterValue!="_showunselected"){var b=a;this.options.property_filter.propertyPath.each(function(a,c){b=b[a]});return b&&b==this.propertyFilterValue}return!0}.bind(this),e=function(a){var b;if(this.stringFilter&&this.stringFilter.value){this.stringFilter.value===this.searchBoxEmptyText?b="":b=this.stringFilter.value.toLowerCase().escapeHTML(!0);return this.tableObjItemsByRef[a.ref].matchStringFilter(b)}return!0}.bind(this),f={},g=10,h=[];while(g--)this.objs[this._filterCurrent]&&(f=this.objs[this._filterCurrent++],this.tableObjItemsByRef[f.ref]||(this.tableObjItemsByRef[f.ref]=new core.tableObjItem(this,f),this.stringFilter&&(h=h.concat(this.disJoinOptions(this.tableObjItemsByRef[f.ref].getStringFilter().slice())))),d(f)&&e(f)&&this.shown.push(f));h.sort().reverse(),this.updateDatalist(h),this._filterCurrent<this.objs.length?this.setFilterTimer=window.setTimeout(this._filter.bind(this),1):(this._filterCurrent=0,input_activate($(this.stringFilter)),wait_popup(!1),this.numItems=this.shown.length,this.options.skipPageSteps?this.numDisplay=this.numDisplay_init:this.numDisplay=this.pagerSteps.getValue()=="all"?this.numItems:parseInt(this.pagerSteps.getValue(),10),this.fill(),this.doPager(),this.setOverflows())},updateDatalist:function(a){var b=a.length,c,d;if(this.datalist){this.dlEntries||(this.dlEntries=[]);while(b--)d=a[b],this.dlEntries.member(d)||(c=Builder.node("option",core.tools.htmlEntityDecode(d)),this.datalist.appendChild(c),this.dlEntries.push(d))}},openFormPopup:function(a,b){if(!this.formOpen){this.formOpen=a?a.ref:!0;var c={name:"POPUP_"+this.options.new_class+"_"+this.options.new_type,anchor:"TABLE_"+this.options.name+"_CONTAINER",update_type:"table",update_name:this.options.name,center:!0,passthru:{},modal:!0,help:this.options.help,onclose:function(){this.formOpen=!1}.bind(this)};a?(c.class=a.class,c.type=a.type,c.obj_ref=a.ref,b&&(c.obj_clone=a.ref),c.passthru[a.type]=a.ref):(c.class=this.options.new_class,c.type=this.options.new_type),new core.popup(c)}},openForm:function(a,b,c){if(this.options.use_popup)return this.openFormPopup(a,b);var d="",e=this,f,g;!a||b?d=this.options.form_title_new:a.lock?d=this.options.form_title_edit.replace(/Edit/,"View"):d=this.options.form_title_edit,this.formOpen||(this.formOpen=a?a.ref:!0,modifyPxWidth(this.scrollBox,-this.options.form_width),modifyPxWidth(this.columnBox,-this.options.form_width),f=$A(this.displayBox.getElementsByTagName("tr"))[0],f.insertBefore(domTd({width:"10px"}),f.firstChild),this.formTitleElement=domSpan({fontWeight:"bold"},{},{},""),this.formCloseButton=domTd({},{align:"right"},{},domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",width:"19px",className:"FORM_close"},{onclick:function(){e.closeForm()}})),f.insertBefore(domTd({width:this.options.form_width-10+"px",maxWidth:this.options.form_width-10+"px",paddingBottom:"8px",verticalAlign:"top"},{valign:"top"},{},domTableCol([domTd({},{align:"left",className:"FORM_header"},{},domTableRow([domTd({},{align:"left",className:"FORM_header_left"},{},""),domTd({},{align:"left",className:"FORM_header_center",style:"width:"+(this.options.form_width-18)+"px;"},{},domTableRow([domTd({},{},{},this.formTitleElement),this.formCloseButton],{width:"100%"})),domTd({},{align:"left",className:"FORM_header_right"},{},"")])),domTd({border:"1px dotted #dddddd",backgroundColor:"#fdfdfd",padding:"8px 4px 8px 4px"},{id:"TABLE_"+this.options.name+"_SIDEBAR",align:"center"})],{width:"100%"})),f.firstChild)),g={objs:[{FID:this.options.form_fid,target:"TABLE_"+this.options.name+"_SIDEBAR",closeJs:'core.tableMap["'+this.options.name+'"].closeForm();',options:{name:"TABLE_"+this.options.name+"_FORM",update_type:"table",form_width:this.options.form_width-10,update_name:this.options.name,dyntab_opts:this.options.dyntab_opts?this.options.dyntab_opts:!1,afcLicensed:this.options.afcLicensed,sandboxLicensed:this.options.sandboxLicensed,propertyFilterValue:this.propertyFilter?this.propertyFilter.getValue():!1,param:c?c:!1}}]},a&&(b?(g.objs[0].options.obj_clone='"'+a.ref+'"',g.objs[0].options.obj_ref=a.ref):(g.objs[0].options.obj_src='"'+a.ref+'"',g.objs[0].options.obj_ref=a.ref)),this.formTitleElement.innerHTML=d,req_send(g),window.setTimeout(this.setOverflows.bind(this),50)},closeForm:function(){var a,b;if(this.formOpen){this.formOpen=!1;if(this.options.use_popup)return;this.scrollBox.style.overflow="",this.scrollBox.style.overflowY="auto",Element.addClassName(this.scrollBox,"noHorizontalScroll"),remove_license_exceptions(),a=$A(this.displayBox.getElementsByTagName("tr"))[0],browser!="ie"?(a.removeChild(a.firstChild),a.removeChild(a.firstChild)):(b=a.firstChild,b.innerHTML="",a.removeChild(b),b=a.firstChild,b.innerHTML="",a.removeChild(b)),modifyPxWidth(this.scrollBox,this.options.form_width),modifyPxWidth(this.columnBox,this.options.form_width),this.itemBox.style.width="100%"}window.setTimeout(this.setOverflows.bind(this),50)},updateItem:function(a,b){if(!!a){var c=this,d=this.objs.detect(function(b,d){if(a==b.ref){c.objs[d]=get_object(a);return!0}return null});d?isNaN(b)?(this.tableObjItemsByRef[d.ref].update(),reload_display()):reload_display():reload_display(),this.closeForm()}},deleteItem:function(a){if(!!a){var b=this,c=null;this.objs.each(function(b,d){a==b.ref&&(c=d)}),this.tableObjItems.length==1&&this.numItems>1&&this.prev();if(c===null)return;this.objs.splice(c,1),reload_display(),this.formOpen&&a==this.formOpen&&this.closeForm()}},deleteItems:function(a){req_send({objs:[{FID:"obj_mass_delete",obj_refs:this.getCheckedItems(),callback:object_mass_delete_result,update_type:"table",update_name:this.options.name}]})},getCheckedItems:function(){return this.objs.clone().collect(function(a){if(a.lock||a.nodel)return!1;return this.tableObjItemsByRef[a.ref]&&this.tableObjItemsByRef[a.ref].checked?a.ref:!1}.bind(this)).reject(function(a){return a===!1})}},core.tableObjItem=Class.create({initialize:function(a,b){var c=this;this.obj=Object.clone(Object.extend(core.table.objExtension,b)),this.parentName=a.options.name,this.parentOptions=a.options,this.checked=!1,this.afcLicensed=a.options.afcLicensed,this.sandboxLicensed=a.options.sandboxLicensed,this.showVisibleIndex=!1,this.visibleIndexSpan=domSpan({},{},{},this.visibleIndex),this.isExtended=!1,this.stringFilterCandidates=[],this.oem=a.options.oem,this.editButton=Builder.node("div"),button_init(this.editButton,{label:_LOC("XzGzuFkGUC","Edit"),width:100,icon:"core/img/icons/edit.png",small:1,onclickfunc:function(){c.edit()}});if(this.obj.lock||a.options.no_edit)form_type_whitelist[this.parentOptions.form_fid]&&form_type_whitelist[this.parentOptions.form_fid].indexOf(this.obj.type)!=-1?(this.editButton=Builder.node("div"),button_init(this.editButton,{label:_LOC("BKuvXBJkuN","View"),width:100,icon:"core/img/icons/search.png",small:1,onclickfunc:function(){c.edit()}})):this.editButton=Builder.node("div","");this.obj.lock||this.obj.nodel||a.options.no_delete?this.deleteButton=Builder.node("div",""):(this.deleteButton=Builder.node("div"),button_init(this.deleteButton,{label:_LOC("GbGnRaDilQ","Delete"),width:100,icon:"core/img/icons/delete.png",small:1,onclickfunc:function(){c.del()}})),this.obj.lock||this.obj.no_clone||a.options.no_clone?this.cloneButton=Builder.node("div",""):(this.cloneButton=Builder.node("div"),button_init(this.cloneButton,{label:_LOC("vlnkbxObBy","Clone"),width:100,icon:"core/img/icons/clone.png",small:1,onclickfunc:function(){c.clone()}}));if(a.options.object_members_information&&this.obj.isGroup()){var d="Group members: <br />";this.obj.getGroupMembers().each(function(a){var b=get_object(a);b&&b.data&&(d+="&nbsp;&nbsp;"+b.data.name+"<br />")}),this.groupMemberInfoButton=domImg({},{src:"core/img/blank1x1.gif",className:"TABLEOBJITEM_BUTTON_groupmembers"},{onmouseover:function(){infopop_up(this,d,!0)},onmouseout:function(){infopop_down()}})}a.options.object_usage_information&&(this.infoButton=domImg({},{src:"core/img/blank1x1.gif",className:"TABLEOBJITEM_BUTTON_usageinformation"},{onclick:function(){c.toggleExtended()},onmouseover:function(){infopop_up(this,_LOC("FyFiWMMzyz","Show where this object is in use and its last change"),!0)},onmouseout:function(){infopop_down()}})),this.controlBox=domTd({width:"108px",minWidth:"108px",verticalAlign:"top"},{valign:"top"},{}),this.infoBox=domTd({width:"40px",verticalAlign:"top",paddingTop:"3px"},{valign:"top"},{}),this.groupIndicator=$(Builder.node("td",{className:"objecttable_groupindicator_width"})),this.groupIndicator.update("&nbsp;"),this.controlBox.appendChild(this.editButton),this.controlBox.appendChild(this.deleteButton),this.controlBox.appendChild(this.cloneButton),this.controlBox.appendChild(domImg({width:"78px",height:"1px"},{src:"core/img/blank1x1.gif"},{})),a.options.object_usage_information&&this.infoBox.appendChild(this.infoButton),a.options.object_members_information&&this.obj.isGroup()&&this.infoBox.appendChild(this.groupMemberInfoButton);var e=this;a.options.custom_buttons&&a.options.custom_buttons.length>0&&a.options.custom_buttons.each(function(a,b){a.htmlElement=Builder.node("div"),button_init(a.htmlElement,{label:a.label,width:70,icon:a.image,small:1,onclickfunc:function(){evaluate.apply(this,["This."+a.onclick])}}),e.controlBox.appendChild(a.htmlElement)}),a.options.additional_buttons&&a.options.additional_buttons.length&&a.options.additional_buttons.each(function(a){var b=Builder.node("div");button_init(b,{label:a.label||"click me",width:70,icon:a.icon||"core/img/icons/search.png",small:1}),Event.observe(b,"click",window[a.onclickfunc].curry(e.obj)),e.controlBox.appendChild(b)}),this.itemBox=domTd({verticalAlign:"top",padding:a.options.collapse_table?"0 2px":"2px"},{valign:"top"},{});var f=[this.controlBox,this.itemBox,this.infoBox,this.groupIndicator];a.options.mass_actions&&(this.checkItemBox=domTd({width:"14px",verticalAlign:a.options.mass_action_checkbox_align?a.options.mass_action_checkbox_align:"top",padding:"0",margin:"0"},{valign:a.options.mass_action_checkbox_align?a.options.mass_action_checkbox_align:"top"},{}),this.obj.nodel||a.options.no_delete?this.checkItemCheckBox=Builder.node("div",""):this.checkItemCheckBox=Builder.node("input",{type:"checkbox",title:_LOC("FmSdNJIogq","Select this object"),className:"TABLEOBJITEM_chkbox",value:this.obj.ref,checked:this.checked,disabled:this.obj.lock||this.obj.no_mass}),Event.observe(this.checkItemCheckBox,"click",function(){this.checked=$F(this.checkItemCheckBox)!="0"}.bind(this)),this.checkItemBox.appendChild(this.checkItemCheckBox),f.unshift(this.checkItemCheckBox)),this.itemContainer=domTableRow([this.checkItemBox,a.options.no_controls?null:this.controlBox,this.itemBox,a.options.hide_info_td?null:this.infoBox,this.groupIndicator],{width:"100%"},{"class":"tableObjItem",className:"tableObjItem"}),this.htmlElement=domDiv({borderBottom:a.options.collapse_table?"":"3px solid #fff"},{},{},this.itemContainer),this.htmlElement.self=this,this.render(),a.tableObjItems.push(this);return this},update:function(){this.obj=Object.clone(Object.extend(core.table.objExtension,get_object(this.obj.ref))),this.render(),this.setVisibleIndex(this.visibleIndex),_debug("item updated")},edit:function(){core.tableMap[this.parentName].openForm(this.obj)},clone:function(){core.tableMap[this.parentName].openForm(this.obj,!0)},edit_with_param:function(a){core.tableMap[this.parentName].openForm(this.obj,!1,a)},del:function(){req_send({objs:[{FID:"obj_delete",obj_ref:this.obj.ref,callback:"object_delete_result",update_type:"table",update_name:this.parentName}]})},toggleExtended:function(){this.isExtended?(this.htmlElement.style.background=this.isExtended[0],this.htmlElement.style.backgroundColor=this.isExtended[1],this.htmlElement.style.backgroundImage=this.isExtended[2],this.htmlElement.removeChild(this.objectUsage),this.isExtended=!1):(this.isExtended=[this.htmlElement.style.background,this.htmlElement.style.backgroundColor,this.htmlElement.style.backgroundImage],this.htmlElement.style.background="#FFF",this.objectUsage=domTableRow([objectUsageDomTd(this.obj)],{width:$(this.itemContainer).getDimensions().width+"px",padding:"2px 10px 2px 10px",background:"#fff"},{}),this.htmlElement.appendChild(this.objectUsage),_debug(this.htmlElement.innerHTML))},toggleStatus:function(a){var b=Object.clone(this.obj);b.data=Object.clone(this.obj.data);if(b.ref.indexOf("REF_ACC_")!=-1||b.lock=="ACC")alert(_LOC("TKtzdLRfJi","You are not allowed to change the status of this object as this is managed by Sophos UTM Manager."));else{var c;b.data[a]==1?(b.data[a]=0,c=1):(b.data[a]=1,c=0),req_send({objs:[{FID:"obj_set",obj:b,callback:"object_toggle_result",update_type:"table",update_name:this.parentName,toggle_status:!0,toggle_field:a,toggle_value:c}]},!0);return!1}},matchPropertyFilter:function(a,b){if(!b||!a)return!0;var c=this.obj;a.each(function(a,b){c=c[a]});if(!c)return!1;return c==b?!0:!1},matchStringFilter:function(a){if(!a)return!0;var b=this,c=this.stringFilterCandidates.detect(function(b,c){if(!b)return!1;if(String(b).toLowerCase().indexOf(a)>=0)return!0;return!1});if(!c)try{var d=new RegExp(a,"gi");c=!!this.stringFilterCandidates.grep(d).length}catch(e){c=!1}return c?!0:!1},getStringFilter:function(){return this.stringFilterCandidates},hide:function(){this.isHidden||(this.htmlElement.style.height="0px",this.htmlElement.style.padding="0px",this.htmlElement.style.borderBottom="0px",this.htmlElement.style.visibility="hidden",this.isHidden=!0)},show:function(){this.isHidden&&(this.htmlElement.style.height=null,this.htmlElement.style.padding="2px 2px 2px 2px",this.htmlElement.style.border="1px solid #f7f7f7",this.htmlElement.style.visibility="visible",this.isHidden=!1)},setVisibleIndex:function(a){this.showVisibleIndex?(this.visibleIndex=a,this.visibleIndexSpan.innerHTML=a):(this.visibleIndex=!1,this.visibleIndexSpan.innerHTML="")},render:function(){this.itemBox.innerHTML="",this.stringFilterCandidates=[];if(!this["renderFunctions__"+this.obj["class"]]){var a=dynIncPath+"_tableObjItem_"+this.obj["class"]+".min.js",b=dynIncPath+"_tableObjItem_"+this.obj["class"]+".js";loadScript(a,!1)!=-1||loadScript(b,!1)!=-1?this["renderFunctions__"+this.obj["class"]]=core.tableObjItem.prototype["renderFunctions__"+this.obj["class"]]:_debug("loading tableObjItems "+this.obj["class"]+" failed. Unknown reason")}try{this["renderFunctions__"+this.obj["class"]]()}catch(c){_debug(this.obj["class"]+"---->"+c)}}}),core.table.objExtension={isGroup:function(){return this.data&&this.data.members?this.data.members.length>0:!1},getGroupMembers:function(){return this.isGroup()?this.data.members:[]}},core.table.sorters={itf_itfhw:function(a,b){return get_itf_hw(a.ref)>get_itf_hw(b.ref)},itf_alias_itfhw:function(a,b){var c=get_alias_parent(a.ref),d=get_alias_parent(b.ref);return get_itf_hw(c.ref)>get_itf_hw(d.ref)},policy_routes_selector:function(a,b){function c(a){return backend_objects[a.data.source].data.name+backend_objects[a.data["interface"]].data.name+backend_objects[a.data.service].data.name+backend_objects[a.data.destination].data.name}return c(a)>c(b)},ipaddr:function(a,b){var c=a.data.ipaddr.split("."),d=b.data.ipaddr.split("."),e=0;for(;e<4;){c[e]=parseInt(c[e],10),d[e]=parseInt(d[e],10);if(c[e]>d[e++])return!0}return!1},reverse_proxy_location_path:function(a,b){var c=a.data.path,d=b.data.path;if(c.length!=d.length)return d.length-c.length;return c>d?1:c<d?-1:0}};var get_tint_color=function(){var a=$A(["#008680","#0095D8","#00549A","#912F72","#D15D9B","#E42077","#E42620","#E1B600","#CCC702","#5C9C21","#F89728","#B55F5E","#8461A9","#4A4B9F","#3282BA","#4B8050"]),b={},c=[];return function(d){if(!d)return"#eeeeee";c.length||(c=a.clone()),b[d]||(b[d]=c.pop());return b[d]}}();core.minitable=Class.create({initialize:function(options){var This=this;this.options=Object.extend({width:280,height:120,bgcolors:["#f7f7f7","#E4E4E7"],string_filter:!1,nodelete:!1,checkboxes:!1,checked:[],selectNewObjects:!1},options||{}),this.numItems=0,this.stringFilterString="",this.stringFilter=!1,this.options.string_filter&&(this.stringFilter=document.createElement("input"),this.stringFilter.setAttribute("type","text"),this.stringFilter.className="text",this.stringFilter.style.backgroundImage="url(core/img/icons/search.png)",this.stringFilter.style.backgroundRepeat="no-repeat",this.stringFilter.style.width="50px",this.stringFilter.style.paddingLeft="16px",this.stringFilter.onkeyup=this.setStringFilter.bind(this)),this.itemBox=domDiv({width:"100%",position:"relative",overflow:"auto",width:this.options.width+"px",height:this.options.height-23+"px"},{},{}),popup_close("POPUP_"+this.options.name),this.addIcon=!1,options.noadd||(this.addIcon=domImg({cursor:"pointer"},{src:"core/img/blank1x1.gif",className:"DRAGDROP_DROPZONE_addicon",title:_LOC("bjnvAyGpUe","Create new...")},{onclick:this.openPopup.bind(this)})),this.itemBox.style.border="1px solid #AAAAAA",this.itemBox.style.borderTopWidth="0px",this.htmlElement=domTableCol([domTd({},{},{},domTableRow([domTd({width:"4px",backgroundImage:"url(core/img/box/widget_left.png)"},{className:"DRAGDROP_DROPZONE_HEADER_left"},{},""),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},domSpan({color:"#333333",fontWeight:"bold"},{},{},this.options.title?this.options.title:"&nbsp;")),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x",width:"68px"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},this.stringFilter),domTd({backgroundImage:"url(core/img/box/widget_center.png)",backgroundRepeat:"repeat-x",width:"16px"},{className:"DRAGDROP_DROPZONE_HEADER_center"},{},this.addIcon),domTd({width:"4px",backgroundImage:"url(core/img/box/widget_right.png)"},{className:"DRAGDROP_DROPZONE_HEADER_right"},{},"")],{width:"100%",height:"26px"})),domTd({},{},{},this.itemBox)]),this.options.value&&(this.options.obj_refs=this.options.value);var objs=[];this.options.obj_refs?this.options.obj_refs.each(function(a,b){objs.push(get_object(a))}):this.options.obj_src&&(objs=eval(this.options.obj_src)),objs.each(function(a,b){var c=new core.minitableObjItem(this,a);this.options.checkboxes&&this.options.checked.indexOf(a.ref)>=0&&(c.checkbox.checked=!0),this.itemBox.appendChild(c.htmlElement),this.numItems++}.bind(this)),this.colorize();return this},getValue:function(){var a=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self");return a.collect(function(a,b){if(!this.options.checkboxes)return a.obj.ref;if(a.checkbox.checked)return a.obj.ref}.bind(this))},updateItem:function(a){var b=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self"),c=b.detect(function(b,c){if(b.obj.ref==a)return!0;return!1});if(c)c.update(),this.itemBox.appendChild(c.htmlElement),this.applyFilter();else{var d=get_object(a),e=new core.minitableObjItem(this,d),f=e.htmlElement;this.itemBox.appendChild(f),this.options.checkboxes&&this.options.selectNewObjects&&(e.checkbox.checked=!0),this.numItems++,this.applyFilter()}},deleteItem:function(a){var b=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self"),c=b.detect(function(b,c){if(b.obj.ref==a)return!0;return!1});c&&(this.itemBox.removeChild(c.htmlElement),this.numItems--,this.colorize())},openPopup:function(){var popup={name:"POPUP_"+this.options.name,"class":this.options.acceptClass,type:this.options.acceptType,anchor:this.addIcon,modal:this.options.modal,help:this.options.help,update_type:"minitable",update_name:this.options.name,passthru:{},leftSide:this.options.leftSide},options=this.options;options.passthru&&Object.extend(popup.passthru,options.passthru);if(options.dynamicPassthru)for(var key in options.dynamicPassthru)options.dynamicPassthru.hasOwnProperty(key)&&(popup.passthru[key]=eval(options.dynamicPassthru[key]));new core.popup(popup)},setStringFilter:function(){this.stringFilterString=this.stringFilter.value.toLowerCase(),this.stringFilterTimer&&window.clearTimeout(this.stringFilterTimer),this.stringFilterTimer=window.setTimeout(function(){this.applyFilter()}.bind(this),this.numItems)},applyFilter:function(){this.stringFilterTimer=!1;var a=$A(document.getElementsByClassName("minitableObjItem",this.htmlElement)).pluck("self"),b=this;a.each(function(a,c){a.matchStringFilter(b.stringFilterString)?a.show():a.hide()}),this.colorize()},colorize:function(){var a=$A(document.getElementsByClassName("minitableObjItem",this.itemBox)),b=this,c=0;a.each(function(a,d){a.self.isHidden||(a.style.backgroundColor=b.options.bgcolors[c%2],c++)})}}),core.minitableObjItem=Class.create({initialize:function(a,b){var c=this;this.parent=a,this.obj=b,this.stringFilterCandidates=[],this.editButton=this.obj.lock?domImg({},{src:"core/img/blank16x16.gif"},{}):domImg({cursor:"pointer"},{src:"core/img/icons/edit.png"},{onclick:this.edit.bind(this)}),this.deleteButton=this.obj.lock?domImg({},{src:"core/img/blank16x16.gif"},{}):domImg({cursor:"pointer"},{src:"core/img/icons/cancel.png"},{onclick:this.del.bind(this)}),this.checkbox=Builder.node("input",{type:"checkbox"}),this.itemBox=domTd({},{},{}),this.htmlElement=domDiv({padding:"2px 2px 2px 2px",borderBottom:"1px solid #666666",backgroundColor:"#eeeeee"},{},{},domTableRow([this.parent.options.checkboxes?domTd({width:"16px",paddingRight:"8px"},{},{},this.checkbox):"",this.parent.options.noedit?"":domTd({width:"16px",paddingRight:"4px"},{},{},this.editButton),this.parent.options.nodelete?"":domTd({width:"16px",paddingRight:"8px"},{},{},this.deleteButton),this.itemBox],{width:"100%"})),this.htmlElement.self=this,this.htmlElement.className="minitableObjItem",this.render();return this},update:function(){this.obj=get_object(this.obj.ref),this.render()},edit:function(){var popup={name:"POPUP_EDIT_"+this.obj.ref,obj_ref:this.obj.ref,anchor:this.editButton,modal:this.parent.options.modal,help:this.parent.options.help,update_type:"minitable",update_name:this.parent.options.name,passthru:{}},options=this.parent.options;options.passthru&&Object.extend(popup.passthru,options.passthru);if(options.dynamicPassthru)for(var key in options.dynamicPassthru)options.dynamicPassthru.hasOwnProperty(key)&&(popup.passthru[key]=eval(options.dynamicPassthru[key]));new core.popup(popup)},del:function(){req_send({objs:[{FID:"obj_delete",obj_ref:this.obj.ref,callback:"object_delete_result",update_type:"minitable",update_name:this.parent.options.name}]})},matchStringFilter:function(a){if(!a)return!0;var b=this,c=this.stringFilterCandidates.detect(function(b,c){if(String(b).toLowerCase().indexOf(a)>=0)return!0;return!1});return c?!0:!1},hide:function(){this.isHidden||(this.htmlElement.style.height="0px",this.htmlElement.style.padding="0px",this.htmlElement.style.borderBottom="0px",this.htmlElement.style.visibility="hidden",this.isHidden=!0)},show:function(){this.isHidden&&(this.htmlElement.style.height=null,this.htmlElement.style.padding="2px 2px 2px 2px",this.htmlElement.style.borderBottom="1px solid #666666",this.htmlElement.style.visibility="visible",this.isHidden=!1)},render:function(){if(!this["renderFunctions__"+this.obj["class"]]){var a=dynIncPath+"_minitableObjItem_"+this.obj["class"]+".min.js",b=dynIncPath+"_minitableObjItem_"+this.obj["class"]+".js";if(loadScript(a,!1,0)>=0||loadScript(b,!1,0)>=0)this["renderFunctions__"+this.obj["class"]]=core.minitableObjItem.prototype["renderFunctions__"+this.obj["class"]]}try{this["renderFunctions__"+this.obj["class"]]()}catch(c){_debug(c)}}}),core.report=Class.create(),core.report.prototype={initialize:function(a){var b=this;this.options=Object.extend({width:744,height:558,bgcolors:["#f7f7f7","#E4E4E7"],totals_string_column:2},a||{}),this.options.chart||(this.options.nochart=!0),this.options.optionGroups&&this.options.optionGroups.length!==0?this.typeDropdown=new core.dropdown({optionGroups:this.options.optionGroups,value:this.options.defaults.typeDropdown,onchange:"core.reportMap['"+this.options.name+"'].changeType()",style:{width:"150px"}}):this.typeDropdown=new core.dropdown({values:this.options.call_values,labels:this.options.call_labels,value:this.options.defaults.typeDropdown,onchange:"core.reportMap['"+this.options.name+"'].changeType()",style:{width:"150px"}}),this.pagerLimit=new core.dropdown({values:["__pager__","20","50","100","250"],labels:{__pager__:_LOC("RUKAADecWQ","number of rows"),20:"20 (default)",50:"50",100:"100",250:"250"},value:this.options.defaults.pagerLimit,style:{width:"125px"}}),this.prevButton=new core.button({icon:"core/img/icons/move_left.png",label:!1,width:34,onclickfunc:this.prev.bind(this)}),this.nextButton=new core.button({icon:"core/img/icons/move_right.png",label:!1,width:34,onclickfunc:this.next.bind(this)}),this.updateButton=new core.button({label:_LOC("pjexQPDIme","Update"),width:55,button_float:"right",onclickfunc:this.updateFilters.bind(this)}),this.typeFilterBox=this.createFilter(this.options.defaults.typeDropdown,""),this.filter_type_current=this.options.defaults.typeDropdown,this.pageInfo=domSpan({},{},{},_LOC("xIFhtQBdeK","Results 0-0 of 0")),this.options.data.reporting.pager&&this._calcPageInfo(),this.chartButton=domTd({},{height:24},{},domDiv({},{},{onclick:function(){b.chartActive?b.hideFlash():b.showFlash()}},domImg({cursor:"pointer",paddingRight:"2px"},{src:"core/img/icons/pie_chart.png",alt:_LOC("oTcAOQLEvm","Show FlashChart"),title:_LOC("JvtiHwIeMC","Show FlashChart")}))),this.controlBox=domTableRow([domTd({},{},{},domTableCol([domTd({},{},{},domTableRow([domTd({height:"24px",paddingRight:"5px"},{valign:"middle"},{height:24},this.typeDropdown.htmlElement),domTd({height:"24px"},{valign:"middle"},{height:24},domDiv({visibility:"hidden"},{id:"type_filter_box_div"},{},domTableRow([domTd({paddingRight:"5px"},{},{},domSpan({},{id:"type_filter_box_label"},{},"")),domTd({},{},{},domDiv({},{id:"type_filter_box_element"},{},this.typeFilterBox))])))],{})),domTd({},{},{},this.addFilters()),domTd({height:"24px"},{valign:"middle"},{height:24},this.pagerLimit.htmlElement)],{width:"100%",minWidth:"550px"})),domTd({},{},{},domTableCol([domTd({height:"24px"},{valign:"middle",align:"right"},{height:24},domTableRow([domTd({},{},{},this.prevButton.htmlElement),domTd({},{},{},this.nextButton.htmlElement)],{paddingBottom:"2px"})),domTd({height:"24px"},{valign:"middle",align:"right"},{height:24},this.updateButton.htmlElement),domTd({height:"24px"},{valign:"middle",align:"right"},{height:24},this.pageInfo)],{width:"150px"})),domTd({},{valign:"top"},{},domTableCol([domTd({},{height:24},{},domDiv({},{},{onclick:function(){core.reportMap[b.options.name].downloadReport("pdf")}},domImg({cursor:"pointer",paddingRight:"2px"},{src:"core/img/icons/download_pdf.png",alt:_LOC("EuXJRAlxRz","Download as PDF"),title:_LOC("CkTolbBeUU","Download as PDF")}))),domTd({},{height:24},{},domDiv({},{},{onclick:function(){core.reportMap[b.options.name].downloadReport("csv")}},domImg({cursor:"pointer",paddingRight:"2px"},{src:"core/img/icons/download_csv.png",alt:_LOC("Wudewwtzyr","Download as CSV"),title:_LOC("QLkYRjCxgS","Download as CSV")}))),this.options.nochart?null:this.chartButton],{width:"30px",marginLeft:"10px"}))],{}),this.controlBox.style.width="100%",this.controlBox.style.minWidth=this.options.width+"px",this.controlBox.style.height="52px",this.itemBox=domTableRow([],{},{id:"REPORTING_"+this.options.name+"_ITEMS",className:"REPORTING_itembox"}),this.scrollBox=domDiv({width:"100%",height:this.options.height-27+"px"},{className:"REPORTING_scrollbox"},{},domDiv({width:"100%"},{},{},this.itemBox)),this.displayBox=domTableRow([domTd({},{valign:"top"},{},this.scrollBox)],{width:"100%"}),this.chartBox=Builder.node("table",{width:"100%",cellspacing:"0",cellpadding:"0",border:"0"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"dashboard_box_header_left"},Builder.node("img",{src:"core/img/blank1x1.gif",width:"4px"})),Builder.node("td",{className:"dashboard_box_header_center width_hundred_percent"},""),Builder.node("td",{className:"dashboard_box_header_right"},Builder.node("img",{src:"core/img/blank1x1.gif",width:"5px"}))]),Builder.node("tr",{},[Builder.node("td",{className:"dashboard_box_content",colSpan:3},Builder.node("div",{className:"dashboard_box_content_div",style:"height:100px;",id:"REPORT_"+b.options.name+"_CHARTCONTAINER"}))])])),$(this.chartBox).hide(),this.options.nochart&&$(this.chartButton)&&$(this.chartButton).hide(),this.htmlElement=domTableCol([this.controlBox?domTd({paddingBottom:"4px"},{},{},this.controlBox):null,domTd({},{},{},this.chartBox),domTd({},{},{},this.displayBox)],{width:"100%"}),this.options.data.reporting_result.column_names&&this._webreport_captions(),this._fill(),this.options.data.reporting_result.result_totals&&this._webreport_totals(),this._colorize();return this},addFilters:function(){return},applyFilters:function(){return},prev:function(){var a=this,b=a.options.data.reporting_result.resultset_rows_total;if(!b||b.length!==0){if(a.options.data.reporting.pager.offset===0)return;a.options.data.reporting.pager.offset<=20?a.options.data.reporting.pager.offset=0:a.options.data.reporting.pager.offset=a.options.data.reporting.pager.offset-a.options.data.reporting.pager.limit;var c=a.options,d={objs:[{FID:a.options.data.reporting.fid,options:c,callback:"report_update"}]};req_send(d)}},next:function(){if(!!this.options.data.reporting_result.resultset_rows_total&&this.options.data.reporting_result.resultset_rows_total.length!==0){var a=Math.ceil(this.options.data.reporting_result.resultset_rows_total/this.options.data.reporting.pager.limit),b=a*this.options.data.reporting.pager.limit-this.options.data.reporting.pager.limit;if(b==this.options.data.reporting.pager.offset)return;this.options.data.reporting.pager.offset=this.options.data.reporting.pager.offset+this.options.data.reporting.pager.limit;var c={objs:[{FID:this.options.data.reporting.fid,options:this.options,callback:"report_update"}]};req_send(c)}},updateFilters:function(a){a=this;var b=a.options.data.reporting.pager;b.offset=0,b.limit=a.pagerLimit.getValue()!="__pager__"?a.pagerLimit.getValue():20,b.limit=parseInt(b.limit,10);if(a.typeDropdown.getValue()=="__seperator__")a._markAsMissing(a.typeDropdown.htmlElement,!0),alert(_LOC("OsBUEKCcOS","You forgot to select view type!"));else{a._markAsMissing(a.typeDropdown.htmlElement,!1);if(a.options.call_filtered.indexOf(a.typeDropdown.getValue())!=-1){var c=a.getFilterValue();if(c===""){a._markAsMissing(a.typeFilterBox,!0),alert(_LOC("MLKYyjHLrV","You forgot to enter a filter argument for the selected view!"));return}a._markAsMissing(a.typeFilterBox,!1),a.options.data.reporting.filter=[[a.options.call_map[a.typeDropdown.getValue()].field,"=",a.typeFilterBox.value.match(/^0[0-9]{3}$/)?a.typeFilterBox.value.substring(1):a.typeFilterBox.value]]}else a.options.data.reporting.filter=[];a.options.type=a.options.call_map[a.typeDropdown.getValue()].call,a.options.data.reporting.fid=a.options.call_map[a.typeDropdown.getValue()].call,a.options.data.reporting.orderby=[a.options.call_map[a.typeDropdown.getValue()].orderby],delete a.options.data.reporting._async,delete a.options.data.reporting.format,a.applyFilters();var d=a.options,e={objs:[{FID:a.options.data.reporting.fid,options:d,callback:"report_update"}]};req_send(e)}},orderby:function(a){var b=this;this.options.data.reporting.orderby[0].indexOf(a)!=-1?this.options.data.reporting.orderby[0]==a+" ASC"?this.options.data.reporting.orderby=[a+" DESC"]:this.options.data.reporting.orderby=[a+" ASC"]:this.options.data.reporting.orderby=[a+" DESC"];var c=this.options;c.data&&c.data.reporting&&c.data.reporting.format&&(delete c.data.reporting.format,delete c.data.reporting._async);var d={objs:[{FID:this.options.data.reporting.fid,options:c,callback:"report_update"}]};req_send(d)},update:function(){var a=this;this._clear(),this._webreport_captions(),this._calcPageInfo(),this._fill(),this._webreport_totals(),this._colorize(),this.options.nochart?($(this.chartButton).hide(),this.hideFlash()):$(this.chartButton).show(),this.chartActive&&this.updateFlash()},changeType:function(a,b){var c=this;b&&this.typeDropdown.setValue(b,1),a||(a="");var d=this.typeDropdown.getValue();d!="__seperator__"&&(this.options.call_filtered.indexOf(d)!=-1?($("type_filter_box_div").style.visibility="",this.typeFilterBox=this.createFilter(d,a),$("type_filter_box_element").removeChild($("type_filter_box_element").firstChild),$("type_filter_box_element").appendChild(this.typeFilterBox),$("type_filter_box_label").innerHTML=this.options.call_map[c.typeDropdown.getValue()].filterbox,this.filter_type_current=d):$("type_filter_box_div").style.visibility="hidden")},createFilter:function(a,b){var c=this,d=null,e=[],f={},g;switch(a){case"webreport_top_appsrcbyapp":case"netacc_top_clients_by_application":case"netacc_top_servers_by_application":e=["Unclassified"],f={Unclassified:":: Unclassified ::"},app.applications&&($H(app.applications).sortBy(function(a){return a.value.long_name.toLowerCase()}).each(function(a){var b=a[1].long_name;e.push(b),f[b]=b}),g=new core.dropdown({values:e,labels:f,value:b,id:"filterbox_el",style:{width:"150px"}}),d=g.htmlElement);break;case"webreport_top_appsrcbygrp":case"netacc_top_clients_by_group":case"netacc_top_servers_by_group":e=[],f={},app.appgroups&&($H(app.appgroups).sortBy(function(a){return a.key.toLowerCase()}).each(function(a){var b=a[0];e.push(b),f[b]=b}),g=new core.dropdown({values:e,labels:f,value:b,id:"filterbox_el",style:{width:"150px"}}),d=g.htmlElement);break;case"top_users_by_blocked_category":case"top_domains_by_blocked_category":e=[],f={};var h=$H(config.mappings.sp_category_map);this.options.spvals.each(function(a){var b=parseInt(a.substring(9),10);e.push(b),f[b]=h[a]}),g=new core.dropdown({values:e,labels:f,value:b,id:"filterbox_el",style:{width:"150px"}}),d=g.htmlElement;break;case"vpnreport_top_connections_by_service":case"vpnreport_top_failed_connections_by_service":case"vpnreport_top_current_connections_by_service":e=[],f=[],c.options.spvals.each(function(a){e.push(a),f[a]=a}),g=new core.dropdown({values:e,labels:f,value:b,id:"filterbox_el",style:{width:"150px"}}),d=g.htmlElement;break;default:d=domInput({padding:"2px",margin:"0px",fontSize:"12px",border:"1px solid #aaaaaa",backgroundColor:"#ffffff",width:"150px"},{type:"text",id:"filterbox_el",value:b},{})}return d},getFilterValue:function(){var a=this,b="";switch(this.filter_type_current){case"top_users_by_blocked_category":case"top_domains_by_blocked_category":b=this.typeFilterBox.getValue(),b=="__pleaseselect"&&(b="");break;default:b=this.typeFilterBox.value}return b},drilldown:function(a,b){var c=this,d="";this.options.optionGroups&&this.options.optionGroups.length!==0?d=this.typeDropdown.getValues().indexOf(a):d=this.options.call_values.indexOf(a),this.typeDropdown.setValue(d),this.changeType(b),this.updateFilters(c)},_fill:function(){var a=this;this.options.data.reporting_result.resultset?this.options.data.reporting_result.resultset.each(function(b,c){a._webreport_lines(b)}):a.itemBox.firstChild.appendChild(domTr(domTd({},{},{},domSpan({},{},{},_LOC("xveQIgrxfM","No entries found.")))))},showFlash:function(){var a=[],b=this.options.data.reporting_result.resultset,c=this.options.data.reporting_result.column_names,d=0,e,f,g,h=b.length;this.chartActive=!0,this.chartBox=$(this.chartBox),this.chartBox.show();for(;d<h;d++){e=0,f={},g="";while(e<c.length)f[c[e]]=b[d][e++];g=(new Template(this.options.chart.tip)).evaluate(f),a.push({tip:g,label:b[d][this.options.chart.labelcolumn],value:b[d][this.options.chart.valuecolumn]})}a.length&&(this.chart=chart_init({type:this.options.chart.type,title:this.options.chart.title||"",name:this.options.chart.name,values:a,container:"REPORT_"+this.options.name+"_CHARTCONTAINER",no_resize:!0,onClick:this.options.chart.onClick||null}))},hideFlash:function(){this.chartActive=!1,this.chartBox.hide()},updateFlash:function(){if(this.chart.options.name==this.options.chart.name){var a=[],b=this.options.data.reporting_result.resultset,c=this.options.data.reporting_result.column_names;for(var d=0,e=b.length;d<e;d++){var f=0,g={},h="";while(f<c.length)g[c[f]]=b[d][f++];h=(new Template(this.options.chart.tip)).evaluate(g),a.push({tip:h,label:b[d][this.options.chart.labelcolumn],value:b[d][this.options.chart.valuecolumn]})}this.chart.setValues(a),this.chart.update()}else this.showFlash()},_colorize:function(){var a=this;try{for(var b=2;b<a.itemBox.firstChild.childNodes.length;b++)a.itemBox.firstChild.childNodes[b].style.backgroundColor=a.options.bgcolors[b%2]}catch(c){}},_clear:function(){var a=this;try{for(var b=a.itemBox.firstChild.childNodes.length-1;b>0;b--)a.itemBox.firstChild.removeChild(a.itemBox.firstChild.childNodes[b])}catch(c){}},_calcPageInfo:function(){var a=this.options.data.reporting.pager.offset,b=0,c=this.options.data.reporting_result.resultset_rows_total;a++,this.options.data.reporting.pager.limit>c?b=c:b=this.options.data.reporting.pager.offset+this.options.data.reporting.pager.limit,c<b&&(b=c),this.pageInfo.removeChild(this.pageInfo.firstChild),this.pageInfo.appendChild(domSpan({},{},{},"Results: "+parseInt(a,10)+"-"+parseInt(b,10)+" of "+parseInt(c,10))),a<=1?(this.prevButton.disable(),input_deactivate(this.prevButton.htmlElement)):(this.prevButton.enable(),input_activate(this.prevButton.htmlElement)),c<=this.options.data.reporting.pager.limit||b==c?(this.nextButton.disable(),input_deactivate(this.nextButton.htmlElement)):(this.nextButton.enable(),input_activate(this.nextButton.htmlElement))},_markAsMissing:function(a,b){b?a.style.borderColor="#ff0000":a.style.borderColor="#aaaaaa"},_webreport_captions:function(){var a=this,b=[];this.options.data.reporting_result.column_names.each(function(c,d){var e=a.options.caption_map[c],f=null,g=null,h=e.orderfield!=="",i="";!e.viewable||(h?(a.options.data.reporting.orderby==e.orderfield+" ASC"?f=domImg({border:"0px",paddingLeft:"5px"},{src:"core/img/icons/sort_asc.png",width:16,height:16},{}):a.options.data.reporting.orderby==e.orderfield+" DESC"&&(f=domImg({border:"1px",paddingLeft:"5px"},{src:"core/img/icons/sort_desc.png",width:16,height:16},{})),g=function(){a.orderby(e.orderfield)}):g=function(){return},b.push(domTd({padding:"2px",fontWeight:"bold",cursor:h?"pointer":"",width:e.width||""},{align:d<=1?"left":e.alignment||"center",valign:"middle"},{},domTableRow([domTd({},{},{onclick:g},Builder.node("span",{className:e.ellipsis?"ellipsis":"",title:e.caption},e.caption)),domTd({},{},{onclick:g},f!==null?f:domSpan({},{},{},""))]))))}),a.itemBox.firstChild.appendChild(domTr(b,{},{className:"REPORTING_itembox_tablehead width_hundred_percent"}))},_webreport_totals:function(){var a=this,b=this.options.data.reporting_result,c=a.options.caption_map;if(!!b&&!!b.result_totals){var d=[];b.column_names.each(function(e,f){var g=c[e];if(g.viewable){var h="";g.totals?h=""+b.result_totals[f]:f==a.options.totals_string_column?h=_LOC("fixrhTxpIH","Totals"):h="&nbsp;",d.push(domTd({textAlign:g.alignment||"",width:g.width||""},{className:"REPORTING_itembox_totals"},{},domSpan({},{},{},h)))}}),this.itemBox.firstChild.appendChild(domTr(d,{color:"#ffffff"},{className:"width_hundred_percent"}))}},_webreport_lines:function(a){var b=this,c=[],d=this.options.data.reporting_result.column_names;d.each(function(e,f){var g=b.options.caption_map[e],h=a[f],i="";if(!!g.viewable){var j="";if(g.img){var k=h.toLowerCase();k!="unknown"&&k!="lan"&&(config.mappings.countries[k]?k=config.mappings.countries[k]:k="unknown"),j=domImg({width:"20px",height:"13px"},{src:b.options.image_path+h.toLowerCase()+".png",title:k},{})}else{var l=!1,m=b.typeDropdown.getValue();m=="undefined"&&(m=b.options.click_default),b.options.call_map[m].drilldown&&b.options.call_map[m].drilldown[e]&&(l=function(){core.reportMap[b.options.name].drilldown(b.options.call_map[m].drilldown[e],h)});var n="";if(/_per$/.exec(e))n=parseFloat(h).toFixed(2);else if(e=="src_host"||e=="dst_host")h=="NXDOMAIN"||h=="RESOLVING"?n=config.mappings.resolver[h]:n=h;else{n=h;if(g.softhyphen){var o=new RegExp("("+g.softhyphen+")","gi");n=n.replace(o,"$1&shy;")}}i=n,g.help&&g.help!=="undefined"&&(i+=" ("+a[d.indexOf(g.help)]+")"),j=domDiv({cursor:l?"pointer":"auto"},{className:g.ellipsis?"ellipsis":""},{onclick:l},Builder.node("span",{className:g.ellipsis?"ellipsis":"",title:i},""+n))}c.push(domTd({textAlign:g.alignment||"",width:g.width||"",maxWidth:g.maxWidth||"",overflow:g.ellipsis?"hidden":"visible",padding:"2px",height:"21px"},{},{},j))}}),b.itemBox.firstChild.appendChild(domTr(c,{},{className:"width_hundred_percent"}))},downloadReport:function(a){var b=this,c=b.options;c.data.reporting.format=a,c.data.reporting._async=1,c=b.options;var d={objs:[{FID:c.download_fid,options:c}]};req_send(d)}},Ajax.RequestQueue=Class.create(),Ajax.RequestQueue.prototype={_reqExtension:{SID:SID,browser:browser,backend_version:-1,loc:loc,_cookie:_cookie,wdebug:wdebug,RID:""},_reqWrapper:{waiting:!0,request:{},retry:0,done:!1,current:!1,timeoutId:null,pending:!1},config:{url:"webadmin.plx",timeoutMS:config.json_timeout,maxHistorySize:10,pendingRequests:config.pendingRequests},_normalQueue:[],_prioQueue:[],_requestHistory:[],_currentRequest:{},_xhr:null,started:!1,savedRequest:{},pendingTimer:!1,initialize:function(){},add:function(a,b){Object.extend(a,this._reqExtension),a.RID=(new Date).getTime()+"_"+Math.random(),a.loc=loc,a.SID=SID,a._cookie=_cookie,a.backend_version=backend_version,a.current_uuid=core.display_current,a.ipv6=core.ipv6;var c=Object.clone(this._reqWrapper);c.request=a,a.objs&&a.objs[0].FID=="pending"&&(c.pending=!0),b?this._prioQueue.push(c):this._normalQueue.push(c);return this},start:function(){this._currentRequest&&this._currentRequest.pending&&(this._xhr.transport.abort(),this.started=!1,window.clearTimeout(this._currentRequest.timeoutId)),this.started||(this.started=!0,this.next())},next:function(){if(this._xhr&&this.inProgress())_debug("next inProgress");else{if(this._prioQueue.length>0)this._currentRequest=this._prioQueue.first(),this._prioQueue.shift();else if(this._normalQueue.length>0)this._currentRequest=this._normalQueue.first(),this._normalQueue.shift();else{this.started=!1,this.config.pendingRequests&&(this.pendingTimer=window.setTimeout(function(){call_fid("pending")},50));return!1}this.pendingTimer&&(window.clearTimeout(this.pendingTimer),this.pendingTimer=!1);var a=this._currentRequest.request.objs[0].FID||"";a&&_debug("backend-rpc: func_"+a),this._currentRequest.waiting=!1,this._currentRequest.current=!0,this._currentRequest.timeoutId&&(window.clearTimeout(this._currentRequest.timeoutId),this._currentRequest.timeoutId=null),this._currentRequest.timeoutId=window.setTimeout(function(){!this._currentRequest.pending&&this.inProgress()&&this.cancelCurrentRequestConfirmUser(),this._currentRequest.pending&&(window.clearTimeout(this.pendingTimer),this._xhr.transport.abort(),this.pendingTimer=window.setTimeout(function(){call_fid("pending")},500))}.bind(this),this.config.timeoutMS),this._xhr=new Ajax.Request(this.config.url,{method:"post",evalJSON:!0,contentType:"application/json",encoding:"UTF-8",postBody:Object.toJSON(this._currentRequest.request),requestHeaders:{"X-FCGI-Session":_cookie},fid:a,onSuccess:function(a){this.cancelTimeoutPopup(this._currentRequest),a.responseJSON?response=a.responseJSON:response=a.responseText.evalJSON();try{this._processResponse(response)}catch(b){_debug(b)}}.bind(this),onFailure:function(a){this.cancelTimeoutPopup(this._currentRequest);var b=this._xhr.options.fid||"";b!=="logout"&&alert(a.statusText)}.bind(this)})}},cancelTimeoutPopup:function(a){a.timeoutId&&(window.clearTimeout(a.timeoutId),a.timeoutId=null),a.iPopup&&(interactionPopup({iPopup:a.iPopup}),a.iPopup=null)},_processResponse:function(response){this._processGlobals(response),response.currentRequest||(response.currentRequest=Object.clone(this._currentRequest));if(response.cache_rebuild)response.cache_rebuild=!1,this.savedRequest=response,this.savedCurrentRequest=this._currentRequest,this._currentRequest.request.objs&&this._currentRequest.request.objs.each(function(a,b){typeof a.callback=="function"&&(this.savedRequest.objs[b].callback=a.callback)}.bind(this)),cache_rebuild(response);else{if(typeof response.js=="string")try{eval(response.js)}catch(e){_debug('Could not evaluate "'+response.js.toString()+'": '+e)}response.objs&&response.objs.each(function(obj,index){obj.nots&&obj.nots==1&&(obj.callback=last_view),this._processGlobals(obj);var target=!1;if(obj.target&&typeof obj.target=="object"&&obj.target.length&&typeof obj.target!="string"){for(var t=0;t<obj.target.length;t++)target=$(obj.target[t]),target&&(target.innerHTML=obj.html[t]),obj.autohide&&obj.autohide[t]&&auto_hide_element(obj.autohide[t]);core.Events.fire("ajax:html_changed")}else target=$(obj.target),target&&(target.innerHTML=obj.html,core.Events.fire("ajax:html_changed")),obj.autohide&&auto_hide_element(obj.autohide);if(typeof obj.js=="string")try{eval(obj.js)}catch(e){_debug('Could not evaluate "'+obj.js.toString()+'": '+e)}obj.alert&&alert(obj.alert);var current=response.currentRequest;if(current&&current.request&&current.request.objs[index]&&typeof current.request.objs[index].callback=="function")current.request.objs[index].callback(obj);else if(obj.callback&&typeof obj.callback=="string")try{eval(obj.callback+"(obj);")}catch(e){_debug('Could not evaluate "'+obj.callback+'": '+e)}}.bind(this)),response.currentRequest.request.onfinal&&typeof response.currentRequest.request.onfinal=="function"&&response.currentRequest.request.onfinal(),this.started=!1,this._currentRequest.current=!1,this._currentRequest.done=!0,this._requestHistory.push(this._currentRequest),this._requestHistory.length>this.config.maxHistorySize&&this._requestHistory.shift(),response.alert&&alert(response.alert),core.Events.fire("ajax:load")}},_processGlobals:function(response){var j=0,rgl;if(response.globals&&response.globals_data)for(rgl=response.globals.length;j<rgl;j++)eval(response.globals[j]+" = response.globals_data[j];")},continueSavedRequest:function(){this.savedRequest&&this._processResponse(this.savedRequest)},cancelCurrentRequestConfirmUser:function(){window.clearTimeout(this._currentRequest.timeoutId),this._currentRequest.timeoutId=null;var a=Builder.node("span");a.innerHTML=(new Template(_LOC("SKhndbnDbB","No, give it another __seconds__ seconds to finish."),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/)).evaluate({seconds:"<b>"+Math.round(this.config.timeoutMS/1e3)+"</b>"});var b=[{label:_LOC("xHdXVmkzkd","Yes"),exec:this.retryCurrentRequest.bind(this),"default":!0},{label:_LOC("BjBJtpRsvG","No"),exec:this.cancelCurrentRequest.bindAsEventListener(this)}],c=(new Template(_LOC("uItSTcgaTV","Do you want to wait __seconds__ more seconds to finish the request?"),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/)).evaluate({seconds:"<b>"+Math.round(this.config.timeoutMS/1e3)+"</b>"});this._currentRequest.retry>0&&(c+="<br /><br />"+(new Template(_LOC("UekJaaQkUP","You extended the timeout __times__ times."),/(^|.|\r|\n)(\__\s*(\w+)\s*__)/)).evaluate({times:this._currentRequest.retry})),this._currentRequest.request.elements&&(c+="<br /><br />"+_LOC("ALLjsxztCz","The request is changing the configuration, and this might not be stopped when you abort now.")),this._currentRequest.iPopup||(this._currentRequest.iPopup=interactionPopup({open:!0,text:c,buttons:b})),this._currentRequest.retry++;return!0},retryCurrentRequest:function(){this._currentRequest.iPopup=null,this._currentRequest.timeoutId=window.setTimeout(function(){this.inProgress()&&this.cancelCurrentRequestConfirmUser()}.bind(this),this.config.timeoutMS)},cancelCurrentRequest:function(a,b){_debug("aborting request"),this.started=!1,this._xhr.transport.abort(),this._currentRequest.iPopup=null,a&&Event.stop(a),b||alert(_LOC("KDLSvzLPDU","Request has been stopped.")),this.add({terminate:1},!0),this.next()},abortXHR:function(){_debug("aborting xhr-object"),this._xhr={},this.started=!1,this._currentRequest.iPopup&&interactionPopup({iPopup:this._currentRequest.iPopup}),this._currentRequest.timeoutId&&window.clearTimeout(this._currentRequest.timeoutId),this._currentRequest={}},inProgress:function(){switch(this._xhr.transport.readyState){case 1:case 2:case 3:return!0;case 4:return!1}},observe:function(a,b){this.observers||(this.observers={load:[],HTMLChanged:[]}),this.observers[a]?this.observers[a].push(b):_debug("Event "+a+" is currently not supported in AjaxReqQueue.")},notify:function(a){this.observers&&this.observers[a]&&this.observers[a].length&&(this.observers[a].each(function(a){a()}),_debug("Event "+a+" processed."))}},Ajax.Responders.register({onCreate:function(a){var b=$("throbber");b&&(AjaxReqQueue._currentRequest.pending?$("throbber_fake")&&($("throbber_active").style.zIndex=9,$("throbber_fake").style.zIndex=10):($("throbber_fake")&&($("throbber_fake").style.zIndex=9),b.className="throbber_active"),b.is_active=!0,b.onclick=function(){AjaxReqQueue.cancelCurrentRequest()}),AjaxReqQueue._currentRequest.request.background||(document.body.style.cursor="progress")},onComplete:function(a){var b=$("throbber"),c=$("throbber_fake");b&&b.is_active&&(AjaxReqQueue._currentRequest.pending&&c&&(c.style.zIndex=9),b.className="throbber_still",b.is_active=!1,b.onclick=function(){}),AjaxReqQueue._currentRequest.request.background||(document.body.style.cursor=""),AjaxReqQueue.next()}});var AjaxReqQueue=new Ajax.RequestQueue;core.Events.observe("ajax:html_changed",function(){document.getElementsByClassName("TOGGLE_FIELDSET").each(function(a){core.tools.toggleFieldset({anchor:a,target:$(a.getAttribute("target")),dflt:$(a).getAttribute("dflt")||"toggled",forcedflt:$(a).getAttribute("forcedflt")==="1"})}),document.getElementsByClassName("inline_link").each(function(a){var b=a.getAttribute("path"),c=a.getAttribute("notext")||!1;b&&core.menu.makeLink(b.split("/"),a,c)})});var saved_req=!1,webadmin_timeout=!1,webadmin_timeout_handle=!1;config&&!config.json_timeout&&(config.json_timeout=1e4);var logout_timeout=!1;Event.observe(window,"beforeunload",function(){core.openedWindows.length>0&&core.openedWindows.each(function(a,b){a.close()})}),core.cache={Methods:{getMeta:function(){if(core.meta_objects&&core.meta_objects[this["class"]][this.type])return core.meta_objects[this["class"]][this.type];return{}},clone:function(){var a=this.getMeta(),b=Object.clone(this);b.data=Object.clone(this.data),b.data.each(function(b){a[b.key]&&a[b.key]._delete_with_parent&&(this.data[b.key]=null)}.bind(b));return b}}},function(a){function p(a,b,c,d){var e=l(a);e&&c&&(e=l(e.data[c]));return e?e.data[b]:d}function o(a){return l(a).type}function n(a){return l(a)["class"]}function m(a,b){var c=[],f,g=0;if(Object.isArray(a))for(f=a.length;g<f;)c[g]=d[a[g++]];else c=e.collect(function(c,d){var e=l(c);if(e["class"]!=a)return null;return b?b.indexOf(e.type)>=0?e:null:e});return c.filter(function(a){return a})}function l(a){_.isString(a)||console.warn("get_object: wrong ref format: "+a);var b=d[a];b||console.warn("get_object: object "+a+" not found");return b}function k(c){function n(a,b){a==j.delete_object&&e.splice(b,1)}var f=!1,g=b.length,i=0,j,k,m;c||(b=a.backend_objects_update,g=b.length);for(;i<g;){j=b[i++],k=j.ref;if(j.delete_object){m=l(j.delete_object),m&&!c&&dnd_remove(m),delete d[j.delete_object],e.each(n);continue}d[k]?(d[k]=$H(Object.extend(j,h)),d[k].data=$H(d[k].data)):(e.push(k),d[k]=$H(Object.extend(j,h)),d[k].data=$H(d[k].data),f=!0,c||dnd_add(j,!0)),c||dnd_update(j)}f&&!c&&(e=object_sort_ref(e)),b=!1,a.backend_objects=d,a.backend_object_refs=e}function j(){e=[],d={},d.filter=function(a){var b=[];$H(this).each(function(c){a(c.value)&&b.push(c.key)}.bind(this));return b}.bind(d),b&&(k(!0),dnd_setup=!1)}function i(a){b=!1,j(),f=0,input_deactivate("display"),g({left:a})}"use strict";var b=!1,c=-1,d={},e=[],f=0,g,h={getMeta:function(){if(core.meta_objects&&core.meta_objects[this["class"]][this.type])return core.meta_objects[this["class"]][this.type];return{}},clone:function(){var a=this.getMeta(),b=Object.clone(this);b.data=Object.clone(this.data),b.data.each(function(b){a[b.key]&&a[b.key]._delete_with_parent&&(this.data[b.key]=null)}.bind(b));return b}};g=function(){var a=_LOC("wCxnkVHJOr","Please wait, caching objects.")+"<br>",c="% "+_LOC("xhzQvKnoFl","done."),d={objs:[{FID:"cache_rebuild_fetch",skip_wait:!0,callback:"cache_rebuild_loop"}]};return function(e){var g,h=0;if(e){e.objects&&(b=e.objects,k(!0));if(e.left){g=++f+e.left,f>1?h=f/(g/100):h=1,wait_popup(!0,a+Math.floor(h)+c,Math.floor(h)),req_send(d,!0);return}}wait_popup(!1),dnd_setup=!1,input_activate("display"),AjaxReqQueue.continueSavedRequest()}}(),a.backend_objects_update=b,a.backend_version=c,a.backend_objects=d,a.backend_object_refs=e,a.cache_rebuild_trips=f,a.cache_rebuild=i,a.cache_rebuild_loop=g,a.cache_flush=j,a.cache_update=k,a.get_object=l,a.get_objects=m,a.get_class=n,a.get_type=o,a.get_data=p}(window),core.upload=Class.create(),core.upload.prototype=function(){function checkExtension(a,b){var c=!1;a.each(function(a){c=c||b.toLowerCase().indexOf("."+a.toLowerCase())>0});return c}"use strict";return{initialize:function(a){var b;this.options=Object.extend({width:153},a||{}),this.filename=!1,this.filenameContainer=domDiv({width:this.options.width-20+"px"},{className:"UPLOAD_container"},{}),this.folderIcon=domImg({},{src:"core/img/blank1x1.gif",title:_LOC("zCmgEjCmrp","Browse..."),className:"UPLOAD_foldericon"},{}),this.htmlElement=domTableRow([domTd({},{},{},this.filenameContainer),domTd({paddingLeft:"4px",cursor:"pointer"},{},{onclick:function(){this.openPopup()}.bind(this)},this.folderIcon)]),this.htmlElement.self=this,a.filename?this.setFilename(a.filename):a.placeholder&&(b=domSpan({fontWeight:"500",paddingLeft:"16px",backgroundImage:"url(core/img/icons/check_small.png)",backgroundRepeat:"no-repeat"},{},{}),b.innerHTML=a.placeholder,this.filenameContainer.appendChild(b));return this},setFilename:function(filename){this.filenameContainer.innerHTML=filename,this.filename=filename,this.options.onchange&&(typeof this.options.onchange=="function"?this.options.onchange(filename):eval(this.options.onchange))},getValue:function(){return this.filename||""},openPopup:function(){function b(a){var b=Builder.node("ul");$H(a).each(function(a){b.appendChild(Builder.node("li",a.key+": "+a.value))});return b}function a(b){try{$("upload_"+this.uploadId).contentDocument&&(this.inputElement=$("upload_"+this.uploadId).contentDocument.getElementById("FILE")),this.inputElement?b():window.setTimeout(a.curry(b).bind(this),10)}catch(c){window.setTimeout(a.curry(b).bind(this),10)}}return function(){this.uploadId=rand_string(10),this.popup=new core.popup({name:"POPUP_UPLOAD_"+this.options.name,"class":"upload",anchor:this.folderIcon,update_type:"upload",update_name:this.options.name,upload_id:this.uploadId,modal:!0}),window.setTimeout(a.curry(function(){Event.observe(this.inputElement,"change",function(){var a=core.formMap["FORM_POPUP_UPLOAD_"+this.options.name],c=a.elements.info;this.options.showLicenseDetails&&(c.update(),this.licenseDetailsReader=getLicenseDetails(this.inputElement,function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=[];d=a.getLicenseInfo(),e=a.getLicenseOptions(),f=a.getNetSec(),g=a.getWebSec(),h=a.getMailSec(),i=a.getWebAppSec(),k=a.getWireless(),l=a.getSandstorm(),m=a.getEndpoint(),j=a.getBasicGuard(),o=a.getPremSupp(),n=a.getStdSupp(),p=a.getAma(),d!=={}&&d.Owner&&(c.appendChild(Builder.node("h3",_LOC("FBDcAxYLFY","License Information"))),c.appendChild(b(d)),c.appendChild(Builder.node("h3",_LOC("jkXbHOkMks","License Options"))),c.appendChild(b(e)),[{name:_LOC("EzgKYWpUVA","Network Protection"),value:f},{name:_LOC("rsbThViscA","Web Protection"),value:g},{name:_LOC("BuPMXPuXVA","Email Protection"),value:h},{name:_LOC("UlfEPDouzY","Webserver Protection"),value:i},{name:_LOC("ETpIqvDAzy","Wireless Protection"),value:k},{name:"Sandstorm",value:l},{name:_LOC("mXlDxbzfFu","Endpoint Protection"),value:m},{name:_LOC("XmwAEjFqYF","BasicGuard"),value:j},{name:_LOC("sPTguEoaOr","Premium Support"),value:o},{name:_LOC("yXbIFJmNlV","Standard Support"),value:n},{name:_LOC("OUTytcDzcF","AMA"),value:p}].each(function(a){a.value&&a.value.Start&&a.value.Stop&&q.push(Builder.node("tr",[Builder.node("td",a.name),Builder.node("td",a.value.Start),Builder.node("td",{style:new Date(a.value.Stop)<new Date?"color:red":""},a.value.Stop)]))}),q.length&&c.appendChild(Builder.node("table",Builder.node("tbody",q))))}))}.bind(this))}.bind(this)).bind(this),10)}}()}}();var update_progress_request=function(){function a(a,b){var c=core.uploadMap[a];b==="Failure"?alert(_LOC("vEFDimVfln","Upload failed. Either you did not select a file or the file you selected cannot be read.")):c.setFilename(b),c.popup.close()}"use strict";return function(b){var c=core.uploadMap[b],d,e;req_send({objs:[{FID:"upload_progress",callback:function(b){var c=core.uploadMap[b.upload_name],f=$("upload_bar_"+c.uploadId),g=$("upload_text_"+c.uploadId),h,i;if(b.progress){/^([0-9]+):(.*?)$/.exec(b.progress),d=RegExp.$1,e=RegExp.$2,h=b.progress.split(":");if(e){f&&(f.style.width=d*4+"px",g.innerHTML=e);if(parseInt(d)===100){a(b.upload_name,e);return}}}i=window.setTimeout(update_progress_request.curry(b.upload_name),1e3)},upload_name:b,upload_id:c.uploadId}]})}}(),menu,linkToTab=!1,linkToTabNo=0,loadTabCallback=null,loadTabOptions=!1;window.tempfunctions=[],core.menu={config:{searchboxEmptyText:_LOC("qEiBgscSZG","search"),style:{htmlElement:"width:189px;vertical-align:top;",mainUL:"border:0px;padding:0px;margin:0px;"},activateFirstSub:!0,maxObjectsSearchResult:10},items:new Hash,create:function(a){this.options=Object.extend({data:[]},a||{}),this.uuid2item={},this.options.data.each(function(a){var b=new core.menu.item(a),c,d,e,f;a.name?this.items[a.name]=b:a.caption&&(this.items[a.caption]=b),a.helpuuid&&(this.uuid2item[a.helpuuid]=[a.name||a.caption]);if(a.submenu){c=a.submenu.length;while(c--){d=a.submenu[c],d.helpuuid&&(this.uuid2item[d.helpuuid]=[a.name||a.caption,d.name||d.caption]);if(d.tabset&&d.tabset.tabs){e=d.tabset.tabs.length;while(e--)f=d.tabset.tabs[e],f.helpuuid&&(this.uuid2item[f.helpuuid]=[a.name||a.caption,d.name||d.caption,f.name||f.caption])}}}}.bind(this)),this.hist=new core.menu.history,this.eventListeners={listeners:{},execute:function(a){this.listeners[a]&&this.listeners[a].each(function(a){a.once===-1&&(a.fnc(),a.once--),a.once===0&&a.fnc()})}}},addListener:function(a,b,c){a=a.toLowerCase();if(!this.eventListeners)return!1;this.eventListeners.listeners[a]||(this.eventListeners.listeners[a]=[]),this.eventListeners.listeners[a].push({fnc:b,once:c?-1:0})},link:function(){var a=$A(arguments),b,c;Object.isArray(a[0])&&(a=a[0]),this.closeAll(),b=this.items[a[0]],b&&(b.items&&a[1]?b.openSub():b.onClick(),a[1]&&b.items&&b.items[a[1]]?(a[2]&&b.items[a[1]].options.tabset&&b.items[a[1]].options.tabset.tabs&&b.items[a[1]].options.tabset.tabs.each(function(b,c){if(b.name==a[2]){linkToTab=!0,linkToTabNo=c;if(a[3])if(typeof a[3]=="function"){var d=window.tempfunctions.length;loadTabCallback="window.tempfunctions["+d+"]",window.tempfunctions[d]=function(){a[3](),window.tempfunctions[d]=Prototype.emptyFunction}}else loadTabOptions=a[3]}}.bind(this)),b.items[a[1]].onClick()):a[1]&&a[2]&&b.options&&b.options.tabset&&b.options.tabset.name==a[1]&&b.options.tabset.tabs&&b.options.tabset.tabs.each(function(b,c){if(b.name==a[2]){linkToTab=!0,linkToTabNo=c;if(a[3])if(typeof a[3]=="function"){var d=window.tempfunctions.length;loadTabCallback="window.tempfunctions["+d+"]",window.tempfunctions[d]=function(){a[3](),window.tempfunctions[d]=Prototype.emptyFunction}}else loadTabOptions=a[3]}}.bind(this)))},makeLink:function(a,b,c){var d=[],e=this.items[a[0]],f,g;b=$(b);if(e){d[0]=e.options.caption;if(a[1]&&e.items&&e.items[a[1]]){e=e.items[a[1]],d[1]=e.options.caption;if(a[2]&&e.options.tabset&&e.options.tabset.tabs){f=e.options.tabset.tabs,g=f.length;while(g--)f[g].name==a[2]&&(d[2]=f[g].caption)}}else if(a[1]&&e.options&&e.options.tabset&&e.options.tabset.name==a[1]&&e.options.tabset.tabs&&a[2]){f=e.options.tabset.tabs,g=f.length;while(g--)f[g].name==a[2]&&(d[1]=f[g].caption)}}c||(b.innerHTML=d.join(" &gt; ")),Event.observe(b,"click",core.menu.link.curry(a).bind(this));return b},action:function(a){!a&&core.menu.config.activateFirstSub&&(a=this.options.data[0].name),this.items[a]&&(this.lastActive=this.items[a],this.closeAll(),this.items[a].openSub(),this.items[a].onClick())},toHTML:function(){this.htmlElement=Builder.node("div",{style:this.config.style.htmlElement}),this.searchbox=Builder.node("input",{id:"ELEMENT_SEARCHBOX",type:"text",className:"menu_searchbox",value:this.config.searchboxEmptyText}),$(this.searchbox).observe("focus",function(){$(this.searchbox).value===this.config.searchboxEmptyText&&($(this.searchbox).value="",$(this.searchboxResetButton).show())}.bind(this)),$(this.searchbox).observe("blur",function(){$(this.searchbox).value===""&&($(this.searchbox).value=this.config.searchboxEmptyText,$(this.searchboxResetButton).hide())}.bind(this)),$(this.searchbox).observe("keyup",this.filter.bind(this)),this.searchboxResetButton=Builder.node("img",{className:"menu_searchbox_ResetButton",alt:"Reset Menu",title:"Reset Menu",src:"core/img/blank1x1.gif"}),$(this.searchboxResetButton).observe("click",function(){this.unfilter(),$(this.searchboxResetButton).hide(),$(this.searchbox).value=this.config.searchboxEmptyText}.bind(this)),this.htmlElement.appendChild(Builder.node("div",{className:"menu_searchbox_Container"},[this.searchbox,this.searchboxResetButton])),$(this.searchboxResetButton).hide(),this.mainUL=Builder.node("ul",{style:this.config.style.mainUL}),this.items.each(function(a){this.mainUL.appendChild(a.value.toHTML())}.bind(this)),this.objectsUl=Builder.node("ul",{className:"menu_sub_item menu_objects"}),this.objectsItem=$(Builder.node("li",{className:"menu_main_item",id:"FoundObjects"},[Builder.node("div",{className:"menu_main_text"},_LOC("QVXxteObjT","Objects found")),[this.objectsUl,Builder.node("ul",{className:"menu_sub_item"})]])),this.objectsItem.hide(),this.mainUL.appendChild(this.objectsItem),this.logoutText=Builder.node("div",{className:"menu_main_text ellipsis"},_LOC("pWmboMkIub","Log off")),this.logoutItem=Builder.node("li",{className:"menu_main_item",id:"LogOff"},this.logoutText),Event.observe(this.logoutItem,"click",logout),this.mainUL.appendChild(this.logoutItem),this.htmlElement.appendChild(this.mainUL);return this.htmlElement},filter:function(){function i(a){a=a.value,a.options.caption.toLowerCase().indexOf(b)<0&&!(a.options.tags&&a.options.tags.toLowerCase().indexOf(b)>=0)?a.filterSub(b)?(a.htmlElement.show(),a.showSub()):(a.htmlElement.hide(),a.hideSub()):(a.filterSub(b),a.htmlElement.show(),a.showSub())}function h(b){var c=b.ref,d;a[c]||(d=get_icon(c),a[c]=oElement=Builder.node("li",{className:"menu_sub_item"},Builder.node("div",{style:"display:block;",className:"menu_sub_text ellipsis",title:b["class"]+"->"+b.type+": "+b.data.name},[d?Builder.node("img",{src:d,align:"left",style:"margin-right:3px;"}):"",b.data.name])),Event.observe(oElement,"click",e.curry(this,b)),Event.observe(oElement,"mouseover",f.bind(oElement)),Event.observe(oElement,"mouseout",g.bind(oElement))),this.objectsUl.appendChild(a[c])}function g(){this.down().className="menu_sub_text ellipsis"}function f(){this.down().className="menu_sub_text_hover ellipsis"}function e(a,b){var c=a.objToMenu(b);c&&core.menu.link.apply(core.menu,c)}var a={},b,c,d,j=function(){function c(e,f,g){var i,j=0,k=backend_objects,l=f+"->"+g+":"+e,m=backend_object_refs,n=m.length;for(;j<100;j++){if(b>=n){a[l].finished=!0;break}i=k[m[b++]];if(typeof i=="function"||!i.data||i.hidden)continue;if(f&&i["class"]!==f)continue;if(g&&i.type!==g)continue;i.data.name&&(i.data.name.toLowerCase().indexOf(e)>-1||i.data.comment.toLowerCase().indexOf(e)>-1)&&(h.apply(this,[i]),a[l].objs.push(i))}a[l].objs.length?this.objectsItem.show():this.objectsItem.hide(),b<n&&(d=window.setTimeout(c.curry(e,f,g).bind(this),1))}var a={},b=0;return function(e,f,g,i){var j=g+"->"+i+":"+e,k=a[j],l;f=f||0,b=0,d&&(window.clearTimeout(d),b=0);if(e)if(!a[j]||!a[j].finished)a[j]=a[j]||{objs:[],from:f||0},d=window.setTimeout(c.curry(e,g,i).bind(this),1);else{l=a[j].objs.length;while(l--)h.apply(this,[a[j].objs[l]]);l&&this.objectsItem.show()}else this.objectsItem.hide()}}();return function(){var a,c,e;b=this.searchbox.value.toLowerCase();b.charCodeAt(0)<48?(b="",this.searchbox.value=""):b?this.items.each(i.bind(this)):(d&&(window.clearTimeout(d),idx_ref=0),this.unfilter())}}(),objToMenu:function(){function b(b){var c="Object:"+b["class"],d="Object:"+b["class"]+"->"+b.type;if(!a[d]){if(!a[c]){_debug(d+" not found in mapping");return!1}return a[c]}return a[d]}var a=config.mappings.path_to_uuid;return function(a){var c=b(a);if(!c)return!1;return this.uuid2item[c]}}(),unfilter:function(){this.objectsItem.hide(),this.items.each(function(a){a.value.htmlElement.show(),a.value.unfilterSub(),a.value.hideSub()}),this.lastActive.showSub(),this.lastActive.options.parent&&this.items[this.lastActive.options.parent].showSub(),this.lastActive.activate()},closeAll:function(){this.items.each(function(a){a.value.closeSub()}.bind(this))},activateID:function(a){this.items[a]&&this.items[a].activate()}},core.menu.item=Class.create(),core.menu.item.prototype={initialize:function(a){this.options=Object.extend({name:"",fid:"",url:"",is_open:0,caption:"",helpuuid:"",classNames:{li:"menu_main_item",text:"ellipsis menu_main_text"},parent:null},a||{}),this.options.livelog&&(this.livelog=this.options.livelog),this.options.submenu&&(this.items=new Hash,this.options.submenu.each(function(a){a.parent=this.options.name||this.options.caption,a.classNames={li:"menu_sub_item",text:"ellipsis menu_sub_text"},a.livelog=a.livelog||this.livelog,a.name?this.items[a.name]=new core.menu.item(a):this.items[a.caption]=new core.menu.item(a)}.bind(this)))},toHTML:function(){this.htmlElement=Builder.node("li",{id:this.options.name||this.options.caption,className:this.options.classNames.li}),this.textElement=Builder.node("div",{className:this.options.classNames.text+(this.options.is_open?"_active":""),style:"display:block;",title:core.tools.htmlEntityDecode(this.options.caption)}),this.textElement.innerHTML=this.options.caption,this.htmlElement.appendChild(this.textElement),Event.observe(this.htmlElement,"click",this.onClick.bindAsEventListener(this)),this.items&&(this.subUL=Builder.node("ul",{className:"menu_sub_item",style:"display:none;"}),this.items.each(function(a){this.subUL.appendChild(a.value.toHTML())}.bind(this)),this.htmlElement.appendChild(this.subUL));return this.htmlElement},onClick:function(a){var b=[],c=!1;core.menu.noHist||(this.options.parent&&b.push(this.options.parent),b.push(this.options.name),core.menu.hist.push(b)),a&&Event.stop(a),core.menu.eventListeners.execute("click"),core.menu.lastActive=this,update_online_help_link(this.options.helpuuid||0),call_fid("update_user_location"),app.GlobalLivelog&&app.Livelog.setCurrentLiveLog(this.options.livelog),core.menu.config.activateFirstSub&&(this.options.fid||(this.options.area&&!this.options.area.fid&&(c=!0),this.options.area||(c=!0)));if(!this.options.parent&&!this.options.is_open&&!this.options.url){core.menu.closeAll(),this.openSub();if(this.items&&c){this.items.each(function(a,b){if(!b){a.value.onClick();throw $break}});return}}this.options.parent&&!this.options.is_open&&(this.deactivateSubs(),this.activate());if(!this.options.parent&&this.options.is_open){this.items&&this.items.each(function(a){a.value.deactivate()}.bind(this));if(this.items&&c){this.items.each(function(a,b){if(!b){a.value.onClick();throw $break}});return}}this.options.parent&&this.options.is_open&&(this.deactivateSubs(),this.activate()),this.options.tabset||this.options.area?(back_fid=this.options.fid||0,back_entry=this.options,back_caption=this.options.caption,load_panel(this.options.fid||0,this.options.caption||0,this.options.area||0,this.options.tabset||0,this.options.helpuuid||0)):(this.options.fid&&(back_fid=this.options.fid,back_entry=this.options,back_caption=this.options.caption,load_display(this.options.fid,this.options.helpuuid)),this.options.url&&(window.open(this.options.url,"_blank"),window.focus()))},activate:function(){this.options.url||(this.textElement.className=this.options.classNames.text+"_active",this.options.is_open=1,this.is_active=!0,this.options.parent&&core.menu.activateID(this.options.parent))},deactivate:function(){this.textElement.className=this.options.classNames.text,this.options.is_open=0,this.is_active=!1},deactivateSubs:function(){core.menu.items.each(function(a){a.value.deactivate(),a.value.items&&a.value.items.each(function(a){a.value.deactivate()});return}.bind(this))},openSub:function(){this.items&&this.options.is_open!=1&&$(this.subUL).show(),this.activate()},closeSub:function(){this.items&&(this.options.is_open==1&&this.subUL.hide(),this.items.each(function(a){a.value.deactivate()}.bind(this))),this.deactivate()},showSub:function(){this.items&&$(this.subUL).show()},hideSub:function(){this.items&&$(this.subUL).hide()},filterSub:function(a){var b=0;this.items&&(this.items.each(function(c){if(!c.value.options.caption.toLowerCase().include(a.toLowerCase())&&(!c.value.options.tags||!c.value.options.tags.toLowerCase().include(a.toLowerCase()))){var d=!1;c.value.options.tabset&&c.value.options.tabset.tabs&&c.value.options.tabset.tabs.each(function(b){if(b.caption.toLowerCase().include(a.toLowerCase())||b.tags&&b.tags.toLowerCase().include(a.toLowerCase()))d=!0}.bind(this)),d?(c.value.htmlElement.show(),b++):c.value.htmlElement.hide()}else c.value.htmlElement.show(),b++}.bind(this)),b===0&&this.items.each(function(a){a.value.htmlElement.show()}.bind(this)));return b},unfilterSub:function(){this.items&&this.items.each(function(a){a.value.htmlElement.show()}.bind(this))}},core.menu.history=function(){this.history=[],this.current=0,this.historyFrame=Builder.node("iframe",{id:"histifr",style:"visibility:hidden;width:0;height:0;",src:"blank.html?id=0&rnd="+Math.random()}),this.init=!0,Event.observe(this.historyFrame,"load",this.handle.bind(this)),document.body.appendChild(this.historyFrame),this.currentHistoryMarker=-1},core.menu.history.prototype=function(){return{handle:function(){var a=parseInt(this.historyFrame.contentWindow.location.search.replace(/.*id=/gi,""),10),b;a!=this.current&&this.history[a-1]&&(b=this.history[a-1],core.menu.noHist=!0,core.menu.link(b),core.menu.noHist=!1,this.current=a,tabset_update_traffic())},push:function(a){this.current=this.history.push(a),this.historyFrame.src="blank.html?id="+this.current+"&rnd="+Math.random()}}}();var MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];core.calendarPopUp=Class.create(),core.calendarPopUp.prototype={initialize:function(a){var b=this;this.options=a,this.calendarPopupDiv=domDiv({zIndex:9999,visibility:"hidden",backgroundColor:"#ffffff",position:"absolute"},{id:"POPUP_"+this.options.id+"_CALENDAR",name:"POPUP_"+this.options.id+"_CALENDAR"},{});var c=document.getElementsByTagName("body")[0];c.appendChild(this.calendarPopupDiv),this.calendarPopup=new CalendarPopup("POPUP_"+this.options.id+"_CALENDAR"),this.calendarPopup.setCssPrefix(this.options.cssPrefix),this.calendarPopup.hideCalendar(),this.calendarPopup.select($(this.options.input),this.options.anchor,"yyyy-MM-dd"),this.calendarPopup.autohide=1,this.calendarPopup.showYearNavigation(),this.calendarPopup.offsetX=this.options.offsetX,this.calendarPopup.offsetY=this.options.offsetY;return this},show:function(a){var b=this;this.calendarPopup.showCalendar(this.options.anchor)}};var ASE={Browser:{processing:!1,fireEvent:function(a,b,c){var d=$(b);c||(c=10);if(!d&&--c)window.setTimeout(function(){this.fireEvent(a,b,c)}.bind(this),100);else{var e=null;if(document.createEvent){e=document.createEvent("Events"),e.initEvent(a,!0,!0);return d.dispatchEvent(e)}if(document.createEventObject){e=document.createEventObject();return d.fireEvent("on"+a,e)}}},clickElement:function(a){return this.fireEvent("click",a)},executeAfterLoading:function(a,b){var c=window.setInterval(function(){$("testhook")||(window.clearInterval(c),c=null,a())}.bind(this),20)},openMenu:function(){this.processing=!0;var a=$A(arguments);if(a.length>0){var b,c,d="";menu.each(function(e,f){e.caption==a[0]&&(b="menu_main_text_"+f,a.length>1&&e.submenu&&e.submenu.each(function(b,e){b.caption==a[1]&&(c="menu_sub_entry_"+f+"_"+e,a.length>2&&b.tabset&&b.tabset.tabs.each(function(c,e){c.caption==a[2]&&(d="TABSET_"+b.tabset.name+"_TAB_"+e)}))}))}),this.clickElement(b),c&&this.executeAfterLoading(function(){this.clickElement(c),d&&this.executeAfterLoading(function(){this.clickElement(d)}.bind(this))}.bind(this))}this.processing=!1},login:function(a,b){this.processing=!0,this.testhook.add(),$("ELEMENT_login_username").value=a,$("ELEMENT_login_password").value=b,this.clickElement("ELEMENT_login_button"),this.executeAfterLoading(function(){this.processing=!1}.bind(this))},executeAfterProcessing:function(a){if(this.processing)window.setTimeout(function(){this.executeAfterProcessing(a)}.bind(this),1e3);else return a()},executeQueue:function(a){this.queue=a;for(var b=0;b<this.queue.length;b++)this.executeAfterProcessing(this.queue[b])},testhook:{testhookDiv:null,add:function(){if(!$("topbar")){window.setTimeout(this.add.bind(this),100);return!1}try{this.testHookDiv||(this.testHookDiv=document.createElement("div"),this.testHookDiv.id="testhook",this.testHookDiv.style.height="0px",this.testHookDiv.style.border="0px solid black"),$("testhook")||(this.testhookTimeout=window.setTimeout(function(){$("topbar").appendChild(this.testHookDiv),!$("testhook"),this.testhookTimeout=!1}.bind(this),500))}catch(a){_debug(a)}},remove:function(){if(!$("topbar")){window.setTimeout(this.remove.bind(this),100);return!1}try{this.testHookTimeout&&(window.clearTimeout(this.testHookTimeout),this.testHookTimeout=!1),$("testhook")&&$("testhook").remove(),!!$("testhook")}catch(a){_debug(a)}}}}};$("testhook")||ASE.Browser.testhook.add(),core.Chart=function(){var a=["#F0B70C","#EE7F00","#FF470C","#999999","#666666","#333333","#000000","#0072A1","#00A7EE","#F5F5F5","#CCCCCC"];config&&config.globals&&config.globals.colors&&(a=config.globals.colors);return function(b){this.options=Object.extend({title:"title",type:"pie",container:"undefined",colors:a,width:"100%",height:"100%",yAxis:{},xAxis:{}},b||{}),this.init(),this.render()}}(),core.Chart.prototype=function(){function f(a){this.chart.update(a)}function e(){return this.chart.render()}function d(c,d){this.options=Object.extend({width:800,height:250,gutters:{top:20,right:40,bottom:30,left:0},yAxis:{left:{min:0,labels:{text:"#{val}"}}}},c||{}),this.r=d,this.options.height=parseInt(this.options.height,10)-this.options.gutters.bottom,this.options.width=$(this.options.container).getWidth()-this.options.gutters.right,this.lines=[],this.columns=d.set(),this.tip=new b({y:10+this.options.gutters.top},this.r),this.options.title&&a(this.r.text(this.options.width/2,5,this.options.title).attr({"font-size":"13px","font-weight":"bold"}))}function c(a,c){this.options=Object.extend({height:100,container:"",radius:35,values:[],minval:!1},a||{}),this.r=c,this.cy=parseInt(this.options.height,10)/2,this.cx=$(this.options.container).getWidth()/2,this.chart=c.set(),this.controlChart=c.set(),this.tip=new b({y:10,insertBefore:this.controlChart},this.r)}function b(a,b){this.options=Object.extend({borderWidth:1,borderColor:"#e4e4e7",backgroundColor:"#f7f7f7",textColor:"#fff",fontSize:12,radius:10,x:10,y:10,padding:10,insertBefore:!1},a||{}),this.r=b,this.box=this.r.rect(this.options.x,this.options.y,10,10,this.options.radius).hide().attr({stroke:this.options.borderColor,"stroke-width":this.options.borderWidth,fill:this.options.backgroundColor,"fill-opacity":.7}),this.string=this.r.text(this.options.x+this.options.padding,this.options.y+this.options.padding,"").attr({"text-anchor":"start","font-size":this.options.fontSize}),this.inserted=!1,this.shown=!1}function a(a){var b=a.getBBox(),c=Math.abs(b.y2)-Math.abs(b.y)+1;a.attr({y:b.y+c});return b}b.prototype=function(){function e(a){return Raphael.isBBoxIntersect(a,this.box.getBBox())}function d(a){var b=this.box.getBBox(),c=b.x,d=b.x2;return a<=d&&a>=c}function c(){this.string.hide(),this.box.hide(),this.shown=!1}function b(b,c,d,e){var f,g,h=this.options.padding,i=2*h,j,k;c=c||this.options.x,this.string.attr({text:b.replace(/\\n|<br>/g,"\n")}),f=this.string.getBBox(),j=f.width+i,j+c>e&&(c=e-j),this.string.attr({x:c+h}),this.box.attr({x:c,width:j,y:f.y-h,height:f.height+i}),this.inserted||(this.options.insertBefore?(this.box.insertBefore(this.options.insertBefore),this.string.insertBefore(this.options.insertBefore)):(this.box.toFront(),this.string.toFront()),a(this.string),f=this.string.getBBox(),this.box.attr({y:f.y-h,height:f.height+i}),this.inserted=!0),this.shown||(this.box.show(),this.string.show(),this.shown=!0)}return{show:b,hide:c,hasX:d,intersect:e}}(),c.prototype=function(){function d(a){this.r.clear(),this.options.values=a,this.tip=new b({y:10},this.r),this.render()}function c(){var b=this.options.values.length,c=0,d=b,e,f,g,h,i,j=0,k=0,l=[];while(d--)this.options.values[d].value=parseInt(this.options.values[d].value,10),c+=this.options.values[d].value;for(d=0;d<b;d++)i=this.options.values[d],e=new a({value:i.value,label:i.label||!1,total:c,tip:i.tip,cx:this.cx,cy:this.cy,radius:this.options.radius,startAngle:j,color:this.options.colors[d%10],idx:d+1},this.r),g=e.render(),this.chart.push(g),f=new a({value:i.value,label:i.label||!1,total:c,tip:i.tip,cx:this.cx,cy:this.cy,radius:this.options.radius,startAngle:j,color:this.options.colors[d%10],idx:d+1,opacity:0},this.r),h=f.render(),h.mouseover(function(a,b,c,d,e){var f=c.options,g={value:f.value,label:f.label,index:f.idx,name:e},h;typeof d=="function"&&(h=d),typeof d=="string"&&window[d]&&(h=window[d]),typeof d=="string"&&core.Chart.callbacks[d]&&(h=core.Chart.callbacks[d]);return function(){b.stop().animate({transform:"s1.2 1.2 "+a.cx+" "+a.cy},800,"elastic"),a.tip.show(c.getTip()),h(g)}}(this,g,e,this.options.onhoverin,this.options.name)),h.mouseout(function(a,b,c,d,e){var f=c.options,g={value:f.value,label:f.label,index:f.idx,name:e},h;typeof d=="function"&&(h=d),typeof d=="string"&&window[d]&&(h=window[d]),typeof d=="string"&&core.Chart.callbacks[d]&&(h=core.Chart.callbacks[d]);return function(){b.stop().animate({transform:""},800,"elastic"),a.tip.hide(),h(g)}}(this,g,e,this.options.onhoverout,this.options.name)),this.controlChart.push(h),j+=e.getAngle();this.controlChart.toFront(),this.chart.click(function(a){return function(){typeof a=="function"&&a({value:this.slice.options.value,label:this.slice.options.label})}}(this.options.onclick))}function a(a,b){this.options=Object.extend({value:1,total:1,tip:"#{val}",cx:50,cy:50,radius:25,color:"",startAngle:0,opacity:1},a||{}),this.r=b,this.angle=360*this.options.value/(this.options.total||1)}a.prototype=function(){function e(){var a=new Template(this.options.tip);return a.evaluate({val:this.options.value})}function d(){return this.angle}function c(){var a={fill:this.options.color,"fill-opacity":this.options.opacity,stroke:"#fff","stroke-width":this.options.opacity?1:0},c;this.options.total===this.options.value?this.slice=this.r.circle(this.options.cx,this.options.cy,this.options.radius).attr(a):(c=b(this.options.cx,this.options.cy,this.options.radius,this.options.startAngle,this.options.startAngle+this.angle),this.slice=this.r.path(c).attr(a)),this.slice.slice=this;return this.slice}function b(b,c,d,e,f){var g=b+d*Math.cos(-e*a),h=b+d*Math.cos(-f*a),i=c+d*Math.sin(-e*a),j=c+d*Math.sin(-f*a);return"M"+b+","+c+"L"+g+","+i+"A"+d+","+d+",0,"+ +(f-e>180)+","+"0,"+h+","+j+"z"}var a=Math.PI/180;return{render:c,getAngle:d,getTip:e}}();return{render:c,update:d}}(),d.prototype=function(){function f(){var c=this.r,f=this.options.values.length,g=0,h=0,i=0,j,k,l,m,n,o,p,q,r=this,s=this.lines,t="",u,v,w,x=this.options.width,y,z,A=this.r.set(),B,C,D,E;for(;h<f;){j=this.options.values[h++],k=j.values,g=k.length,B=this.options.colors[(h-1)%4],l=new a({color:B,strokeWidth:1,strokeLinejoin:"round",shade:!0,text:j.text||!1,yAxis:j.yAxis||"left"},c),A.push(this.r.circle(0,0,4).attr({fill:B,"stroke-width":0}));for(i=0;i<g;)m=k[i++],l.addPoint(m.x,m.y,m.tip||j.tip||!1);this.lines.push(l),n=l.getDim(),l.options.yAxis==="left"?(o?(o.y.max=Math.max(o.y.max,n.y.max),o.y.min=Math.min(o.y.min,n.y.min)):o=n,typeof this.options.yAxis.left.min!="undefined"&&(o.y.min=this.options.yAxis.left.min),typeof this.options.yAxis.left.max!="undefined"&&(o.y.max=this.options.yAxis.left.max)):(p?(p.y.max=Math.max(p.y.max,n.y.max),p.y.min=Math.min(p.y.min,n.y.min)):p=n,typeof this.options.yAxis.right.min!="undefined"&&(p.y.min=this.options.yAxis.right.min),typeof this.options.yAxis.left.max!="undefined"&&(p.y.max=this.options.yAxis.right.max))}w=this.options.height-this.options.gutters.top,o&&(o.y.min<0&&(w=o.y.max/(o.y.max+Math.abs(o.y.min))*w),y=this.options.yAxis.left.steps,o.y.max-o.y.min===0&&(y=1,o.y.max=1),u=e(this.options.yAxis.left.labels.type,this.options.yAxis.left.labels.text,"left",this.options.gutters.top,w,this.options.height-this.options.gutters.top,o,y,x,this.r),x-=u.width,D=u.width),p&&(p.y.min<0&&(w=p.y.max/(p.y.max+Math.abs(p.y.min))*w),z=this.options.yAxis.right.steps,p.y.max-p.y.min===0&&(z=1,p.y.max=1),v=e(this.options.yAxis.right.labels.type,this.options.yAxis.right.labels.text,"right",this.options.gutters.top,w,this.options.height-this.options.gutters.top,p,z,D+x,this.r),x-=v.width);if(u.ySteps){z=u.ySteps.length;while(y--)this.r.path("M"+D+","+u.ySteps[y]+"h"+x).attr({stroke:"#aaaaaa","stroke-width":.5,"stroke-dasharray":"."})}d(D,w+this.options.gutters.top,x,o||p,!p,this.r);for(h=0;h<f;)l=this.lines[h++],n=l.options.yAxis==="left"?o:p,l.render(x,w==0?this.options.height-this.options.gutters.top:w,D,w+this.options.gutters.top,n.x.max-n.x.min,w==0?Math.abs(n.y.min):n.y.max);g=l.points.length;for(i=0;i<g;i++)q=this.r.rect(D+i*(x/g),0,x/g,this.options.height).attr({stroke:"none",fill:"#fff",opacity:0}),q.x=l.points[i][0],q.tipText=b(q.x)+"\n",this.columns.push(q);this.tip.options.x=this.options.width-x+10,this.tip.options.insertBefore=this.columns,A.hide(),this.columns.mouseover(function(a){var b=f,c,d,e=this.tipText;E&&window.clearTimeout(E);while(b--)d=s[b],c=d.getTip(this.x),e+=" * "+d.options.text+": "+c.tip+"\n",A[b].attr({cy:c.realY,cx:c.realX});A.show(),r.tip.show(e,c.realX+20,10,D+x)}),Event.observe(this.options.container,"mouseout",function(a){return function(){E=window.setTimeout(function(){A.hide(),a.hide()},1e3)}}(this.tip))}function e(a,b,c,d,e,f,g,h,i,j){function B(b){var c;if(a==="pct")return b.toFixed(0);if(a==="bps"){c=core.utils.transformers.metric(b);return c[0].toFixed(2)+" "+c[1]}if(a==="int")return b.toFixed(0);return b.toFixed(2)}var k=j.set(),l=h||4,m=g.y.max,n=[],o=m/l,p=Math.abs(g.y.min)/l,q=e/l,r=f/l,s=e+d,t=l+1,u,v,w,x,y=new Template(b||"#{val}"),z,A;c==="left"?(u=40,w="end"):(u=i-10,w="start"),g.y.max==0&&(t=1);while(t--)x=y.evaluate({val:B(o*t)}),v=s-q*t,k.push(j.text(u,v,x).attr({"text-anchor":w})),n.push(v);if(g.y.min<0){z=0,t=1;while(z>g.y.min)z-=o==0?p:o,x=y.evaluate({val:B(z)}),v=s+(q==0?r:q)*t++,k.push(j.text(u,v,x).attr({"text-anchor":w})),n.push(v)}A=k.getBBox(),k.attr({x:c==="left"?A.width:i-A.width}),t=t+l+1;while(t--)k.push(j.path("M"+(c==="left"?A.width+5:i-A.width-10)+","+n[t]+"h5"));k.push(j.path("M"+(c==="left"?A.width+10:i-A.width-10)+","+(d+f)+"v"+ -(f+6)).attr({"arrow-end":"classic-wide-long"})),A=k.getBBox(),A.ySteps=n;return A}function d(a,d,e,f,g,h){var i=h.set(),j=f.x.max-f.x.min,k=c(j),l=k.steps,m=l+1,n=j/l,o=[],p,q=d+15,r;g?i.push(h.path("M"+a+","+d+"h"+(e+6)).attr({"arrow-end":"classic-wide-long"})):i.push(h.path("M"+a+","+d+"h"+e));while(m--)p=a+m*(n/j)*e,i.push(h.path("M"+p+","+d+"v5")),r=h.text(p,q,b(f.x.min+m*n,k.format)),m||r.transform("t"+parseInt(r.getBBox().width/2+2,10)+",0"),i.push(r)}function c(a){if(a<=86400)return{format:"HH:mm",steps:12};if(a<=604800)return{format:"EE",steps:7};if(a<=2678400)return{format:"M.d.",steps:15};if(a<=31622400)return{format:"NNN yy",steps:12};return{format:"HH:mm",steps:12}}function a(a,b){this.options=Object.extend({color:"",yAxis:"left",getTip:function(a,b){return b}},a||{}),this.r=b,this.maxX=0,this.maxY=0,this.minX=0,this.minY=0,this.points=[],this.tips={},this.symbol=this.r.circle(0,0,4).attr({fill:this.options.color,"stroke-width":0}).hide()}a.prototype=function(){function e(a){var b=this.tips[a];return b||{x:a,y:0,tip:"undefined"}}function d(a,b,c,d,e,f){var g=this.getPath(a,b,c,d,e,f),h=this;this.options.shade&&(this.shade=this.r.path("M"+c+","+d+"L"+g+"V"+d+"Z").attr({fill:this.options.color,"fill-opacity":.5,"stroke-width":0})),this.path=this.r.path("M"+g).attr({stroke:this.options.color,"stroke-width":this.options.strokeWidth,"stroke-linejoin":this.options.strokeLinejoin});return this.path}function c(){return{x:{max:this.maxX,min:this.minX},y:{max:this.maxY,min:this.minY}}}function b(a,b,c,d,e,f){var g=this.points.length,h=0,i,j,k,l=this.points[0],m=l[0],n=l[1],o=e||1,p=f||1,q=a/o,r=b/p,s,t=a/g/2,u=c+","+(d-r*n)+"L";for(;h<g;)k=this.points[h++],i=c+q*(k[0]-m),j=d-r*k[1],u+=i+","+j+",",this.tips[k[0]].realX=i,this.tips[k[0]].realY=j;return u}function a(a,b,c){var d=new Template(c||"#{val}");this.points.length?(this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,b),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,b)):(this.maxX=a,this.maxY=b,this.minX=a,this.minY=b),this.points.push([a,b]),this.tips[a]={x:a,y:b,tip:d.evaluate({val:b})||this.options.getTip(a,b)}}return{addPoint:a,getPath:b,getDim:c,render:d,getTip:e}}();var b=function(){var a={};return function(b,c){var d,e;c=c||"yyyy-MM-dd HH:mm:ss",d=a[c],d||(a[c]={},d=a[c]),e=d[b],e||(e=(new Date(b*1e3)).format(c),d[b]=e);return e}}();return{render:f,update:function(a){console.log("setting values on linechart")}}}();return{init:function(){var a=$(this.options.container).getDimensions();this.r=Raphael(this.options.container,"100%","100%"),this.options.width=a.width,this.options.height=a.height,this.r.setViewBox(0,0,a.width,a.height,!0);if(this.options.type==="pie"){this.options.radius=a.height/2-a.height*.1,this.chart=new c(this.options,this.r);return!0}if(this.options.type==="lines"){this.chart=new d(this.options,this.r);return!0}},render:e,update:f}}(),core.Chart.callbacks={hoverInPieMarkIrTableRow:function(a){$("IR_TABLE"+a.name+"_ROW_"+a.index).style.fontWeight="bold"},hoverOutPieMarkIrTableRow:function(a){$("IR_TABLE"+a.name+"_ROW_"+a.index).style.fontWeight="normal"}},core.feedReader=Class.create(),core.feedReader.prototype={initialize:function(a){var b=this;this.options=a,this.current=0,this.hidden=!1,this.timestamp=(new Date).getTime(),this.timeout=216e5,this.feed_window=null;return this},render:function(){var a=(new Date).getTime()-this.timestamp,b=$("FEED_TOGGLE");if(a>this.timeout)this.refetch();else{if(!this.hidden){var c="";c+="<h2>"+this.options.feeds[this.current].title+"</h2>",c+="<p>"+this.options.feeds[this.current].content+"</p>",c+="<h3>Issued "+this.options.feeds[this.current].issued+" by Sophos Ltd</h3>",$(this.options.target).innerHTML=c,b.src="core/img/table_content_collapse.png"}else b.src="core/img/table_content_expand.png";if($("FEED_AMOUNT")){var d=this.current+1,e=d+" <b>of</b> "+this.options.feeds.length;$("FEED_AMOUNT").innerHTML=e}}},next:function(){var a=this.current+1;a!=this.options.feeds.length&&(this.current=a,this.render())},prev:function(){var a=this.current-1;a<0||(this.current=a,this.render())},toggle:function(){this.hidden?($(this.options.target).show(),this.hidden=!1):($(this.options.target).hide(),this.hidden=!0),this.render()},refetch:function(){req_send({objs:[{FID:"refetch_feed",callback:"core.feed.update"}]})},update:function(a){a.feeds&&(this.timestamp=(new Date).getTime(),this.options.feeds=a.feeds,this.render())}},core.slideshow=Class.create({initialize:function(a,b){this.options=Object.extend({width:710,height:310,left:190,top:76,tabs:{1:"daily",2:"weekly",3:"monthly",4:"yearly"},defaultTab:1,showTabSwitch:!0},a||{}),this.buttons={},this.buttons.up=new core.slideshow.button(this,{title:"Up",position:"up"}),this.buttons.down=new core.slideshow.button(this,{title:"Down",position:"down"}),this.buttons.left=new core.slideshow.button(this,{title:"Left",position:"left"}),this.buttons.right=new core.slideshow.button(this,{title:"Right",position:"right"}),this.tabMenu=new core.slideshow.tabmenu({},this.options.tabs,this),$(this.tabMenu.htmlElement).hide(),this.image=Builder.node("img",{style:"position:absolute;z-index:1;top:0;left:0;"}),Event.observe(this.image,"load",this.imageLoaded.bind(this)),this.resizeHelper=Builder.node("div",{style:"vertical-align:middle;text-align:center;"}),this.controlElement=Builder.node("div",{style:"border:0px solid black;position:absolute;top:0;left:0;z-index:2;"},[Builder.node("table",{border:0,style:"width:100%;margin-left:auto;margin-right:auto;"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{rowSpan:"3"},this.buttons.left.htmlElement),Builder.node("td",{},this.buttons.up.htmlElement),Builder.node("td",{rowSpan:"3"},this.buttons.right.htmlElement)]),Builder.node("tr",{},[Builder.node("td",{},this.resizeHelper)]),Builder.node("tr",{},[Builder.node("td",{},this.buttons.down.htmlElement)])]))]),$(this.controlElement).hide(),this.htmlElement=Builder.node("div",{style:"vertical-align:middle;position:relative;"},[this.image,this.tabMenu.htmlElement,this.controlElement]),Event.observe(this.htmlElement,"mouseover",function(){$(this.controlElement).show(),this.tabMenu.htmlElement.show(),this.buttons.up.active&&this.buttons.up.show(),this.buttons.down.active&&this.buttons.down.show(),this.buttons.left.active&&this.buttons.left.show(),this.buttons.right.active&&this.buttons.right.show()}.bind(this)),Event.observe(this.htmlElement,"mouseout",function(){this.controlElement.hide(),this.tabMenu.htmlElement.hide()}.bind(this)),this.provider=b,this.window=new Window({className:"astaro",title:"Details",top:this.options.top,left:this.options.left,width:this.options.width,height:this.options.height})},throbber:function(a){a?_debug("next image loaded\nwidth: "+this.image.getWidth()+"\nheight: "+this.image.getHeight()):_debug("loading next image")},imageLoaded:function(){if(!this.image.complete)window.setTimeout(this.imageLoaded.bind(this),10);else{this.throbber(!0);var a=this.image.getWidth()||600,b=this.image.getHeight()||230;this.controlElement.style.width=a+"px",this.controlElement.style.height=b+"px",this.window.setSize(a,b),this.resizeHelper.style.height=b-48+"px"}},show:function(a){this.window.setContent(this.htmlElement),this.window.show(!0),$(this.window.getId()+"_content").style.overflow="hidden",this.update(a)},hide:function(){this.window.close()},update:function(a){var b;this.throbber(),typeof a=="string"?b=this.provider[a]():a&&a.x!="undefined"&&a.y!="undefined"?(this.provider.currentPosition=Object.clone(a),b=this.provider.getPosition(a.x,a.y)):b=this.provider.getPosition(0,0),this.window.setTitle(b.current.title),this.resizeHelper.innerHTML=b.current.description,this.image.src=b.current.image+"?t="+Math.random(),b.upTitle?(this.buttons.up.setTitle(b.upColumn||b.upTitle),this.buttons.up.show()):this.buttons.up.hide(),b.downTitle?(this.buttons.down.setTitle(b.downColumn||b.downTitle),this.buttons.down.show()):this.buttons.down.hide(),b.leftTitle?(this.buttons.left.setTitle(b.leftColumn),this.buttons.left.show()):this.buttons.left.hide(),b.rightTitle?(this.buttons.right.setTitle(b.rightColumn),this.buttons.right.show()):this.buttons.right.hide()}}),core.slideshow.tabmenu=Class.create({initialize:function(a,b,c){this.options=Object.extend({},a||{}),this.data=$H(b),this.parent=c,this.items=[],this.data.each(function(a){this._renderItem({text:a.value,id:a.key})}.bind(this)),this.htmlElement=Builder.node("ul",{style:"list-style:none;padding:0px;margin:0px;position:absolute;z-index:3;top:0;left:0;"},this.items)},_renderItem:function(a){var b=Builder.node("li",{style:"cursor:pointer;float:left;border:0px;background-color:#f78e1f;color:white;margin:0px 2px;padding:3px;"},a.text);this.items.push(b),Event.observe(b,"mouseover",function(a){this.style.backgroundColor="#F9B063"}.bindAsEventListener(b)),Event.observe(b,"mouseout",function(){this.style.backgroundColor="#f78e1f"}.bind(b)),Event.observe(b,"click",function(){this.parent.provider.switchTab(a.id),this.parent.update(this.parent.provider.currentPosition)}.bind(this))}}),core.slideshow.button=Class.create({initialize:function(a,b){this.options=Object.extend({title:"",position:"top"},b||{}),this.parent=a,this.titleElement=Builder.node("div",{style:"white-space:nowrap;top:0px;left:0px;z-index:2;position:absolute;border:1px solid #AAAAAA;background-color:white;padding:5px;"},this.options.title),this.controlElement=Builder.node("div",{style:"position:absolute;top:-70px;left:-70px;height:160px;width:160px;border:0px solid black;"},this.titleElement);switch(this.options.position){case"down":this.imageElement=Builder.node("img",{src:"core/img/icons/slide_bottom2.gif",style:"margin-left:45%;margin-right:50%;text-align:center;"});break;case"up":this.imageElement=Builder.node("img",{src:"core/img/icons/slide_top2.gif",style:"margin-left:45%;margin-right:50%;text-align:center;"});break;case"right":this.imageElement=Builder.node("img",{src:"core/img/icons/slide_right2.gif",style:"text-align:center;"});break;case"left":this.imageElement=Builder.node("img",{src:"core/img/icons/slide_left2.gif",style:"text-align:center;"})}this.htmlElement=Builder.node("div",{style:"border:0px solid black;position:relative;cursor:pointer;height:100%;width:100%;background-repeat:no-repeat;text-align:center;vertical-align:middle;"},[this.imageElement,this.controlElement]),$(this.titleElement).hide(),Event.observe(this.htmlElement,"mouseover",this.onmouseover.bindAsEventListener(this)),Event.observe(this.htmlElement,"mouseout",this.onmouseout.bindAsEventListener(this)),Event.observe(this.htmlElement,"mousemove",this.onmousemove.bindAsEventListener(this)),Event.observe(this.htmlElement,"click",this.onclick.bindAsEventListener(this))},setTitle:function(a){this.options.title=a,this.titleElement.update(this.options.title)},hide:function(){this.active=!1,this.htmlElement.style.visibility="hidden"},show:function(){this.active=!0,this.htmlElement.style.visibility="visible",$(this.controlElement).style.left=$(this.htmlElement).getWidth()/2-70+"px"},onclick:function(a){this.parent.update(this.options.position)},onmouseover:function(a){this.titleElement.show()},onmousemove:function(a){var b=$(this.controlElement).cumulativeOffset(),c=$(this.parent.window.getId()+"_content").cumulativeOffset()[0]+$(this.parent.window.getId()+"_content").getWidth(),d=Event.pointerX(a)+$(this.titleElement).getWidth()+5,e=$(this.parent.window.getId()+"_content").cumulativeOffset()[1]+$(this.parent.window.getId()+"_content").getHeight(),f=Event.pointerY(a)+$(this.titleElement).getHeight()+5;d<=c&&(this.titleElement.style.left=Event.pointerX(a)-b[0]+15+"px"),f<=e&&(this.titleElement.style.top=Event.pointerY(a)-b[1]+15+"px")},onmouseout:function(a){this.titleElement.hide()}}),core.slideshow.provider=Class.create({initialize:function(a,b){this.options=Object.extend({},a||{}),this.globalData=b,this.data=this.globalData.daily,this.currentPosition={x:0,y:0}},up:function(){this.currentPosition.y>0&&this.currentPosition.y--;return this.getPosition(this.currentPosition.x,this.currentPosition.y)},down:function(){this.currentPosition.y<this.data.length-1&&this.currentPosition.y++;return this.getPosition(this.currentPosition.x,this.currentPosition.y)},left:function(){this.currentPosition.x>0&&this.currentPosition.x--;return this.getPosition(this.currentPosition.x,this.currentPosition.y)},right:function(){this.currentPosition.x<this.data[0].length-1&&this.currentPosition.x++;return this.getPosition(this.currentPosition.x,this.currentPosition.y)},getPosition:function(a,b){a=parseInt(a,10),b=parseInt(b,10);if(!this.data[b]||!this.data[b][a])return!1;var c={};try{c.upTitle=this.data[b-1][a].title}catch(d){c.upTitle=!1}try{c.downTitle=this.data[b+1][a].title}catch(e){c.downTitle=!1}try{c.leftTitle=this.data[b][a-1].title,c.leftColumn=this.data[b][a-1].column}catch(f){c.leftTitle=!1}try{c.rightTitle=this.data[b][a+1].title,c.rightColumn=this.data[b][a+1].column}catch(g){c.rightTitle=!1}c.current=this.data[b][a];return c},switchTab:function(a){switch(a){case"1":this.data=this.globalData.daily;break;case"2":this.data=this.globalData.weekly;break;case"3":this.data=this.globalData.monthly;break;case"4":this.data=this.globalData.yearly}}}),core.fieldset=Class.create({initialize:function(a){this.refresh(a)},refresh:function(a){this.options=Object.extend({name:"",fid:"",elements:[],button:!1},a||{}),this.messageElement=$("ELEMENT_"+this.options.name+"_error"),this.applyButton=$(this.options.button)||$("ELEMENT_FORM_"+this.options.name+"_BUTTON_apply"),this.buttons=$("GRID_"+this.options.name+"_buttons_CONTAINER"),this.buttonContainer=($("GRID_"+this.options.name+"_buttons_CONTAINER")||this.applyButton).up(),this.contentElement=$("GRID_CELL_"+this.options.name+"_content"),this.help=$("ELEMENT_"+this.options.name+"_help")},submit:function(a,b){this.disable(),b=Object.extend({callback:this.submit_cb.bind(this),ack:a||null},b||{}),a&&(b.elements={_confirmation:a}),core.utils.gotoLastScrollPos(!0),call_fid(this.options.fid,b,this.options.elements)},submit_cb:function(a){var b;this.refresh(this.options),core.utils.gotoLastScrollPos();var c="";if(a.error&&typeof a.error=="object")this.onError(a);else{if(a.confirm&&typeof a.confirm=="object"){this.onConfirm(a);return}a.success&&typeof a.success=="object"&&this.onSuccess(a);if(a.callback){b=Object.clone(a),delete b.callback;try{a.callback.apply(this,[b])}catch(d){try{window[a.callback].apply(this,[b])}catch(e){_debug(e)}}delete a.callback}}},disable:function(){this.applyButton.button.disable()},enable:function(){this.applyButton.button.enable()},onError:function(a){a.noreenable||this.enable();if(Object.isArray(a.error)){var b=a.error.length,c="",d=!1,e;while(b--){if(a.error[b].field){a.error[b].field=a.error[b].field.uniq(),e=a.error[b].field.length;while(e--)a.error[b].field[e]&&a.error[b].msgtype!="NODE_WRITE_DENIED"&&a.error[b].msgtype!="FUNCTION_DENY"&&a.error[b].msgtype!="OBJECT_CHANGE_DENY"&&a.error[b].msgtype!="OBJECT_INSERT_DENY"&&border_blink_element(a.error[b].field[e])}a.error[b].force_alert&&(d=!0),c+=a.error[b].text+"\n"}d?alert(c):this._message(c,!1,"red","core/img/icons/warning.png")}},onSuccess:function(a){a.noreenable||this.enable();if(Object.isArray(a.success)){var b=a.success.length;while(b--)this._message(a.success[b].text,!0,"green")}},onConfirm:function(a){var b=[{label:_LOC("NWskcZRcJz","OK"),"default":!0,icon:"core/img/icons/check.png",exec:function(){this.messageElement.update(""),this.buttons?this.buttons.show():this.applyButton.show(),$(this.confirmButtonContainer).remove(),this.confirmButtons=[],a.confirm=null,this.submit(a.ack||1,a)}.bind(this)},{label:_LOC("vlOCimCoLo","Cancel"),icon:"core/img/icons/cancel.png",exec:function(){this.messageElement.update(""),this.buttons?this.buttons.show():this.applyButton.show(),$(this.confirmButtonContainer).remove(),this.confirmButtons=[],this.enable()}.bind(this)}];if(Object.isArray(a.confirm)){var c=a.confirm.length,d="";while(c--){if(a.confirm[c].field){a.confirm[c].field=a.confirm[c].field.uniq();var e=a.confirm[c].field.length;while(e--)a.confirm[c].field[e]&&border_blink_element(a.confirm[c].field[e])}d+='<p style="margin-top:0;'+(c?"":"margin-bottom:0;")+'">'+a.confirm[c].text+"</p>"}this.buttons?this.buttons.hide():this.applyButton.hide(),this._message(d,!1,"red","core/img/icons/confirm.png",b)}return},_message:function(a,b,c,d,e){auto_hide_elements[this.messageElement.id]&&(self.clearTimeout(auto_hide_elements[this.messageElement.id]),auto_hide_elements[this.messageElement.id]=null),this.confirmButtons=[],e&&e.each(function(a,b){var c=new core.button({label:a.label,icon:a.icon,onclickfunc:a.exec}),d=Builder.node("td",{},[c.htmlElement]);this.confirmButtons.push(d)}.bind(this)),this.messageElement&&(this.messageElement.style.color=c,d?($(this.messageElement).update(),this.messageElement.appendChild(Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},[Builder.node("td",{className:"message_icon_container"},Builder.node("img",{align:"left",src:d,style:"padding-right:5px"})),$(Builder.node("td",{},"")).update(a)]))))):this.messageElement.update(a),this.confirmButtons.length&&(this.buttonContainer.style.verticalAlign="bottom",this.confirmButtonContainer=Builder.node("table",{style:"float:right;",border:"0",cellpadding:"0",cellspacing:"0"},Builder.node("tbody",{},Builder.node("tr",{},this.confirmButtons))),this.buttonContainer.appendChild(this.confirmButtonContainer)),b&&auto_hide_element(this.messageElement.id))},reset:function(){},_obj_key_err:function(a,b,c){c||(c=!1);var d=!1;switch(b){case"name":d=_LOC("WmHahZGtkd","Names must start with a non-number.");break;case"src_low":case"src_high":case"dst_low":case"dst_high":d=_LOC("NyrkVsXRrl","One of the entered numbers is not a valid port number (range 1-65535).");break;case"email_primary":case"email_secondary":switch(a){case"EMAIL_ADDR_UNIQUE":d=_LOC("PHidYDeTOo","One of the specified email addresses is already in use for another user.");break;default:d=(c?c:"")+" "+_LOC("mlQnlvTbob","is not a valid email address.")}}return d}}),core.capslock=Class.create({initialize:function(a){this.options=a||{},this.element=$(a.element_id),this.addEvent(this.element,"keypress",this.keypress.bind(this))},addEvent:function(a,b,c){document.addEventListener?(this.addEvent=function(a,b,c){a.addEventListener(b,c,!1)},this.addEvent(a,b,c)):document.attachEvent&&(this.addEvent=function(a,b,c){a.attachEvent("on"+b,c)},this.addEvent(a,b,c))},keypress:function(a){var b=a?a:window.event,c,d=-1,e=!1;!b||(c=b.target?b.target:b.srcElement,b.which?d=b.which:b.keyCode&&(d=b.keyCode),b.shiftKey?e=b.shiftKey:b.modifiers&&(e=!!(b.modifiers&4)),d>=65&&d<=90&&!e||d>=97&&d<=122&&e?($(this.options.capslock_warn).innerHTML=_LOC("MHbKMDNlIm","Caps Lock is on"),$(this.options.capslock_warn).style.visibility="visible"):($(this.options.capslock_warn).style.visibility="hidden",$(this.options.capslock_warn).innerHTML=""))}}),core.status_slider=function(){"use strict";var a=[_LOC("dSMCwZkXxK","Disabled"),_LOC("uUCILhZwIi","Enabled"),_LOC("PAXYlRmZpO","Abort enable"),_LOC("fdtyEmQFqp","Abort disable")];return function(b){var c=this;this.container=b.container?$(b.container):!1,this.container.statusSlider=this,this.options=Object.extend({baseclassname:"status_slider_"},b||{}),this.enabled=!0,this.options.status>1?(this.options.status==2&&(this.status_text=a[2]),this.options.status==3&&(this.status_text=a[3]),this.status_class="configure"):this.options.status==1?(this.status_text=a[1],this.status_class="on"):(this.status_text=a[0],this.status_class="off"),this.status_slider=$(Builder.node("div",{title:this.status_text,id:"status_slider",className:this.options.baseclassname+this.status_class})),Event.observe($(this.status_slider),"click",function(){c.enabled&&req_send({objs:[{FID:c.options.fid,options:c.options,name:c.options.name,current_state:c.options.status,callback:function(b){function f(){var a=[],c;for(c=0;c<b.confirm.length;c++)a.push(b.confirm[c].text);confirm_dialog({message:a,ok_cb:function(){b.confirm&&delete b.confirm,call_fid(b.FID,{callback:widget_traffic_callback}.extend(b||{}),[])}});return}function e(){b.success&&(c.options.status=b.success.status,c.status_slider.setAttribute("title",a[b.success.status]),b.success.status===1&&(c.status_class="on"),b.success.status===0&&(c.status_class="off"),c.status_slider.className="",c.status_slider.addClassName(c.options.baseclassname+c.status_class),b.success.tab_traffic_name&&tab_traffic(b.success.status,b.success.tab_traffic_name))}function d(){if(Object.isArray(b.error)){var a=b.error.length,c="",d=!1;while(a--)c+=b.error[a].text+"\n";alert(c)}}if(b.error&&typeof b.error=="object")d();else{if(b.confirm&&typeof b.confirm=="object"){f();return}e()}}}]})}),this.container&&this.container.appendChild(this.status_slider)}}(),core.status_slider.prototype={disable:function(){this.enabled=!1},enable:function(){this.enabled=!0}},core.report.loadConfig=function(a){if(core.report.config.subsystem!=a.type){var b=dynIncPath+"_reportconfig_"+a.subsystem;loadScript(b+".min.js",!1)!=-1?typeof a.onsuccess=="function"&&a.onsuccess():loadScript(b+".js",!1)!=-1?typeof a.onsuccess=="function"&&a.onsuccess():(_debug("loading report-config "+a.subsystem+" failed. Unknown reason"),typeof a.onfail=="function"&&a.onfail())}},core.report.config={subsystem:!1},core.report.map=[],core.report.Report=Class.create({initialize:function(a){this.options=Object.extend({filter:{},customReports:{},container:"",width:744,height:558,maxRows:40,bgcolors:["#F7F7F7","#E4E4E7"],totals_string_column:2},a||{});var b=!0;this.options.filter.subsystem&&core.report.loadConfig({subsystem:this.options.filter.subsystem,onsuccess:function(){b=!1}});if(b)throw'Loading Report Config "'+this.options.filter.subsystem+'" failed. Aborting Report';this.filter=new core.report.filtering.Filter(this.options.filter),this.options.maxRows=this.filter.options.maxRows||this.options.maxRows,this.reportTable=new core.report.ReportTable({width:this.options.width,filter:this.filter,maxRows:this.options.maxRows}),this.filterDialog=new core.report.filtering.FilterDialog({filter:this.filter,customReports:this.options.customReports,reportContainer:this.options.container,reportNumber:core.report.map.length}),core.report.map.push(this)},addFilter:function(a){this.reportTable.setFilter(this.options.filter)},load:function(a){this.reportTable.load(0,this.options.maxRows,a?this.show.bind(this):!1)},sort:function(a,b){},show:function(){$(this.options.container).update(),$(this.options.container).appendChild(this.toHTML()),this.reportTable.updateColumnsWidth()},toHTML:function(){this.htmlElement=Builder.node("div",{},[this.filterDialog.toHTML(),Builder.node("div",{style:"clear:both;"}),this.reportTable.toHTML()]);return this.htmlElement}}),core.report.ReportTable=Class.create({initialize:function(a){this.options=Object.extend({width:640,filter:{}},a||{}),this.emptyString=_LOC("XJoluMRUtd","Empty result"),this.filter=this.options.filter,this.filter.observe(this.notify.bind(this));var b=this.filter.options;this.rows=[],this.columns={},b.sort_by?(this.sorting={},this.sorting[b.sort_by]=b.sort_dir||"DESC"):this.sorting=core.report.config.tableColumns[b.callname].defaults.sort||{}},setFilter:function(a){this.filter=a},clean:function(){this.rows=[],this.columns={},this.sorting=core.report.filtering.sanitizeSorting(this.sorting,this.filter.options.callname),this.scrollElement&&(this.scrollElement.update(),this.scrollElement.scrollTop=0),this.headerElement&&this.headerElement.update(),this.htmlElement&&this.htmlElement.hide()},load:function(a,b,c){c&&(this.directshow=c);var d=this.filter.options;call_fid("get_report_data",{start_line:a,end_line:b,start_date:d.start_date,end_date:d.end_date,department:d.department,filter:core.report.filtering.sanitizeFilter(d.filter,d.callname),sort:core.report.filtering.sanitizeSorting(this.sorting,d.callname),callname:d.callname,callback:this.load_cb.bind(this)})},load_cb:function(a){var b,c,d,e=a.start_line,f=this.filter.options.callname,g=core.report.config,h=g.tableColumns[f],i=this.notify.bind(this);f==a.callname&&(this.currentMaxLine=e+parseInt(a.end_line,10),a=a.result||[],h&&h.full&&h.full.each(function(f){var h=f.attribute,j=f.action,k=f.filter||j,l=f.width,m=f.align||"left",n=f.link,o=f.tip?new Template(f.tip):!1,p=g.attributeMap[h].caption,q=g.attributeMap[h].type;if(h){this.columns[h]||(this.columns[h]=new core.report.ReportTableColumn({label:p.text||"d:"+h,className:p.className,width:f.width,align:f.align||"left",attribute:h,link:n,sort_dir:this.sorting[h]||(a.sort[h]?h:!1),table:this}),this.columns[h].observe(this.notify.bind(this)));var r=a.length,s=r+e;if(r){b=e;while(b<s){var t=a[b-e],u=this.rows[b++];d=u||new core.report.ReportTableRow,c=new core.report.ReportTableCell({text:t[h]||"--",type:q,attribute:h,action:j,filter:k,value:t[j],filtervalue:t[k],link:t[n]||!1,width:l,align:m,tip:o?o.evaluate(t):!1,table:this}),c.observe(i),d.addCell(c),this.columns[h].addCell(c),u||(this.rows[this.rows.length]=d)}}}}.bind(this)),this.directshow&&(this.directshow(),this.directshow=!1))},notify:function(a){_debug("ReportTable notified"),_debug(a);if(a.cell&&a.event=="click"){var b=a.cell.options;this.filter.update({attributes:[{attribute:b.filter,value:b.filtervalue}],actionAttribute:b.action,sort:{sort_by:b.attribute,sort_dir:"ASC"}})}if(a.filter&&(a.event=="set_callname"||a.event=="reset"||a.event=="deleted"||a.event=="update")){this.filter=a.filter,this.clean();if(a.filter&&a.filter.options&&a.filter.options.sort_by){var c=a.filter.options;this.sorting={},this.sorting[c.sort_by]=c.sort_dir}this.load(0,this.options.maxRows,this.toHTML.bind(this))}a.event=="updateMaxRows"&&(this.options.maxRows=a.filter.options.maxRows||40,this.clean(),this.load(0,this.options.maxRows,this.toHTML.bind(this)));if(a.event=="sort"){var d,e;a.column&&(d=a.column,e=a.sort_dir),a.filter&&(d=a.filter.options.sort_by,e=a.filter.options.sort_dir),$H(this.columns).each(function(a){a.value.setSortdir(!1)}),this.columns[d]&&this.columns[d].setSortdir(e),this.clean(),this.sorting={},this.sorting[d]=e,a.source||(a.source=""),a.source!=="filter"&&this.filter.setSortBy(d,e),this.load(0,this.options.maxRows,this.toHTML.bind(this))}},appendRow:function(a){if(this.rows[a]){var b=$(this.rows[a].toHTML(a+1));b.addClassName("ng_rep_table_row_"+(a%2?"odd":"even")),this.rowsElement.appendChild(b)}},appendRows:function(a,b){for(var c=a;c<b;c++)this.appendRow(c)},toHTML:function(){var a,b=[],c=[Builder.node("th",{className:"dashboard_box_header_left"}),$(Builder.node("th",{className:"dashboard_box_header_center",scope:"col"},"#")).setStyle({width:"30px",maxWidth:"30px"}),Builder.node("th",{className:"dashboard_box_table_divider"})],d=[],e=[Builder.node("col",{width:"4px"}),Builder.node("col",{width:"30px"}),Builder.node("col",{width:"4px"})],f=[Builder.node("col",{width:"4px"}),Builder.node("col",{width:"30px"}),Builder.node("col",{width:"4px"})];$H(this.columns).each(function(a){e.push(a.value.toHTML("column")),e.push(Builder.node("col",{width:"4px"})),f.push(a.value.toHTML("column")),f.push(Builder.node("col",{width:"4px"})),c.push(a.value.toHTML("header")),c.push(Builder.node("th",{className:"dashboard_box_table_divider"}))}),e.pop(),f.pop(),c.pop(),this.rowsElement=Builder.node("tbody"),c.push(Builder.node("th",{className:"dashboard_box_header_right"})),e.push(Builder.node("col",{width:"4px"})),f.push(Builder.node("col",{width:"4px"})),this.headerTableElement=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"width: 100%;table-layout:fixed;"},[Builder.node("colgroup",e),Builder.node("thead",{},Builder.node("tr",c))]),this.tableElement=Builder.node("table",{border:"0",cellpadding:"0",cellspacing:"0",style:"width: 100%;table-layout:fixed;"},[Builder.node("colgroup",f),this.rowsElement]);if(this.rows.length)this.appendRows(0,this.rows.length);else{var g=$(Builder.node("td",{style:"width:100%;text-align:center;",colspan:c.length},this.emptyString)),h=Builder.node("tr",{},g);this.tableElement.appendChild(h)}this.htmlElement?(this.scrollElement.appendChild(this.tableElement),this.headerElement.appendChild(this.headerTableElement)):(this.headerElement=$(Builder.node("div",{className:"ng_rep_header_table",style:"width:"+(770-core.tools.getScrollbarWidth())+"px;"},this.headerTableElement)),this.scrollElement=Builder.node("div",{className:"ng_rep_data_table"},this.tableElement),this.htmlElement=$(Builder.node("div",{className:"ng_rep_table"},[this.headerElement,this.scrollElement])),Event.observe(this.scrollElement,"scroll",this.onscroll.bind(this))),this.htmlElement.show(),this.appended&&this.updateColumnsWidth();return this.htmlElement},onscroll:function(){if(this.scrollElement.scrollTop>0&&this.scrollElement.scrollTop+this.scrollElement.clientHeight>=this.scrollElement.scrollHeight-100&&!this.loading){var a=this.currentMaxLine,b=a+this.options.maxRows;this.loading=this.options.maxRows==40?!1:!0,this.loading||(this.loading=!0,this.load(this.currentMaxLine,this.options.maxRows,function(){this.appendRows(a,b),this.loading=!1}.bind(this)))}},updateColumnsWidth:function(){this.appended=!0;for(var a in this.columns)if(this.columns.hasOwnProperty(a)){a=this.columns[a];var b=a.options;if(b&&b.width&&b.width=="*"){var c=$(a.headerHtml).getWidth();b.link&&(c-=14),altercss(".ng_rep_table_cell_"+b.attribute,{"max-width":c+"px",width:c+"px"})}}}}),core.report.ReportTableRow=function(){var a=[];return{addCell:function(b){a.push(b)},toHTML:function(b){var c=Builder.node("tr"),d,e=a.length;c.appendChild(Builder.node("td"));if(b||b===0)c.appendChild(Builder.node("td",b)),c.appendChild(Builder.node("td",{className:"table_columns_row_divider"}));for(d=0;d<e;d++)c.appendChild(a[d].toHTML("td")),d!=e-1&&c.appendChild(Builder.node("td",{className:"table_columns_row_divider"}));c.appendChild(Builder.node("td"));return c}}},core.report.ReportTableColumn=function(a){function j(b){var c;switch(b){case"header":f||(f=Builder.node("img",{style:"float:right;height:6px;width:6px;padding-top:3px;"})),f.src=d=="DESC"?"core/img/dashboard/arrow_down.png":d=="ASC"?"core/img/dashboard/arrow_up.png":"core/img/blank16x16.gif",g=Builder.node("div",{style:"float:"+a.align+";margin-right:2px;"+(a.width!=="*"?"width:"+(a.width-8)+"px;":""),className:"ellipsis",title:core.tools.htmlEntityDecode(a.label)},a.label),this.headerHtml||(this.headerHtml=$(Builder.node("th",{className:a.className||"dashboard_box_header_center",scope:"col"},[f,g])).setStyle({textAlign:a.align,cursor:"pointer"}),Event.observe(this.headerHtml,"click",h));return this.headerHtml;case"footer":break;case"column":return Builder.node("col",{width:a.width=="*"?"":a.width+"px"});default:}}function i(a){d=a,j("header")}function h(){if(!a.table.loading){i(!d||d=="ASC"?"DESC":"ASC");var b,c={column:a.attribute,sort_dir:d,event:"sort"};for(b=0;b<e.length;b++)e[b](c)}}this.options=a=Object.extend({sort_dir:!1,className:"",style:"padding: 0 2px;"},a||{});var b=[],c=this,d=a.sort_dir||!1,e=[],f,g;return{addCell:function(a){b.push(a)},observe:function(a){e.push(a)},setSortdir:i,toHTML:j,options:a,sort_dir:d}},core.report.ReportTableCell=function(a){function k(){var c,d={cell:{options:{filter:g.single||a.filter,filtervalue:a.filtervalue,action:a.action,attribute:a.attribute}},event:"click"};if(a.table&&!a.table.loading){Object.isArray(a.filtervalue)&&a.filtervalue.length==1&&(d.cell.options.filtervalue=d.cell.options.filtervalue[0]);for(c=0;c<b.length;c++)b[c](d)}}function j(){if(!e){var d=a.text.length,h=[],j,k=function(){var c=0,d=b.length;e.hide();for(;c<d;)b[c++]({cell:{options:{filter:g.single||a.filter,filtervalue:this.innerHTML,action:a.action,attribute:a.attribute}},event:"click"})},l=function(){this.className="menu_sub_text_active"},m=function(){this.className="menu_sub_text"};for(i=0;i<d;i++)j=Builder.node("li",{className:"menu_sub_text"},a.text[i]),Event.observe(j,"mouseup",k.bind(j)),Event.observe(j,"mouseover",l.bind(j)),Event.observe(j,"mouseout",m.bind(j)),h.push(j);e=Builder.node("div",{style:"position:absolute;"},Builder.node("ul",{style:"list-style-type:none;margin:1px;padding:1px;"},h)),c.appendChild(e)}else e.show();f=!0}function h(){var b={content:d.options.text,style:"text-align:left;"},c=core.report.config.typeMap[a.type];c&&(b.content=c(b.content));switch(a.type){case"categories":case"text":break;case"number":case"bytes":case"time":case"pct":b.style="text-align: right;"}return b}this.options=a=Object.extend({text:"",attribute:"",action:"",value:"",width:"",align:"left",type:"text",tip:!1},a||{});var b=[],c,d=this,e,f=!1,g=core.report.config.attributeMap[a.attribute];return{observe:function(a){b.push(a)},toHTML:function(b){var d=h(),e,f;e=Builder.node("div",{style:"overflow-x:hidden;cursor:pointer;",className:"ellipsis ng_rep_table_cell_"+a.attribute,title:d.content},d.content),f=e,a.link&&(f=Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0"},Builder.node("tbody",Builder.node("tr",[Builder.node("td",Builder.node("a",{href:a.link,target:"_blank",style:"margin-right: 3px;",title:_LOC("LvtaDPLnXE","Open in new window")},Builder.node("img",{src:"core/img/icons/external.png",style:"display:inline;"}))),Builder.node("td",e)])))),c=$(Builder.node(b||"td",f)),a.tip&&c.appendChild(Builder.node("span").update(a.tip)),c.setStyle({textAlign:a.align}),g.multiple&&Object.isArray(a.text)&&a.text.length>1?Event.observe(e,"mousedown",j):Event.observe(e,"click",k);return c}}},core.report.filtering={filters:{},getAvailableReports:function(a,b,c){var d=core.report.config.availableReports,e=core.report.config.attributeMap,f=[];if(!b||!d[b]||!d[b][a])b="fallback";f=d[b][a]||[],c&&$H(c).keys().each(function(a){var b=e[a];b.view&&(f=f.without(b.view))});return f},sanitizeFilter:function(a,b){var c=core.report.config.tableColumns[b]||!1,d={};if(c&&c.valid){var e=c.valid,f=e.length;while(f--)a[e[f]]&&(d[e[f]]=a[e[f]]);return d}return a},sanitizeSorting:function(a,b){var c=core.report.config.tableColumns[b]||!1,d={},e=$H(a).keys()[0],f,g,h=0;if(c){if(c.full){f=c.full,g=c.full.length;for(;h<g;)f[h++].attribute==e&&(d[e]=a[e])}d[e]||c.defaults&&c.defaults.sort&&(d=c.defaults.sort)}return d}},core.report.filtering.Filter=Class.create({initialize:function(a){this.options=Object.extend({ref:"",name:"",comment:"",filter:{},callname:"",subsystem:"",sort_by:"",sort_dir:"ASC",start_date:"",end_date:"",maxRows:0,timeframe:"today",department:"__all__"},a||{}),this.observers=[],this.deletable=!1,this.history=new core.report.filtering.FilterHistory,this.options.ref?this.loadRef(this.options.ref,!0):this.setTimeframe(this.options.timeframe,!0);if((!this.options.sort_by||this.options.sort_by=="0")&&this.options.callname){var b=$H(core.report.config.tableColumns[this.options.callname].defaults.sort);this.options.sort_by=b.keys()[0],this.options.sort_dir=b[this.options.sort_by]}core.report.filtering.filters[this.options.ref]=this,this.updateHistory()},updateHistory:function(a){a?this.history.current(Object.toJSON(this.options)):this.history.add(Object.toJSON(this.options))},backHistory:function(){this.goHistory(this.history.back())},forwardHistory:function(){this.goHistory(this.history.forward())},goHistory:function(a){a!==!1&&(this.options=a.evalJSON(),this.sendNotification({filter:this,updated:!0,event:"update",reinit:!0}))},loadRef:function(a,b){var c=get_object(a);this.options=Object.extend(this.options,c),this.options.filter=Object.clone(c.data.filter),this.options.callname=c.data.callname,this.options.subsystem=c.data.subsystem,this.options.name=c.name,this.options.sort_by=c.data.sort_by,this.options.sort_dir=c.data.sort_dir,this.setTimeframe(c.data.timeframe,b),this.setDepartment(c.data.department,b),this.options.maxRows=c.data.top,this.deletable=!0,this.updateHistory()},sendNotification:function(a){a.source="filter";for(var b=0,c=this.observers.length;b<c;)this.observers[b++](a)},update:function(a){var b,c=core.report.config.attributeMap;notification={filter:this,updated:!0,event:"update",reinit:!1},this.deletable=!1,a.attributes&&a.attributes.each(function(a){c[a.attribute].addToFilter!==!1&&(this.options.filter[a.attribute]||(this.options.filter[a.attribute]=""),this.options.filter[a.attribute]=a.value)}.bind(this)),notification.updated=a.actionAttribute,a.sort&&(this.options.sort_by=a.sort.attribute,this.options.sort_dir=a.sort.direction||"ASC"),this.updateHistory(),this.sendNotification(notification)},setDepartment:function(a,b){var c={filter:this,updated:"department",event:"update"};this.options.department=a||"__all__",b||(this.updateHistory(),this.sendNotification(c))},setTimeframe:function(a,b){var c="yyyy-MM-dd";this.options.timeframe=a;switch(a){case"all":this.setDates("","");break;case"today":day=DateFormat.format(new Date,c),this.setDates(day,day,b);break;case"yesterday":day=DateFormat.format(new Date(new Date-864e5),c),this.setDates(day,day,b);break;case"week":day=DateFormat.format(new Date(new Date-6048e5),c),this.setDates(day,DateFormat.format(new Date,c),b);break;case"month":day=DateFormat.format(new Date(new Date-26784e5),c),this.setDates(day,DateFormat.format(new Date,c),b);break;case"custom":}},setDates:function(a,b,c){var d,e={filter:this,updated:"start_date",event:"update"};this.deletable=!1,this.options.start_date=a,this.options.end_date=b,c||(this.updateHistory(),this.sendNotification(e))},setStartDate:function(a){var b,c={filter:this,updated:"start_date",event:"update"};this.deletable=!1,this.options.start_date=a,this.updateHistory(),this.sendNotification(c)},setEndDate:function(a){var b,c={filter:this,updated:"end_date",event:"update"};this.deletable=!1,this.options.end_date=a,this.updateHistory(),this.sendNotification(c)},addAttribute:function(a,b,c,d,e){var f,g={filter:this,updated:a,event:"update"},h=!1;g.manual=!!c,this.options.filter[a]||(this.options.filter[a]=[],h=!0);if(this.options.filter[a]!=b){if(!d||h&&d)this.options.filter[a]=b;e||this.updateHistory(),this.sendNotification(g)}},changeAttribute:function(a,b,c,d){delete this.options.filter[a],this.addAttribute(b,c,d)},removeAttribute:function(a,b){var c,d={filter:this,updated:a,event:"deleted"};this.options.filter[a]&&(delete this.options.filter[a],this.updateHistory(),this.sendNotification(d))},setCallname:function(a,b){if(!a)return!1;this.options.callname=a,core.report.config.tableColumns[this.options.callname].defaults.filter&&$H(core.report.config.tableColumns[this.options.callname].defaults.filter).each(function(a){this.addAttribute(a.key,a.value,!0,!0,!0)}.bind(this));var c={filter:this,updated:a,event:"set_callname"};this.deletable=!1,this.updateHistory(b),this.sendNotification(c)},setSortBy:function(a,b){var c,d={filter:this,event:"sort"};this.deletable=!1,this.options.sort_by=a,this.options.sort_dir=b||"ASC",this.updateHistory(),this.sendNotification(d)},updateMaxRows:function(a){var b,c={filter:this,updated:"maxRows",event:"updateMaxRows"};a==="0"&&(a=0),this.deletable=!1,this.options.maxRows=a,this.updateHistory(),this.sendNotification(c)},observe:function(a){this.observers.push(a)},save:function(){call_fid("webreport_filter_save",{callback:function(a){if(a.error)alert(a.error[0].text);else{if(a.confirm)return;if(a.success){alert("Filter successfully saved!");return}}}.bind(this)}.extend(this.options))},reset:function(){this.goHistory(this.history.home())}}),core.report.filtering.FilterHistory=function(){function f(a){var c,d=e(b);if(d){if(a<0)if(d.prev!==!1)c=e(d.prev),b=d.prev;else return!1;else if(d.next!==!1)c=e(d.next),b=d.next;else return!1;return c.value}return!1}function e(b){return a[b]||!1}function d(c){a[b]&&(a[b].value=c)}function c(c){var d={prev:b>=0?b:!1,value:c,next:!1},e=a.length;a[b]&&(a[b].next=e),a[e]=d,b=e;return d}var a=[],b=-1;return{add:function(a){return c(a)},back:function(){return f(-1)},forward:function(){return f(1)},current:function(a){var c=e(b);if(a)d(a);else if(c)return c.value||!1;return!1},home:function(){b=0;return e(b).value||"{}"},hasNext:function(){var a=e(b);if(a)return a.next!==!1;return!1},hasPrev:function(){var a=e(b);if(a)return e(b).prev!==!1;return!1}}},core.report.filtering.Choice=function(a){function i(){c.close()}function h(){var a,f,g=e.length,h=0;c=new Window({className:"astaro",top:b[1]||30,left:b[0]||60,width:960,height:500,minimizable:!1,maximizable:!1,closable:!1,title:_LOC("YidsLIdajS","Reporting Direction"),maxWidth:document.viewport.getWidth()-30,maxHeight:document.viewport.getHeight()-60,destroyOnClose:!0});for(a=0;a<g;a++)f=e[a].toHTML(),d.appendChild(f);c.setContent(d),h=g>3?960+core.tools.getScrollbarWidth():g*320,c.setSize(h,500),c.show(!0)}function g(b,c){var d,f,g=[],h=function(a){i(),c(a)},j=b.length;for(d=0;d<j;d++)f=new core.report.filtering.ChoiceCard({callname:b[d],filter:a.filter,callback:h}),e.push(f),req_send({objs:[f.getCall()]})}function f(){d.update(),e=[]}a=Object.extend({filter:{},listener:Prototype.emptyFunction},a||{});var b=$("content_wrapper").cumulativeOffset(),c,d=$(Builder.node("div")),e=[];return{getNextReport:function(b,c){var d=a.filter.options,e=core.report.filtering.getAvailableReports(b,d.callname,d.filter);e.length>1?(f(),g(e,c),h()):c(e[0])}}},core.report.filtering.ChoiceCard=function(a){function n(b){var c=[],d,e,i=core.report.config;b=b.result||!1,i.tableColumns[a.callname]&&i.tableColumns[a.callname].small&&(g=Builder.node("tr",{className:"REPORTING_itembox_tablehead"}),i.tableColumns[a.callname].small.each(function(a,g){if(a.attribute)if(b.length){h.update(),button_init(h,{label:_LOC("ZvmZMNyYNJ","Select this view"),icon:"core/img/icons/check.png",small:!0});for(e=0;e<10;e++){c[e]?d=c[e]:(d=Builder.node("tr",{className:"ng_rep_choice_row_"+(e%2?"odd":"even")}),d.appendChild(Builder.node("td",{className:"ng_rep_choice_row_cell"},e+1)),f.appendChild(d)),b[e]||(b[e]={});var j=b[e][a.attribute]||" ",k=i.attributeMap[a.attribute],l=i.typeMap[k?k.type:"text"];j&&(l&&b[e][a.attribute]&&(j=l(j)),d.appendChild(Builder.node("td",{className:"ng_rep_choice_row_cell"},Builder.node("div",{style:"white-space:nowrap;max-width:"+a.width+"px;"+"overflow-x:hidden;"+"float:"+(a.align||"left")+";",className:"ellipsis"},j)))),c[e]||c.push(d)}}else h.update(this.emptyString)}))}function m(){a.callback(a.callname)}a=Object.extend({callname:"",filter:{},title:""},a||{});var b=core.report.config,c=a.callname;b.tableColumns[c]&&b.tableColumns[c].caption&&(c=b.tableColumns[c].caption);var d=Builder.node("table",{cellpadding:"0",cellspacing:"0",border:"0",width:"100%"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"ir_table_caption_left"}),Builder.node("td",{className:"ir_table_caption_center"},[Builder.node("span",{},c)]),Builder.node("td",{className:"ir_table_caption_right"})])])),e=Builder.node("div",{}),f=Builder.node("tbody",{}),g=Builder.node("tr",{className:"REPORTING_itembox_tablehead"}),h=$(Builder.node("td",{colspan:g.length},_LOC("mFDSpCXUJx","Please wait, loading..."))),i=Builder.node("tfoot",Builder.node("tr",[h])),j=Builder.node("div",{style:"min-width: 314px;float:left;margin:2px;cursor:pointer;position:relative;"},d),k;g.appendChild(Builder.node("th","#")),b.tableColumns[a.callname]&&b.tableColumns[a.callname].small&&(h.setAttribute("colspan",b.tableColumns[a.callname].small.length+1),h.setStyle({textAlign:"center"}),b.tableColumns[a.callname].small.each(function(a){a.attribute&&g.appendChild(Builder.node("th",{},b.attributeMap[a.attribute].caption.text||a.attribute))})),reportHeader=Builder.node("thead",{},g),e.appendChild(Builder.node("table",{border:"0",cellspacing:"0",cellpadding:"0",style:"width:100%;"},[reportHeader,f,i]));if(!k){var l=Builder.node("div",{style:"position:absolute;margin:2px;right:0;top:0;"});k=$(Builder.node("div",{className:"ng_rep_choice_modiv"},[Builder.node("div"),l])),k.show(),j.appendChild(k)}Event.observe(j,"mouseover",function(){k&&k.hide()}),Event.observe(j,"mouseout",function(){k&&k.show()});return{toHTML:function(){Event.observe(j,"click",m),j.appendChild(e);return j},getCall:function(){var b=a.filter.options;return{FID:"get_report_data",start_line:0,end_line:10,start_date:b.start_date,end_date:b.end_date,callname:a.callname,filter:core.report.filtering.sanitizeFilter(b.filter,a.callname),sort:core.report.config.tableColumns[a.callname].defaults.sort,callback:n}}}},core.report.filtering.ChartWindow=Class.create(Window,{initialize:function($super,a){var b;this.options=Object.extend({filter:{},width:600,height:200,destroyOnClose:!0},a||{}),this.filter=this.options.filter,this.filter.observe(this.load.bind(this)),this.chartActive=!1,this.options.anchor&&(b=$(this.options.anchor).cumulativeOffset(),this.options.top=b[1],this.options.left=b[0]-this.options.width),$super(Object.extend({className:"astaro"},this.options||{})),this.getContent().style.overflow="hidden",this.load()},load:function(){var a=this.filter.options;this.currentCallname=a.callname,call_fid("get_report_data",{start_line:0,end_line:10,start_date:a.start_date,end_date:a.end_date,department:a.department,filter:a.filter,sort:this.sorting||{traffic:"DESC"},callname:a.callname,callback:this.load_cb.bind(this)})},load_cb:function(a){function f(a){var b,c={},d=core.report.config.attributeMap,e=core.report.config.typeMap;for(b in a){if(!a[b])continue;a.hasOwnProperty(b)&&(d[b]&&d[b].type&&e[d[b].type]?c[b]=e[d[b].type](a[b]):c[b]=a[b])}return c}var b=core.report.config.tableColumns[a.callname].chart,c,d=[],e=new Template(b.tip);this.currentKey=b.key,a=a.result,c=a.length;while(c--){var g=a[c],h=e.evaluate(f(g));d.push({label:g[b.key],value:g[b.default_value],tip:h||g[b.key]+"\n"+g[b.default_value]})}this.chartActive?this.chart.update(d):(this.chart=chart_init({type:"pie",title:"",name:this.options.name||"test",values:d,container:this.getContent().id,onclick:this.onClick.bind(this),radius:35}),this.chartActive=!0)},onClick:function(a){this.filter.addAttribute(this.currentKey,a.label)}}),core.report.filtering.FilterDialog=function(a){function Z(a){var c=a.filter;c&&a.event=="update"&&a.updated!="start_date"&&a.updated!="end_date"&&(X(),!a.reinit&&!a.manual&&H.getNextReport(a.updated,function(a){this.setCallname(a,!0)}.bind(b))),(c&&a.event=="deleted"||a.event=="reset")&&X(),c&&a.event=="set_callname"&&X(),c.options.sort_by?(e={},e[c.options.sort_by]=c.options.sort_dir):e=core.report.filtering.sanitizeSorting(e,c.options.callname),Y()}function Y(){h.update((E?"*":"")+G)}function X(){if(!f){G=g,b&&b.options&&b.options.data&&(G=b.options.data.name),h=$(Builder.node("span",G)),K(),j=Builder.node("select",{style:"width:70px;"}),$H({0:_LOC("lLvShaaLGt","All"),10:_LOC("ARMEmoWMMh","Top 10"),50:_LOC("qbkOShZjtF","Top 50"),100:_LOC("gpgTYvFARk","Top 100")}).each(function(a){var c=new Option(a.value,a.key,a.key==b.options.maxRows);j.options[j.options.length]=c}.bind(this)),Event.observe(j,"change",function(){var a=$F(j);b.updateMaxRows(a)}),w=Builder.node("li",{style:"cursor:pointer;float: left; list-style: none outside none; margin-left: 5px; border-width:1px; border-color:black;"},j),z=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/download.png",title:_LOC("dWfTHCcFfb","Save"),onclick:O}),p=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/cancel.png",title:_LOC("yxovYiuXlX","Delete"),onclick:S}),t=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/lightgreen_arrow_left.png",title:_LOC("qDMlQKSJMx","Undo"),style:"cursor:pointer;float: left; list-style: none outside none; margin-left: 5px; border-width:1px; border-color:black;",onclick:function(){b.backHistory()}}),u=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/lightgreen_arrow_right.png",style:"cursor:pointer;float: left; list-style: none outside none; margin-left: 5px; border-width:1px; border-color:black;",title:_LOC("IOxfbCNZmN","Redo"),onclick:function(){b.forwardHistory()}}),v=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/home.png",style:"cursor:pointer;float: left; list-style: none outside none; margin-left: 0px; border-width:1px; border-color:black;",title:_LOC("TYylIYmkkJ","Home"),onclick:function(){b.reset()}}),A=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/send.png",title:_LOC("JKUAREHHHU","Send"),onclick:T}),r=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/download_pdf.png",title:_LOC("mDqlOdiGZx","Export as PDF"),onclick:U}),q=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/download_csv.png",title:_LOC("UxeUcQKaHs","Export as CSV"),onclick:V}),y=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/pie_chart.png",title:_LOC("cXnviNQxQT","Open piechart"),onclick:W}),n=new core.report.filtering.FilterDialog.MenuButton({icon:"core/img/icons/plus.png",style:"cursor:pointer;float: left;list-style: none outside none;margin-left: 5px;border-width:1px;border-color:black;",title:_LOC("jURMuwwCgn","Add Filter"),onclick:R}),k=Builder.node("select",{style:"width:160px;"});var a=get_objects("reporting",["department"]);a.length?(k.options[k.options.length]=new Option(_LOC("NumNFkGYhi","All Departments"),"__all__","__all__"===b.options.department),a.each(function(a){var c=new Option(a.data.name,a.ref,a.ref===b.options.department,a.ref===b.options.department);k.options[k.options.length]=c}.bind(this))):k.options[k.options.length]=new Option(_LOC("OPscvCdkOf","No Departments defined"),"__all__","__all__"===b.options.department),Event.observe(k,"change",function(){b.setDepartment($F(k))}),x=Builder.node("li",{style:"cursor:pointer;float: left;list-style: none outside none;margin-left: 5px;border-width:1px;border-color:black;"},k);var c=Builder.node("input",{value:b.options.start_date,type:"date",style:"height: 16px; width:70px; border-width:1px;padding:0;"}),e=Builder.node("input",{value:b.options.end_date,type:"date",style:"height: 16px; width:70px; border-width:1px;padding:0;"}),l=new core.date.TimeframePicker({maxDate:new Date,panelLeftTitle:_LOC("mqIBNBZTws","Select From-Date"),panelRightTitle:_LOC("HnYtjbBgtu","Select Until-Date"),oncomplete:function(a){var d="yyyy-MM-dd",f=DateFormat.format(a.firstDay,d),g=DateFormat.format(a.lastDay,d);c.value=f,e.value=g,b.setDates(f,g)}});s=$(Builder.node("li",{style:"float: left;list-style: none outside none;margin-left: 5px;border-width:1px;border-color:black;"},[Builder.node("span",{},"From"),c])),B=$(Builder.node("li",{style:"float: left;list-style: none outside none;margin-left: 5px;border-width:1px;border-color:black;"},[Builder.node("span",{},"Until"),e]));var E=function(a){Event.stop(a),l.show(s)};Event.observe(s,"click",E),Event.observe(B,"click",E),C=Builder.node("select",{style:"width:85px;"}),$H({all:_LOC("imIUfuTWnj","Any Time"),today:_LOC("DJKrsCEIEw","Today"),yesterday:_LOC("zbmJdEmnQE","Yesterday"),week:_LOC("GgyPsIJlPs","Last Week"),month:_LOC("GSnGHWuwwF","Last Month"),custom:_LOC("eoAMCIZsBM","Custom")}).each(function(a){var c=new Option(a.value,a.key,b.options.timeframe==a.key,b.options.timeframe==a.key);C.options[C.options.length]=c}.bind(this)),Event.observe(C,"change",function(){var a=$F(C),d,f="yyyy-MM-dd";a!="custom"?(s.hide(),B.hide(),b.setTimeframe(a)):(c.value=b.options.start_date,s.show(),e.value=b.options.end_date,B.show())}),o=Builder.node("li",{style:"float: left; list-style: none outside none; margin-left: 5px; border-width:1px; border-color:black;"},[C]),m=Builder.node("ul",{style:"padding:0;position:relative;margin: 2px 0 5px 0;"},[n.toHTML(),w,o,s,B,x,A.toHTML(),r.toHTML(),q.toHTML(),y.toHTML()]),s.hide(),B.hide(),D=$(Builder.node("td",{colSpan:3})).setStyle({paddingBottom:"10px",backgroundColor:"#FAFAFA"});var F=$(Builder.node("td",{className:"ir_table_caption_center"},[Builder.node("ul",{style:"line-height:18px;float:left;padding:0;position:relative;margin: 2px 0 3px 0;"},[v.toHTML(),t.toHTML(),u.toHTML(),Builder.node("li",{style:"float: left; list-style: none outside none; margin-left: 5px;"},h)]),Builder.node("ul",{style:"line-height:18px;float:right;padding:0;position:relative;margin: 2px 0 3px 0;"},[Builder.node("li",{style:"float: left; list-style: none outside none; margin-left: 5px;"},Builder.node("span",{},_LOC("fIKbxIooJX","Available Reports:")+" ")),Builder.node("li",{style:"float: left; list-style: none outside none; margin-left: 5px;"},i),z.toHTML(),p.toHTML()])])).setStyle({paddingTop:"1px",paddingLeft:"0",paddingRight:"0"});f=Builder.node("table",{id:Math.random(),cellpadding:"0",cellspacing:"0",border:"0",width:"100%"},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{className:"ir_table_caption_left"}),F,Builder.node("td",{className:"ir_table_caption_right"})]),Builder.node("tr",{},[$(Builder.node("td",{colSpan:3,className:"dashboard_box_content_div"},m))]),Builder.node("tr",{},[D])]))}b.options.ref?(b.deletable?p.enable():p.disable(),i.value="__custom__"+b.options.ref):(p.disable(),b.options.callname?i.value="__standard__"+b.options.callname:i.options[0].selected=!0),j.value=b.options.maxRows,C.value=b.options.timeframe,k.value=b.options.department,b.history.hasPrev()?t.enable():t.disable(),b.history.hasNext()?u.enable():u.disable();if(b&&b.options.filter){D.update(),d={};var H=core.report.filtering.sanitizeFilter(b.options.filter,b.options.callname);$H(b.options.filter).each(function(a){var c=new core.report.filtering.FilterDialogObject({attributename:a.key,values:a.value,onsave:b.addAttribute.bind(b),onupdate:b.changeAttribute.bind(b),onremove:b.removeAttribute.bind(b)});d[a.key]=c,D.appendChild(c.toHTML()),H[a.key]||c.disable()})}return f}function W(){var a=new core.report.filtering.ChartWindow({anchor:y.toHTML(),title:_LOC("uXwpWoPrLR","TOP 10 PieChart"),filter:b});F=!0,a.show()}function V(){var a=b.options;call_fid("get_report_csv",{start_line:0,end_line:a.maxRows||!1,start_date:a.start_date,end_date:a.end_date,department:a.department,filter:core.report.filtering.sanitizeFilter(a.filter,a.callname),sort:e||{traffic:"DESC"},callname:a.callname,callback:function(a){if(a.result)var b=new core.report.CSVDownloadWindow({handle:a.result,anchor:q.toHTML()})}.bind(this)})}function U(){var a=b.options;call_fid("get_report_pdf",{start_line:0,end_line:a.maxRows||!1,start_date:a.start_date,end_date:a.end_date,department:a.department,filter:core.report.filtering.sanitizeFilter(a.filter,a.callname),sort:e||{traffic:"DESC"},callname:a.callname,callback:function(a){if(a.result)var b=new core.report.PDFDownloadWindow({handle:a.result,anchor:r.toHTML()})}.bind(this)})}function T(){var a=b.options,c=new core.ngPopup({name:"POPUP_reporting_websecurity_sendmail","class":"reporting",type:"sendmail",anchor:A.toHTML(),openLeft:!0,passthru:{start_date:a.start_date,end_date:a.end_date,start_line:0,end_line:a.maxRows||!1,filter:a.filter,sort:e||{traffic:"DESC"},callname:a.callname,department:a.department},modal:!0})}function S(){b.options.ref&&req_send({objs:[{FID:"obj_delete",obj_ref:b.options.ref,callback:function(a){if(typeof a.error=="string")alert(a.error);else{if(Object.isArray(a.error)){alert(a.error[0].text);return}if(a.confirm&&a.confirm.length){var c=[],d;for(d=0;d<a.confirm.length;d++)c.push(a.confirm[d].text);confirm_dialog({message:c,ok_cb:function(){delete a.confirm,a.callback=function(a){L(a.success),delete b.options.ref,b.deletable=!1,p.disable()}.bind(this),req_send({objs:[a]})}})}}}}]})}function R(){var a,c=new core.report.filtering.FilterDialogObject({onsave:b.addAttribute.bind(b),onremove:b.removeAttribute.bind(b),onneweditcancel:function(){this.removeChild(a)}.bind(D),edit:!0});a=c.toHTML(),D.appendChild(a)}function Q(){b.reset()}function P(a){core.formMap[a.form_name].submit_result(a),M(a.success,!0),J(a.success)}function O(){var c=new core.ngPopup({name:"POPUP_reporting_websecurity","class":"reporting",type:"filter",anchor:z.toHTML(),openLeft:!0,passthru:b.options,obj_ref:b.options.ref||!1,modal:!0,saveCallback:"core.report.map["+a.reportNumber+"].filterDialog.save_cb"})}function N(b){a.listener()}function M(b,c){var d=get_object(b);l.appendChild(new Option(d.data.name,"__custom__"+d.ref,c,c)),a.customReports[b]=d.data.name}function L(b){delete a.customReports[b],I()}function K(){if(!i){var a=Builder.node("optgroup",{label:_LOC("QCeRvfRaPD","Standard")});$H(c.tableColumns).each(function(b){var c=document.createElement("option");a.appendChild(c),c.value="__standard__"+b.key,c.text=b.value.caption}),I();var d=new Option(_LOC("xpRMMMfIbJ","Please select"),"__please_select__",!0,!0);d.setAttribute("selected","selected"),d.defaultSelected=!0,i=document.createElement("select"),i.options[0]=d,i.appendChild(a),i.appendChild(l),Event.observe(i,"change",function(){var a=$F(i);a!="__please_select__"&&(a.startsWith("__custom__")?J(a.replace("__custom__","")):(b.options.sort_by="traffic",b.options.sort_dir="DESC",delete b.options.ref,G=g,b.setCallname(a.replace("__standard__",""))))})}}function J(c){var d=(new core.report.Report({filter:{ref:c,subsystem:b.options.subsystem},container:a.reportContainer,customReports:a.customReports})).load(!0)}function I(b){l?$(l).update():l=Builder.node("optgroup",{label:c.customReportsTitle||_LOC("uwsDBzpIeK","Custom")});var d=$H(a.customReports);d.each(function(a){var c=document.createElement("option");l.appendChild(c),c.value="__custom__"+a.key,c.text=a.value,b&&a.key==b&&c.setAttribute("selected","selected")})}a=Object.extend({filter:{},customReports:{},listener:Prototype.emptyFunction},a||{});var b=a.filter,c=core.report.config,d={},e,f,g=_LOC("WfgBSuISbI","New custom Report"),h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=new core.report.filtering.Choice({filter:b});b.options.sort_by&&b.options.sort_dir&&(e={},e[b.options.sort_by]=b.options.sort_dir||"DESC"),b.observe(Z);return{toHTML:X,save_cb:P,notify:Z}},core.report.filtering.FilterDialog.MenuButton=function(a){function d(){c&&a.onclick()}a=Object.extend({icon:"",style:"cursor:pointer;float: right;list-style: none outside none; margin-left: 5px;border-width:1px; border-color:black;",title:"",onclick:Prototype.emptyFunction},a||{});var b=$(Builder.node("li",{style:a.style},Builder.node("img",{src:a.icon,alt:a.title,title:a.title}))),c=!0;Event.observe(b,"click",d);return{toHTML:function(){return b},enable:function(){c=!0,b.removeClassName("opaque"),b.style.cursor="pointer"},disable:function(){c=!1,b.addClassName("opaque"),b.style.cursor="default"}}},core.report.filtering.FilterDialogObject=function(a){function t(){h.hide(),i=!1}function s(){h.show(),i=!0}function r(a){e=a}function q(){var e=a.attributename,f=d;b=!0,c.update(),c.appendChild(o(e,f))}function p(b,c){var d=core.report.config.attributeMap[b],e,f,g,i,j;if(!!b&&!!c){g=Builder.node("div",{style:"font-weight: bold;padding:0 2px;"},d.caption.text||b),i=Builder.node("ul",{style:"padding:0;margin:0;"}),f=Builder.node("li",{style:"list-style: none outside none;padding-left:5px;overflow:hidden;margin:3px;"},c),i.appendChild(f);var k=Builder.node("div",{style:"position:absolute;margin:2px;right:15px;top:0;cursor:pointer;"},Builder.node("img",{src:"core/img/icons/edit.png",title:_LOC("tpYVxWAoDx","Edit"),alt:_LOC("HKbGovhfLM","Edit")})),l=Builder.node("div",{style:"position:absolute;margin:2px;right:0;top:0;cursor:pointer;"},Builder.node("img",{src:"core/img/icons/delete.png",title:_LOC("PnUxmLaOcp","Delete"),alt:_LOC("rXJGqulbwW","Delete")}));h=$(Builder.node("div",{style:"position:absolute;margin:2px;right:32px;top:0;"},Builder.node("img",{src:"core/img/icons/forbidden.png",title:_LOC("hYFzJLZGhJ","This filterattribute has been disabled for the current view"),alt:_LOC("XkdHluMvQb","This filterattribute has been disabled for the current view")}))).hide(),Event.observe(k,"click",q),Event.observe(l,"click",a.onremove.curry(b,a.values)),j=Builder.node("div",{style:"position:relative;border:1px solid #AAAAAA; background-color: #EEEEEE; width:150px;float:left;margin:5px 0 0 5px;"},[g,i,k,l,h]);return j}}function o(b,c){var d=[],e,f,g,h,i;e=document.createElement("select"),e.style.width="144px",$H(core.report.config.attributeMap).each(function(a){if(a.value.addManual){b||(b=a.key);var c=a.value.caption.text||a.key;e.options[e.options.length]=new Option(c,a.key,a.key===b,a.key===b)}}),f=$(j(b)),Event.observe(e,"change",function(){var a=$($(f).up());a.update(),f=j($F(e)),a.appendChild(f)}),Event.observe(f,"keyup",function(b){if(b.keyCode==27)l();else if(b.keyCode==13){a.attributename?n(a.attributename,$F(e),$F(f)):m($F(e),$F(f)),k();return}}),g=Builder.node("div",{}),button_init(g,{label:_LOC("UKGZqEAwjM","Cancel"),icon:"core/img/icons/delete.png",small:!0,width:70,button_float:"right",onclickfunc:l}),h=Builder.node("div",{}),button_init(h,{label:_LOC("xvTtaiOMfm","Save"),width:70,button_float:"right",onclickfunc:function(){a.attributename?n(a.attributename,$F(e),$F(f)):m($F(e),$F(f)),k()},icon:"core/img/icons/edit.png",small:!0}),i=Builder.node("div",{style:"position:relative;border:1px solid #AAAAAA;background-color: #EEEEEE; width:150px;float:left;margin:5px 0 0 5px;"},Builder.node("table",{},Builder.node("tbody",{},[Builder.node("tr",{},[Builder.node("td",{},Builder.node("div",e))]),Builder.node("tr",{},[Builder.node("td",{},Builder.node("div",f))]),Builder.node("tr",{},[Builder.node("td",{},[g,h])])])));return i}function n(d,f,g){b=!1,a.onneweditcancel&&(a.onneweditcancel=!1),c.update(),c.appendChild(p(f,e||g)),a.onupdate(d,f,e||g,!0)}function m(d,f){b=!1,a.onneweditcancel&&(a.onneweditcancel=!1),c.update(),c.appendChild(p(d,e||f)),a.onsave(d,e||f,!0)}function l(){var e=a.attributename,f=d;a.onneweditcancel?(a.onneweditcancel(),a.onneweditcancel=!1):(b=!1,c.update(),c.appendChild(p(e,f)),i&&s())}function k(){var e=a.attributename;b=!1,c.update(),c.appendChild(p(e,d)),i&&s()}function j(b){var c=core.report.config.attributeMap[b];return c.renderInput?c.renderInput(a.values||"",r):Builder.node("input",{value:a.values||"",style:"border:1px solid #666666;width:142px;"})}a=Object.extend({attributename:"",values:[],onsave:Prototype.emptyFunction,onremove:Prototype.emptyFunction},a||{});var b=!!a.edit,c,d,e,f,g,h,i=!1;return{disable:s,enable:t,toHTML:function(){var e=a.attributename,f,g,h=a.values,j=core.report.config.attributeMap[e],k=core.report.config.typeMap;j&&k[j.type]&&(d=h=k[j.type](h)),c=$(Builder.node("div",b?o(e,h):p(e,h))),i&&s();return c}}},core.report.PDFDownloadWindow=Class.create(Window,{initialize:function($super,a){this.options=Object.extend({width:300,height:100,handle:!1,minimizable:!0,onClose:function(){this.timeout&&(window.clearTimeout(this.timeout),this.closed=!0)}.bind(this)},a||{});if(this.options.anchor){var b=$(this.options.anchor).cumulativeOffset();this.options.top=b[1],this.options.left=b[0]-this.options.width}$super(Object.extend({className:"astaro"},this.options||{})),this.start()},start:function(){if(!this.options.handle)return!1;this.show(),this.setContent(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("span",_LOC("OzRUjpnIHV","Please wait while generating PDF..."))])),this.getStatus()},onError:function(a){this.setContent(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("img",{src:"core/img/icons/warning.png",align:"left"}),Builder.node("span",{},a)]))},onSuccess:function(a){var b=$(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("span",{},[Builder.node("a",{href:a},[Builder.node("img",{src:"core/img/icons/download_big.png",align:"left"}),Builder.node("span").update(_LOC("aIYdNzbAal","Please right click on the left icon and then click 'Save Target As' to save the file to your hard disk."))])])]));Event.observe(b,"mouseup",this.handleDownloadClick.bind(this)),this.setContent(b)},handleDownloadClick:function(a){a.which===1&&this.close()},getStatus:function(){call_fid("get_report_pdf",{handle:this.options.handle,callback:function(a){a.result&&a.result.status&&a.result.status=="finished"?this.onSuccess(a.result.file):(a.error&&this.onError(a.error[0].text),a.result&&a.result.error?this.onError(a.result.status):!this.closed&&a.result&&a.result.status&&a.result.status==="running"&&(this.timeout=window.setTimeout(this.getStatus.bind(this),500)))}.bind(this)})}}),core.report.CSVDownloadWindow=Class.create(Window,{initialize:function($super,a){this.options=Object.extend({width:300,height:100,handle:!1,minimizable:!0,onClose:function(){this.timeout&&(window.clearTimeout(this.timeout),this.closed=!0)}.bind(this)},a||{});if(this.options.anchor){var b=$(this.options.anchor).cumulativeOffset();this.options.top=b[1],this.options.left=b[0]-this.options.width}$super(Object.extend({className:"astaro"},this.options||{})),this.start()},start:function(){if(!this.options.handle)return!1;this.show(),this.setContent(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("span",_LOC("pNLczUTAro","Please wait while generating CSV..."))])),this.getStatus()},onError:function(a){this.setContent(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("img",{src:"core/img/icons/warning.png",align:"left"}),Builder.node("span",{},a)]))},onSuccess:function(a){var b=$(Builder.node("div",{style:"width:100%;text-align:center;"},[Builder.node("span",{},[Builder.node("a",{href:a},[Builder.node("img",{src:"core/img/icons/download_big.png",align:"left"}),Builder.node("span").update(_LOC("IwcmiOmuXv","Please right click on the left icon and then click 'Save Target As' to save the file to your hard disk."))])])]));Event.observe(b,"mouseup",this.handleDownloadClick.bind(this)),this.setContent(b)},handleDownloadClick:function(a){a.which===1&&this.close()},getStatus:function(){call_fid("get_report_csv",{handle:this.options.handle,callback:function(a){a.result&&a.result.status&&a.result.status=="finished"?this.onSuccess(a.result.file):(a.error&&this.onError(a.error[0].text),a.result&&a.result.error?this.onError(a.result.status):!this.closed&&a.result&&a.result.status&&a.result.status==="running"&&(this.timeout=window.setTimeout(this.getStatus.bind(this),500)))}.bind(this)})}}),core.date={},core.date.DateRange=function(a,b){this.firstDay=new Date(a),this.lastDay=new Date(b),this.currentDay=this.firstDay},core.date.DateRange.prototype=function(){function b(a,b){var c=a.getDate(),d=a.getMonth(),e=a.getFullYear(),f;b.day&&(c+=b.day),b.month&&(d+=b.month),b.year&&(e+=b.year);return new Date(e,d,c)}function a(a,b,c){return a>=b&&a<=c}return{first:function(){this.currentDay=this.firstDay;return this.firstDay},last:function(){this.currentDay=this.lastDay;return this.lastDay},next:function(){var c=b(this.currentDay,{day:1});if(!a(c,this.firstDay,this.lastDay))return!1;this.currentDay=c;return this.currentDay},previous:function(){var c=b(this.currentDay,{day:-1});if(!a(c,this.firstDay,this.lastDay))return!1;this.currentDay=c;return this.currentDay},has:function(b){return a(b,this.firstDay,this.lastDay)}}}(),core.date.Calendar=function(a){var b=new Date,c=new Date(b.getFullYear(),b.getMonth(),1);this.options=Object.extend({month:c.getMonth(),year:c.getFullYear(),onclick:function(a){console.log(a)},offset:-1,minDate:!1,maxDate:!1},a||{}),this.options.minDate||(this.options.minDate=new Date(this.options.year,this.options.month,1)),this.options.maxDate||(this.options.maxDate=new Date(new Date(this.options.minDate.getFullYear(),this.options.minDate.getMonth()+1,1)-1)),this.dateRange=new core.date.DateRange(this.options.minDate,this.options.maxDate),this.htmlElement=""},core.date.Calendar.prototype=function(){function f(){return["M","T","W","T","F","S","S"]}function e(a){return["January","February","March","April","May","June","July","August","September","October","November","December"][a]}function d(a){return c(a,2)===29}function c(a,b){return(new Date(new Date(a,b+1,1)-1)).getDate()}function b(b,c,d){var e=a(b,c).getDay()+d;return e<0?6:e}function a(a,b){return new Date(a,b,1)}return{toHTML:function(){var a=Builder.node("span",{className:"title"},e(this.options.month)+" "+this.options.year),d=f(),g=[],h=0,i=0,j=[],k=1,l,m=[],n="",o=this.options.year,p=this.options.month,q=c(o,p),r=b(o,p,this.options.offset);for(;h<7;)g.push(Builder.node("th",{},d[h++]));j.push(Builder.node("tr",g));for(h=0;h<10;h++){m=[];for(i=0;i<7;i++)n=$(Builder.node("td")),k<=q&&(h>0||i>=r)&&(n.innerHTML=k,l=new Date(this.options.year,this.options.month,k++),this.dateRange.has(l)?(Event.observe(n,"click",this.options.onclick.curry(l)),n.addClassName("day")):n.addClassName("day_disabled")),m.push(n);j.push(Builder.node("tr",m));if(k>q)break}var s=Builder.node("table",{className:"ngCalendarTableGrid"},Builder.node("tbody",j));this.htmlElement=Builder.node("table",{className:"ngCalendarTable"},Builder.node("tbody",[Builder.node("tr",{},[Builder.node("td",{},a)]),Builder.node("tr",[Builder.node("td",s)])]));return this.htmlElement},mark:function(a){!(a instanceof core.date.DateRange)}}}(),core.date.CalendarPanel=function(a){this.options=Object.extend({cssFloat:!1,panelTitle:""},a||{}),this.calendar=new core.date.Calendar(a),this.options.month||(this.options.month=this.calendar.options.month),this.options.year||(this.options.year=this.calendar.options.year),this.calendarContainer=$(Builder.node("div",{className:"ngCalendarPanelCalendarContainer"},this.calendar.toHTML())),this.htmlElement=$(Builder.node("div",{className:"ngCalendarPanel"})),this.options.cssFloat&&this.htmlElement.setStyle({cssFloat:this.options.cssFloat})},core.date.CalendarPanel.prototype=function(){function f(b,c){this.options.minDate=b,this.options.maxDate=c,a.apply(this)}function e(){var b=this.calendar.options.month,c=this.calendar.options.year-1;this.options.month=b,this.options.year=c,a.apply(this)}function d(){var b=this.calendar.options.month,c=this.calendar.options.year+1;this.options.month=b,this.options.year=c,a.apply(this)}function c(){var b=this.calendar.options.month-1,c=this.calendar.options.year;b<0&&(b=11,c--),this.options.month=b,this.options.year=c,a.apply(this)}function b(){var b=this.options.month+1,c=this.options.year;b>11&&(b=0,c++),this.options.month=b,this.options.year=c,a.apply(this)}function a(){this.calendar=new core.date.Calendar({month:this.options.month,year:this.options.year,minDate:this.options.minDate,maxDate:this.options.maxDate,onclick:this.options.onclick}),this.calendarContainer.update(),this.calendarContainer.appendChild(this.calendar.toHTML())}return{toHTML:function(){this.options.panelTitle&&this.htmlElement.appendChild(Builder.node("span",{className:"panelTitle"},this.options.panelTitle)),this.htmlElement.appendChild(this.calendarContainer);var a=Builder.node("div",{className:"button prevyear"},"<<");Event.observe(a,"click",e.bind(this)),this.htmlElement.appendChild(a);var f=Builder.node("div",{className:"button prevmonth"},"<");Event.observe(f,"click",c.bind(this)),this.htmlElement.appendChild(f);var g=Builder.node("div",{className:"button nextyear"},">>");Event.observe(g,"click",d.bind(this)),this.htmlElement.appendChild(g);var h=Builder.node("div",{className:"button nextmonth"},">");Event.observe(h,"click",b.bind(this)),this.htmlElement.appendChild(h);return this.htmlElement},setMinDate:function(a){f.apply(this,[a,this.options.maxDate])},setMaxDate:function(a){f.apply(this,[this.options.minDate,a])}}}(),core.date.TimeframePicker=function(a){function b(){this.minDate&&this.maxDate&&(this.options.oncomplete(new core.date.DateRange(this.minDate,this.maxDate)),this.close())}this.options=Object.extend({panelLeftTitle:"",panelRightTitle:"",onclickLeft:function(a){},onclickRight:function(a){},oncomplete:function(a){console.log(a.firstDay+" - "+a.lastDay)}},a||{}),this.minDate=!1,this.maxDate=!1,this.panelLeft=new core.date.CalendarPanel({panelTitle:this.options.panelLeftTitle,onclick:function(a){this.minDate=a,this.panelRight.setMinDate(a),this.options.onclickLeft(a)}.bind(this),cssFloat:"left"}.extend(a)),this.panelRight=new core.date.CalendarPanel({panelTitle:this.options.panelRightTitle,onclick:function(a){this.maxDate=a,b.apply(this),this.panelLeft.setMaxDate(a),this.options.onclickRight(a)}.bind(this),cssFloat:"right"}.extend(a)),this.htmlElement=Builder.node("div",{className:"ngCalendarTimeFrame"},[this.panelLeft.toHTML(),this.panelRight.toHTML()])},core.date.TimeframePicker.prototype=function(){function a(){$(this.htmlElement).hide()}return{toHTML:function(){return this.htmlElement},show:function(a){function d(a){$(Event.element(a)).up(".ngCalendarTimeFrame")||(c.close(),Event.stopObserving($(document.body),"click",d))}document.body.appendChild(this.htmlElement),$(this.htmlElement).show();var b=$(a).cumulativeOffset();this.htmlElement.setStyle({top:b[1]+"px",left:b[0]+"px",zIndex:10});var c=this;Event.observe($(document.body),"click",d)},close:function(){a.apply(this)}}}(),core.date.DatePicker=function(a){this.date=!1,this.options=Object.extend({panelTitle:"",cssFloat:"left",onselect:function(a){}},a||{}),this.options.onclick=function(a){this.date=a,this.options.onselect.apply(this,[a])}.bind(this),this.panel=new core.date.CalendarPanel(this.options),this.htmlElement=Builder.node("div",{className:"ngCalendarTimeFrame"},[this.panel.toHTML()])},core.date.DatePicker.prototype=function(){function a(){$(this.htmlElement).hide()}return{toHTML:function(){return this.htmlElement},show:function(a,b){this.input=$(a);if(this.input){var c=this.input.cumulativeOffset();b&&b.offset&&(c[0]+=b.offset.left,c[1]+=b.offset.top),this.htmlElement.setStyle({top:c[1]+"px",left:c[0]+"px",zIndex:10}),document.body.appendChild(this.htmlElement),this.registerEvents(),$(this.htmlElement).show()}},registerEvents:function(){this.onKeyUpHandler=function(a){this.close()}.bind(this),this.onClickHandler=function(a){!$(Event.element(a)).up(".ngCalendarTimeFrame")&&Event.element(a)!=this.input?this.close():Event.element(a)==this.input&&Event.stop(a)}.bind(this),Event.observe($(document.body),"click",this.onClickHandler),Event.observe(this.input,"keyup",this.onKeyUpHandler)},unregisterEvents:function(){Event.stopObserving($(document.body),"click",this.onClickHandler),Event.stopObserving(this.input,"keyup",this.onKeyUpHandler)},close:function(){this.unregisterEvents(),a.apply(this)}}}(),core.NgTable||(core.NgTable={}),core.NgTable=function(a,b){function e(a){this.options=Object.extend({name:"",container:"",title:"",width:600,acceptClass:"",acceptType:"",importer:!1,exporter:!1,pager:!0,stringfilter:!0},a||{}),this.options.container=$(this.options.container),this.options.container||(this.options.container=$("ELEMENT_"+name)),this.config=d[this.options.acceptClass][this.options.acceptType],this.objects=get_objects(this.options.acceptClass,this.options.acceptType),this.toHTML(),c[this.options.name]=this}var c={},d={authentication:{otp_token:{type:"table",sort:{dflt:function(a,b){var c=get_object(a.data.user),d=get_object(b.data.user),e,f;e=c&&c.data.name?c.data.name:"",f=d&&d.data.name?d.data.name:"";return e<f?1:e>f?-1:0}},attributes:[{width:130,label:_LOC("sXwuAsUqjd","Username"),value:function(a){return get_data(a.ref,"name","user"," ")}},{ellipsis:!0,width:70,label:_LOC("TrPurQDTzR","Secret"),value:function(a){return a.data.secret}},{width:45,label:_LOC("dKtPDfognx","Hash"),value:function(a){if(a.data.digest==="sha1")return"SHA1";if(a.data.digest==="sha256")return"SHA256";if(a.data.digest==="sha512")return"SHA512"}},{width:235,ellipsis:!0,label:_LOC("mQMPidDWAn","Comment"),value:function(a){return a.data.comment.unescapeHTML()}},{width:78,label:"",value:function(a){var b=Builder.node("img",{src:"core/img/icons/xinfo.png",style:"position:absolute;top:-8px;left:75px;cursor:pointer;",title:_LOC("PiLaOPesPg","Show token QR code")}),c=Builder.node("img",{src:"core/img/icons/xtime.png",style:"position:absolute;top:-8px;left:57px;cursor:pointer;",title:_LOC("NIwNvkYRTH","Check token time-offset")});Event.observe(b,"click",qrcode_show.curry(a)),Event.observe(c,"click",function(){new core.popup({name:"otp_timeoffset","class":"authentication",type:"otp_timeoffset",anchor:$(c),update_type:!1,width:320,modal:!0,passthru:{obj_src:'"'+a.ref+'"'},update_name:"otp_timeoffset"})});return Builder.node("div",{style:"position:relative;width:95px;"},[a.data.for_ssh?Builder.node("img",{src:"core/img/icons/xterminal.png",style:"position:absolute;top:-8px;left:0px",title:_LOC("aZhlQsBdjz","Token can be used for remote shell access")}):"",a.data.hide?Builder.node("img",{src:"core/img/icons/xqrcode_strike.png",style:"position:absolute;top:-8px;left:19px;",title:_LOC("fBpkVpGmIl","Token information is not displayed in User Portal")}):"",a.data.extra_codes.length?Builder.node("img",{src:"core/img/icons/xplus.png",style:"position:absolute;top:-8px;left:38px;",title:_LOC("bdNpDKIhzs","Codes:")+"\n"+a.data.extra_codes.join("\n")}):"",c,b])}}],filter:function(a,b){var c=get_data(a.ref,"name","user","");c+=a.data.comment;return c.toLowerCase().indexOf(b.toLowerCase())>-1},functions:[{label:_LOC("cpNMebpKua","Edit"),onclick:function(a,b,c){new core.popup({name:"POPUP_EDIT_"+a.options.table.options.name,"class":a.options.table.options.acceptClass,type:a.options.table.options.acceptType,obj_src:b.ref,obj_ref:b.ref,modal:!0,anchor:c,width:290,update_type:"ngtable",update_name:a.options.table.options.name,leftSide:a.options.table.options.leftSide})},toHTML:function(a,b){return Builder.node("img",{src:"core/img/icons/edit.png",title:_LOC("CCuDLxCmrW","Edit")})},width:16},{label:_LOC("ZPHKdhgzlv","Delete"),onclick:function(a,b){req_send({objs:[{FID:"obj_delete",obj_ref:b.ref,callback:"object_delete_result",update_type:"ngtable",update_name:a.options.table.options.name}]})},toHTML:function(a,b){return Builder.node("img",{src:"core/img/icons/delete.png",title:_LOC("JBzfVthUiK","Delete")})},width:16},{label:_LOC("QTJlZqSSqV","Reset"),onclick:function(a,b){req_send({objs:[{FID:"auth_otp_reset_token",obj_ref:b.ref,callback:function(c){c.success&&a.refresh(get_object(b.ref))},update_type:"ngtable",update_name:a.options.table.options.name}]})},toHTML:function(a,b){var c=Builder.node("img",{src:"core/img/icons/reset.png",title:_LOC("gUcLgtiXFY","Reset")});return c},width:16,isDisabled:function(a,b){return!b.data.lastuse}},{label:_LOC("wVpMButTec","Status"),onclick:function(a,b){a.toggleStatus(b,reload_tab)},toHTML:function(a,b){var c="slider_small_";b.data.status?c+="on.png":c+="off.png";return Builder.node("img",{src:"core/img/status_slider/"+c,title:_LOC("wrpuYYfYbe","Status")})},width:32}]}}};e.prototype=function(){function i(a){this.itemContainer.filter(a)}function h(){var a,b=[],c,d,g,h,i,j,k,l,m=_LOC("sbeNCNbVsr","search"),n;this.options.nosearch||(j=Builder.node("input",{id:"stringFilter",type:"text",className:"tableStringFilter"}),j.resetButton=$(Builder.node("img",{className:"ngtable_searchbox_ResetButton_chrome",alt:_LOC("uwhVGQpXIX","Reset"),title:_LOC("UpDXZlPcBE","Reset"),src:"core/img/blank1x1.gif"})).hide().observe("click",function(){var a=$(j);a.value="",a.focus(),this.filter($F(j))}.bind(this)),$(j).observe("focus",function(){$(this.resetButton).hide(),$F(this)!==""&&$(this.resetButton).show(),$F(this)===m&&($(this).value="",$(this.resetButton).show())}.bind(j)),$(j).observe("blur",function(){focus_unregister(this),$F(this)===""&&($(this).value=m,this.resetButton.hide())}.bind(j)),i=Builder.node("li",{className:"ngTableSearch"},[j,j.resetButton]),Event.observe(j,"keyup",function(){this.itemContainer.pager.clearHiddenStates(),this.filter($F(j)),j.resetButton.show()}.bind(this)),b.push(i)),this.options.noadd||(h=Builder.node("li",{className:"ngTableAddIcon",title:_LOC("UDxiJLZJzm","New...")}),Event.observe(h,"click",e.bind(this,h)),b.push(h)),this.options.importer&&(k=Builder.node("li",{className:"ngTableImportIcon",title:_LOC("PkzqWtMbkl","Import...")}),Event.observe(k,"click",f.bind(this,k)),b.push(k)),this.options.pager&&(d=Builder.node("div",{className:"ngTablePager"}),n=Builder.node("span","0/0"),l=Builder.node("div",{className:"ngTableFooter"},[Builder.node("div",[Builder.node("label",_LOC("vNlbQTYGrf","Page")),n])])),c=Builder.node("ul",{},b),a=Builder.node("div",{className:"ngTableHead"},[Builder.node("span",{className:"ellipsis"},this.options.title),[d,Builder.node("div",c)]]),g=Builder.node("div",{className:"ngTableItemBox"}),this.options.pager&&(g.style.height=20*(this.options.pager+1)+"px"),this.options.container.appendChild(a),this.options.container.appendChild(g),this.options.container.appendChild(l),this.fill(g,d,n)}function g(a){}function f(a){new core.popup({name:"POPUP_IMPORT_"+this.options.name,"class":this.options.acceptClass,type:this.options.acceptType+"_import",anchor:a,modal:this.options.modal||!1,width:376,update_type:"ngtable",update_name:this.options.name,leftSide:this.options.leftSide})}function e(a){new core.popup({name:"POPUP_ADD_NEW_"+this.options.name,"class":this.options.acceptClass,type:this.options.acceptType,width:290,modal:this.options.modal||!1,anchor:a,update_type:"ngtable",update_name:this.options.name,leftSide:this.options.leftSide})}function d(a,b,d){this.config.type==="table"&&(this.itemContainer=new c({config:this.config,table:this,objects:this.objects,container:a,pager:this.options.pager,pagerContainer:b,footerPagerCount:d}))}function c(a){this.options=Object.extend({},a||{}),this.objectElements={},this.toHTML(),this.options.pager&&(this.pager=new b({step:this.options.pager,container:this.options.pagerContainer,onForward:function(){},onBackward:function(){},pagerContainer:this.options.pagerContainer,footerPagerCount:this.options.footerPagerCount}),this.pager.toHTML())}function b(a){this.options=Object.extend({step:10},a||{}),this.currentPage=1,this.activeRows=0,this.onForwards=function(){},this.onBackwards=function(){},this.rows=[]}b.prototype=function(){function a(a){this.options=Object.extend({onclick:function(){}},a||{}),this.disabled=!1}a.prototype={disable:function(){this.disabled=!0,input_deactivate(this.htmlElement)},enable:function(){this.disabled=!1,input_activate(this.htmlElement)},toHTML:function(){this.htmlElement=Builder.node("li"),Event.observe(this.htmlElement,"click",function(){this.disabled||this.options.onclick()}.bind(this));return this.htmlElement}};return{updateButtons:function(){this.currentPage===this.maxPage||this.currentPage>this.maxPage?this.btnForward.disable():this.btnForward.enable(),this.currentPage===1||this.currentPage===0?this.btnBackward.disable():this.btnBackward.enable()},toHTML:function(){this.btnForward=new a({onclick:function(){this.currentPage<this.maxPage&&(this.currentPage++,this.doPaging(),this.options.onForward()),this.updateButtons()}.bind(this)}),this.btnBackward=new a({onclick:function(){this.currentPage>1&&(this.currentPage--,this.doPaging(),this.options.onBackward()),this.updateButtons()}.bind(this)}),this.options.pagerContainer.appendChild(Builder.node("ul",{className:"pager"},[this.btnBackward.toHTML(),this.btnForward.toHTML()])),this.btnForward.disable(),this.btnBackward.disable()},addRow:function(a){var b=this.rows.length;this.rows.push(a),b++,this.maxPage=Math.ceil(b/this.options.step),b<(this.currentPage-1)*this.options.step&&($(a).hide(),$(a).setDataset("hiddenby","pager")),b>this.currentPage*this.options.step&&($(a).hide(),$(a).setDataset("hiddenby","pager")),this.updateButtons(),this.options.footerPagerCount.update(this.currentPage+"/"+this.maxPage);return this.rows.length-1},removeRow:function(a){this.rows=this.rows.without(a),this.maxPage=Math.ceil(this.rows.length/this.options.step),this.doPaging()},doPaging:function(){var a=this.rows.length,b,c=0,d;this.activeRows=0;for(b=0;b<a;b++)d=this.rows[b],$(d).getDataset("hiddenby")!=="filter"?(c++,this.activeRows++,c>this.currentPage*this.options.step&&($(d).hide(),$(d).setDataset("hiddenby","pager")),c<=(this.currentPage-1)*this.options.step&&($(d).hide(),$(d).setDataset("hiddenby","pager")),c>(this.currentPage-1)*this.options.step&&c<=this.currentPage*this.options.step&&($(d).show(),$(d).setDataset("hiddenby",null))):$(d).hide();this.maxPage=Math.ceil(this.activeRows/this.options.step),this.rows.length?this.currentPage>this.maxPage&&(this.setCurrentPage(this.maxPage),this.doPaging()):this.setCurrentPage(0),this.options.footerPagerCount.update(this.currentPage+"/"+this.maxPage),this.updateButtons()},clearHiddenStates:function(){var a=this.rows.length;while(a--)this.rows[a].hasAttribute("hiddenby")&&$(this.rows[a]).getDataset("hiddenby")!=="filter"&&$(this.rows[a]).setDataset("hiddenby",null)},setCurrentPage:function(a){this.currentPage=a}}}(),c.prototype=function(){function h(){$("stringFilter")&&$("stringFilter").value!==""?this.filter($F($("stringFilter"))):this.options.objects.length===0&&reload_tab()}function g(a){var b=this.options.objects.length;this.body.removeChild(this.objectElements[a]),this.pager.removeRow(this.objectElements[a]),delete this.objectElements[a];while(b--)this.options.objects[b].ref===a&&(this.options.objects=this.options.objects.without(this.options.objects[b]));this.refreshDisplayedItems()}function f(b,c){var d=this.options.config.filter;wait_popup(!0,_LOC("XPTVPmsiHx","Searching..")),c=c||this.options.objects.length,c--&&a.setTimeout(function(c,e){this.objectElements[c.ref]&&(d(c,b)?$(this.objectElements[c.ref]).setDataset("hiddenby",null):$(this.objectElements[c.ref]).setDataset("hiddenby","filter")),e?a.setTimeout(this.filter.bind(this,b,e),1):(wait_popup(!1),this.pager.setCurrentPage(1),this.pager.doPaging())}.bind(this,this.options.objects[c],c),1)}function e(a,b,c,d){c=c||"status",req_send({objs:[{FID:"obj_set",obj:{ref:a.ref},ack:d&&d.ack?d.ack:!1,callback:function(e){var f,g=0,h="",i=[],j=0;if(e.success)d&&d.ack?reload_tab():this.refresh(get_object(a.ref));else{if(e.error){f=e.error.length;for(;g<f;)h+=e.error[g++].text+"\n";alert(h)}if(e.confirm&&e.confirm.length){f=e.confirm.length;for(;j<f;)i.push(e.confirm[j++].text);confirm_dialog({message:i,ok_cb:function(){this.toggleStatus(a,b,c,e)}.bind(this)})}}}.bind(this),toggle_status:!0,toggle_field:c,toggle_value:a.data[c]}]},!0)}function d(a){this.addObject(a,!0)}function c(b){var c=this.options.config.attributes.length,d=0,e,f=[],g,h=0;if(!b){if(this.options.config.functions&&this.options.config.functions.length){g=this.options.config.functions.length;while(g--)h+=this.options.config.functions[g].width||0;f.push(Builder.node("th",{width:h+"px"}))}for(d=0;d<c;d++)h=this.options.config.attributes[d].width,e=Builder.node("th",{width:h?h+"px":"*"},this.options.config.attributes[d].label),f.push(e);this.header=Builder.node("thead",{},Builder.node("tr",{},f)),this.body=Builder.node("tbody"),this.htmlElement=Builder.node("table",{cellpadding:"0",cellspacing:"0"},[this.header,this.body]),this.options.container.addClassName("ngTableItemTableBox")}this.options.objects&&(this.options.config.sort&&this.options.config.sort.dflt&&(this.options.objects=this.options.objects.sort(this.options.config.sort.dflt)),b=b||this.options.objects.length,b--&&a.setTimeout(function(b,c){this.addObject(b),c?a.setTimeout(this.toHTML.bind(this,c),1):this.pager.doPaging()}.bind(this,this.options.objects[b],b),0)),this.options.container.appendChild(this.htmlElement)}function b(a,b){var c=this.options.config.attributes.length,d=0,e,f,g=[],h,i=[],j,k,l=this.options.config,m=this.options.objects.length,n=!1;if(!b){while(m--){n=n||this.options.objects[m].ref===a.ref;if(n)break}n||this.options.objects.push(a)}if(l.functions&&l.functions.length){h=l.functions.length;for(d=0;d<h;d++)j=Builder.node("li",l.functions[d].toHTML(this,a)),typeof l.functions[d].isDisabled=="function"&&l.functions[d].isDisabled(this,a)&&(j.disabled=!0),j.disabled?input_deactivate(j):Event.observe(j,"click",l.functions[d].onclick.curry(this,a,j)),i.push(j);g.push(Builder.node("td",Builder.node("ul",i)))}for(d=0;d<c;d++)typeof l.attributes[d].value=="function"?e=l.attributes[d].value(a):e=l.attributes[d].value,f=Builder.node("td",{className:l.attributes[d].ellipsis?"ellipsis":""},e),g.push(f);k=Builder.node("tr",g),this.objectElements[a.ref]||(this.objectElements[a.ref]=k);if(!b)this.pager.addRow(k),this.body.appendChild(k);else{this.objectElements[a.ref].update();for(d=0,c=g.length;d<c;d++)this.objectElements[a.ref].appendChild(g[d])}}return{toHTML:c,addObject:b,hasObject:function(a){return!!this.objectElements[a]},deleteObject:g,refresh:d,toggleStatus:e,filter:f}}();return{toHTML:h,fill:d,filter:i,addObject:function(a){this.itemContainer.addObject(get_object(a))},updateObject:function(a){this.itemContainer.hasObject(a)?this.itemContainer.refresh(get_object(a)):this.itemContainer.addObject(get_object(a))},deleteObject:function(a){this.itemContainer.deleteObject(a)}}}(),e.add=function(a,b){c[a].addObject(b)},e.update=function(a,b){var d,e,f=c[a];if(Object.isArray(b)){d=b.length;while(d--)e=b[d],window.setTimeout(function(a){f.updateObject(a)}.curry(e),d)}else f.updateObject(b)},e.del=function(a,b){b&&c[a].deleteObject(b)};return e}(window,core.NgTable);var QRCode;(function(){function p(a,b){var c=1;for(var e=0,f=l.length;e<=f;e++){var g=0;switch(b){case d.L:g=l[e][0];break;case d.M:g=l[e][1];break;case d.Q:g=l[e][2];break;case d.H:g=l[e][3]}if(a.length<=g)break;c++}if(c>l.length)throw new Error("Too long data");return c}function n(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,aMat=b.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(a=parseFloat(aMat[1])));return a}function m(){return typeof CanvasRenderingContext2D!="undefined"}function k(){this.buffer=[],this.length=0}function j(a,b){this.totalCount=a,this.dataCount=b}function i(a,b){if(a.length==undefined)throw new Error(a.length+"/"+b);var c=0;while(c<a.length&&a[c]==0)c++;this.num=Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function b(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function a(a){this.mode=c.MODE_8BIT_BYTE,this.data=a}a.prototype={getLength:function(a){return this.data.length},write:function(a){for(var b=0;b<this.data.length;b++)a.put(this.data.charCodeAt(b),8)}},b.prototype={addData:function(b){var c=new a(b);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(a<0||this.moduleCount<=a||b<0||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=this.typeNumber*4+17,this.modules=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a),this.dataCache==null&&(this.dataCache=b.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,b){for(var c=-1;c<=7;c++){if(a+c<=-1||this.moduleCount<=a+c)continue;for(var d=-1;d<=7;d++){if(b+d<=-1||this.moduleCount<=b+d)continue;0<=c&&c<=6&&(d==0||d==6)||0<=d&&d<=6&&(c==0||c==6)||2<=c&&c<=4&&2<=d&&d<=4?this.modules[a+c][b+d]=!0:this.modules[a+c][b+d]=!1}}},getBestMaskPattern:function(){var a=0,b=0;for(var c=0;c<8;c++){this.makeImpl(!0,c);var d=f.getLostPoint(this);if(c==0||a>d)a=d,b=c}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++){var g=f*e;for(var h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++){if(this.modules[a][6]!=null)continue;this.modules[a][6]=a%2==0}for(var b=8;b<this.moduleCount-8;b++){if(this.modules[6][b]!=null)continue;this.modules[6][b]=b%2==0}},setupPositionAdjustPattern:function(){var a=f.getPatternPosition(this.typeNumber);for(var b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(this.modules[d][e]!=null)continue;for(var g=-2;g<=2;g++)for(var h=-2;h<=2;h++)g==-2||g==2||h==-2||h==2||g==0&&h==0?this.modules[d+g][e+h]=!0:this.modules[d+g][e+h]=!1}},setupTypeNumber:function(a){var b=f.getBCHTypeNumber(this.typeNumber);for(var c=0;c<18;c++){var d=!a&&(b>>c&1)==1;this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;c<18;c++){var d=!a&&(b>>c&1)==1;this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){var c=this.errorCorrectLevel<<3|b,d=f.getBCHTypeInfo(c);for(var e=0;e<15;e++){var g=!a&&(d>>e&1)==1;e<6?this.modules[e][8]=g:e<8?this.modules[e+1][8]=g:this.modules[this.moduleCount-15+e][8]=g}for(var e=0;e<15;e++){var g=!a&&(d>>e&1)==1;e<8?this.modules[8][this.moduleCount-e-1]=g:e<9?this.modules[8][15-e-1+1]=g:this.modules[8][15-e-1]=g}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){var c=-1,d=this.moduleCount-1,e=7,g=0;for(var h=this.moduleCount-1;h>0;h-=2){h==6&&h--;for(;;){for(var i=0;i<2;i++)if(this.modules[d][h-i]==null){var j=!1;g<a.length&&(j=(a[g]>>>e&1)==1);var k=f.getMask(b,d,h-i);k&&(j=!j),this.modules[d][h-i]=j,e--,e==-1&&(g++,e=7)}d+=c;if(d<0||this.moduleCount<=d){d-=c,c=-c;break}}}}},b.PAD0=236,b.PAD1=17,b.createData=function(a,c,d){var e=j.getRSBlocks(a,c),g=new k;for(var h=0;h<d.length;h++){var i=d[h];g.put(i.mode,4),g.put(i.getLength(),f.getLengthInBits(i.mode,a)),i.write(g)}var l=0;for(var h=0;h<e.length;h++)l+=e[h].dataCount;if(g.getLengthInBits()>l*8)throw new Error("code length overflow. ("+g.getLengthInBits()+">"+l*8+")");g.getLengthInBits()+4<=l*8&&g.put(0,4);while(g.getLengthInBits()%8!=0)g.putBit(!1);for(;;){if(g.getLengthInBits()>=l*8)break;g.put(b.PAD0,8);if(g.getLengthInBits()>=l*8)break;g.put(b.PAD1,8)}return b.createBytes(g,e)},b.createBytes=function(a,b){var c=0,d=0,e=0,g=Array(b.length),h=Array(b.length);for(var j=0;j<b.length;j++){var k=b[j].dataCount,l=b[j].totalCount-k;d=Math.max(d,k),e=Math.max(e,l),g[j]=Array(k);for(var m=0;m<g[j].length;m++)g[j][m]=255&a.buffer[m+c];c+=k;var n=f.getErrorCorrectPolynomial(l),o=new i(g[j],n.getLength()-1),p=o.mod(n);h[j]=Array(n.getLength()-1);for(var m=0;m<h[j].length;m++){var q=m+p.getLength()-h[j].length;h[j][m]=q>=0?p.get(q):0}}var r=0;for(var m=0;m<b.length;m++)r+=b[m].totalCount;var s=Array(r),t=0;for(var m=0;m<d;m++)for(var j=0;j<b.length;j++)m<g[j].length&&(s[t++]=g[j][m]);for(var m=0;m<e;m++)for(var j=0;j<b.length;j++)m<h[j].length&&(s[t++]=h[j][m]);return s};var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},d={L:1,M:0,Q:3,H:2},e={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},f={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){var b=a<<10;while(f.getBCHDigit(b)-f.getBCHDigit(f.G15)>=0)b^=f.G15<<f.getBCHDigit(b)-f.getBCHDigit(f.G15);return(a<<10|b)^f.G15_MASK},getBCHTypeNumber:function(a){var b=a<<12;while(f.getBCHDigit(b)-f.getBCHDigit(f.G18)>=0)b^=f.G18<<f.getBCHDigit(b)-f.getBCHDigit(f.G18);return a<<12|b},getBCHDigit:function(a){var b=0;while(a!=0)b++,a>>>=1;return b},getPatternPosition:function(a){return f.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case e.PATTERN000:return(b+c)%2==0;case e.PATTERN001:return b%2==0;case e.PATTERN010:return c%3==0;case e.PATTERN011:return(b+c)%3==0;case e.PATTERN100:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case e.PATTERN101:return b*c%2+b*c%3==0;case e.PATTERN110:return(b*c%2+b*c%3)%2==0;case e.PATTERN111:return(b*c%3+(b+c)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){var b=new i([1],0);for(var c=0;c<a;c++)b=b.multiply(new i([1,g.gexp(c)],0));return b},getLengthInBits:function(a,b){if(1<=b&&b<10)switch(a){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(b<27)switch(a){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(b<41))throw new Error("type:"+b);switch(a){case c.MODE_NUMBER:return 14;case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){var b=a.getModuleCount(),c=0;for(var d=0;d<b;d++)for(var e=0;e<b;e++){var f=0,g=a.isDark(d,e);for(var h=-1;h<=1;h++){if(d+h<0||b<=d+h)continue;for(var i=-1;i<=1;i++){if(e+i<0||b<=e+i)continue;if(h==0&&i==0)continue;g==a.isDark(d+h,e+i)&&f++}}f>5&&(c+=3+f-5)}for(var d=0;d<b-1;d++)for(var e=0;e<b-1;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++;if(j==0||j==4)c+=3}for(var d=0;d<b;d++)for(var e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;e<b;e++)for(var d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);var k=0;for(var e=0;e<b;e++)for(var d=0;d<b;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;c+=l*10;return c}},g={glog:function(a){if(a<1)throw new Error("glog("+a+")");return g.LOG_TABLE[a]},gexp:function(a){while(a<0)a+=255;while(a>=256)a-=255;return g.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)};for(var h=0;h<8;h++)g.EXP_TABLE[h]=1<<h;for(var h=8;h<256;h++)g.EXP_TABLE[h]=g.EXP_TABLE[h-4]^g.EXP_TABLE[h-5]^g.EXP_TABLE[h-6]^g.EXP_TABLE[h-8];for(var h=0;h<255;h++)g.LOG_TABLE[g.EXP_TABLE[h]]=h;i.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){var b=Array(this.getLength()+a.getLength()-1);for(var c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=g.gexp(g.glog(this.get(c))+g.glog(a.get(d)));return new i(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;var b=g.glog(this.get(0))-g.glog(a.get(0)),c=Array(this.getLength());for(var d=0;d<this.getLength();d++)c[d]=this.get(d);for(var d=0;d<a.getLength();d++)c[d]^=g.gexp(g.glog(a.get(d))+b);return(new i(c,0)).mod(a)}},j.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],j.getRSBlocks=function(a,b){var c=j.getRsBlockTable(a,b);if(c==undefined)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);var d=c.length/3,e=[];for(var f=0;f<d;f++){var g=c[f*3+0],h=c[f*3+1],i=c[f*3+2];for(var k=0;k<g;k++)e.push(new j(h,i))}return e},j.getRsBlockTable=function(a,b){switch(b){case d.L:return j.RS_BLOCK_TABLE[(a-1)*4+0];case d.M:return j.RS_BLOCK_TABLE[(a-1)*4+1];case d.Q:return j.RS_BLOCK_TABLE[(a-1)*4+2];case d.H:return j.RS_BLOCK_TABLE[(a-1)*4+3];default:return undefined}},k.prototype={get:function(a){var b=Math.floor(a/8);return(this.buffer[b]>>>7-a%8&1)==1},put:function(a,b){for(var c=0;c<b;c++)this.putBit((a>>>b-c-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}};var l=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],o=m()?function(){function d(a,b){var c=this;c._fFail=b,c._fSuccess=a;if(c._bSupportDataURI===null){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1,c._fFail&&_fFail.call(c)},f=function(){c._bSupportDataURI=!0,c._fSuccess&&c._fSuccess.call(c)};d.onabort=e,d.onerror=e,d.onload=f,d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=="}else c._bSupportDataURI===!0&&c._fSuccess?c._fSuccess.call(c):c._bSupportDataURI===!1&&c._fFail&&c._fFail.call(c)}function a(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var b=1/window.devicePixelRatio,c=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,d,e,f,g,h,i,j,k){if("nodeName"in a&&/img/i.test(a.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*b;else typeof j=="undefined"&&(arguments[1]*=b,arguments[2]*=b,arguments[3]*=b,arguments[4]*=b);c.apply(this,arguments)}}var e=function(a,b){this._bIsPainted=!1,this._android=n(),this._htOption=b,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=b.width,this._elCanvas.height=b.height,a.appendChild(this._elCanvas),this._el=a,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};e.prototype.draw=function(a){var b=this._elImage,c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=Math.floor(d.width/e),g=Math.floor(d.height/e),h=Math.floor(d.width%e/2),i=Math.floor(d.height%e/2);b.style.display="none",this.clear();for(var j=0;j<e;j++)for(var k=0;k<e;k++){var l=k*f+h,m=j*g+i;c.fillStyle=a.isDark(j,k)?d.colorDark:d.colorLight,c.fillRect(l,m,f,g)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&d.call(this,a)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(a){if(!a)return a;return Math.floor(a*1e3)/1e3};return e}():function(){var a=function(a,b){this._el=a,this._htOption=b};a.prototype.draw=function(a){var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['<table style="border:0;border-collapse:collapse;">'];for(var h=0;h<d;h++){g.push("<tr>");for(var i=0;i<d;i++)g.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,i)?b.colorDark:b.colorLight)+';"></td>');g.push("</tr>")}g.push("</table>"),c.innerHTML=g.join("");var j=c.childNodes[0],k=(b.width-j.offsetWidth)/2,l=(b.height-j.offsetHeight)/2;k>0&&l>0&&(j.style.margin=l+"px "+k+"px")},a.prototype.clear=function(){this._el.innerHTML=""};return a}();QRCode=function(a,b){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:d.H},typeof b=="string"&&(b={text:b});if(b)for(var c in b)this._htOption[c]=b[c];typeof a=="string"&&(a=document.getElementById(a)),this._android=n(),this._el=a,this._oQRCode=null,this._oDrawing=new o(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(a){var c=p(a,this._htOption.correctLevel);c<this._htOption.codeMinVersion&&(c=this._htOption.codeMinVersion),this._oQRCode=new b(c,this._htOption.correctLevel),this._oQRCode.addData(a),this._oQRCode.make(),this._el.title=a,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){typeof this._oDrawing.makeImage=="function"&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=d})(),function(){function d(b){var d=0,e=0,f=0,g=0,h,i,j;b=b.split(/(..)/).collect(function(a){return a&&String.fromCharCode(parseInt(a,16))}).join(""),h=Array(c(b)*8),j=b.length;while(d<j)i=b.charCodeAt(d),f>3?(g=i&255>>f,f=(f+5)%8,g=g<<f|(d+1<j?b.charCodeAt(d+1):0)>>8-f,d++):(g=i>>8-(f+5)&31,f=(f+5)%8,f==0&&d++),h[e]=a[g],e++;for(d=e;d<h.length;d++)h[d]="=";return h.join("")}function c(a){var b=Math.floor(a.length/5);return a.length%5==0?b:b+1}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",b=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];window.base32encode=d}(),function(a){var b="0.3.4",c="hasOwnProperty",d=/[\.\/]/,e="*",f=function(){},g=function(a,b){return a-b},h,i,j={n:{}},k=function(a,b){var c=j,d=i,e=Array.prototype.slice.call(arguments,2),f=k.listeners(a),l=0,m=!1,n,o=[],p={},q=[],r=h,s=[],t,u;h=a,i=0;for(t=0,u=f.length;t<u;t++)"zIndex"in f[t]&&(o.push(f[t].zIndex),f[t].zIndex<0&&(p[f[t].zIndex]=f[t]));o.sort(g);while(o[l]<0){n=p[o[l++]],q.push(n.apply(b,e));if(i){i=d;return q}}for(t=0;t<u;t++){n=f[t];if("zIndex"in n)if(n.zIndex==o[l]){q.push(n.apply(b,e));if(i)break;do{l++,n=p[o[l]],n&&q.push(n.apply(b,e));if(i)break}while(n)}else p[n.zIndex]=n;else{q.push(n.apply(b,e));if(i)break}}i=d,h=r;return q.length?q:null};k.listeners=function(a){var b=a.split(d),c=j,f,g,h,i,k,l,m,n,o=[c],p=[];for(i=0,k=b.length;i<k;i++){n=[];for(l=0,m=o.length;l<m;l++){c=o[l].n,g=[c[b[i]],c[e]],h=2;while(h--)f=g[h],f&&(n.push(f),p=p.concat(f.f||[]))}o=n}return p},k.on=function(a,b){var c=a.split(d),e=j;for(var g=0,h=c.length;g<h;g++)e=e.n,!e[c[g]]&&(e[c[g]]={n:{}}),e=e[c[g]];e.f=e.f||[];for(g=0,h=e.f.length;g<h;g++)if(e.f[g]==b)return f;e.f.push(b);return function(a){+a==+a&&(b.zIndex=+a)}},k.stop=function(){i=1},k.nt=function(a){if(a)return(new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)")).test(h);return h},k.off=k.unbind=function(a,b){var f=a.split(d),g,h,i,k,l,m,n,o=[j];for(k=0,l=f.length;k<l;k++)for(m=0;m<o.length;m+=i.length-2){i=[m,1],g=o[m].n;if(f[k]!=e)g[f[k]]&&i.push(g[f[k]]);else for(h in g)g[c](h)&&i.push(g[h]);o.splice.apply(o,i)}for(k=0,l=o.length;k<l;k++){g=o[k];while(g.n){if(b){if(g.f){for(m=0,n=g.f.length;m<n;m++)if(g.f[m]==b){g.f.splice(m,1);break}!g.f.length&&delete g.f}for(h in g.n)if(g.n[c](h)&&g.n[h].f){var p=g.n[h].f;for(m=0,n=p.length;m<n;m++)if(p[m]==b){p.splice(m,1);break}!p.length&&delete g.n[h].f}}else{delete g.f;for(h in g.n)g.n[c](h)&&g.n[h].f&&delete g.n[h].f}g=g.n}}},k.once=function(a,b){var c=function(){var d=b.apply(this,arguments);k.unbind(a,c);return d};return k.on(a,c)},k.version=b,k.toString=function(){return"You are running Eve "+b},typeof module!="undefined"&&module.exports?module.exports=k:typeof define!="undefined"?define("eve",[],function(){return k}):a.eve=k}(this),function(){function cF(a){for(var b=0;b<cy.length;b++)cy[b].el.paper==a&&cy.splice(b--,1)}function cE(b,d,e,f,h,i){e=Q(e);var j,k,l,m=[],o,p,q,t=b.ms,u={},v={},w={};if(f)for(y=0,z=cy.length;y<z;y++){var x=cy[y];if(x.el.id==d.id&&x.anim==b){x.percent!=e?(cy.splice(y,1),l=1):k=x,d.attr(x.totalOrigin);break}}else f=+v;for(var y=0,z=b.percents.length;y<z;y++){if(b.percents[y]==e||b.percents[y]>f*b.top){e=b.percents[y],p=b.percents[y-1]||0,t=t/b.top*(e-p),o=b.percents[y+1],j=b.anim[e];break}f&&d.attr(b.anim[b.percents[y]])}if(!!j){if(!k){for(var A in j)if(j[g](A))if(U[g](A)||d.paper.customAttributes[g](A)){u[A]=d.attr(A),u[A]==null&&(u[A]=T[A]),v[A]=j[A];switch(U[A]){case C:w[A]=(v[A]-u[A])/t;break;case"colour":u[A]=a.getRGB(u[A]);var B=a.getRGB(v[A]);w[A]={r:(B.r-u[A].r)/t,g:(B.g-u[A].g)/t,b:(B.b-u[A].b)/t};break;case"path":var D=bR(u[A],v[A]),E=D[1];u[A]=D[0],w[A]=[];for(y=0,z=u[A].length;y<z;y++){w[A][y]=[0];for(var F=1,G=u[A][y].length;F<G;F++)w[A][y][F]=(E[y][F]-u[A][y][F])/t}break;case"transform":var H=d._,I=ca(H[A],v[A]);if(I){u[A]=I.from,v[A]=I.to,w[A]=[],w[A].real=!0;for(y=0,z=u[A].length;y<z;y++){w[A][y]=[u[A][y][0]];for(F=1,G=u[A][y].length;F<G;F++)w[A][y][F]=(v[A][y][F]-u[A][y][F])/t}}else{var J=d.matrix||new cb,K={_:{transform:H.transform},getBBox:function(){return d.getBBox(1)}};u[A]=[J.a,J.b,J.c,J.d,J.e,J.f],b$(K,v[A]),v[A]=K._.transform,w[A]=[(K.matrix.a-J.a)/t,(K.matrix.b-J.b)/t,(K.matrix.c-J.c)/t,(K.matrix.d-J.d)/t,(K.matrix.e-J.e)/t,(K.matrix.f-J.f)/t]}break;case"csv":var L=r(j[A])[s](c),M=r(u[A])[s](c);if(A=="clip-rect"){u[A]=M,w[A]=[],y=M.length;while(y--)w[A][y]=(L[y]-u[A][y])/t}v[A]=L;break;default:L=[][n](j[A]),M=[][n](u[A]),w[A]=[],y=d.paper.customAttributes[A].length;while(y--)w[A][y]=((L[y]||0)-(M[y]||0))/t}}var O=j.easing,P=a.easing_formulas[O];if(!P){P=r(O).match(N);if(P&&P.length==5){var R=P;P=function(a){return cC(a,+R[1],+R[2],+R[3],+R[4],t)}}else P=bf}q=j.start||b.start||+(new Date),x={anim:b,percent:e,timestamp:q,start:q+(b.del||0),status:0,initstatus:f||0,stop:!1,ms:t,easing:P,from:u,diff:w,to:v,el:d,callback:j.callback,prev:p,next:o,repeat:i||b.times,origin:d.attr(),totalOrigin:h},cy.push(x);if(f&&!k&&!l){x.stop=!0,x.start=new Date-t*f;if(cy.length==1)return cA()}l&&(x.start=new Date-x.ms*f),cy.length==1&&cz(cA)}else k.initstatus=f,k.start=new Date-k.ms*f;eve("raphael.anim.start."+d.id,d,b)}}function cD(a,b){var c=[],d={};this.ms=b,this.times=1;if(a){for(var e in a)a[g](e)&&(d[Q(e)]=a[e],c.push(Q(e)));c.sort(bd)}this.anim=d,this.top=c[c.length-1],this.percents=c}function cC(a,b,c,d,e,f){function o(a,b){var c,d,e,f,j,k;for(e=a,k=0;k<8;k++){f=m(e)-a;if(z(f)<b)return e;j=(3*i*e+2*h)*e+g;if(z(j)<1e-6)break;e=e-f/j}c=0,d=1,e=a;if(e<c)return c;if(e>d)return d;while(c<d){f=m(e);if(z(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}function n(a,b){var c=o(a,b);return((l*c+k)*c+j)*c}function m(a){return((i*a+h)*a+g)*a}var g=3*b,h=3*(d-b)-g,i=1-g-h,j=3*c,k=3*(e-c)-j,l=1-j-k;return n(a,1/(200*f))}function cq(){return this.x+q+this.y+q+this.width+" ? "+this.height}function cp(){return this.x+q+this.y}function cb(a,b,c,d,e,f){a!=null?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function bH(b,c,d){b=a._path2curve(b),c=a._path2curve(c);var e,f,g,h,i,j,k,l,m,n,o=d?0:[];for(var p=0,q=b.length;p<q;p++){var r=b[p];if(r[0]=="M")e=i=r[1],f=j=r[2];else{r[0]=="C"?(m=[e,f].concat(r.slice(1)),e=m[6],f=m[7]):(m=[e,f,e,f,i,j,i,j],e=i,f=j);for(var s=0,t=c.length;s<t;s++){var u=c[s];if(u[0]=="M")g=k=u[1],h=l=u[2];else{u[0]=="C"?(n=[g,h].concat(u.slice(1)),g=n[6],h=n[7]):(n=[g,h,g,h,k,l,k,l],g=k,h=l);var v=bG(m,n,d);if(d)o+=v;else{for(var w=0,x=v.length;w<x;w++)v[w].segment1=p,v[w].segment2=s,v[w].bez1=m,v[w].bez2=n;o=o.concat(v)}}}}}return o}function bG(b,c,d){var e=a.bezierBBox(b),f=a.bezierBBox(c);if(!a.isBBoxIntersect(e,f))return d?0:[];var g=bB.apply(0,b),h=bB.apply(0,c),i=~~(g/5),j=~~(h/5),k=[],l=[],m={},n=d?0:[];for(var o=0;o<i+1;o++){var p=a.findDotsAtSegment.apply(a,b.concat(o/i));k.push({x:p.x,y:p.y,t:o/i})}for(o=0;o<j+1;o++)p=a.findDotsAtSegment.apply(a,c.concat(o/j)),l.push({x:p.x,y:p.y,t:o/j});for(o=0;o<i;o++)for(var q=0;q<j;q++){var r=k[o],s=k[o+1],t=l[q],u=l[q+1],v=z(s.x-r.x)<.001?"y":"x",w=z(u.x-t.x)<.001?"y":"x",x=bD(r.x,r.y,s.x,s.y,t.x,t.y,u.x,u.y);if(x){if(m[x.x.toFixed(4)]==x.y.toFixed(4))continue;m[x.x.toFixed(4)]=x.y.toFixed(4);var y=r.t+z((x[v]-r[v])/(s[v]-r[v]))*(s.t-r.t),A=t.t+z((x[w]-t[w])/(u[w]-t[w]))*(u.t-t.t);y>=0&&y<=1&&A>=0&&A<=1&&(d?n++:n.push({x:x.x,y:x.y,t1:y,t2:A}))}}return n}function bF(a,b){return bG(a,b,1)}function bE(a,b){return bG(a,b)}function bD(a,b,c,d,e,f,g,h){if(!(x(a,c)<y(e,g)||y(a,c)>x(e,g)||x(b,d)<y(f,h)||y(b,d)>x(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(!k)return;var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(n<+y(a,c).toFixed(2)||n>+x(a,c).toFixed(2)||n<+y(e,g).toFixed(2)||n>+x(e,g).toFixed(2)||o<+y(b,d).toFixed(2)||o>+x(b,d).toFixed(2)||o<+y(f,h).toFixed(2)||o>+x(f,h).toFixed(2))return;return{x:l,y:m}}}function bC(a,b,c,d,e,f,g,h,i){if(!(i<0||bB(a,b,c,d,e,f,g,h)<i)){var j=1,k=j/2,l=j-k,m,n=.01;m=bB(a,b,c,d,e,f,g,h,l);while(z(m-i)>n)k/=2,l+=(m<i?1:-1)*k,m=bB(a,b,c,d,e,f,g,h,l);return l}}function bB(a,b,c,d,e,f,g,h,i){i==null&&(i=1),i=i>1?1:i<0?0:i;var j=i/2,k=12,l=[-0.1252,.1252,-0.3678,.3678,-0.5873,.5873,-0.7699,.7699,-0.9041,.9041,-0.9816,.9816],m=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],n=0;for(var o=0;o<k;o++){var p=j*l[o]+j,q=bA(p,a,c,e,g),r=bA(p,b,d,f,h),s=q*q+r*r;n+=m[o]*w.sqrt(s)}return j*n}function bA(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function by(a,b){var c=[];for(var d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}function bx(){return this.hex}function bv(a,b,c){function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join("?"),h=d.cache=d.cache||{},i=d.count=d.count||[];if(h[g](f)){bu(i,f);return c?c(h[f]):h[f]}i.length>=1e3&&delete h[i.shift()],i.push(f),h[f]=a[m](b,e);return c?c(h[f]):h[f]}return d}function bu(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function bm(a){if(Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[g](c)&&(b[c]=bm(a[c]));return b}function a(c){if(a.is(c,"function"))return b?c():eve.on("raphael.DOMload",c);if(a.is(c,E))return a._engine.create[m](a,c.splice(0,3+a.is(c[0],C))).add(c);var d=Array.prototype.slice.call(arguments,0);if(a.is(d[d.length-1],"function")){var e=d.pop();return b?e.call(a._engine.create[m](a,d)):eve.on("raphael.DOMload",function(){e.call(a._engine.create[m](a,d))})}return a._engine.create[m](a,arguments)}a.version="2.1.0",a.eve=eve;var b,c=/[, ]+/,d={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},e=/\{(\d+)\}/g,f="prototype",g="hasOwnProperty",h={doc:document,win:window},i={was:Object.prototype[g].call(h.win,"Raphael"),is:h.win.Raphael},j=function(){this.ca=this.customAttributes={}},k,l="appendChild",m="apply",n="concat",o="createTouch"in h.doc,p="",q=" ",r=String,s="split",t="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[s](q),u={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},v=r.prototype.toLowerCase,w=Math,x=w.max,y=w.min,z=w.abs,A=w.pow,B=w.PI,C="number",D="string",E="array",F="toString",G="fill",H=Object.prototype.toString,I={},J="push",K=a._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,L=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,M={NaN:1,Infinity:1,"-Infinity":1},N=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,O=w.round,P="setAttribute",Q=parseFloat,R=parseInt,S=r.prototype.toUpperCase,T=a._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},U=a._availableAnimAttrs={blur:C,"clip-rect":"csv",cx:C,cy:C,fill:"colour","fill-opacity":C,"font-size":C,height:C,opacity:C,path:"path",r:C,rx:C,ry:C,stroke:"colour","stroke-opacity":C,"stroke-width":C,transform:"transform",width:C,x:C,y:C},V=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,W=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,X={hs:1,rg:1},Y=/,?([achlmqrstvxz]),?/gi,Z=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,$=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,_=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,ba=a._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,bb={},bc=function(a,b){return a.key-b.key},bd=function(a,b){return Q(a)-Q(b)},be=function(){},bf=function(a){return a},bg=a._rectPath=function(a,b,c,d,e){if(e)return[["M",a+e,b],["l",c-e*2,0],["a",e,e,0,0,1,e,e],["l",0,d-e*2],["a",e,e,0,0,1,-e,e],["l",e*2-c,0],["a",e,e,0,0,1,-e,-e],["l",0,e*2-d],["a",e,e,0,0,1,e,-e],["z"]];return[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},bh=function(a,b,c,d){d==null&&(d=c);return[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},bi=a._getPath={path:function(a){return a.attr("path")},circle:function(a){var b=a.attrs;return bh(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return bh(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return bg(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return bg(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return bg(b.x,b.y,b.width,b.height)}},bj=a.mapPath=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;a=bR(a);for(e=0,g=a.length;e<g;e++){i=a[e];for(f=1,h=i.length;f<h;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d}return a};a._g=h,a.type=h.win.SVGAngle||h.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a.type=="VML"){var bk=h.doc.createElement("div"),bl;bk.innerHTML='<v:shape adj="1"/>',bl=bk.firstChild,bl.style.behavior="url(#default#VML)";if(!bl||typeof bl.adj!="object")return a.type=p;bk=null}a.svg=!(a.vml=a.type=="VML"),a._Paper=j,a.fn=k=j.prototype=a.prototype,a._id=0,a._oid=0,a.is=function(a,b){b=v.call(b);if(b=="finite")return!M[g](+a);if(b=="array")return a instanceof Array;return b=="null"&&a===null||b==typeof a&&a!==null||b=="object"&&a===Object(a)||b=="array"&&Array.isArray&&Array.isArray(a)||H.call(a).slice(8,-1).toLowerCase()==b},a.angle=function(b,c,d,e,f,g){if(f==null){var h=b-d,i=c-e;if(!h&&!i)return 0;return(180+w.atan2(-i,-h)*180/B+360)%360}return a.angle(b,c,f,g)-a.angle(d,e,f,g)},a.rad=function(a){return a%360*B/180},a.deg=function(a){return a*180/B%360},a.snapTo=function(b,c,d){d=a.is(d,"finite")?d:10;if(a.is(b,E)){var e=b.length;while(e--)if(z(b[e]-c)<=d)return b[e]}else{b=+b;var f=c%b;if(f<d)return c-f;if(f>b-d)return c-f+b}return c};var bn=a.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=w.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)});a.setWindow=function(b){eve("raphael.setWindow",a,h.win,b),h.win=b,h.doc=h.win.document,a._engine.initWin&&a._engine.initWin(h.win)};var bo=function(b){if(a.vml){var c=/^\s+|\s+$/g,d;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),d=e.body}catch(f){d=createPopup().document.body}var g=d.createTextRange();bo=bv(function(a){try{d.style.color=r(a).replace(c,p);var b=g.queryCommandValue("ForeColor");b=(b&255)<<16|b&65280|(b&16711680)>>>16;return"#"+("000000"+b.toString(16)).slice(-6)}catch(e){return"none"}})}else{var i=h.doc.createElement("i");i.title="Rapha?l Colour Picker",i.style.display="none",h.doc.body.appendChild(i),bo=bv(function(a){i.style.color=a;return h.doc.defaultView.getComputedStyle(i,p).getPropertyValue("color")})}return bo(b)},bp=function(){return"hsb("+[this.h,this.s,this.b]+")"},bq=function(){return"hsl("+[this.h,this.s,this.l]+")"},br=function(){return this.hex},bs=function(b,c,d){c==null&&a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b&&(d=b.b,c=b.g,b=b.r);if(c==null&&a.is(b,D)){var e=a.getRGB(b);b=e.r,c=e.g,d=e.b}if(b>1||c>1||d>1)b/=255,c/=255,d/=255;return[b,c,d]},bt=function(b,c,d,e){b*=255,c*=255,d*=255;var f={r:b,g:c,b:d,hex:a.rgb(b,c,d),toString:br};a.is(e,"finite")&&(f.opacity=e);return f};a.color=function(b){var c;a.is(b,"object")&&"h"in b&&"s"in b&&"b"in b?(c=a.hsb2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):a.is(b,"object")&&"h"in b&&"s"in b&&"l"in b?(c=a.hsl2rgb(b),b.r=c.r,b.g=c.g,b.b=c.b,b.hex=c.hex):(a.is(b,"string")&&(b=a.getRGB(b)),a.is(b,"object")&&"r"in b&&"g"in b&&"b"in b?(c=a.rgb2hsl(b),b.h=c.h,b.s=c.s,b.l=c.l,c=a.rgb2hsb(b),b.v=c.b):(b={hex:"none"},b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1)),b.toString=br;return b},a.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;a=a%360/60,i=c*b,h=i*(1-z(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a];return bt(e,f,g,d)},a.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h);if(a>1||b>1||c>1)a/=360,b/=100,c/=100;a*=360;var e,f,g,h,i;a=a%360/60,i=2*b*(c<.5?c:1-c),h=i*(1-z(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a];return bt(e,f,g,d)},a.rgb2hsb=function(a,b,c){c=bs(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;f=x(a,b,c),g=f-y(a,b,c),d=g==0?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=g==0?0:g/f;return{h:d,s:e,b:f,toString:bp}},a.rgb2hsl=function(a,b,c){c=bs(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;g=x(a,b,c),h=y(a,b,c),i=g-h,d=i==0?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=i==0?0:f<.5?i/(2*f):i/(2-2*f);return{h:d,s:e,l:f,toString:bq}},a._path2string=function(){return this.join(",").replace(Y,"$1")};var bw=a._preload=function(a,b){var c=h.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em",c.onload=function(){b.call(this),this.onload=null,h.doc.body.removeChild(this)},c.onerror=function(){h.doc.body.removeChild(this)},h.doc.body.appendChild(c),c.src=a};a.getRGB=bv(function(b){if(!b||!!((b=r(b)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bx};if(b=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:bx};!X[g](b.toLowerCase().substring(0,2))&&b.charAt()!="#"&&(b=bo(b));var c,d,e,f,h,i,j,k=b.match(L);if(k){k[2]&&(f=R(k[2].substring(5),16),e=R(k[2].substring(3,5),16),d=R(k[2].substring(1,3),16)),k[3]&&(f=R((i=k[3].charAt(3))+i,16),e=R((i=k[3].charAt(2))+i,16),d=R((i=k[3].charAt(1))+i,16)),k[4]&&(j=k[4][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),k[1].toLowerCase().slice(0,4)=="rgba"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100));if(k[5]){j=k[5][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),(j[0].slice(-3)=="deg"||j[0].slice(-1)=="?")&&(d/=360),k[1].toLowerCase().slice(0,4)=="hsba"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100);return a.hsb2rgb(d,e,f,h)}if(k[6]){j=k[6][s](W),d=Q(j[0]),j[0].slice(-1)=="%"&&(d*=2.55),e=Q(j[1]),j[1].slice(-1)=="%"&&(e*=2.55),f=Q(j[2]),j[2].slice(-1)=="%"&&(f*=2.55),(j[0].slice(-3)=="deg"||j[0].slice(-1)=="?")&&(d/=360),k[1].toLowerCase().slice(0,4)=="hsla"&&(h=Q(j[3])),j[3]&&j[3].slice(-1)=="%"&&(h/=100);return a.hsl2rgb(d,e,f,h)}k={r:d,g:e,b:f,toString:bx},k.hex="#"+(16777216|f|e<<8|d<<16).toString(16).slice(1),a.is(h,"finite")&&(k.opacity=h);return k}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:bx}},a),a.hsb=bv(function(b,c,d){return a.hsb2rgb(b,c,d).hex}),a.hsl=bv(function(b,c,d){return a.hsl2rgb(b,c,d).hex}),a.rgb=bv(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),a.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||.75},c=this.hsb2rgb(b.h,b.s,b.b);b.h+=.075,b.h>1&&(b.h=0,b.s-=.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b}));return c.hex},a.getColor.reset=function(){delete this.start},a.parsePathString=function(b){if(!b)return null;var c=bz(b);if(c.arr)return bJ(c.arr);var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];a.is(b,E)&&a.is(b[0],E)&&(e=bJ(b)),e.length||r(b).replace(Z,function(a,b,c){var f=[],g=b.toLowerCase();c.replace(_,function(a,b){b&&f.push(+b)}),g=="m"&&f.length>2&&(e.push([b][n](f.splice(0,2))),g="l",b=b=="m"?"l":"L");if(g=="r")e.push([b][n](f));else while(f.length>=d[g]){e.push([b][n](f.splice(0,d[g])));if(!d[g])break}}),e.toString=a._path2string,c.arr=bJ(e);return e},a.parseTransformString=bv(function(b){if(!b)return null;var c={r:3,s:4,t:2,m:6},d=[];a.is(b,E)&&a.is(b[0],E)&&(d=bJ(b)),d.length||r(b).replace($,function(a,b,c){var e=[],f=v.call(b);c.replace(_,function(a,b){b&&e.push(+b)}),d.push([b][n](e))}),d.toString=a._path2string;return d});var bz=function(a){var b=bz.ps=bz.ps||{};b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[g](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])});return b[a]};a.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=A(j,3),l=A(j,2),m=i*i,n=m*i,o=k*a+l*3*i*c+j*3*i*i*e+n*g,p=k*b+l*3*i*d+j*3*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,x=j*e+i*g,y=j*f+i*h,z=90-w.atan2(q-s,r-t)*180/B;(q>s||r<t)&&(z+=180);return{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:x,y:y},alpha:z}},a.bezierBBox=function(b,c,d,e,f,g,h,i){a.is(b,"array")||(b=[b,c,d,e,f,g,h,i]);var j=bQ.apply(null,b);return{x:j.min.x,y:j.min.y,x2:j.max.x,y2:j.max.y,width:j.max.x-j.min.x,height:j.max.y-j.min.y}},a.isPointInsideBBox=function(a,b,c){var d=b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2;return d},a.isBBoxIntersect=function(b,c){var d=a.isPointInsideBBox;return d(c,b.x,b.y)||d(c,b.x2,b.y)||d(c,b.x,b.y2)||d(c,b.x2,b.y2)||d(b,c.x,c.y)||d(b,c.x2,c.y)||d(b,c.x,c.y2)||d(b,c.x2,c.y2)||(b.x<c.x2&&b.x>c.x||c.x<b.x2&&c.x>b.x)&&(b.y<c.y2&&b.y>c.y||c.y<b.y2&&c.y>b.y)},a.pathIntersection=function(a,b){return bH(a,b)},a.pathIntersectionNumber=function(a,b){return bH(a,b,1)},a.isPointInsidePath=function(b,c,d){var e=a.pathBBox(b);return a.isPointInsideBBox(e,c,d)&&bH(b,[["M",c,d],["H",e.x2+10]],1)%2==1},a._removedFactory=function(a){return function(){eve("raphael.log",null,"Rapha?l: you are calling to method ?"+a+"? of removed object",a)}};var bI=a.pathBBox=function(a){var b=bz(a);if(b.bbox)return b.bbox;if(!a)return{x:0,y:0,width:0,height:0,x2:0,y2:0};a=bR(a);var c=0,d=0,e=[],f=[],g;for(var h=0,i=a.length;h<i;h++){g=a[h];if(g[0]=="M")c=g[1],d=g[2],e.push(c),f.push(d);else{var j=bQ(c,d,g[1],g[2],g[3],g[4],g[5],g[6]);e=e[n](j.min.x,j.max.x),f=f[n](j.min.y,j.max.y),c=g[5],d=g[6]}}var k=y[m](0,e),l=y[m](0,f),o=x[m](0,e),p=x[m](0,f),q={x:k,y:l,x2:o,y2:p,width:o-k,height:p-l};b.bbox=bm(q);return q},bJ=function(b){var c=bm(b);c.toString=a._path2string;return c},bK=a._pathToRelative=function(b){var c=bz(b);if(c.rel)return bJ(c.rel);if(!a.is(b,E)||!a.is(b&&b[0],E))b=a.parsePathString(b);var d=[],e=0,f=0,g=0,h=0,i=0;b[0][0]=="M"&&(e=b[0][1],f=b[0][2],g=e,h=f,i++,d.push(["M",e,f]));for(var j=i,k=b.length;j<k;j++){var l=d[j]=[],m=b[j];if(m[0]!=v.call(m[0])){l[0]=v.call(m[0]);switch(l[0]){case"a":l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=+(m[6]-e).toFixed(3),l[7]=+(m[7]-f).toFixed(3);break;case"v":l[1]=+(m[1]-f).toFixed(3);break;case"m":g=m[1],h=m[2];default:for(var n=1,o=m.length;n<o;n++)l[n]=+(m[n]-(n%2?e:f)).toFixed(3)}}else{l=d[j]=[],m[0]=="m"&&(g=m[1]+e,h=m[2]+f);for(var p=0,q=m.length;p<q;p++)d[j][p]=m[p]}var r=d[j].length;switch(d[j][0]){case"z":e=g,f=h;break;case"h":e+=+d[j][r-1];break;case"v":f+=+d[j][r-1];break;default:e+=+d[j][r-2],f+=+d[j][r-1]}}d.toString=a._path2string,c.rel=bJ(d);return d},bL=a._pathToAbsolute=function(b){var c=bz(b);if(c.abs)return bJ(c.abs);if(!a.is(b,E)||!a.is(b&&b[0],E))b=a.parsePathString(b);if(!b||!b.length)return[["M",0,0]];var d=[],e=0,f=0,g=0,h=0,i=0;b[0][0]=="M"&&(e=+b[0][1],f=+b[0][2],g=e,h=f,i++,d[0]=["M",e,f]);var j=b.length==3&&b[0][0]=="M"&&b[1][0].toUpperCase()=="R"&&b[2][0].toUpperCase()=="Z";for(var k,l,m=i,o=b.length;m<o;m++){d.push(k=[]),l=b[m];if(l[0]!=S.call(l[0])){k[0]=S.call(l[0]);switch(k[0]){case"A":k[1]=l[1],k[2]=l[2],k[3]=l[3],k[4]=l[4],k[5]=l[5],k[6]=+(l[6]+e),k[7]=+(l[7]+f);break;case"V":k[1]=+l[1]+f;break;case"H":k[1]=+l[1]+e;break;case"R":var p=[e,f][n](l.slice(1));for(var q=2,r=p.length;q<r;q++)p[q]=+p[q]+e,p[++q]=+p[q]+f;d.pop(),d=d[n](by(p,j));break;case"M":g=+l[1]+e,h=+l[2]+f;default:for(q=1,r=l.length;q<r;q++)k[q]=+l[q]+(q%2?e:f)}}else if(l[0]=="R")p=[e,f][n](l.slice(1)),d.pop(),d=d[n](by(p,j)),k=["R"][n](l.slice(-2));else for(var s=0,t=l.length;s<t;s++)k[s]=l[s];switch(k[0]){case"Z":e=g,f=h;break;case"H":e=k[1];break;case"V":f=k[1];break;case"M":g=k[k.length-2],h=k[k.length-1];default:e=k[k.length-2],f=k[k.length-1]}}d.toString=a._path2string,c.abs=bJ(d);return d},bM=function(a,b,c,d){return[a,b,c,d,c,d]},bN=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},bO=function(a,b,c,d,e,f,g,h,i,j){var k=B*120/180,l=B/180*(+e||0),m=[],o,p=bv(function(a,b,c){var d=a*w.cos(c)-b*w.sin(c),e=a*w.sin(c)+b*w.cos(c);return{x:d,y:e}});if(!j){o=p(a,b,-l),a=o.x,b=o.y,o=p(h,i,-l),h=o.x,i=o.y;var q=w.cos(B/180*e),r=w.sin(B/180*e),t=(a-h)/2,u=(b-i)/2,v=t*t/(c*c)+u*u/(d*d);v>1&&(v=w.sqrt(v),c=v*c,d=v*d);var x=c*c,y=d*d,A=(f==g?-1:1)*w.sqrt(z((x*y-x*u*u-y*t*t)/(x*u*u+y*t*t))),C=A*c*u/d+(a+h)/2,D=A*-d*t/c+(b+i)/2,E=w.asin(((b-D)/d).toFixed(9)),F=w.asin(((i-D)/d).toFixed(9));E=a<C?B-E:E,F=h<C?B-F:F,E<0&&(E=B*2+E),F<0&&(F=B*2+F),g&&E>F&&(E=E-B*2),!g&&F>E&&(F=F-B*2)}else E=j[0],F=j[1],C=j[2],D=j[3];var G=F-E;if(z(G)>k){var H=F,I=h,J=i;F=E+k*(g&&F>E?1:-1),h=C+c*w.cos(F),i=D+d*w.sin(F),m=bO(h,i,c,d,e,0,g,I,J,[F,H,C,D])}G=F-E;var K=w.cos(E),L=w.sin(E),M=w.cos(F),N=w.sin(F),O=w.tan(G/4),P=4/3*c*O,Q=4/3*d*O,R=[a,b],S=[a+P*L,b-Q*K],T=[h+P*N,i-Q*M],U=[h,i];S[0]=2*R[0]-S[0],S[1]=2*R[1]-S[1];if(j)return[S,T,U][n](m);m=[S,T,U][n](m).join()[s](",");var V=[];for(var W=0,X=m.length;W<X;W++)V[W]=W%2?p(m[W-1],m[W],l).y:p(m[W],m[W+1],l).x;return V},bP=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:A(j,3)*a+A(j,2)*3*i*c+j*3*i*i*e+A(i,3)*g,y:A(j,3)*b+A(j,2)*3*i*d+j*3*i*i*f+A(i,3)*h}},bQ=bv(function(a,b,c,d,e,f,g,h){var i=e-2*c+a-(g-2*e+c),j=2*(c-a)-2*(e-c),k=a-c,l=(-j+w.sqrt(j*j-4*i*k))/2/i,n=(-j-w.sqrt(j*j-4*i*k))/2/i,o=[b,h],p=[a,g],q;z(l)>"1e12"&&(l=.5),z(n)>"1e12"&&(n=.5),l>0&&l<1&&(q=bP(a,b,c,d,e,f,g,h,l),p.push(q.x),o.push(q.y)),n>0&&n<1&&(q=bP(a,b,c,d,e,f,g,h,n),p.push(q.x),o.push(q.y)),i=f-2*d+b-(h-2*f+d),j=2*(d-b)-2*(f-d),k=b-d,l=(-j+w.sqrt(j*j-4*i*k))/2/i,n=(-j-w.sqrt(j*j-4*i*k))/2/i,z(l)>"1e12"&&(l=.5),z(n)>"1e12"&&(n=.5),l>0&&l<1&&(q=bP(a,b,c,d,e,f,g,h,l),p.push(q.x),o.push(q.y)),n>0&&n<1&&(q=bP(a,b,c,d,e,f,g,h,n),p.push(q.x),o.push(q.y));return{min:{x:y[m](0,p),y:y[m](0,o)},max:{x:x[m](0,p),y:x[m](0,o)}}}),bR=a._path2curve=bv(function(a,b){var c=!b&&bz(a);if(!b&&c.curve)return bJ(c.curve);var d=bL(a),e=b&&bL(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=function(a,b){var c,d;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null);switch(a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"][n](bO[m](0,[b.x,b.y][n](a.slice(1))));break;case"S":c=b.x+(b.x-(b.bx||b.x)),d=b.y+(b.y-(b.by||b.y)),a=["C",c,d][n](a.slice(1));break;case"T":b.qx=b.x+(b.x-(b.qx||b.x)),b.qy=b.y+(b.y-(b.qy||b.y)),a=["C"][n](bN(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"][n](bN(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][n](bM(b.x,b.y,a[1],a[2]));break;case"H":a=["C"][n](bM(b.x,b.y,a[1],b.y));break;case"V":a=["C"][n](bM(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"][n](bM(b.x,b.y,b.X,b.Y))}return a},i=function(a,b){if(a[b].length>7){a[b].shift();var c=a[b];while(c.length)a.splice(b++,0,["C"][n](c.splice(0,6)));a.splice(b,1),l=x(d.length,e&&e.length||0)}},j=function(a,b,c,f,g){a&&b&&a[g][0]=="M"&&b[g][0]!="M"&&(b.splice(g,0,["M",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=x(d.length,e&&e.length||0))};for(var k=0,l=x(d.length,e&&e.length||0);k<l;k++){d[k]=h(d[k],f),i(d,k),e&&(e[k]=h(e[k],g)),e&&i(e,k),j(d,e,f,g,k),j(e,d,g,f,k);var o=d[k],p=e&&e[k],q=o.length,r=e&&p.length;f.x=o[q-2],f.y=o[q-1],f.bx=Q(o[q-4])||f.x,f.by=Q(o[q-3])||f.y,g.bx=e&&(Q(p[r-4])||g.x),g.by=e&&(Q(p[r-3])||g.y),g.x=e&&p[r-2],g.y=e&&p[r-1]}e||(c.curve=bJ(d));return e?[d,e]:d},null,bJ),bS=a._parseDots=bv(function(b){var c=[];for(var d=0,e=b.length;d<e;d++){var f={},g=b[d].match(/^([^:]*):?([\d\.]*)/);f.color=a.getRGB(g[1]);if(f.color.error)return null;f.color=f.color.hex,g[2]&&(f.offset=g[2]+"%"),c.push(f)}for(d=1,e=c.length-1;d<e;d++)if(!c[d].offset){var h=Q(c[d-1].offset||0),i=0;for(var j=d+1;j<e;j++)if(c[j].offset){i=c[j].offset;break}i||(i=100,j=e),i=Q(i);var k=(i-h)/(j-d+1);for(;d<j;d++)h+=k,c[d].offset=h+"%"}return c}),bT=a._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)},bU=a._tofront=function(a,b){b.top!==a&&(bT(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},bV=a._toback=function(a,b){b.bottom!==a&&(bT(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},bW=a._insertafter=function(a,b,c){bT(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},bX=a._insertbefore=function(a,b,c){bT(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},bY=a.toMatrix=function(a,b){var c=bI(a),d={_:{transform:p},getBBox:function(){return c}};b$(d,b);return d.matrix},bZ=a.transformPath=function(a,b){return bj(a,bY(a,b))},b$=a._extractTransform=function(b,c){if(c==null)return b._.transform;c=r(c).replace(/\.{3}|\u2026/g,b._.transform||p);var d=a.parseTransformString(c),e=0,f=0,g=0,h=1,i=1,j=b._,k=new cb;j.transform=d||[];if(d)for(var l=0,m=d.length;l<m;l++){var n=d[l],o=n.length,q=r(n[0]).toLowerCase(),s=n[0]!=q,t=s?k.invert():0,u,v,w,x,y;q=="t"&&o==3?s?(u=t.x(0,0),v=t.y(0,0),w=t.x(n[1],n[2]),x=t.y(n[1],n[2]),k.translate(w-u,x-v)):k.translate(n[1],n[2]):q=="r"?o==2?(y=y||b.getBBox(1),k.rotate(n[1],y.x+y.width/2,y.y+y.height/2),e+=n[1]):o==4&&(s?(w=t.x(n[2],n[3]),x=t.y(n[2],n[3]),k.rotate(n[1],w,x)):k.rotate(n[1],n[2],n[3]),e+=n[1]):q=="s"?o==2||o==3?(y=y||b.getBBox(1),k.scale(n[1],n[o-1],y.x+y.width/2,y.y+y.height/2),h*=n[1],i*=n[o-1]):o==5&&(s?(w=t.x(n[3],n[4]),x=t.y(n[3],n[4]),k.scale(n[1],n[2],w,x)):k.scale(n[1],n[2],n[3],n[4]),h*=n[1],i*=n[2]):q=="m"&&o==7&&k.add(n[1],n[2],n[3],n[4],n[5],n[6]),j.dirtyT=1,b.matrix=k}b.matrix=k,j.sx=h,j.sy=i,j.deg=e,j.dx=f=k.e,j.dy=g=k.f,h==1&&i==1&&!e&&j.bbox?(j.bbox.x+=+f,j.bbox.y+=+g):j.dirtyT=1},b_=function(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return a.length==4?[b,0,a[2],a[3]]:[b,0];case"s":return a.length==5?[b,1,1,a[3],a[4]]:a.length==3?[b,1,1]:[b,1]}},ca=a._equaliseTransform=function(b,c){c=r(c).replace(/\.{3}|\u2026/g,b),b=a.parseTransformString(b)||[],c=a.parseTransformString(c)||[];var d=x(b.length,c.length),e=[],f=[],g=0,h,i,j,k;for(;g<d;g++){j=b[g]||b_(c[g]),k=c[g]||b_(j);if(j[0]!=k[0]||j[0].toLowerCase()=="r"&&(j[2]!=k[2]||j[3]!=k[3])||j[0].toLowerCase()=="s"&&(j[3]!=k[3]||j[4]!=k[4]))return;e[g]=[],f[g]=[];for(h=0,i=x(j.length,k.length);h<i;h++)h in j&&(e[g][h]=j[h]),h in k&&(f[g][h]=k[h])}return{from:e,to:f}};a._getContainer=function(b,c,d,e){var f;f=e==null&&!a.is(b,"object")?h.doc.getElementById(b):b;if(f!=null){if(f.tagName)return c==null?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:c,height:d};return{container:1,x:b,y:c,width:d,height:e}}},a.pathToRelative=bK,a._engine={},a.path2curve=bR,a.matrix=function(a,b,c,d,e,f){return new cb(a,b,c,d,e,f)},function(b){function d(a){var b=w.sqrt(c(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}function c(a){return a[0]*a[0]+a[1]*a[1]}b.add=function(a,b,c,d,e,f){var g=[[],[],[]],h=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],i=[[a,c,e],[b,d,f],[0,0,1]],j,k,l,m;a&&a instanceof cb&&(i=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]);for(j=0;j<3;j++)for(k=0;k<3;k++){m=0;for(l=0;l<3;l++)m+=h[j][l]*i[l][k];g[j][k]=m}this.a=g[0][0],this.b=g[1][0],this.c=g[0][1],this.d=g[1][1],this.e=g[0][2],this.f=g[1][2]},b.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new cb(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},b.clone=function(){return new cb(this.a,this.b,this.c,this.d,this.e,this.f)},b.translate=function(a,b){this.add(1,0,0,1,a,b)},b.scale=function(a,b,c,d){b==null&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},b.rotate=function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var e=+w.cos(b).toFixed(9),f=+w.sin(b).toFixed(9);this.add(e,f,-f,e,c,d),this.add(1,0,0,1,-c,-d)},b.x=function(a,b){return a*this.a+b*this.c+this.e},b.y=function(a,b){return a*this.b+b*this.d+this.f},b.get=function(a){return+this[r.fromCharCode(97+a)].toFixed(4)},b.toString=function(){return a.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},b.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},b.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},b.split=function(){var b={};b.dx=this.e,b.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];b.scalex=w.sqrt(c(e[0])),d(e[0]),b.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*b.shear,e[1][1]-e[0][1]*b.shear],b.scaley=w.sqrt(c(e[1])),d(e[1]),b.shear/=b.scaley;var f=-e[0][1],g=e[1][1];g<0?(b.rotate=a.deg(w.acos(g)),f<0&&(b.rotate=360-b.rotate)):b.rotate=a.deg(w.asin(f)),b.isSimple=!+b.shear.toFixed(9)&&(b.scalex.toFixed(9)==b.scaley.toFixed(9)||!b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate;return b},b.toTransformString=function(a){var b=a||this[s]();if(b.isSimple){b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4);return(b.dx||b.dy?"t"+[b.dx,b.dy]:p)+(b.scalex!=1||b.scaley!=1?"s"+[b.scalex,b.scaley,0,0]:p)+(b.rotate?"r"+[b.rotate,0,0]:p)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(cb.prototype);var cc=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(cc&&cc[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&cc&&cc[1]<8?k.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:k.safari=be;var cd=function(){this.returnValue=!1},ce=function(){return this.originalEvent.preventDefault()},cf=function(){this.cancelBubble=!0},cg=function(){return this.originalEvent.stopPropagation()},ch=function(){if(h.doc.addEventListener)return function(a,b,c,d){var e=o&&u[b]?u[b]:b,f=function(e){var f=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,i=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,j=e.clientX+i,k=e.clientY+f;if(o&&u[g](b))for(var l=0,m=e.targetTouches&&e.targetTouches.length;l<m;l++)if(e.targetTouches[l].target==a){var n=e;e=e.targetTouches[l],e.originalEvent=n,e.preventDefault=ce,e.stopPropagation=cg;break}return c.call(d,e,j,k)};a.addEventListener(e,f,!1);return function(){a.removeEventListener(e,f,!1);return!0}};if(h.doc.attachEvent)return function(a,b,c,d){var e=function(a){a=a||h.win.event;var b=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,e=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;a.preventDefault=a.preventDefault||cd,a.stopPropagation=a.stopPropagation||cf;return c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){a.detachEvent("on"+b,e);return!0};return f}}(),ci=[],cj=function(a){var b=a.clientX,c=a.clientY,d=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,e=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft,f,g=ci.length;while(g--){f=ci[g];if(o){var i=a.touches.length,j;while(i--){j=a.touches[i];if(j.identifier==f.el._drag.id){b=j.clientX,c=j.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else a.preventDefault();var k=f.el.node,l,m=k.nextSibling,n=k.parentNode,p=k.style.display;h.win.opera&&n.removeChild(k),k.style.display="none",l=f.el.paper.getElementByPoint(b,c),k.style.display=p,h.win.opera&&(m?n.insertBefore(k,m):n.appendChild(k)),l&&eve("raphael.drag.over."+f.el.id,f.el,l),b+=e,c+=d,eve("raphael.drag.move."+f.el.id,f.move_scope||f.el,b-f.el._drag.x,c-f.el._drag.y,b,c,a)}},ck=function(b){a.unmousemove(cj).unmouseup(ck);var c=ci.length,d;while(c--)d=ci[c],d.el._drag={},eve("raphael.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,b);ci=[]},cl=a.el={};for(var cm=t.length;cm--;)(function(b){a[b]=cl[b]=function(c,d){a.is(c,"function")&&(this.events=this.events||[],this.events.push({name:b,f:c,unbind:ch(this.shape||this.node||h.doc,b,c,d||this)}));return this},a["un"+b]=cl["un"+b]=function(a){var c=this.events||[],d=c.length;while(d--)if(c[d].name==b&&c[d].f==a){c[d].unbind(),c.splice(d,1),!c.length&&delete this.events;return this}return this}})(t[cm]);cl.data=function(b,c){var d=bb[this.id]=bb[this.id]||{};if(arguments.length==1){if(a.is(b,"object")){for(var e in b)b[g](e)&&this.data(e,b[e]);return this}eve("raphael.data.get."+this.id,this,d[b],b);return d[b]}d[b]=c,eve("raphael.data.set."+this.id,this,c,b);return this},cl.removeData=function(a){a==null?bb[this.id]={}:bb[this.id]&&delete bb[this.id][a];return this},cl.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},cl.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var cn=[];cl.drag=function(b,c,d,e,f,g){function i(i){(i.originalEvent||i).preventDefault();var j=h.doc.documentElement.scrollTop||h.doc.body.scrollTop,k=h.doc.documentElement.scrollLeft||h.doc.body.scrollLeft;this._drag.x=i.clientX+k,this._drag.y=i.clientY+j,this._drag.id=i.identifier,!ci.length&&a.mousemove(cj).mouseup(ck),ci.push({el:this,move_scope:e,start_scope:f,end_scope:g}),c&&eve.on("raphael.drag.start."+this.id,c),b&&eve.on("raphael.drag.move."+this.id,b),d&&eve.on("raphael.drag.end."+this.id,d),eve("raphael.drag.start."+this.id,f||e||this,i.clientX+k,i.clientY+j,i)}this._drag={},cn.push({el:this,start:i}),this.mousedown(i);return this},cl.onDragOver=function(a){a?eve.on("raphael.drag.over."+this.id,a):eve.unbind("raphael.drag.over."+this.id)},cl.undrag=function(){var b=cn.length;while(b--)cn[b].el==this&&(this.unmousedown(cn[b].start),cn.splice(b,1),eve.unbind("raphael.drag.*."+this.id));!cn.length&&a.unmousemove(cj).unmouseup(ck)},k.circle=function(b,c,d){var e=a._engine.circle(this,b||0,c||0,d||0);this.__set__&&this.__set__.push(e);return e},k.rect=function(b,c,d,e,f){var g=a._engine.rect(this,b||0,c||0,d||0,e||0,f||0);this.__set__&&this.__set__.push(g);return g},k.ellipse=function(b,c,d,e){var f=a._engine.ellipse(this,b||0,c||0,d||0,e||0);this.__set__&&this.__set__.push(f);return f},k.path=function(b){b&&!a.is(b,D)&&!a.is(b[0],E)&&(b+=p);var c=a._engine.path(a.format[m](a,arguments),this);this.__set__&&this.__set__.push(c);return c},k.image=function(b,c,d,e,f){var g=a._engine.image(this,b||"about:blank",c||0,d||0,e||0,f||0);this.__set__&&this.__set__.push(g);return g},k.text=function(b,c,d){var e=a._engine.text(this,b||0,c||0,r(d));this.__set__&&this.__set__.push(e);return e},k.set=function(b){!a.is(b,"array")&&(b=Array.prototype.splice.call(arguments,0,arguments.length));var c=new cG(b);this.__set__&&this.__set__.push(c);return c},k.setStart=function(a){this.__set__=a||this.set()},k.setFinish=function(a){var b=this.__set__;delete this.__set__;return b},k.setSize=function(b,c){return a._engine.setSize.call(this,b,c)},k.setViewBox=function(b,c,d,e,f){return a._engine.setViewBox.call(this,b,c,d,e,f)},k.top=k.bottom=null,k.raphael=a;var co=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,i=b.top+(h.win.pageYOffset||e.scrollTop||d.scrollTop)-f,j=b.left+(h.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:i,x:j}};k.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=h.doc.elementFromPoint(a,b);if(h.win.opera&&e.tagName=="svg"){var f=co(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var i=d.getIntersectionList(g,null);i.length&&(e=i[i.length-1])}if(!e)return null;while(e.parentNode&&e!=d.parentNode&&!e.raphael)e=e.parentNode;e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null;return e},k.getById=function(a){var b=this.bottom;while(b){if(b.id==a)return b;b=b.next}return null},k.forEach=function(a,b){var c=this.bottom;while(c){if(a.call(b,c)===!1)return this;c=c.next}return this},k.getElementsByPoint=function(a,b){var c=this.set();this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)});return c},cl.isPointInside=function(b,c){var d=this.realPath=this.realPath||bi[this.type](this);this.attr("transform")&&this.attr("transform").length&&(d=a.transformPath(d,this.attr("transform")));return a.isPointInsidePath(d,b,c)},cl.getBBox=function(a){if(this.removed)return{};var b=this._;if(a){if(b.dirty||!b.bboxwt)this.realPath=bi[this.type](this),b.bboxwt=bI(this.realPath),b.bboxwt.toString=cq,b.dirty=0;return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath)b.bboxwt=0,this.realPath=bi[this.type](this);b.bbox=bI(bj(this.realPath,this.matrix)),b.bbox.toString=cq,b.dirty=b.dirtyT=0}return b.bbox},cl.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(a);return a},cl.glow=function(a){if(this.type=="text")return null;a=a||{};var b={width:(a.width||10)+(+this.attr("stroke-width")||1),fill:a.fill||!1,opacity:a.opacity||.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||"#000"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||bi[this.type](this);f=this.matrix?bj(f,this.matrix):f;for(var g=1;g<c+1;g++)e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}));return e.insertBefore(this).translate(b.offsetx,b.offsety)};var cr={},cs=function(b,c,d,e,f,g,h,i,j){return j==null?bB(b,c,d,e,f,g,h,i):a.findDotsAtSegment(b,c,d,e,f,g,h,i,bC(b,c,d,e,f,g,h,i,j))},ct=function(b,c){return function(d,e,f){d=bR(d);var g,h,i,j,k="",l={},m,n=0;for(var o=0,p=d.length;o<p;o++){i=d[o];if(i[0]=="M")g=+i[1],h=+i[2];else{j=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6]);if(n+j>e){if(c&&!l.start){m=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),k+=["C"+m.start.x,m.start.y,m.m.x,m.m.y,m.x,m.y];if(f)return k;l.start=k,k=["M"+m.x,m.y+"C"+m.n.x,m.n.y,m.end.x,m.end.y,i[5],i[6]].join(),n+=j,g=+i[5],h=+i[6];continue}if(!b&&!c){m=cs(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n);return{x:m.x,y:m.y,alpha:m.alpha}}}n+=j,g=+i[5],h=+i[6]}k+=i.shift()+i}l.end=k,m=b?n:c?l:a.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1),m.alpha&&(m={x:m.x,y:m.y,alpha:m.alpha});return m}},cu=ct(1),cv=ct(),cw=ct(0,1);a.getTotalLength=cu,a.getPointAtLength=cv,a.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return cw(a,b).end;var d=cw(a,c,1);return b?cw(d,b).end:d},cl.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return cu(this.attrs.path)}},cl.getPointAtLength=function(a){if(this.type=="path")return cv(this.attrs.path,a)},cl.getSubpath=function(b,c){if(this.type=="path")return a.getSubpath(this.attrs.path,b,c)};var cx=a.easing_formulas={linear:function(a){return a},"<":function(a){return A(a,1.7)},">":function(a){return A(a,.48)},"<>":function(a){var b=.48-a/1.04,c=w.sqrt(.1734+b*b),d=c-b,e=A(z(d),1/3)*(d<0?-1:1),f=-c-b,g=A(z(f),1/3)*(f<0?-1:1),h=e+g+.5;return(1-h)*3*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a=a-1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){if(a==!!a)return a;return A(2,-10*a)*w.sin((a-.075)*2*B/.3)+1},bounce:function(a){var b=7.5625,c=2.75,d;a<1/c?d=b*a*a:a<2/c?(a-=1.5/c,d=b*a*a+.75):a<2.5/c?(a-=2.25/c,d=b*a*a+.9375):(a-=2.625/c,d=b*a*a+.984375);return d}};cx.easeIn=cx["ease-in"]=cx["<"],cx.easeOut=cx["ease-out"]=cx[">"],cx.easeInOut=cx["ease-in-out"]=cx["<>"],cx["back-in"]=cx.backIn,cx["back-out"]=cx.backOut;var cy=[],cz=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,16)},cA=function(){var b=+(new Date),c=0;for(;c<cy.length;c++){var d=cy[c];if(d.el.removed||d.paused)continue;var e=b-d.start,f=d.ms,h=d.easing,i=d.from,j=d.diff,k=d.to,l=d.t,m=d.el,o={},p,r={},s;d.initstatus?(e=(d.initstatus*d.anim.top-d.prev)/(d.percent-d.prev)*f,d.status=d.initstatus,delete d.initstatus,d.stop&&cy.splice(c--,1)):d.status=(d.prev+(d.percent-d.prev)*(e/f))/d.anim.top;if(e<0)continue;if(e<f){var t=h(e/f);for(var u in i)if(i[g](u)){switch(U[u]){case C:p=+i[u]+t*f*j[u];break;case"colour":p="rgb("+[cB(O(i[u].r+t*f*j[u].r)),cB(O(i[u].g+t*f*j[u].g)),cB(O(i[u].b+t*f*j[u].b))].join(",")+")";break;case"path":p=[];for(var v=0,w=i[u].length;v<w;v++){p[v]=[i[u][v][0]];for(var x=1,y=i[u][v].length;x<y;x++)p[v][x]=+i[u][v][x]+t*f*j[u][v][x];p[v]=p[v].join(q)}p=p.join(q);break;case"transform":if(j[u].real){p=[];for(v=0,w=i[u].length;v<w;v++){p[v]=[i[u][v][0]];for(x=1,y=i[u][v].length;x<y;x++)p[v][x]=i[u][v][x]+t*f*j[u][v][x]}}else{var z=function(a){return+i[u][a]+t*f*j[u][a]};p=[["m",z(0),z(1),z(2),z(3),z(4),z(5)]]}break;case"csv":if(u=="clip-rect"){p=[],v=4;while(v--)p[v]=+i[u][v]+t*f*j[u][v]}break;default:var A=[][n](i[u]);p=[],v=m.paper.customAttributes[u].length;while(v--)p[v]=+A[v]+t*f*j[u][v]}o[u]=p}m.attr(o),function(a,b,c){setTimeout(function(){eve("raphael.anim.frame."+a,b,c)})}(m.id,m,d.anim)}else{(function(b,c,d){setTimeout(function(){eve("raphael.anim.frame."+c.id,c,d),eve("raphael.anim.finish."+c.id,c,d),a.is(b,"function")&&b.call(c)})})(d.callback,m,d.anim),m.attr(k),cy.splice(c--,1);if(d.repeat>1&&!d.next){for(s in k)k[g](s)&&(r[s]=d.totalOrigin[s]);d.el.attr(r),cE(d.anim,d.el,d.anim.percents[0],null,d.totalOrigin,d.repeat-1)}d.next&&!d.stop&&cE(d.anim,d.el,d.next,null,d.totalOrigin,d.repeat)}}a.svg&&m&&m.paper&&m.paper.safari(),cy.length&&cz(cA)},cB=function(a){return a>255?255:a<0?0:a};cl.animateWith=function(b,c,d,e,f,g){var h=this;if(h.removed){g&&g.call(h);return h}var i=d instanceof cD?d:a.animation(d,e,f,g),j,k;cE(i,h,i.percents[0],null,h.attr());for(var l=0,m=cy.length;l<m;l++)if(cy[l].anim==c&&cy[l].el==b){cy[m-1].start=cy[l].start;break}return h},cl.onAnimation=function(a){a?eve.on("raphael.anim.frame."+this.id,a):eve.unbind("raphael.anim.frame."+this.id);return this},cD.prototype.delay=function(a){var b=new cD(this.anim,this.ms);b.times=this.times,b.del=+a||0;return b},cD.prototype.repeat=function(a){var b=new cD(this.anim,this.ms);b.del=this.del,b.times=w.floor(x(a,0))||1;return b},a.animation=function(b,c,d,e){if(b instanceof cD)return b;if(a.is(d,"function")||!d)e=e||d||null,d=null;b=Object(b),c=+c||0;var f={},h,i;for(i in b)b[g](i)&&Q(i)!=i&&Q(i)+"%"!=i&&(h=!0,f[i]=b[i]);if(!h)return new cD(b,c);d&&(f.easing=d),e&&(f.callback=e);return new cD({100:f},c)},cl.animate=function(b,c,d,e){var f=this;if(f.removed){e&&e.call(f);return f}var g=b instanceof cD?b:a.animation(b,c,d,e);cE(g,f,g.percents[0],null,f.attr());return f},cl.setTime=function(a,b){a&&b!=null&&this.status(a,y(b,a.ms)/a.ms);return this},cl.status=function(a,b){var c=[],d=0,e,f;if(b!=null){cE(a,this,-1,y(b,1));return this}e=cy.length;for(;d<e;d++){f=cy[d];if(f.el.id==this.id&&(!a||f.anim==a)){if(a)return f.status;c.push({anim:f.anim,status:f.status})}}if(a)return 0;return c},cl.pause=function(a){for(var b=0;b<cy.length;b++)cy[b].el.id==this.id&&(!a||cy[b].anim==a)&&eve("raphael.anim.pause."+this.id,this,cy[b].anim)!==!1&&(cy[b].paused=!0);return this},cl.resume=function(a){for(var b=0;b<cy.length;b++)if(cy[b].el.id==this.id&&(!a||cy[b].anim==a)){var c=cy[b];eve("raphael.anim.resume."+this.id,this,c.anim)!==!1&&(delete c.paused,this.status(c.anim,c.status))}return this},cl.stop=function(a){for(var b=0;b<cy.length;b++)cy[b].el.id==this.id&&(!a||cy[b].anim==a)&&eve("raphael.anim.stop."+this.id,this,cy[b].anim)!==!1&&cy.splice(b--,1);return this},eve.on("raphael.remove",cF),eve.on("raphael.clear",cF),cl.toString=function(){return"Rapha?l?s object"};var cG=function(a){this.items=[],this.length=0,this.type="set";if(a)for(var b=0,c=a.length;b<c;b++)a[b]&&(a[b].constructor==cl.constructor||a[b].constructor==cG)&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},cH=cG.prototype;cH.push=function(){var a,b;for(var c=0,d=arguments.length;c<d;c++)a=arguments[c],a&&(a.constructor==cl.constructor||a.constructor==cG)&&(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},cH.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},cH.forEach=function(a,b){for(var c=0,d=this.items.length;c<d;c++)if(a.call(b,this.items[c],c)===!1)return this;return this};for(var cI in cl)cl[g](cI)&&(cH[cI]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][m](c,b)})}}(cI));cH.attr=function(b,c){if(b&&a.is(b,E)&&a.is(b[0],"object"))for(var d=0,e=b.length;d<e;d++)this.items[d].attr(b[d]);else for(var f=0,g=this.items.length;f<g;f++)this.items[f].attr(b,c);return this},cH.clear=function(){while(this.length)this.pop()},cH.splice=function(a,b,c){a=a<0?x(this.length+a,0):a,b=x(0,y(this.length-a,b));var d=[],e=[],f=[],g;for(g=2;g<arguments.length;g++)f.push(arguments[g]);for(g=0;g<b;g++)e.push(this[a+g]);for(;g<this.length-a;g++)d.push(this[a+g]);var h=f.length;for(g=0;g<h+d.length;g++)this.items[a+g]=this[a+g]=g<h?f[g]:d[g-h];g=this.items.length=this.length-=b-h;while(this[g])delete this[g++];return new cG(e)},cH.exclude=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a){this.splice(b,1);return!0}},cH.animate=function(b,c,d,e){(a.is(d,"function")||!d)&&(e=d||null);var f=this.items.length,g=f,h,i=this,j;if(!f)return this;e&&(j=function(){!--f&&e.call(i)}),d=a.is(d,D)?d:j;var k=a.animation(b,c,d,j);h=this.items[--g].animate(k);while(g--)this.items[g]&&!this.items[g].removed&&this.items[g].animateWith(h,k,k);return this},cH.insertAfter=function(a){var b=this.items.length;while(b--)this.items[b].insertAfter(a);return this},cH.getBBox=function(){var a=[],b=[],c=[],d=[];for(var e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}a=y[m](0,a),b=y[m](0,b),c=x[m](0,c),d=x[m](0,d);return{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}},cH.clone=function(a){a=new cG;for(var b=0,c=this.items.length;b<c;b++)a.push(this.items[b].clone());return a},cH.toString=function(){return"Rapha?l?s set"},a.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"];for(var d in a.face)a.face[g](d)&&(b.face[d]=a.face[d]);this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b];if(!a.svg){b.face["units-per-em"]=R(a.face["units-per-em"],10);for(var e in a.glyphs)if(a.glyphs[g](e)){var f=a.glyphs[e];b.glyphs[e]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"};if(f.k)for(var h in f.k)f[g](h)&&(b.glyphs[e].k[h]=f.k[h])}}return a},k.getFont=function(b,c,d,e){e=e||"normal",d=d||"normal",c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(!!a.fonts){var f=a.fonts[b];if(!f){var h=new RegExp("(^|\\s)"+b.replace(/[^\w\d\s+!~.:_-]/g,p)+"(\\s|$)","i");for(var i in a.fonts)if(a.fonts[g](i)&&h.test(i)){f=a.fonts[i];break}}var j;if(f)for(var k=0,l=f.length;k<l;k++){j=f[k];if(j.face["font-weight"]==c&&(j.face["font-style"]==d||!j.face["font-style"])&&j.face["font-stretch"]==e)break}return j}},k.print=function(b,d,e,f,g,h,i){h=h||"middle",i=x(y(i||0,1),-1);var j=r(e)[s](p),k=0,l=0,m=p,n;a.is(f,e)&&(f=this.getFont(f));if(f){n=(g||16)/f.face["units-per-em"];var o=f.face.bbox[s](c),q=+o[0],t=o[3]-o[1],u=0,v=+o[1]+(h=="baseline"?t+ +f.face.descent:t/2);for(var w=0,z=j.length;w<z;w++){if(j[w]=="\n")k=0,B=0,l=0,u+=t;else{var A=l&&f.glyphs[j[w-1]]||{},B=f.glyphs[j[w]];k+=l?(A.w||f.w)+(A.k&&A.k[j[w]]||0)+f.w*i:0,l=1}B&&B.d&&(m+=a.transformPath(B.d,["t",k*n,u*n,"s",n,n,q,v,"t",(b-q)/n,(d-v)/n]))}}return this.path(m).attr({fill:"#000",stroke:"none"})},k.add=function(b){if(a.is(b,"array")){var c=this.set(),e=0,f=b.length,h;for(;e<f;e++)h=b[e]||{},d[g](h.type)&&c.push(this[h.type]().attr(h))}return c},a.format=function(b,c){var d=a.is(c,E)?[0][n](c):arguments;b&&a.is(b,D)&&d.length-1&&(b=b.replace(e,function(a,b){return d[++b]==null?p:d[b]}));return b||p},a.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),typeof e=="function"&&f&&(e=e()))}),e=(e==null||e==d?a:e)+"";return e};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),a.ninja=function(){i.was?h.win.Raphael=i.is:delete Raphael;return a},a.st=cH,function(b,c,d){function e(){/in/.test(b.readyState)?setTimeout(e,9):a.eve("raphael.DOMload")}b.readyState==null&&b.addEventListener&&(b.addEventListener(c,d=function(){b.removeEventListener(c,d,!1),b.readyState="complete"},!1),b.readyState="loading"),e()}(document,"DOMContentLoaded"),i.was?h.win.Raphael=a:Raphael=a,eve.on("raphael.DOMload",function(){b=!0})}(),window.Raphael.svg&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=a.eve,l="",m=" ",n="http://www.w3.org/1999/xlink",o={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},p={};a.toString=function(){return"Your browser supports SVG.\nYou are running Rapha?l "+this.version};var q=function(d,e){if(e){typeof d=="string"&&(d=q(d));for(var f in e)e[b](f)&&(f.substring(0,6)=="xlink:"?d.setAttributeNS(n,f.substring(6),c(e[f])):d.setAttribute(f,c(e[f])))}else d=a._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)");return d},r=function(b,e){var j="linear",k=b.id+e,m=.5,n=.5,o=b.node,p=b.paper,r=o.style,s=a._g.doc.getElementById(k);if(!s){e=c(e).replace(a._radial_gradient,function(a,b,c){j="radial";if(b&&c){m=d(b),n=d(c);var e=(n>.5)*2-1;i(m-.5,2)+i(n-.5,2)>.25&&(n=f.sqrt(.25-i(m-.5,2))*e+.5)&&n!=.5&&(n=n.toFixed(5)-1e-5*e)}return l}),e=e.split(/\s*\-\s*/);if(j=="linear"){var t=e.shift();t=-d(t);if(isNaN(t))return null;var u=[0,0,f.cos(a.rad(t)),f.sin(a.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=a._parseDots(e);if(!w)return null;k=k.replace(/[\(\)\s,\xb0#]/g,"_"),b.gradient&&k!=b.gradient.id&&(p.defs.removeChild(b.gradient),delete b.gradient);if(!b.gradient){s=q(j+"Gradient",{id:k}),b.gradient=s,q(s,j=="radial"?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:b.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;x<y;x++)s.appendChild(q("stop",{offset:w[x].offset?w[x].offset:x?"100%":"0%","stop-color":w[x].color||"#fff"}))}}q(o,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1}),r.fill=l,r.opacity=1,r.fillOpacity=1;return 1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},t=function(d,e,f){if(d.type=="path"){var g=c(e).toLowerCase().split("-"),h=d.paper,i=f?"end":"start",j=d.node,k=d.attrs,m=k["stroke-width"],n=g.length,r="classic",s,t,u,v,w,x=3,y=3,z=5;while(n--)switch(g[n]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":r=g[n];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":x=5;break;case"short":x=2}r=="open"?(x+=2,y+=2,z+=2,u=1,v=f?4:1,w={fill:"none",stroke:k.stroke}):(v=u=x/2,w={fill:k.stroke,stroke:"none"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={};if(r!="none"){var A="raphael-marker-"+r,B="raphael-marker-"+i+r+x+y;a._g.doc.getElementById(A)?p[A]++:(h.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:o[r],id:A})),p[A]=1);var C=a._g.doc.getElementById(B),D;C?(p[B]++,D=C.getElementsByTagName("use")[0]):(C=q(q("marker"),{id:B,markerHeight:y,markerWidth:x,orient:"auto",refX:v,refY:y/2}),D=q(q("use"),{"xlink:href":"#"+A,transform:(f?"rotate(180 "+x/2+" "+y/2+") ":l)+"scale("+x/z+","+y/z+")","stroke-width":(1/((x/z+y/z)/2)).toFixed(4)}),C.appendChild(D),h.defs.appendChild(C),p[B]=1),q(D,w);var F=u*(r!="diamond"&&r!="oval");f?(s=d._.arrows.startdx*m||0,t=a.getTotalLength(k.path)-F*m):(s=F*m,t=a.getTotalLength(k.path)-(d._.arrows.enddx*m||0)),w={},w["marker-"+i]="url(#"+B+")";if(t||s)w.d=Raphael.getSubpath(k.path,s,t);q(j,w),d._.arrows[i+"Path"]=A,d._.arrows[i+"Marker"]=B,d._.arrows[i+"dx"]=F,d._.arrows[i+"Type"]=r,d._.arrows[i+"String"]=e}else f?(s=d._.arrows.startdx*m||0,t=a.getTotalLength(k.path)-s):(s=0,t=a.getTotalLength(k.path)-(d._.arrows.enddx*m||0)),d._.arrows[i+"Path"]&&q(j,{d:Raphael.getSubpath(k.path,s,t)}),delete d._.arrows[i+"Path"],delete d._.arrows[i+"Marker"],delete d._.arrows[i+"dx"],delete d._.arrows[i+"Type"],delete d._.arrows[i+"String"];for(w in p)if(p[b](w)&&!p[w]){var G=a._g.doc.getElementById(w);G&&G.parentNode.removeChild(G)}}},u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},v=function(a,b,d){b=u[c(b).toLowerCase()];if(b){var e=a.attrs["stroke-width"]||"1",f={round:e,square:e,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,g=[],h=b.length;while(h--)g[h]=b[h]*e+(h%2?1:-1)*f;q(a.node,{"stroke-dasharray":g.join(",")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility="hidden";for(var o in f)if(f[b](o)){if(!a._availableAttrs[b](o))continue;var p=f[o];k[o]=p;switch(o){case"blur":d.blur(p);break;case"href":case"title":case"target":var u=i.parentNode;if(u.tagName.toLowerCase()!="a"){var w=q("a");u.insertBefore(w,i),w.appendChild(i),u=w}o=="target"?u.setAttributeNS(n,"show",p=="blank"?"new":p):u.setAttributeNS(n,o,p);break;case"cursor":i.style.cursor=p;break;case"transform":d.transform(p);break;case"arrow-start":t(d,p);break;case"arrow-end":t(d,p,1);break;case"clip-rect":var x=c(p).split(j);if(x.length==4){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var z=q("clipPath"),A=q("rect");z.id=a.createUUID(),q(A,{x:x[0],y:x[1],width:x[2],height:x[3]}),z.appendChild(A),d.paper.defs.appendChild(z),q(i,{"clip-path":"url(#"+z.id+")"}),d.clip=A}if(!p){var B=i.getAttribute("clip-path");if(B){var C=a._g.doc.getElementById(B.replace(/(^url\(#|\)$)/g,l));C&&C.parentNode.removeChild(C),q(i,{"clip-path":l}),delete d.clip}}break;case"path":d.type=="path"&&(q(i,{d:p?k.path=a._pathToAbsolute(p):"M0,0"}),d._.dirty=1,d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1)));break;case"width":i.setAttribute(o,p),d._.dirty=1;if(k.fx)o="x",p=k.x;else break;case"x":k.fx&&(p=-k.x-(k.width||0));case"rx":if(o=="rx"&&d.type=="rect")break;case"cx":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"height":i.setAttribute(o,p),d._.dirty=1;if(k.fy)o="y",p=k.y;else break;case"y":k.fy&&(p=-k.y-(k.height||0));case"ry":if(o=="ry"&&d.type=="rect")break;case"cy":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"r":d.type=="rect"?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case"src":d.type=="image"&&i.setAttributeNS(n,"href",p);break;case"stroke-width":if(d._.sx!=1||d._.sy!=1)p/=g(h(d._.sx),h(d._.sy))||1;d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k["stroke-dasharray"]&&v(d,k["stroke-dasharray"],f),d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"stroke-dasharray":v(d,p,f);break;case"fill":var D=c(p).match(a._ISURL);if(D){z=q("pattern");var F=q("image");z.id=a.createUUID(),q(z,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(F,{x:0,y:0,"xlink:href":D[1]}),z.appendChild(F),function(b){a._preload(D[1],function(){var a=this.offsetWidth,c=this.offsetHeight;q(b,{width:a,height:c}),q(F,{width:a,height:c}),d.paper.safari()})}(z),d.paper.defs.appendChild(z),q(i,{fill:"url(#"+z.id+")"}),d.pattern=z,d.pattern&&s(d);break}var G=a.getRGB(p);if(!G.error)delete f.gradient,delete k.gradient,!a.is(k.opacity,"undefined")&&a.is(f.opacity,"undefined")&&q(i,{opacity:k.opacity}),!a.is(k["fill-opacity"],"undefined")&&a.is(f["fill-opacity"],"undefined")&&q(i,{"fill-opacity":k["fill-opacity"]});else if((d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p)){if("opacity"in k||"fill-opacity"in k){var H=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l));if(H){var I=H.getElementsByTagName("stop");q(I[I.length-1],{"stop-opacity":("opacity"in k?k.opacity:1)*("fill-opacity"in k?k["fill-opacity"]:1)})}}k.gradient=p,k.fill="none";break}G[b]("opacity")&&q(i,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case"stroke":G=a.getRGB(p),i.setAttribute(o,G.hex),o=="stroke"&&G[b]("opacity")&&q(i,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity}),o=="stroke"&&d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"gradient":(d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p);break;case"opacity":k.gradient&&!k[b]("stroke-opacity")&&q(i,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(k.gradient){H=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l)),H&&(I=H.getElementsByTagName("stop"),q(I[I.length-1],{"stop-opacity":p}));break};default:o=="font-size"&&(p=e(p,10)+"px");var J=o.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[J]=p,d._.dirty=1,i.setAttribute(o,p)}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if(d.type=="text"&&!!(f[b]("text")||f[b]("font")||f[b]("font-size")||f[b]("x")||f[b]("y"))){var g=d.attrs,h=d.node,i=h.firstChild?e(a._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue("font-size"),10):10;if(f[b]("text")){g.text=f.text;while(h.firstChild)h.removeChild(h.firstChild);var j=c(f.text).split("\n"),k=[],m;for(var n=0,o=j.length;n<o;n++)m=q("tspan"),n&&q(m,{dy:i*x,x:g.x}),m.appendChild(a._g.doc.createTextNode(j[n])),h.appendChild(m),k[n]=m}else{k=h.getElementsByTagName("tspan");for(n=0,o=k.length;n<o;n++)n?q(k[n],{dy:i*x,x:g.x}):q(k[0],{dy:0})}q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&a.is(r,"finite")&&q(k[0],{dy:r})}},z=function(b,c){var d=0,e=0;this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.matrix=a.matrix(),this.realPath=null,this.paper=c,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},A=a.el;z.prototype=A,A.constructor=z,a._engine.path=function(a,b){var c=q("path");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);d.type="path",w(d,{fill:"none",stroke:"#000",path:a});return d},A.rotate=function(a,b,e){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}this.transform(this._.transform.concat([["r",a,b,e]]));return this},A.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]]));return this},A.translate=function(a,b){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this.transform(this._.transform.concat([["t",a,b]]));return this},A.transform=function(c){var d=this._;if(c==null)return d.transform;a._extractTransform(this,c),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix});if(d.sx!=1||d.sy!=1){var e=this.attrs[b]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":e})}return this},A.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},A.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},A.remove=function(){if(!this.removed&&!!this.node.parentNode){var b=this.paper;b.__set__&&b.__set__.exclude(this),k.unbind("raphael.*.*."+this.id),this.gradient&&b.defs.removeChild(this.gradient),a._tear(this,b),this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var c in this)this[c]=typeof this[c]=="function"?a._removedFactory(c):null;this.removed=!0}},A._getBBox=function(){if(this.node.style.display=="none"){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}a&&this.hide();return b},A.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform;return e}if(d==null&&a.is(c,"string")){if(c=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(c=="transform")return this._.transform;var g=c.split(j),h={};for(var i=0,l=g.length;i<l;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return l-1?h:h[g[0]]}if(d==null&&a.is(c,"array")){h={};for(i=0,l=c.length;i<l;i++)h[c[i]]=this.attr(c[i]);return h}if(d!=null){var m={};m[c]=d}else c!=null&&a.is(c,"object")&&(m=c);for(var n in m)k("raphael.attr."+n+"."+this.id,this,m[n]);for(n in this.paper.customAttributes)if(this.paper.customAttributes[b](n)&&m[b](n)&&a.is(this.paper.customAttributes[n],"function")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o)o[b](p)&&(m[p]=o[p])}w(this,m);return this},A.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var b=this.paper;b.top!=this&&a._tofront(this,b);return this},A.toBack=function(){if(this.removed)return this;var b=this.node.parentNode;b.tagName.toLowerCase()=="a"?b.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):b.firstChild!=this.node&&b.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper);var c=this.paper;return this},A.insertAfter=function(b){if(this.removed)return this;var c=b.node||b[b.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper);return this},A.insertBefore=function(b){if(this.removed)return this;var c=b.node||b[0].node;c.parentNode.insertBefore(this.node,c),a._insertbefore(this,b,this.paper);return this},A.blur=function(b){var c=this;if(+b!==0){var d=q("filter"),e=q("feGaussianBlur");c.attrs.blur=b,d.id=a.createUUID(),q(e,{stdDeviation:+b||1.5}),d.appendChild(e),c.paper.defs.appendChild(d),c._blur=d,q(c.node,{filter:"url(#"+d.id+")"})}else c._blur&&(c._blur.parentNode.removeChild(c._blur),delete c._blur,delete c.attrs.blur),c.node.removeAttribute("filter")},a._engine.circle=function(a,b,c,d){var e=q("circle");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);f.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"},f.type="circle",q(e,f.attrs);return f},a._engine.rect=function(a,b,c,d,e,f){var g=q("rect");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",q(g,h.attrs);return h},a._engine.ellipse=function(a,b,c,d,e){var f=q("ellipse");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);g.attrs={cx:b,cy:c,rx:d,ry:e,fill:"none",stroke:"#000"},g.type="ellipse",q(f,g.attrs);return g},a._engine.image=function(a,b,c,d,e,f){var g=q("image");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:"none"}),g.setAttributeNS(n,"href",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);h.attrs={x:c,y:d,width:e,height:f,src:b},h.type="image";return h},a._engine.text=function(b,c,d,e){var f=q("text");b.canvas&&b.canvas.appendChild(f);var g=new z(f,b);g.attrs={x:c,y:d,"text-anchor":"middle",text:e,font:a._availableAttrs.font,stroke:"none",fill:"#000"},g.type="text",w(g,g.attrs);return g},a._engine.setSize=function(a,b){this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b&&b.container,d=b.x,e=b.y,f=b.width,g=b.height;if(!c)throw new Error("SVG container not found.");var h=q("svg"),i="overflow:hidden;",j;d=d||0,e=e||0,f=f||512,g=g||342,q(h,{height:g,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),c==1?(h.style.cssText=i+"position:absolute;left:"+d+"px;top:"+e+"px",a._g.doc.body.appendChild(h),j=1):(h.style.cssText=i+"position:relative",c.firstChild?c.insertBefore(h,c.firstChild):c.appendChild(h)),c=new a._Paper,c.width=f,c.height=g,c.canvas=h,c.clear(),c._left=c._top=0,j&&(c.renderfix=function(){}),c.renderfix();return c},a._engine.setViewBox=function(a,b,c,d,e){k("raphael.setViewBox",this,this._viewBox,[a,b,c,d,e]);var f=g(c/this.width,d/this.height),h=this.top,i=e?"meet":"xMinYMin",j,l;a==null?(this._vbSize&&(f=1),delete this._vbSize,j="0 0 "+this.width+m+this.height):(this._vbSize=f,j=a+m+b+m+c+m+d),q(this.canvas,{viewBox:j,preserveAspectRatio:i});while(f&&h)l="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":l}),h._.dirty=1,h._.dirtyT=1,h=h.prev;this._viewBox=[a,b,c,d,!!e];return this},a.prototype.renderfix=function(){var a=this.canvas,b=a.style,c;try{c=a.getScreenCTM()||a.createSVGMatrix()}catch(d){c=a.createSVGMatrix()}var e=-c.e%1,f=-c.f%1;if(e||f)e&&(this._left=(this._left+e)%1,b.left=this._left+"px"),f&&(this._top=(this._top+f)%1,b.top=this._top+"px")},a.prototype.clear=function(){a.eve("raphael.clear",this);var b=this.canvas;while(b.firstChild)b.removeChild(b.firstChild);this.bottom=this.top=null,(this.desc=q("desc")).appendChild(a._g.doc.createTextNode("Created with Rapha?l "+a.version)),b.appendChild(this.desc),b.appendChild(this.defs=q("defs"))},a.prototype.remove=function(){k("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null};var B=a.st;for(var C in A)A[b](C)&&!B[b](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}(window.Raphael),window.Raphael.vml&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j="fill",k=/[, ]+/,l=a.eve,m=" progid:DXImageTransform.Microsoft",n=" ",o="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\S+Blur\([^\)]+\)/g,s=/-?[^,\s-]+/g,t="position:absolute;left:0;top:0;width:1px;height:1px",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(b){var d=/[ahqstv]/ig,e=a._pathToAbsolute;c(b).match(d)&&(e=a._path2curve),d=/[clmz]/g;if(e==a._pathToAbsolute&&!c(b).match(d)){var g=c(b).replace(q,function(a,b,c){var d=[],e=b.toLowerCase()=="m",g=p[b];c.replace(s,function(a){e&&d.length==2&&(g+=d+p[b=="m"?"l":"L"],d=[]),d.push(f(a*u))});return g+d});return g}var h=e(b),i,j;g=[];for(var k=0,l=h.length;k<l;k++){i=h[k],j=h[k][0].toLowerCase(),j=="z"&&(j="x");for(var m=1,r=i.length;m<r;m++)j+=f(i[m]*u)+(m!=r-1?",":o);g.push(j)}return g.join(n)},y=function(b,c,d){var e=a.matrix();e.rotate(-b,.5,.5);return{dx:e.x(c,d),dy:e.y(c,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p="",q,r=u/b,s=u/c;m.visibility="hidden";if(!!b&&!!c){l.coordsize=i(r)+n+i(s),m.rotation=f*(b*c<0?-1:1);if(f){var t=y(f,d,e);d=t.dx,e=t.dy}b<0&&(p+="x"),c<0&&(p+=" y")&&(o=-1),m.flip=p,l.coordorigin=d*-r+n+e*-s;if(k||g.fillsize){var v=l.getElementsByTagName(j);v=v&&v[0],l.removeChild(v),k&&(t=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),v.position=t.dx*o+n+t.dy*o),g.fillsize&&(v.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(v)}m.visibility="visible"}};a.toString=function(){return"Your browser doesn?t support SVG. Falling down to VML.\nYou are running Rapha?l "+this.version};var A=function(a,b,d){var e=c(b).toLowerCase().split("-"),f=d?"end":"start",g=e.length,h="classic",i="medium",j="medium";while(g--)switch(e[g]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":h=e[g];break;case"wide":case"narrow":j=e[g];break;case"long":case"short":i=e[g]}var k=a.node.getElementsByTagName("stroke")[0];k[f+"arrow"]=h,k[f+"arrowlength"]=i,k[f+"arrowwidth"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q,r=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),s=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),t=e;for(var y in i)i[b](y)&&(m[y]=i[y]);r&&(m.path=a._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),"blur"in i&&e.blur(i.blur);if(i.path&&e.type=="path"||r)l.path=x(~c(m.path).toLowerCase().indexOf("r")?a._pathToAbsolute(m.path):m.path),e.type=="image"&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0));"transform"in i&&e.transform(i.transform);if(s){var B=+m.cx,D=+m.cy,E=+m.rx||+m.r||0,G=+m.ry||+m.r||0;l.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f((B-E)*u),f((D-G)*u),f((B+E)*u),f((D+G)*u),f(B*u))}if("clip-rect"in i){var H=c(i["clip-rect"]).split(k);if(H.length==4){H[2]=+H[2]+ +H[0],H[3]=+H[3]+ +H[1];var I=l.clipRect||a._g.doc.createElement("div"),J=I.style;J.clip=a.format("rect({1}px {2}px {3}px {0}px)",H),l.clipRect||(J.position="absolute",J.top=0,J.left=0,J.width=e.paper.width+"px",J.height=e.paper.height+"px",l.parentNode.insertBefore(I,l),I.appendChild(l),l.clipRect=I)}i["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto")}if(e.textpath){var K=e.textpath.style;i.font&&(K.font=i.font),i["font-family"]&&(K.fontFamily='"'+i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,o)+'"'),i["font-size"]&&(K.fontSize=i["font-size"]),i["font-weight"]&&(K.fontWeight=i["font-weight"]),i["font-style"]&&(K.fontStyle=i["font-style"])}"arrow-start"in i&&A(t,i["arrow-start"]),"arrow-end"in i&&A(t,i["arrow-end"],1);if(i.opacity!=null||i["stroke-width"]!=null||i.fill!=null||i.src!=null||i.stroke!=null||i["stroke-width"]!=null||i["stroke-opacity"]!=null||i["fill-opacity"]!=null||i["stroke-dasharray"]!=null||i["stroke-miterlimit"]!=null||i["stroke-linejoin"]!=null||i["stroke-linecap"]!=null){var L=l.getElementsByTagName(j),M=!1;L=L&&L[0],!L&&(M=L=F(j)),e.type=="image"&&i.src&&(L.src=i.src),i.fill&&(L.on=!0);if(L.on==null||i.fill=="none"||i.fill===null)L.on=!1;if(L.on&&i.fill){var N=c(i.fill).match(a._ISURL);if(N){L.parentNode==l&&l.removeChild(L),L.rotate=!0,L.src=N[1],L.type="tile";var O=e.getBBox(1);L.position=O.x+n+O.y,e._.fillpos=[O.x,O.y],a._preload(N[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else L.color=a.getRGB(i.fill).hex,L.src=o,L.type="solid",a.getRGB(i.fill).error&&(t.type in{circle:1,ellipse:1}||c(i.fill).charAt()!="r")&&C(t,i.fill,L)&&(m.fill="none",m.gradient=i.fill,L.rotate=!1)}if("fill-opacity"in i||"opacity"in i){var P=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+a.getRGB(i.fill).o+1||2)-1);P=h(g(P,0),1),L.opacity=P,L.src&&(L.color="none")}l.appendChild(L);var Q=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],T=!1;!Q&&(T=Q=F("stroke"));if(i.stroke&&i.stroke!="none"||i["stroke-width"]||i["stroke-opacity"]!=null||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])Q.on=!0;(i.stroke=="none"||i.stroke===null||Q.on==null||i.stroke==0||i["stroke-width"]==0)&&(Q.on=!1);var U=a.getRGB(i.stroke);Q.on&&i.stroke&&(Q.color=U.hex),P=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+U.o+1||2)-1);var V=(d(i["stroke-width"])||1)*.75;P=h(g(P,0),1),i["stroke-width"]==null&&(V=m["stroke-width"]),i["stroke-width"]&&(Q.weight=V),V&&V<1&&(P*=V)&&(Q.weight=1),Q.opacity=P,i["stroke-linejoin"]&&(Q.joinstyle=i["stroke-linejoin"]||"miter"),Q.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(Q.endcap=i["stroke-linecap"]=="butt"?"flat":i["stroke-linecap"]=="square"?"square":"round");if(i["stroke-dasharray"]){var W={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};Q.dashstyle=W[b](i["stroke-dasharray"])?W[i["stroke-dasharray"]]:o}T&&l.appendChild(Q)}if(t.type=="text"){t.paper.canvas.style.display=o;var X=t.paper.span,Y=100,Z=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);p=X.style,m.font&&(p.font=m.font),m["font-family"]&&(p.fontFamily=m["font-family"]),m["font-weight"]&&(p.fontWeight=m["font-weight"]),m["font-style"]&&(p.fontStyle=m["font-style"]),Z=d(m["font-size"]||Z&&Z[0])||10,p.fontSize=Z*Y+"px",t.textpath.string&&(X.innerHTML=c(t.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var $=X.getBoundingClientRect();t.W=m.w=($.right-$.left)/Y,t.H=m.h=($.bottom-$.top)/Y,t.X=m.x,t.Y=m.y+t.H/2,("x"in i||"y"in i)&&(t.path.v=a.format("m{0},{1}l{2},{1}",f(m.x*u),f(m.y*u),f(m.x*u)+1));var _=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var ba=0,bb=_.length;ba<bb;ba++)if(_[ba]in i){t._.dirty=1;break}switch(m["text-anchor"]){case"start":t.textpath.style["v-text-align"]="left",t.bbx=t.W/2;break;case"end":t.textpath.style["v-text-align"]="right",t.bbx=-t.W/2;break;default:t.textpath.style["v-text-align"]="center",t.bbx=0}t.textpath.style["v-text-kern"]=!0}},C=function(b,f,g){b.attrs=b.attrs||{};var h=b.attrs,i=Math.pow,j,k,l="linear",m=".5 .5";b.attrs.gradient=f,f=c(f).replace(a._radial_gradient,function(a,b,c){l="radial",b&&c&&(b=d(b),c=d(c),i(b-.5,2)+i(c-.5,2)>.25&&(c=e.sqrt(.25-i(b-.5,2))*((c>.5)*2-1)+.5),m=b+n+c);return o}),f=f.split(/\s*\-\s*/);if(l=="linear"){var p=f.shift();p=-d(p);if(isNaN(p))return null}var q=a._parseDots(f);if(!q)return null;b=b.shape||b.node;if(q.length){b.removeChild(g),g.on=!0,g.method="none",g.color=q[0].color,g.color2=q[q.length-1].color;var r=[];for(var s=0,t=q.length;s<t;s++)q[s].offset&&r.push(q[s].offset+n+q[s].color);g.colors=r.length?r.join():"0% "+g.color,l=="radial"?(g.type="gradientTitle",g.focus="100%",g.focussize="0 0",g.focusposition=m,g.angle=0):(g.type="gradient",g.angle=(270-p)%360),b.appendChild(g)}return 1},D=function(b,c){this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=c,this.matrix=a.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},E=a.el;D.prototype=E,E.constructor=D,E.transform=function(b){if(b==null)return this._.transform;var d=this.paper._viewBoxShift,e=d?"s"+[d.scale,d.scale]+"-1-1t"+[d.dx,d.dy]:o,f;d&&(f=b=c(b).replace(/\.{3}|\u2026/g,this._.transform||o)),a._extractTransform(this,e+b);var g=this.matrix.clone(),h=this.skew,i=this.node,j,k=~c(this.attrs.fill).indexOf("-"),l=!c(this.attrs.fill).indexOf("url(");g.translate(-0.5,-0.5);if(l||k||this.type=="image"){h.matrix="1 0 0 1",h.offset="0 0",j=g.split();if(k&&j.noRotation||!j.isSimple){i.style.filter=g.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;i.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else i.style.filter=o,z(this,j.scalex,j.scaley,j.dx,j.dy,j.rotate)}else i.style.filter=o,h.matrix=c(g),h.offset=g.offset();f&&(this._.transform=f);return this},E.rotate=function(a,b,e){if(this.removed)return this;if(a!=null){a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",a,b,e]]));return this}},E.translate=function(a,b){if(this.removed)return this;a=c(a).split(k),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=b),this.transform(this._.transform.concat([["t",a,b]]));return this},E.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]])),this._.dirtyT=1;return this},E.hide=function(){!this.removed&&(this.node.style.display="none");return this},E.show=function(){!this.removed&&(this.node.style.display=o);return this},E._getBBox=function(){if(this.removed)return{};return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&!!this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),a.eve.unbind("raphael.*.*."+this.id),a._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;this.removed=!0}},E.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform;return e}if(d==null&&a.is(c,"string")){if(c==j&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;var g=c.split(k),h={};for(var i=0,m=g.length;i<m;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return m-1?h:h[g[0]]}if(this.attrs&&d==null&&a.is(c,"array")){h={};for(i=0,m=c.length;i<m;i++)h[c[i]]=this.attr(c[i]);return h}var n;d!=null&&(n={},n[c]=d),d==null&&a.is(c,"object")&&(n=c);for(var o in n)l("raphael.attr."+o+"."+this.id,this,n[o]);if(n){for(o in this.paper.customAttributes)if(this.paper.customAttributes[b](o)&&n[b](o)&&a.is(this.paper.customAttributes[o],"function")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p)p[b](q)&&(n[q]=p[q])}n.text&&this.type=="text"&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&a._tofront(this,this.paper);return this},E.toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper));return this},E.insertAfter=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[b.length-1]),b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper);return this},E.insertBefore=function(b){if(this.removed)return this;b.constructor==a.st.constructor&&(b=b[0]),b.node.parentNode.insertBefore(this.node,b.node),a._insertbefore(this,b,this.paper);return this},E.blur=function(b){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(r,o),+b!==0?(this.attrs.blur=b,c.filter=d+n+m+".Blur(pixelradius="+(+b||1.5)+")",c.margin=a.format("-{0}px 0 0 -{0}px",f(+b||1.5))):(c.filter=d,c.margin=0,delete this.attrs.blur)},a._engine.path=function(a,b){var c=F("shape");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:"none",stroke:"#000"};a&&(e.path=a),d.type="path",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F("skew");f.on=!0,c.appendChild(f),d.skew=f,d.transform(o);return d},a._engine.rect=function(b,c,d,e,f,g){var h=a._rectPath(c,d,e,f,g),i=b.path(h),j=i.attrs;i.X=j.x=c,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type="rect";return i},a._engine.ellipse=function(a,b,c,d,e){var f=a.path(),g=f.attrs;f.X=b-d,f.Y=c-e,f.W=d*2,f.H=e*2,f.type="ellipse",B(f,{cx:b,cy:c,rx:d,ry:e});return f},a._engine.circle=function(a,b,c,d){var e=a.path(),f=e.attrs;e.X=b-d,e.Y=c-d,e.W=e.H=d*2,e.type="circle",B(e,{cx:b,cy:c,r:d});return e},a._engine.image=function(b,c,d,e,f,g){var h=a._rectPath(d,e,f,g),i=b.path(h).attr({stroke:"none"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];k.src=c,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type="image",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=c,m.type="tile",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0);return i},a._engine.text=function(b,d,e,g){var h=F("shape"),i=F("path"),j=F("textpath");d=d||0,e=e||0,g=g||"",i.v=a.format("m{0},{1}l{2},{1}",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=c(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin="0 0";var k=new D(h,b),l={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type="text",k.attrs.text=c(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),b.canvas.appendChild(h);var m=F("skew");m.on=!0,h.appendChild(m),k.skew=m,k.transform(o);return k},a._engine.setSize=function(b,c){var d=this.canvas.style;this.width=b,this.height=c,b==+b&&(b+="px"),c==+c&&(c+="px"),d.width=b,d.height=c,d.clip="rect(0 "+b+" "+c+" 0)",this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox);return this},a._engine.setViewBox=function(b,c,d,e,f){a.eve("raphael.setViewBox",this,this._viewBox,[b,c,d,e,f]);var h=this.width,i=this.height,j=1/g(d/h,e/i),k,l;f&&(k=i/e,l=h/d,d*k<h&&(b-=(h-d*k)/2/k),e*l<i&&(c-=(i-e*l)/2/l)),this._viewBox=[b,c,d,e,!!f],this._viewBoxShift={dx:-b,dy:-c,scale:j},this.forEach(function(a){a.transform("...")});return this};var F;a._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),F=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){F=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},a._engine.initWin(a._g.win),a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b.container,d=b.height,e,f=b.width,g=b.x,h=b.y;if(!c)throw new Error("VML container not found.");var i=new a._Paper,j=i.canvas=a._g.doc.createElement("div"),k=j.style;g=g||0,h=h||0,f=f||512,d=d||342,i.width=f,i.height=d,f==+f&&(f+="px"),d==+d&&(d+="px"),i.coordsize=u*1e3+n+u*1e3,i.coordorigin="0 0",i.span=a._g.doc.createElement("span"),i.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",j.appendChild(i.span),k.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d),c==1?(a._g.doc.body.appendChild(j),k.left=g+"px",k.top=h+"px",k.position="absolute"):c.firstChild?c.insertBefore(j,c.firstChild):c.appendChild(j),i.renderfix=function(){};return i},a.prototype.clear=function(){a.eve("raphael.clear",this),this.canvas.innerHTML=o,this.span=a._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},a.prototype.remove=function(){a.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;return!0};var G=a.st;for(var H in E)E[b](H)&&!G[b](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}(window.Raphael),function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):this[a]=b()}("clipboard",function(){if(!document.addEventListener)return null;var a={};a.copy=function(){function c(){a=!1,b=null}var a=!1,b=null;document.addEventListener("copy",function(c){if(a){for(var d in b)c.clipboardData.setData(d,b[d]);c.preventDefault()}});return function(d){return new Promise(function(e,f){a=!0,typeof d=="string"?b={"text/plain":d}:d instanceof Node?b={"text/html":(new XMLSerializer).serializeToString(d)}:b=d;try{if(document.execCommand("copy"))c(),e();else throw new Error("Unable to copy. Perhaps it's not available in your browser?")}catch(g){c(),f(g)}})}}(),a.paste=function(){var a=!1,b,c;document.addEventListener("paste",function(d){if(a){a=!1,d.preventDefault();var e=b;b=null,e(d.clipboardData.getData(c))}});return function(d){return new Promise(function(e,f){a=!0,b=e,c=d||"text/plain";try{document.execCommand("paste")||(a=!1,f(new Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(g){a=!1,f(new Error(g))}})}}(),typeof ClipboardEvent=="undefined"&&typeof window.clipboardData!="undefined"&&typeof window.clipboardData.setData!="undefined"&&(function(a){function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function f(a){this._state=!1,this._value=a,g.call(this)}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void (b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function b(a,b){return function(){a.apply(b,arguments)}}var j=c.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&k(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this),a.copy=function(a){return new Promise(function(b,c){if(typeof a!="string"&&!("text/plain"in a))throw new Error("You must provide a text/plain type.");var d=typeof a=="string"?a:a["text/plain"],e=window.clipboardData.setData("Text",d);e?b():c(new Error("Copying was rejected."))})},a.paste=function(){return new Promise(function(a,b){var c=window.clipboardData.getData("Text");c?a(c):b(new Error("Pasting was rejected."))})});return a}),function(a){function h(a){return function(b,c,d){return g(a,b,c,d)}}function g(a,c,d,g){function o(){j.abort(),h.done(i.ETIMEOUT,"",j)}var h=new b,j,k;d=d||{},g=g||{};try{j=f()}catch(l){h.done(i.ENOXHR,"");return h}k=e(d),a==="GET"&&k&&(c+="?"+k,k=null),j.open(a,c);var m="application/x-www-form-urlencoded";for(var n in g)g.hasOwnProperty(n)&&(n.toLowerCase()==="content-type"?m=g[n]:j.setRequestHeader(n,g[n]));j.setRequestHeader("Content-type",m);var p=i.ajaxTimeout;if(p)var q=setTimeout(o,p);j.onreadystatechange=function(){p&&clearTimeout(q);if(j.readyState===4){var a=!j.status||(j.status<200||j.status>=300)&&j.status!==304;h.done(a,j.responseText,j)}},j.send(k);return h}function f(){var a;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function e(a){var b="";if(typeof a=="string")b=a;else{var c=encodeURIComponent,d=[];for(var e in a)a.hasOwnProperty(e)&&d.push(c(e)+"="+c(a[e]));b=d.join("&")}return b}function d(a,c){var e=new b;a.length===0?e.done.apply(e,c):a[0].apply(null,c).then(function(){a.splice(0,1),d(a,arguments).then(function(){e.done.apply(e,arguments)})});return e}function c(a){function g(a){return function(){e+=1,d[a]=Array.prototype.slice.call(arguments),e===f&&c.done(d)}}var c=new b,d=[];if(!a||!a.length){c.done(d);return c}var e=0,f=a.length;for(var h=0;h<f;h++)a[h].then(g(h));return c}function b(){this._callbacks=[]}b.prototype.then=function(a,c){var d;this._isdone?d=a.apply(c,this.result):(d=new b,this._callbacks.push(function(){var b=a.apply(c,arguments);b&&typeof b.then=="function"&&b.then(d.done,d)}));return d},b.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var a=0;a<this._callbacks.length;a++)this._callbacks[a].apply(null,arguments);this._callbacks=[]};var i={Promise:b,join:c,chain:d,ajax:g,get:h("GET"),post:h("POST"),put:h("PUT"),del:h("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};typeof define=="function"&&define.amd?define(function(){return i}):a.promise=i}(this)
